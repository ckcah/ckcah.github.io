<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Xposed Development tutorial | 博世的个人博客</title><meta name="keywords" content="Xposed"><meta name="author" content="bosch"><meta name="copyright" content="bosch"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Alright.. you want to learn how you can create a new module for Xposed? Then read this tutorial (or let’s rather call it “extensive essay”) and learn how to approach this. This includes not only the t">
<meta property="og:type" content="article">
<meta property="og:title" content="Xposed Development tutorial">
<meta property="og:url" content="https://ckcah.github.io/2022/04/22/tutorial/index.html">
<meta property="og:site_name" content="博世的个人博客">
<meta property="og:description" content="Alright.. you want to learn how you can create a new module for Xposed? Then read this tutorial (or let’s rather call it “extensive essay”) and learn how to approach this. This includes not only the t">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.pixabay.com/photo/2016/11/23/14/37/blur-1853262__340.jpg">
<meta property="article:published_time" content="2022-04-22T02:39:26.000Z">
<meta property="article:modified_time" content="2022-05-01T09:07:00.021Z">
<meta property="article:author" content="bosch">
<meta property="article:tag" content="Xposed">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.pixabay.com/photo/2016/11/23/14/37/blur-1853262__340.jpg"><link rel="shortcut icon" href="https://ckcah.github.io/images/cat.jpg"><link rel="canonical" href="https://ckcah.github.io/2022/04/22/tutorial/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?1fc9630d700c25378bbd9cc7b83ea3a4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-XDVEQ9NLN8"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-XDVEQ9NLN8');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"GUYXF2H6BD","apiKey":"c0d60afba1b4290f43971634820e4275","indexName":"ckcah","hits":{"per_page":6},"languages":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}.","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Xposed Development tutorial',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-05-01 17:07:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/video.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://ckcah.github.io/images/title1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">103</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">41</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">21</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fa fa-book"></i><span> Books</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.pixabay.com/photo/2016/11/23/14/37/blur-1853262__340.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">博世的个人博客</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fa fa-book"></i><span> Books</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Xposed Development tutorial</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-04-22T02:39:26.000Z" title="Created 2022-04-22 10:39:26">2022-04-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-05-01T09:07:00.021Z" title="Updated 2022-05-01 17:07:00">2022-05-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90/">取证分析</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91/">安卓逆向</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">3,272</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>20min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Xposed Development tutorial"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>Alright.. you want to learn how you can create a new module for Xposed? Then read this tutorial (or let’s rather call it “extensive essay”) and learn how to approach this. This includes not only the technical “create this file and insert …”, but also the thinking behind it, which is the step where value is created and for which you really need to understand what you do and why. If you feel like “TL;DR”, you can just look at the final source code and read the “<a target="_blank" rel="noopener" href="https://github.com/rovo89/XposedBridge/wiki/Development-tutorial#definingmodules">Making the project an Xposed module</a>“ chapter. But you will get a better understanding if you read the whole tutorial. You will save the time spent for reading this later because you don’t have to figure everything out yourself.</p>
<h1 id="The-modification-subject"><a href="#The-modification-subject" class="headerlink" title="The modification subject"></a>The modification subject</h1><p>You will recreate the red clock example that can be found at <a target="_blank" rel="noopener" href="https://github.com/rovo89/XposedExamples/tree/master/RedClock">Github</a> as well. It includes changing the color of the status bar clock to red and adding a smiley. I’m choosing this example because it is a rather small, but easily visible change. Also, it uses some of the basic methods provided by the framework.</p>
<h1 id="How-Xposed-works"><a href="#How-Xposed-works" class="headerlink" title="How Xposed works"></a>How Xposed works</h1><p>Before beginning with your modification, you should get a rough idea how Xposed works (you might skip this section though if you feel too bored). Here is how:</p>
<p>There is a process that is called “Zygote”. This is the heart of the Android runtime. Every application is started as a copy (“fork”) of it. This process is started by an <code>/init.rc</code> script when the phone is booted. The process start is done with <code>/system/bin/app_process</code>, which loads the needed classes and invokes the initialization methods.</p>
<p>This is where Xposed comes into play. When you install the framework, an <a target="_blank" rel="noopener" href="https://github.com/rovo89/Xposed">extended app_process</a> executable is copied to <code>/system/bin</code>. This extended startup process adds an additional jar to the classpath and calls methods from there at certain places. For instance, just after the VM has been created, even before the <code>main</code> method of Zygote has been called. And inside that method, we are part of Zygote and can act in its context.</p>
<p>The jar is located at <code>/data/data/de.robv.android.xposed.installer/bin/XposedBridge.jar</code> and its source code can be found <a target="_blank" rel="noopener" href="https://github.com/rovo89/XposedBridge">here</a>. Looking at the class [XposedBridge] (<a target="_blank" rel="noopener" href="https://github.com/rovo89/XposedBridge/blob/master/src/de/robv/android/xposed/XposedBridge.java">https://github.com/rovo89/XposedBridge/blob/master/src/de/robv/android/xposed/XposedBridge.java</a>), you can see the <code>main</code> method. This is what I wrote about above, this gets called in the very beginning of the process. Some initializations are done there and also the modules are loaded (I will come back to module loading later).</p>
<h4 id="Method-hooking-replacing"><a href="#Method-hooking-replacing" class="headerlink" title="Method hooking/replacing"></a>Method hooking/replacing</h4><p>What really creates the power of Xposed is the possibility to “hook” method calls. When you do a modification by decompiling an APK, you can insert/change commands directly wherever you want. However, you will need to recompile/sign the APK afterwards and you can only distribute the whole package. With the hooks you can place with Xposed, you can’t modify the code inside methods (it would be impossible to define clearly what kind of changes you want to do in which place). Instead, you can inject your own code before and after methods, which are the smallest unit in Java that can be addressed clearly.</p>
<p>XposedBridge has a private, native method <code>hookMethodNative</code>. This method is implemented in the extended <code>app_process</code> as well. It will change the method type to “native” and link the method implementation to its own native, generic method. That means that every time the hooked method is called, the generic method will be called instead without the caller knowing about it. In this method, the method <code>handleHookedMethod</code> in XposedBridge is called, passing over the arguments to the method call, the <code>this</code> reference etc. And this method then takes care of invoking callbacks that have been registered for this method call. Those can change the arguments for the call, change instance/static variables, invoke other methods, do something with the result… or skip anything of that. It is very flexible.</p>
<p>Ok, enough theory. Let’s create a module now!</p>
<h1 id="Creating-the-project"><a href="#Creating-the-project" class="headerlink" title="Creating the project"></a>Creating the project</h1><p>A module is normal app, just with some special meta data and files. So begin with creating a new Android project. I assume you have already done this before. If not, the [official documentation] (<a target="_blank" rel="noopener" href="http://developer.android.com/sdk/installing.html">http://developer.android.com/sdk/installing.html</a>) is quite detailed. When asked for the SDK, I chose 4.0.3 (API 15). I suggest you try this as well and do not start experiments yet. You don’t need to create an activity because the modification does not have any user-interface. After answering that question, you should have a blank project.</p>
<p># Making the project an Xposed module Now let’s turn the project into something loaded by Xposed, a module. Several steps are required for this.</p>
<h4 id="Adding-the-Xposed-Framework-API-to-your-project"><a href="#Adding-the-Xposed-Framework-API-to-your-project" class="headerlink" title="Adding the Xposed Framework API to your project"></a>Adding the Xposed Framework API to your project</h4><p>You can find the required steps in <a target="_blank" rel="noopener" href="https://github.com/rovo89/XposedBridge/wiki/Using-the-Xposed-Framework-API">Using the Xposed Framework API</a>. Make sure to remember the API version, you’ll need it in the next step.</p>
<h4 id="AndroidManifest-xml"><a href="#AndroidManifest-xml" class="headerlink" title="AndroidManifest.xml"></a>AndroidManifest.xml</h4><p>The module list in the Xposed Installer looks for applications with a special meta data flag. You can create it by going to AndroidManifest.xml =&gt; Application =&gt; Application Nodes (at the bottom) =&gt; Add =&gt; Meta Data. The name should be <code>xposedmodule</code> and the value <code>true</code>. Leave the resource empty. Then repeat the same for <code>xposedminversion</code> (the API version from the previous step) and <code>xposeddescription</code> (a very short description of your module). The XML source will now look like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    package=&quot;de.robv.android.xposed.mods.tutorial&quot;</span><br><span class="line">    android:versionCode=&quot;1&quot;</span><br><span class="line">    android:versionName=&quot;1.0&quot; &gt;</span><br><span class="line"></span><br><span class="line">    &lt;uses-sdk android:minSdkVersion=&quot;15&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;application</span><br><span class="line">        android:icon=&quot;@drawable/ic_launcher&quot;</span><br><span class="line">        android:label=&quot;@string/app_name&quot; &gt;</span><br><span class="line">        &lt;meta-data</span><br><span class="line">            android:name=&quot;xposedmodule&quot;</span><br><span class="line">            android:value=&quot;true&quot; /&gt;</span><br><span class="line">        &lt;meta-data</span><br><span class="line">            android:name=&quot;xposeddescription&quot;</span><br><span class="line">            android:value=&quot;Easy example which makes the status bar clock red and adds a smiley&quot; /&gt;</span><br><span class="line">        &lt;meta-data</span><br><span class="line">            android:name=&quot;xposedminversion&quot;</span><br><span class="line">            android:value=&quot;53&quot; /&gt;</span><br><span class="line">    &lt;/application&gt;</span><br><span class="line">&lt;/manifest&gt;</span><br></pre></td></tr></table></figure>

<h4 id="Module-implementation"><a href="#Module-implementation" class="headerlink" title="Module implementation"></a>Module implementation</h4><p>Now you can create a class for your module. Mine is named “Tutorial” and is in the package <code>de.robv.android.xposed.mods.tutorial</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">package de.robv.android.xposed.mods.tutorial;</span><br><span class="line"></span><br><span class="line">public class Tutorial &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>For the first step, we will just do some logging to show that the module was loaded. A module can have a few entry points. Which one(s) you choose depends on the what you want to modify. You can have Xposed call a function in your module when the Android system boots, when a new app is about to be loaded, when the resources for an app are initialised and so on.</p>
<p>A bit further down this tutorial, you will learn that the necessary changes need to be done in one specific app, so let’s go with the “let me know when a new app is loaded” entry point. All entry points are marked with a sub-interface of IXposedMod. In this case, it’s IXposedHookLoadPackage which you need to implement. It’s actually just one method with one parameter that gives more information about the context to the implementing module. In our example, let’s log the name of the loaded app:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">package de.robv.android.xposed.mods.tutorial;</span><br><span class="line"></span><br><span class="line">import de.robv.android.xposed.IXposedHookLoadPackage;</span><br><span class="line">import de.robv.android.xposed.XposedBridge;</span><br><span class="line">import de.robv.android.xposed.callbacks.XC_LoadPackage.LoadPackageParam;</span><br><span class="line"></span><br><span class="line">public class Tutorial implements IXposedHookLoadPackage &#123;</span><br><span class="line">    public void handleLoadPackage(final LoadPackageParam lpparam) throws Throwable &#123;</span><br><span class="line">        XposedBridge.log(&quot;Loaded app: &quot; + lpparam.packageName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This log method writes the message to the standard logcat (tag <code>Xposed</code>) and to /data/data/de.robv.android.xposed.installer/log/debug.log` (which is easily accessible via the Xposed Installer).</p>
<h4 id="assets-xposed-init"><a href="#assets-xposed-init" class="headerlink" title="assets/xposed_init"></a>assets/xposed_init</h4><p>The only thing that is still missing now is a hint for XposedBridge which classes contain such entry points. This is done via a file called <code>xposed_init</code>. Create a new text file with that name in the <code>assets</code> folder. In this file, each line contains one fully qualified class name. In this case, this is <code>de.robv.android.xposed.mods.tutorial.Tutorial</code>.</p>
<h1 id="Trying-it-out"><a href="#Trying-it-out" class="headerlink" title="Trying it out"></a>Trying it out</h1><p>Save your files. Then run your project as Android application. As this is the first time you install it, you need to enable it before you can use it. Open the Xposed Installer app and make sure you have installed the framework. Then go to the “Modules” tab. You should find your app in there. Check the box to enable it. Then reboot. You will not see a difference of course, but if you check the log, you should see something like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Loading Xposed (for Zygote)...</span><br><span class="line">Loading modules from /data/app/de.robv.android.xposed.mods.tutorial-1.apk</span><br><span class="line">  Loading class de.robv.android.xposed.mods.tutorial.Tutorial</span><br><span class="line">Loaded app: com.android.systemui</span><br><span class="line">Loaded app: com.android.settings</span><br><span class="line">... (many more apps follow)</span><br></pre></td></tr></table></figure>

<p>Voilà! That worked. You now have an Xposed module. It could just be a bit more useful than writing logs…</p>
<h1 id="Exploring-your-target-and-finding-a-way-to-modify-it"><a href="#Exploring-your-target-and-finding-a-way-to-modify-it" class="headerlink" title="Exploring your target and finding a way to modify it"></a>Exploring your target and finding a way to modify it</h1><p>Ok, so now begins the part that can be very different depending on what you want to do. If you have modded APKs before, you probably know how to think here. In general, you first need to get some details about the implementation of the target. In this tutorial, the target is the clock in the statusbar. It helps to know that the statusbar and lots of other things are part of the SystemUI. So let’s begin our search there.</p>
<p>Possibility one: Decompile it. This will give you the exact implementation, but it is hard to read and understand because you get smali format. Possibility two: Get the AOSP sources (e.g. [here] (<a target="_blank" rel="noopener" href="http://source.android.com/source/downloading.html">http://source.android.com/source/downloading.html</a>) or [here] (<a target="_blank" rel="noopener" href="http://grepcode.com/snapshot/repository.grepcode.com/java/ext/com.google.android/android/4.0.3_r1/">http://grepcode.com/snapshot/repository.grepcode.com/java/ext/com.google.android/android/4.0.3_r1/</a>) and look there. This can be quite different from your ROM, but in this case it is a similar or even the same implementation. I would look at AOSP first and see if that is enough. If I need more details, look at the actual decompiled code.</p>
<p>You can look for classes with “clock” in their name or containing that string. Other things to look for are resources and layout used. If you downloaded the official AOSP code, you can start looking in <code>frameworks/base/packages/SystemUI</code>. You will find quite a few places where “clock” appears. This is normal and indeed there will be different ways to implement a modification. Keep in mind that you can “only” hook methods. So you have to find a place where you can insert some code to do the magic either before, after or replacing a method. You should hook methods that are as specific as possible, not ones that are called thousands of times to avoid performance issues and unintended side-effects.</p>
<p>In this case, you might find that the layout <code>res/layout/status_bar.xml</code> contains a reference to a custom view with the class <code>com.android.systemui.statusbar.policy.Clock</code>. Multiple ideas might come to your mind now. The text color is defined via a <code>textAppearance</code> attribute, so the cleanest way to change it would be to change the appearance definition. However, the this is not possible to change styles with the Xposed framework and probably won’t be (it’s too deep in native code). Replacing the layout for the statusbar would be possible, but an overkill for the small change you are trying to make. Instead, look at this class. There is a method called <code>updateClock</code>, which seems to be called every minute to update the time:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">final void updateClock() &#123;</span><br><span class="line">    mCalendar.setTimeInMillis(System.currentTimeMillis());</span><br><span class="line">    setText(getSmallTime());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>That looks perfect for modifications because it is a very specific method which seems to be the only means of setting the text for the clock. If we add something after every call to this method that changes the color and the text of the clock, that should work. So let’s do it.</p>
<blockquote>
<p>For the text color alone, there is an even better way. See the example for “Modifying layouts” on “<a target="_blank" rel="noopener" href="https://github.com/rovo89/XposedBridge/wiki/Replacing-resources">Replacing resources</a>“.</p>
</blockquote>
<h1 id="Using-reflection-to-find-and-hook-a-method"><a href="#Using-reflection-to-find-and-hook-a-method" class="headerlink" title="Using reflection to find and hook a method"></a>Using reflection to find and hook a method</h1><p>What do we already know? We have a method <code>updateClock</code> in class <code>com.android.systemui.statusbar.policy.Clock</code> that we want to intercept. We found this class inside the SystemUI sources, so it will only be available in the process for the SystemUI. Some other classes belong to the framework and are available everywhere. If we tried to get any information and references to this class directly in the <code>handleLoadPackage</code> mehod, this would fail because it is the wrong process. So let’s implement a condition to execute certain code only when a specified package is about to be loaded:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public void handleLoadPackage(LoadPackageParam lpparam) throws Throwable &#123;</span><br><span class="line">    if (!lpparam.packageName.equals(&quot;com.android.systemui&quot;))</span><br><span class="line">        return;</span><br><span class="line"></span><br><span class="line">    XposedBridge.log(&quot;we are in SystemUI!&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Using the parameter, we can easily check if we are in the correct package. Once we verified that, we get access to the classes in that packages with the ClassLoader which is also referenced from this variable. Now we can look for the <code>com.android.systemui.statusbar.policy.Clock</code> class and its <code>updateClock</code> method and tell XposedBridge to hook it:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">package de.robv.android.xposed.mods.tutorial;</span><br><span class="line"></span><br><span class="line">import static de.robv.android.xposed.XposedHelpers.findAndHookMethod;</span><br><span class="line">import de.robv.android.xposed.IXposedHookLoadPackage;</span><br><span class="line">import de.robv.android.xposed.XC_MethodHook;</span><br><span class="line">import de.robv.android.xposed.callbacks.XC_LoadPackage.LoadPackageParam;</span><br><span class="line"></span><br><span class="line">public class Tutorial implements IXposedHookLoadPackage &#123;</span><br><span class="line">    public void handleLoadPackage(final LoadPackageParam lpparam) throws Throwable &#123;</span><br><span class="line">    	if (!lpparam.packageName.equals(&quot;com.android.systemui&quot;))</span><br><span class="line">            return;</span><br><span class="line">    	</span><br><span class="line">    	findAndHookMethod(&quot;com.android.systemui.statusbar.policy.Clock&quot;, lpparam.classLoader, &quot;updateClock&quot;, new XC_MethodHook() &#123;</span><br><span class="line">    		@Override</span><br><span class="line">    		protected void beforeHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">    			// this will be called before the clock was updated by the original method</span><br><span class="line">    		&#125;</span><br><span class="line">    		@Override</span><br><span class="line">    		protected void afterHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">    			// this will be called after the clock was updated by the original method</span><br><span class="line">    		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>findAndHookMethod</code> is a <a target="_blank" rel="noopener" href="https://github.com/rovo89/XposedBridge/wiki/Helpers">helper</a> function. Note the static import, which is automatically added if you configure it as described in the linked page. This method looks up the <code>Clock</code> class using the ClassLoader for the SystemUI package. Then it looks for the <code>updateClock</code> method in it. If there were any parameters to this method, you would have to list the types (classes) of these parameters afterwards. There are different ways to do this, but as our method doesn’t have any parameters, let’s skip this for now. As the last argument, you need to provide an implementation of the <code>XC_MethodHook</code> class. For smaller modifications, you can use a anonymous class. If you have much code, it’s better to create a normal class and only create the instance here. The helper will then do everything necessary to hook the method as described above.</p>
<p>There are two methods in <code>XC_MethodHook</code> that you can override. You can override both or even none, but the latter makes absolutely no sense. These methods are <code>beforeHookedMethod</code> and <code>afterHookedMethod</code>. It’s not too hard to guess that the are executed before/after the original method. You can use the “before” method to evaluate/manipulate the parameters of the method call (via <code>param.args</code>) and even prevent the call to the original method (sending your own result). The “after” method can be used to do something based on the result of the original method. You can also manipulate the result at this point. And of course, you can add your own code which should be executed exactly before/after the method call.</p>
<blockquote>
<p>If you want to replace a method completely, have a look at the subclass <code>XC_MethodReplacement</code> instead, where you just need to override <code>replaceHookedMethod</code>.</p>
</blockquote>
<p>XposedBridge keeps a list of registered callbacks for each hooked method. Those with highest priority (as defined in hookMethod) are called first. The original method has always the lowest priority. So if you have hooked a method with callbacks A (prio high) and B (prio default), then whenever the hooked method is called, the control flow will be this: A.before -&gt; B.before -&gt; original method -&gt; B.after -&gt; A.after. So A could influence the arguments B gets to see, which could further change them before passing them on. The result of the original method can be processed by B first, but A has the final word what the original caller gets.</p>
<h1 id="Final-steps-Execute-your-own-code-before-after-the-method-call"><a href="#Final-steps-Execute-your-own-code-before-after-the-method-call" class="headerlink" title="Final steps: Execute your own code before/after the method call"></a>Final steps: Execute your own code before/after the method call</h1><p>Alright, you have now a method that is called every time the <code>updateClock</code> method is called, with exactly that context (i.e. you’re in the SystemUI process). Now let’s modify something.</p>
<p>First thing to check: Do we have a reference to the concrete Clock object? Yes we have, it’s in the <code>param.thisObject</code> parameter. So if the method was called with <code>myClock.updateClock()</code>, then <code>param.thisObject</code> would be <code>myClock</code>.</p>
<p>Next: What can we do with the clock? The <code>Clock</code> class is not available, you can’t cast <code>param.thisObject</code> to class (don’t even try to). However it inherits from <code>TextView</code>. So you can use methods like <code>setText</code>, <code>getText</code> and <code>setTextColor</code> once you have casted the <code>Clock</code> reference to <code>TextView</code>. The changes should be done after the original method has set the new time. As there is nothing to do before the method call, we can leave out the <code>beforeHookedMethod</code>. Calling the (empty) “super” method is not necessary.</p>
<p>So here is the complete source code:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">package de.robv.android.xposed.mods.tutorial;</span><br><span class="line"></span><br><span class="line">import static de.robv.android.xposed.XposedHelpers.findAndHookMethod;</span><br><span class="line">import android.graphics.Color;</span><br><span class="line">import android.widget.TextView;</span><br><span class="line">import de.robv.android.xposed.IXposedHookLoadPackage;</span><br><span class="line">import de.robv.android.xposed.XC_MethodHook;</span><br><span class="line">import de.robv.android.xposed.callbacks.XC_LoadPackage.LoadPackageParam;</span><br><span class="line"></span><br><span class="line">public class Tutorial implements IXposedHookLoadPackage &#123;</span><br><span class="line">	public void handleLoadPackage(final LoadPackageParam lpparam) throws Throwable &#123;</span><br><span class="line">		if (!lpparam.packageName.equals(&quot;com.android.systemui&quot;))</span><br><span class="line">			return;</span><br><span class="line"></span><br><span class="line">		findAndHookMethod(&quot;com.android.systemui.statusbar.policy.Clock&quot;, lpparam.classLoader, &quot;updateClock&quot;, new XC_MethodHook() &#123;</span><br><span class="line">			@Override</span><br><span class="line">			protected void afterHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">				TextView tv = (TextView) param.thisObject;</span><br><span class="line">				String text = tv.getText().toString();</span><br><span class="line">				tv.setText(text + &quot; :)&quot;);</span><br><span class="line">				tv.setTextColor(Color.RED);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Be-happy-about-the-result"><a href="#Be-happy-about-the-result" class="headerlink" title="Be happy about the result"></a>Be happy about the result</h1><p>Now install/start your app again. As you have already enabled it in the Xposed Installer when you started it the first time, you do not need to do that again, rebooting is enough. However, you will want to disable the red clock example if you were using it. Both use the default priority for their <code>updateClock</code> handler, so you cannot know which one will win (it actually depends on the string representation of the handler method, but don’t rely on that).</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>I know that this tutorial was very long. But I hope you can now not only implement a green clock, but also something completely different. Finding good methods to hook is a matter of experience, so start with something rather easy. Try using the <code>log</code> functions a lot in the beginning to make sure that everything is called when you expect it. And now: Have fun!</p>
<p><strong>文档来源：<a target="_blank" rel="noopener" href="https://github.com/rovo89/XposedBridge/wiki/Development-tutorial">https://github.com/rovo89/XposedBridge/wiki/Development-tutorial</a></strong></p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css"></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://ckcah.github.io">bosch</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://ckcah.github.io/2022/04/22/tutorial/">https://ckcah.github.io/2022/04/22/tutorial/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Xposed/">Xposed</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.pixabay.com/photo/2016/11/23/14/37/blur-1853262__340.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/04/23/%E8%B4%A7%E5%B8%81%E6%88%98%E4%BA%89-%E5%AE%8B%E9%B8%BF%E5%85%B5/"><img class="prev-cover" src="https://i.pinimg.com/236x/48/60/2b/48602bacede84c60b8fe95e6b3c08bca.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">货币战争-宋鸿兵</div></div></a></div><div class="next-post pull-right"><a href="/2022/04/21/HOOK%E7%AE%80%E5%8D%95%E7%90%86%E8%A7%A3/"><img class="next-cover" src="https://cdn.pixabay.com/photo/2020/04/08/16/32/keyboard-5017973__340.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">HOOK简单理解</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Gitalk</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://ckcah.github.io/images/title1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">bosch</div><div class="author-info__description">现在就要学既走得快又走得远的东西</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">103</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">41</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">21</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ckcah"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/ckcah" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:bcheng490@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">不管怎么样，总要追求点什么，多累一点才好</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#The-modification-subject"><span class="toc-number">1.</span> <span class="toc-text">The modification subject</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#How-Xposed-works"><span class="toc-number">2.</span> <span class="toc-text">How Xposed works</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Method-hooking-replacing"><span class="toc-number">2.0.0.1.</span> <span class="toc-text">Method hooking&#x2F;replacing</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Creating-the-project"><span class="toc-number">3.</span> <span class="toc-text">Creating the project</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Adding-the-Xposed-Framework-API-to-your-project"><span class="toc-number">3.0.0.1.</span> <span class="toc-text">Adding the Xposed Framework API to your project</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AndroidManifest-xml"><span class="toc-number">3.0.0.2.</span> <span class="toc-text">AndroidManifest.xml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Module-implementation"><span class="toc-number">3.0.0.3.</span> <span class="toc-text">Module implementation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#assets-xposed-init"><span class="toc-number">3.0.0.4.</span> <span class="toc-text">assets&#x2F;xposed_init</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Trying-it-out"><span class="toc-number">4.</span> <span class="toc-text">Trying it out</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Exploring-your-target-and-finding-a-way-to-modify-it"><span class="toc-number">5.</span> <span class="toc-text">Exploring your target and finding a way to modify it</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Using-reflection-to-find-and-hook-a-method"><span class="toc-number">6.</span> <span class="toc-text">Using reflection to find and hook a method</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Final-steps-Execute-your-own-code-before-after-the-method-call"><span class="toc-number">7.</span> <span class="toc-text">Final steps: Execute your own code before&#x2F;after the method call</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Be-happy-about-the-result"><span class="toc-number">8.</span> <span class="toc-text">Be happy about the result</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Conclusion"><span class="toc-number">9.</span> <span class="toc-text">Conclusion</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/06/08/%E5%A6%82%E4%BD%95%E9%80%89%E5%9F%BA%E9%87%91-%E8%B5%84%E4%BA%A7%E9%85%8D%E7%BD%AE%E7%AC%94%E8%AE%B0/" title="如何选基金-资产配置笔记"><img src="https://cdn.pixabay.com/photo/2016/03/26/13/09/workspace-1280538__340.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="如何选基金-资产配置笔记"/></a><div class="content"><a class="title" href="/2022/06/08/%E5%A6%82%E4%BD%95%E9%80%89%E5%9F%BA%E9%87%91-%E8%B5%84%E4%BA%A7%E9%85%8D%E7%BD%AE%E7%AC%94%E8%AE%B0/" title="如何选基金-资产配置笔记">如何选基金-资产配置笔记</a><time datetime="2022-06-08T06:42:34.000Z" title="Created 2022-06-08 14:42:34">2022-06-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/01/%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B/" title="取证分析流程"><img src="https://i.pinimg.com/236x/d2/f3/b9/d2f3b9a9e3c7c99c6268a0f8e0c5e12d.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="取证分析流程"/></a><div class="content"><a class="title" href="/2022/06/01/%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B/" title="取证分析流程">取证分析流程</a><time datetime="2022-06-01T07:36:18.000Z" title="Created 2022-06-01 15:36:18">2022-06-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/09/Android%E5%8A%A0%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E5%8A%A0%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3/" title="Android加壳与脱壳（二）：加壳与脱壳"><img src="https://cdn.pixabay.com/photo/2021/08/04/20/27/circuit-board-6522546__340.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android加壳与脱壳（二）：加壳与脱壳"/></a><div class="content"><a class="title" href="/2022/05/09/Android%E5%8A%A0%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E5%8A%A0%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3/" title="Android加壳与脱壳（二）：加壳与脱壳">Android加壳与脱壳（二）：加壳与脱壳</a><time datetime="2022-05-09T06:24:16.000Z" title="Created 2022-05-09 14:24:16">2022-05-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/06/Android%20Inline%20Hook%20%E5%88%9D%E8%AF%86/" title="Android Inline Hook 初识"><img src="https://cdn.pixabay.com/photo/2016/03/27/07/12/apple-1282241__340.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android Inline Hook 初识"/></a><div class="content"><a class="title" href="/2022/05/06/Android%20Inline%20Hook%20%E5%88%9D%E8%AF%86/" title="Android Inline Hook 初识">Android Inline Hook 初识</a><time datetime="2022-05-06T12:18:29.000Z" title="Created 2022-05-06 20:18:29">2022-05-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/06/Android%E5%8A%A0%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%E4%B8%8E%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E7%9A%84%E5%85%B3%E7%B3%BB%E4%B8%8E%E5%8E%9F%E7%90%86/" title="Android加壳与脱壳（一）：类加载器与动态加载的关系与原理"><img src="https://i.pinimg.com/236x/ff/6c/fe/ff6cfe7fac0da7c023166f2849bbcade.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android加壳与脱壳（一）：类加载器与动态加载的关系与原理"/></a><div class="content"><a class="title" href="/2022/05/06/Android%E5%8A%A0%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%E4%B8%8E%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E7%9A%84%E5%85%B3%E7%B3%BB%E4%B8%8E%E5%8E%9F%E7%90%86/" title="Android加壳与脱壳（一）：类加载器与动态加载的关系与原理">Android加壳与脱壳（一）：类加载器与动态加载的关系与原理</a><time datetime="2022-05-06T06:54:43.000Z" title="Created 2022-05-06 14:54:43">2022-05-06</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By bosch</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Algolia</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'A1yHizbt6njivw1xL89dRlHw-gzGzoHsz',
      appKey: 'dUsAYDyF0DqEAvpSTG3sioz6',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '',
      clientSecret: '',
      repo: '',
      owner: '',
      admin: [''],
      id: 'f6e93d1c35670a77b9805376757ee410',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Valine' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>
  function gitcalendar_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 280px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      console.log('已挂载gitcalendar')
      }

    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
        gitcalendar_injector_config()
        GitCalendarInit("ckcah-github-io-1.vercel.app/api?ckcah",['#ebedf0', '#f1f8ff', '#dbedff', '#c8e1ff', '#79b8ff', '#2188ff', '#0366d6', '#005cc5', '#044289', '#032f62', '#05264c'],'ckcah')
    }
  </script><!-- hexo injector body_end end --></body></html>